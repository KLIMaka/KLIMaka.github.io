{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./node_modules/@popperjs/core/lib/dom-utils/contains.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getNodeName.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getParentNode.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getWindow.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/instanceOf.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/isTableElement.js","webpack:///./node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js","webpack:///./node_modules/@popperjs/core/lib/enums.js","webpack:///./node_modules/@popperjs/core/lib/index.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/applyStyles.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/arrow.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/computeStyles.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/eventListeners.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/flip.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/hide.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/offset.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/popperOffsets.js","webpack:///./node_modules/@popperjs/core/lib/modifiers/preventOverflow.js","webpack:///./node_modules/@popperjs/core/lib/popper.js","webpack:///./node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js","webpack:///./node_modules/@popperjs/core/lib/utils/computeOffsets.js","webpack:///./node_modules/@popperjs/core/lib/utils/debounce.js","webpack:///./node_modules/@popperjs/core/lib/utils/detectOverflow.js","webpack:///./node_modules/@popperjs/core/lib/utils/expandToHashMap.js","webpack:///./node_modules/@popperjs/core/lib/utils/format.js","webpack:///./node_modules/@popperjs/core/lib/utils/getAltAxis.js","webpack:///./node_modules/@popperjs/core/lib/utils/getBasePlacement.js","webpack:///./node_modules/@popperjs/core/lib/utils/getFreshSideObject.js","webpack:///./node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js","webpack:///./node_modules/@popperjs/core/lib/utils/getOppositePlacement.js","webpack:///./node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js","webpack:///./node_modules/@popperjs/core/lib/utils/getVariation.js","webpack:///./node_modules/@popperjs/core/lib/utils/mergeByName.js","webpack:///./node_modules/@popperjs/core/lib/utils/mergePaddingObject.js","webpack:///./node_modules/@popperjs/core/lib/utils/orderModifiers.js","webpack:///./node_modules/@popperjs/core/lib/utils/rectToClientRect.js","webpack:///./node_modules/@popperjs/core/lib/utils/uniqueBy.js","webpack:///./node_modules/@popperjs/core/lib/utils/validateModifiers.js","webpack:///./node_modules/@popperjs/core/lib/utils/within.js","webpack:///./node_modules/solid-js/dist/dom/index.js","webpack:///./node_modules/solid-js/dist/index.js","webpack:///./node_modules/stage0/index.js","webpack:///./node_modules/tippy.js/dist/tippy.esm.js","webpack:///./src/app/apis/app.ts","webpack:///./src/app/apis/builder.ts","webpack:///./src/app/apis/handler.ts","webpack:///./src/app/apis/referencetracker.ts","webpack:///./src/app/apis/renderable.ts","webpack:///./src/app/apis/scheduler.ts","webpack:///./src/app/apis/ui.ts","webpack:///./src/app/edit/context.ts","webpack:///./src/app/edit/editutils.ts","webpack:///./src/app/edit/handle.ts","webpack:///./src/app/edit/messages.ts","webpack:///./src/app/edit/sector.ts","webpack:///./src/app/edit/sprite.ts","webpack:///./src/app/edit/tools/drawsector.ts","webpack:///./src/app/edit/tools/drawwall.ts","webpack:///./src/app/edit/tools/joinsectors.ts","webpack:///./src/app/edit/tools/pushwall.ts","webpack:///./src/app/edit/tools/selection.ts","webpack:///./src/app/edit/tools/toolsbus.ts","webpack:///./src/app/edit/tools/utils.ts","webpack:///./src/app/edit/wall.ts","webpack:///./src/app/edit/wallsegment.ts","webpack:///./src/app/input/keymap.ts","webpack:///./src/app/input/messageparser.ts","webpack:///./src/app/modules/arteditor.ts","webpack:///./src/app/modules/artselector.ts","webpack:///./src/app/modules/buildartprovider.ts","webpack:///./src/app/modules/context.ts","webpack:///./src/app/modules/db.ts","webpack:///./src/app/modules/default/grid.ts","webpack:///./src/app/modules/default/history.ts","webpack:///./src/app/modules/default/reftracker.ts","webpack:///./src/app/modules/default/state.ts","webpack:///./src/app/modules/default/utiltex.ts","webpack:///./src/app/modules/duke/module.ts","webpack:///./src/app/modules/fs/db.ts","webpack:///./src/app/modules/fs/fs.ts","webpack:///./src/app/modules/fs/manager.ts","webpack:///./src/app/modules/fs/mount.ts","webpack:///./src/app/modules/geometry/builders/common.ts","webpack:///./src/app/modules/geometry/builders/sector.ts","webpack:///./src/app/modules/geometry/builders/sectorcluster.ts","webpack:///./src/app/modules/geometry/builders/sectorhelper.ts","webpack:///./src/app/modules/geometry/builders/selected.ts","webpack:///./src/app/modules/geometry/builders/setups.ts","webpack:///./src/app/modules/geometry/builders/sprite.ts","webpack:///./src/app/modules/geometry/builders/sprite2d.ts","webpack:///./src/app/modules/geometry/builders/spritehelper.ts","webpack:///./src/app/modules/geometry/builders/wall.ts","webpack:///./src/app/modules/geometry/builders/wall2d.ts","webpack:///./src/app/modules/geometry/builders/wallhelper.ts","webpack:///./src/app/modules/geometry/builders/wallpointhelper.ts","webpack:///./src/app/modules/geometry/cache.ts","webpack:///./src/app/modules/geometry/common.ts","webpack:///./src/app/modules/gl/buffers.ts","webpack:///./src/app/modules/gl/buildgl.ts","webpack:///./src/app/modules/info.tsx","webpack:///./src/app/modules/input.ts","webpack:///./src/app/modules/photonui.ts","webpack:///./src/app/modules/selectmap.ts","webpack:///./src/app/modules/statusbar.ts","webpack:///./src/app/modules/taskmanager.ts","webpack:///./src/app/modules/view/boardrenderer2d.ts","webpack:///./src/app/modules/view/boardrenderer3d.ts","webpack:///./src/app/modules/view/view.ts","webpack:///./src/app/modules/view/view2d.ts","webpack:///./src/app/modules/view/view3d.ts","webpack:///./src/build/artpixelprovider.ts","webpack:///./src/build/board/distances.ts","webpack:///./src/build/board/loops.ts","webpack:///./src/build/board/mutations/ceatesector.ts","webpack:///./src/build/board/mutations/drawwall.ts","webpack:///./src/build/board/mutations/internal.ts","webpack:///./src/build/board/mutations/joinsectors.ts","webpack:///./src/build/board/mutations/sectorbuilder.ts","webpack:///./src/build/board/mutations/sectors.ts","webpack:///./src/build/board/mutations/splitsector.ts","webpack:///./src/build/board/mutations/sprites.ts","webpack:///./src/build/board/mutations/walls.ts","webpack:///./src/build/board/query.ts","webpack:///./src/build/board/structs.ts","webpack:///./src/build/boardvisitor.ts","webpack:///./src/build/formats/art.ts","webpack:///./src/build/formats/grp.ts","webpack:///./src/build/hitscan.ts","webpack:///./src/build/maploader.ts","webpack:///./src/build/utils.ts","webpack:///./src/builded.ts","webpack:///./src/libs_js/glmatrix.js","webpack:///./src/libs_js/glmatrix/common.js","webpack:///./src/libs_js/glmatrix/mat2.js","webpack:///./src/libs_js/glmatrix/mat2d.js","webpack:///./src/libs_js/glmatrix/mat3.js","webpack:///./src/libs_js/glmatrix/mat4.js","webpack:///./src/libs_js/glmatrix/quat.js","webpack:///./src/libs_js/glmatrix/quat2.js","webpack:///./src/libs_js/glmatrix/vec2.js","webpack:///./src/libs_js/glmatrix/vec3.js","webpack:///./src/libs_js/glmatrix/vec4.js","webpack:///./src/utils/bag.ts","webpack:///./src/utils/cachedvalue.ts","webpack:///./src/utils/camera/camera.ts","webpack:///./src/utils/camera/controller2d.ts","webpack:///./src/utils/camera/controller3d.ts","webpack:///./src/utils/collections.ts","webpack:///./src/utils/color.ts","webpack:///./src/utils/filesave.ts","webpack:///./src/utils/getter.ts","webpack:///./src/utils/gl/buffergl.ts","webpack:///./src/utils/gl/bufferimpl.ts","webpack:///./src/utils/gl/gl.ts","webpack:///./src/utils/gl/shaders.ts","webpack:///./src/utils/gl/stategl.ts","webpack:///./src/utils/gl/statevalue.ts","webpack:///./src/utils/gl/textures.ts","webpack:///./src/utils/imglib.ts","webpack:///./src/utils/imgutils.ts","webpack:///./src/utils/injector.ts","webpack:///./src/utils/input.ts","webpack:///./src/utils/interpolator.ts","webpack:///./src/utils/iter.ts","webpack:///./src/utils/lexer.ts","webpack:///./src/utils/list.ts","webpack:///./src/utils/logger.ts","webpack:///./src/utils/mathutils.ts","webpack:///./src/utils/pixelprovider.ts","webpack:///./src/utils/profiler.ts","webpack:///./src/utils/stream.ts","webpack:///./src/utils/tiler.ts","webpack:///./src/utils/timed.ts","webpack:///./src/utils/ui/canvasgrid.ts","webpack:///./src/utils/ui/drawpanel.ts","webpack:///./src/utils/ui/renderers.ts","webpack:///./src/utils/ui/ui.ts","webpack:///./src/utils/vecmath.ts"],"names":["STORAGES","Dependency","ART","VIEW","ENGINE_API","BOARD","DEFAULT_BOARD","STATE","REFERENCE_TRACKER","RESOURCES","GRID","SCHEDULER","Builders","constructor","builders","copy","get","reset","size","length","drawCall","consumer","needToRebuild","BUS","DefaultMessageBus","injector","list","MessageHandlerList","connect","h","push","handle","msg","e","error","stack","messageBox","handleReflective","obj","message","name","handler","undefined","apply","handleCollection","handlers","MessageHandlerReflective","handleDefault","Deck","clone","track","refs","f","crefs","start","stop","ReferenceTrackerImpl","nil","parent","parentNode","nested","stopped","IndexedDeck","List","ref","value","indexOf","val","update","updater","i","r","set","n","Error","tracker","remove","NULL_RENDERABLE","SPRITE_LABEL","HELPER_GRID","sorter","l","hint","SortingRenderable","renderables","filter","drawList","dc","kind","sorted","sort","Renderables","DefaultScheduler","bus","getInstance","scheduler","SchedulerImpl","TaskHandleImpl","description","progress","isStopped","getDescription","getProgress","setDescription","s","setProgress","p","tasks","nextTasks","addTask","task","handleAdd","addHandler","removeHandler","idx","splice","currentTasks","iter","map","t","onTaskAdd","handleStop","onTaskStop","handleUpdate","onTaskUpdate","PostFrame","clear","ent","result","next","done","UI","EditContext","board","api","view","gridController","state","art","EditContextConstructor","Promise","all","EntityFactory","ctx","sector","SectorEnt","sprite","id","SpriteEnt","wall","WallEnt","wallSegment","ids","hids","bottom","WallSegmentsEnt","ENTITY_FACTORY","EntityFactoryConstructor","invalidateSectorAndWalls","sectorId","BoardInvalidate","Entity","EntityType","CEILING","sec","sectors","end","wallnum","wallptr","w","WALL_POINT","walls","nextwall","sectorZesult","getClosestSectorZ","x","y","z","fz","slope","floorheinum","floorz","cz","ceilingheinum","ceilingz","Math","abs","tuple2","FLOOR","MovingHandle","startPoint","vec3","create","currentPoint","dzoff","active","vertical","parallel","pos","dir","dx","dy","len2d","dz","scale","add","isActive","dx_","dy_","NamedMessage","LoadBoard","StartMove","Move","EndMove","Rotate","da","Highlight","Set","Render","SetPicnum","picnum","Shade","absolute","PanRepeat","xpan","ypan","xrepeat","yrepeat","ResetPanRepeat","Palette","max","Flip","SpriteMode","Frame","dt","Mouse","SetWallCstat","toggle","SetSectorCstat","SetSpriteCstat","COMMIT","INVALIDATE_ALL","namedMessageHandler","resetPanrepeat","sectorEnt","originz","origin","valid","GLM","target","coords","sectorZ","ZSCALE","MOVE_VERTICAL","entity","isSector","snap","setSectorZ","sectorHeinum","setSectorHeinum","tuple","type","setSectorPicnum","shade","ceilingshade","floorshade","ceilingxpanning","ceilingypanning","floorxpanning","floorypanning","ceilingpal","floorpal","cyclic","stat","ceilingstat","floorstat","nstat","deleteSector","spriteId","origAng","spr","sprites","MOVE_COPY","newSprite","cloneSprite","addSprite","ang","moveSpriteX","SPRITE","sign","xoffset","yoffset","pal","cstat","flip","xflip","yflip","nflip","deleteSprite","Contour","factory","firstPoint","contour","contourPoints","renderable","wireframe","pointSprite","points","pushPoint","setZ","getZ","updateLastPoint","updatePoint","popPoint","getRenderable","updateRenderable","updateContourPoints","updateContour","updateLength","tex","builder","PointSpritesBuilder","build","buff","deallocate","LineBuilder","p1","p2","segment","prepareLengthLabels","total","labels","label","int","allocate","off","writeText","DrawSectorModule","module","execute","TOOLS_BUS","DrawSector","BUILDERS_FACTORY","DefaultTool","pointer","isRect","predrawUpdate","snapTarget","fp","p3","closestWallPointDist","sectorOfWall","isSprite","getPointerZ","isSplitSector","findContainingSector","wallInSector","insertPoint","rect","activate","checkFinish","deactivate","splitSector","latsPoint","createSector","pop","isWall","sectnum","findContainingSectorMidPoints","values","createInnerLoop","createNewSector","wrap","PortalModel","wallId","wallVec","vec2","wallNormal","needToUpdate","lastMove","lastDistance","distance","wall2","point2","normalize","nx","ny","nextsector","PortalType","MID","nextsectorId","curslope","createSlopeCalculator","nextslope","cnz","fnz","DOWN","UP","move","addPoint","buildHull","project","dist","drawWall","fromValues","sub","dot","xp","yp","_","needToMove","updateLastMove","hasPoints","onLastPoint","lastPoint","exactEquals","hull","line","buildNonMid","buildMid","last","first","addSegment","zdown","zup","zupoff","zdownoff","down","lastz","firstz","x1","z1","y1","x2","z2","y2","DrawWallModule","toolsBus","grid","DrawWall","portal","movingHandle","_wallNormal","_start","_dir","getDistance","abort","pushPortal","build2gl","dot2d","JoinSectorsModule","JoinSectors","sectorId1","sectorId2","join","joinSectors","wallNormal_","wallNormal1_","target_","start_","dir_","PushWallModule","PushWall","pushWall","updateWireframe","normal","slopeCalc","z3","z4","z5","z6","z7","z8","PICNUM_SELECTOR","MOVE","START_MOVE","END_MOVE","SET_PICNUM","HIGHLIGHT","MOVE_STATE","LOOP_STATE","FULL_LOOP_STATE","MOVE_PARALLEL","clipboardPicnum","clipboardShade","getFromHitscan","fullLoop","innerWalls","loopWalls","LOWER_WALL","firstWall","loop","w1","SelectionModule","Selection","RENDRABLES_CACHE","picnumSelector","selection","highlighted","register","updateSelection","isEmpty","activeMove","updateHandle","updateMove","underCursor","pushAll","checkSelected","selectedUnderCursor","setTexture","handleSelected","commit","cloneSelected","selected","isStartMove","getGridSize","sel","ceilingpicnum","floorpicnum","MID_WALL","UPPER_WALL","v","keys","detuple0","detuple1","rs","helpers","ceiling","floor","wallPoint","ToolsBusConstructor","ToolsMessageBus","activateH","deactivateH","activateHandler","deactivateHandler","tools","activeTool","tool","activateTool","deactivateTool","forEach","UtilsModule","pics","Utils","insertSprite","setFirstWall","fillInnerLoop","deleteLoop","deleteFull","printPicUsage","splitWall","offx","offy","WALL_SPRITE","vec2ang","invalidateAll","deleteLoopFull","deleteSectorFull","cloneWall","print","info","getSectorPics","wallend","nextwall2","cz1","cz2","czn1","czn2","fz1","fz2","fzn1","fzn2","swapBottoms","masking","overpicnum","sizes","pf","getInfo","has","connectedWalls","connected","invalidate","invalidatedSectors","cwalls","moveWall","mergePoints","lastwall","xpanning","ypanning","deleteWall","getClosestWallByIds","mindist","Number","MAX_VALUE","Symbol","iterator","collectConnectedWalls","wallIds","refwall","canonicalWalls","canonicalWall","getWall","invalidateWall","cx","cy","PI","matrix","mat2d","translate","rotate","transformMat2d","hwalls","fixxrepeat","keyPress","key","keysPress","mouseClick","button","mouseClicks","mouseButton","mouseButtons","combination","lh","rh","wheelUp","wheel","wheelDown","parseMod","str","toUpperCase","parseKey","canonizeBind","mods","toLowerCase","createHandler","Binder","binds","messages","sorttable","stateBinds","stateHandlers","stateValues","poolEvents","EMPTY_COLLECTION","updateState","input","on","addStateBind","enabled","disabled","bindName","addBind","bindIdx","findBind","insertBind","ensureSortTable","loadBinds","binder","messageParser","lines","split","trim","warning","substr","startsWith","keyParts","MessageParser","lexer","Lexer","addRule","LexerRule","parseFloat","parseInt","setSource","src","expected","isEoi","tokenId","rule","actual","tryGet","mark","parser","parseArgs","args","types","NOOP_MESSAGE","factArgs","createMessage","constr","Reflect","construct","parsdMessages","tryParseMessage","tryParse","parsedMessages","createDrawPanel","arts","plu","canvas","cb","provider","PixelDataProvider","ArtPixelProvider","DrawPanel","ArtEditorModule","editor","ArtEditor","RAW_PAL","RAW_PLUs","PIC_TAGS","show","ui","plus","tags","window","drawPanel","searchWidget","currentId","centerX","centerY","frame","animation","currentPlu","pluProvider","search","updateFilter","updateSuggestions","browserCanvas","document","createElement","width","height","style","display","createView","title","draggable","closeable","centered","content","div","appendHtml","elem","toolbar","widget","createPalSelectingMenu","select","hide","menu","range","item","redraw","menuButton","allTags","setValue","sugggestionsMenu","scrollToId","draw","applyFilter","includes","any","addEventListener","deltaY","updateView","isDrag","oldx","oldy","deselectAll","attrs","frames","resetAnimation","clearTimeout","anim","getContext","fillStyle","strokeStyle","fillRect","clientWidth","clientHeight","mainInfo","frameInfo","animate","scaledW","scaledH","img","resize","xoff","yoff","drawToCanvas","setTimeout","speed","axisSwap","RGBPalPixelProvider","SelectorConstructor","selector","Selector","modal","createTagsGridModel","columns","IconTextRenderer","callback","rows","onClick","row","rowElement","delete","classList","renderGrid","setCellSize","onclose","seOffset","setPosition","GL","ART_FILES","TEXTURES_OVERRIDE","PARALLAX_TEXTURES","createIndexedTexture","gl","arr","mipmaps","lib","repeat","WebGLRenderingContext","CLAMP_TO_EDGE","NEAREST_MIPMAP_NEAREST","NEAREST","createTexture","LUMINANCE","addMipMaps","level","nw","dw","nh","dh","mip","BuildArtProviderConstructor","util","parallax","INDEXED_IMG_LIB","BuildArtProvider","addTextures","parallaxPics","textures","parallaxTextures","infos","getParallaxTexture","axisSwapped","merged","mergeParallax","arrs","Uint8Array","data","ArtInfo","getWidth","getHeight","Attributes","mapBackupService","storages","defaultBoard","store","newMap","DefaultSetupModule","bindInstance","BuildReferenceTrackerImpl","StateImpl","bind","DefaultAdditionalTextures","DefaultGridController","BUILD_GL","BuildGlConstructor","BUFFER_FACTORY","DefaultBufferFactory","DefaultBuildersFactory","DefaultBoardProviderConstructor","IndexedImgLibJsConstructor","install","SwappableViewModule","RenderablesCacheModule","InfoModule","StatusBarModule","TaskManagerModule","MainLoopConstructor","MainLoop","createTools","FRAME","POSTFRAME","RENDER","drawTools","PROFILE","Db","version","db","ok","openRequest","indexedDB","open","onerror","onsuccess","onupgradeneeded","createObjectStore","keyPath","request","mode","transaction","objectStore","put","openCursor","cursor","continue","StorageDbConstructor","storage","GridControllerImpl","gridSizes","gridSizeIdx","setGridSize","i1","snapGrid","coord","gridSize","round","incGridSize","decGridSize","History","history","top","activeBoard","cloneBoard","defaultValue","prevState","stateValue","createLexer","loadTexture","options","format","bpp","RGBA","loadImage","then","fs","FS","file","decoder","TextDecoder","decode","path","opts","texture","loadImageFromBuffer","indexed","palettize","GRP","SHADOW_TABLE","loadArtFiles","grp","artFiles","a","ArtFile","slice","ArtFiles","loadPal","createPalette","loadPalTexture","RGB","loadShadowTable","loadShadeTables","loadLookups","loadPlus","loadPluTexture","shadows","lookups","lookup","shadowed","shadow","c","loadMapImpl","res","loadBuildMap","Stream","createBoard","Board","numwalls","numsectors","numsprites","posx","posy","posz","cursectnum","DukeImplementation","rorLinks","RorLinks","isMirrorPic","loadGrp","GrpFile","getMapNames","endsWith","shadowsteps","palswaps","PicTags","Resources","getArrayBuffer","files","Object","mapLoader","mapName","showMapSelection","mapSaver","fsmgr","FS_MANAGER","write","saveBuildMap","engineApi","cloneSector","newWall","newSector","newBoard","DukeModule","Implementation_","PALSWAPS","SHADOWSTEPS","PAL_TEXTURE","PLU_TEXTURE","MAP_NAMES","createDb","fsProvider","fsinfoProvider","StorageFs","StorageFsManager","fsinfo","read","byteLength","DbFsModule","rom","MountableFs","MOUNTS","UrlFs","loadBin","FileBrowser","manager","gridModel","createGridModel","startGroup","refreshContent","downloadSelected","deleteSelected","endGroup","win","winElement","addDragAndDrop","fileReader","FileReader","readAsArrayBuffer","onload","dataTransfer","text","icon","getIcon","self","toggleItem","table","replaceContent","newContent","contentElement","firstChild","replaceChild","appendChild","saveAs","browser","getFileBrowser","showFileBrowser","FileBrowserModule","mounts","mount","GRID_SECTOR_MATRIX","mat4","identity","rotateX","WallGridType","getBaseZ","alignBottom","VOID","BOT","TOP","min","tmp","vec4","texMat","createGridWallMatrix","wall1","zbase","wlen","walllen","sx","DEFAULT_REPEAT_RATE","sy","rotateY","atan2","buildCeilingHinge","prepareHinge","buildFloorHinge","TRIANGLES","color","dl","x3","y3","x4","y4","heinum","writePos","writeQuad","charW","charH","bufferOff","tiler","Tiler","charCodeAt","vtxoff","idxoff","charTexSize","centerXOff","centerYOff","tile","tileId","column","writeTcLighting","writeNormal","SectorBuilder","solid","applySectorTextureTransform","stats","doubleSmooshiness","parallaxscale","parallaxing","tcscalex","tcscaley","swapXY","rotateZ","alignToFirstWall","getFirstWallAngle","tc_","fillBuffersForSectorNormal","ceil","vtxs","vidxs","vx","vy","vz","transformMat4","writeTriangle","compress","triangles","vtxidx","vtxset","indexes","x0","y0","vtx0","trapCmp","triangulate","secy","sectorWalls","collect","zoids","sy0","sy1","ts","w0","traps","j","trapi","trapi1","pol","polx","poly","fp0x","fp0y","fp1x","fp1y","fp2x","fp2y","fillBuffersForSector","d","sectorNormal_","texMat_","updateSector","ceilinginfo","sectorNormal","floorinfo","ClusterBuilder","solids","transSprites","transSolids","updateCluster","SectorHelperBuilder","ceilpoints","ceilwire","ceilhinge","ceilgrid","floorpoints","floorwire","floorhinge","floorgrid","knd","fillBufferForWallPoint","offset","vtxOff","addWallPoint","zz","fillBuffersForSectorWireframe","fw","wid","writeLine","updateSectorHelper","cache","secId","pointTex","sectorRenderable","gridTexMat","SectorSelectedBuilder","flat","WallSelectedBuilder","mid","bot","updateSectorSelected","updateWallSelected","GenericBufferSetup","shaderIdx","aIndexIdx","aPosIdx","getState","valueIdx","createDrawCall","hash","textureHint","DrawCall","shader","drawMode","buffer","getIdxBuffer","getPosBuffer","getSize","BufferSetup","aNormIdx","aTcps","getNormBuffer","getTexCoordBuffer","SolidSetup","baseIdx","colorIdx","base","GridSetup","GTIdx","gridIdx","gridSettings","settings","WireframeSetup","PointSpriteSetup","BufferRenderable","setup","cachedDrawCall","applySetup","textureMap","Map","bufferMap","shaderMap","sh","normals","writeTransformTc","writeTc","genQuad","onesided","fillbuffersForWallSprite","xo","yo","hw","hh","xf","yf","sin","cos","xs","ys","ang2vec","fillbuffersForFloorSprite","dwx","dwy","dhx","dhy","genSpriteQuad","fillBuffersForFaceSprite","updateSprite","sprId","invisible","spriteAngle","realCenter","sectorShade","trans","translucent","tranclucentReversed","FACE_SPRITE","Type","FACE","FLOOR_SPRITE","Sprite2dBuilder","CIRCLE_SECTIONS","CIRCLE_OUT_RADIUS","CIRCLE_IN_RADIUS","genSpriteMarker","dxo","dxi","dyo","dyi","angle","dx1","dy1","i2","cyclicPairs","off1","off2","updateSpriteAngle","SPRITE_COLOR","updateSpriteImage","WALL_SPRITE_LINE_WIDTH","updateSpriteLine","dxt","dyt","updateSprite2d","SpriteHelperBuillder","wire","genQuadWireframe","fillbuffersForWallSpriteWireframe","fillbuffersForFloorSpriteWireframe","fillBuffersForFaceSpriteWireframe","updateSpriteWireframe","SURFACE","vec1","updateSpriteHelper","WallBuilder","getWallCoords","nextheinum","nextz","check","x1_","y1_","z1_","x2_","y2_","z2_","applyWallTextureTransform","originalWall","tw","th","tcxoff","tcyoff","tc","getMaskedWallCoords","ceilheinum","ceilnextheinum","ceilz","ceilnextz","floornextheinum","floornextz","currz1","currz2","currz3","currz4","nextz1","nextz2","nextz3","nextz4","updateWall","translucentReversed","oneWay","nextfloorz","nextceilingz","nextfloorheinum","floorcoords","wall_","wall2_","tex_","info_","nextceilingheinum","ceilcoords","tex1","info1","Wall2dBuilder","updateWall2d","MASKED_WALL_COLOR","WALL_COLOR","INTERSECTOR_WALL_COLOR","WallHelperBuilder","topWire","topGrid","topPoints","topLength","midWire","midGrid","botWire","botGrid","botPoints","botLength","updateWallWireframe","botcoords","topcoords","updateWallPoint","addWallPoints","wallId2","addLength","toFixed","replace","updateWallHelper","wallRenderable","WallPointHelperBuilder","updateWallLine","Entry","CacheMap","ensureValue","CachedTopDownBuildRenderableProvider","NULL_SECTOR_RENDERABLE","sectorCluster","invalidateSector","invalidateSprite","CachedBuildRenderableProvider","clusters","CachedSelectedRenderableProvider","CachedHelperBuildRenderableProvider","wallPoints","RenderablesCacheContext","RENDERABLES_CACHE_CONTEXT","RenderablesCacheContextConstructor","RenderablesCacheConstructor","RenderablesCacheImpl","geometry","topdown","preloadTask","launchPrebuild","prebuild","bufferFactory","buildgl","solidSetup","gridSetup","bufferSetup","pointspriteSetup","wireframeSetup","SolidBuilder","GridBuilder","FlatBuilder","PointSpriteBuilder","WireframeBuilder","LINES","clr","g","b","BuildBufferFactoryImpl","vtxIndex","linesIndex","idx1","addVtx","idx2","addLine","vtx","POSITION","NORMAL","TEX_SHADING","buffers","addNewBuffer","Buffer","BufferBuilder","addVertexBuffer","FLOAT","BuildBufferImpl","vtxSize","idxSize","ptr","vtxCount","triIndexCount","writeVertex","u","writeIndex","getVertexBuffer","getIndexBuffer","resolve","plaswaps","BuildGl","SHADER_NAME","inv","clipPlane","State","pixelStorei","UNPACK_ALIGNMENT","enable","CULL_FACE","DEPTH_TEST","POLYGON_OFFSET_FILL","blendFunc","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","defs","createShader","registerShader","setProjectionMatrix","proj","setUniform","setViewMatrix","isUniformEnabled","invert","setCursorPosiotion","setClipPlane","run","newFrame","updateProfile","profile","clearColor","clearStencil","clearDepth","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","performance","now","drawingBufferWidth","drawingBufferHeight","modulation","PROFILER","drawsRequested","drawsMerged","shaderChanges","uniformChanges","textureChanges","bufferChanges","printInfo","flush","Info","rowTemplate","createRow","root","cloneNode","nameNode","valueNode","nodeValue","rowsTemplate","createSprite","head","headUpdater","idUpdater","picnumUpdater","shadeUpdater","palUpdater","offsetUpdater","repeatUpdater","zUpdater","Row","SpriteProperties","WallProperties","SectorProperties","InfoPanel","InfoPanelState","setState","createState","render","getElementById","MOUSE","InputModule","keybinds","loadString","mouseMove","mouseX","mouseY","inputState","m","postFrame","PhotonWindow","currentButtonGroup","titleElem","tag","className","header","append","close","span","click","footer","dragElement","body","addToolbarWidget","container","addToolMenuButton","btn","addToolIconButton","addToolSearch","change","suggestContainer","textBox","attr","tippy","allowHTML","placement","interactive","trigger","arrow","startButtonGroup","endButtonGroup","actualX","actualY","left","PhotonWindowBuilder","_id","_title","_draggable","_centered","_closeable","_onclose","_w","_h","_toolbar","_content","ToolbarGroupBuilder","items","PhotonToolbarBuilder","groups","currentGroup","addItem","group","PhotonMenuBuilder","instance","duration","appendTo","Builder","PhotonUiModule","oncontextmenu","selectMapWindow","getWindow","mapNamesProvider","mapNames","Table","lastTable","removeChild","Statusbar","positionBoxTemplate","PositionBox","cachedPosX","cachedPosY","valueBoxTemplate","ValueBox","parentElement","cachedValue","statusBarTemplate","StatusBar","statusbar","posBox","posUpdate","sectorBox","sectorUpdate","drawsBox","drawsUpdate","fpsBox","fpsUpdate","updaters","draws","counts","skips","time","TaskWidget","updateHandler","setUpdateHandler","TaskWidgetRenderer","css","cancel","descr","TaskManager","taskWidgets","refreshGrid","getTaskManager","showTasks","visible","AllBoardVisitorResult","Renderer2D","bgl","BoardRenderer2D","upp","surfaces","pass","spriteLabel","gridHelper","sectorVisitor_","sectorVisitor","wallVisitor_","wallVisitor","spriteVisitor_","spriteVisitor","getGrid","gridSolid","disable","BLEND","campos","controller","getUnitsPerPixel","visit","getProjectionMatrix","getTransformMatrix","getPosition","drawRooms","clearDrawLists","forSector","forWall","forSprite","RorLink","srcSpriteId","dstSpriteId","ceilLinks","floorLinks","hasRor","PvsBoardVisitorResult","rorViss","diff","stackTransform","srcPos","dstPos","npos","mstmp","mirrorVis","mirrorNormal","mirroredTransform","mpos","polyOffsetOn","polygonOffset","polyOffsetOff","blendOn","blendOff","Renderer3D","impl","Boardrenderer3D","rorSectorCollector","createSectorCollector","mirrorWallsCollector","createWallCollector","surfacesTrans","spritesTrans","_sectorVisitor","_wallVisitor","_spriteVisitor","drawGeometry","writeStencilOnly","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","stencilMask","depthMask","colorMask","writeStenciledOnly","EQUAL","writeDepthOnly","writeAll","getForward","drawMirrors","drawRor","getLinkVis","link","vis","drawStack","surface","stencilValue","dst","inc","STENCIL_TEST","unpackWallId","wallVisible","w2","normal2d","mirrorrD","mirrorBasis","cullFace","FRONT","reflectPoint3d","BACK","wallr","spriter","drawImpl","TargetImpl","coords_","entity_","VIEW_2D","VIEW_3D","View2dConstructor","View3dConstructor","SwappableViewConstructor","SwappableView","view2d","view3d","lastGridScale","viewPos","getViewPosition","gridScale","renderer","View2d","position","control","Controller2D","hit","CachedValue","updateHitscan","Hitscan","snapTargetValue","updateSnapTarget","direction","updateDir","Ray","DelayedValue","NumberInterpolator","loadBoard","isWireframe","getPointerPosition","inSector","findSector","invalidateTarget","setSize","recalcGridSize","setUnitsPerPixel","getPlayerStart","hitscan","closestSpriteInSector","closestWallPoint","ws","closestWallSegment","snapWall","ray","View3d","aspect","Controller3D","forwardDamper","sideDamper","setFov","cameraSpeed","moveForward","moveSideway","getClosestWall","closestWallInSector","snapWallPoint","snapSprite","copyTarget","minScale","updateGridSize","closestWallSegmentInSector","gl2build","getForwardUnprojected","AbstractPixelProvider","palTmp","putToDst","dstoff","blend","paloff","distanceToWallSegment","lenPointToLine","distanceToWallPoint","distf","closestWallInSectorDist","closestWallSegmentInSectorDist","closestSpriteInSectorDist","closestWallSegmentDist","lse","isValidSectorId","loopPoints","loopStart","wallsBetween","from","to","innerSectorsOfLoop","isOuterLoop","innerSectors","loopoint","isec","WALL_MAPPER","clockwise","canonical","minValue","counter","searchMatchWall","matchWalls","loopPairs","commonSectorWall","matched","createNewWalls","matchedWalls","commonWall","enumerate","matchedWall","baseWall","order","mwalls","commonSector","addSector","addLoop","Point","findIndex","convert","newHull","lastUp","lastDown","upline","downline","upoff","downoff","HullPoint","pp1","pp2","startz","doff1","doff2","lastup0","lastup1","lastdown0","lastdown1","isValidWallId","nonMid","firsWall","doff","k","ANGSCALE","findPortalWall","fromSectorId","toSectorId","newSectorId","floork","ceilingk","pwall","newSpriteId","isValidSpriteId","newSectorIdx","wallsend","updateSpriteSector","resizeWalls","deleteSectorImpl","fromSector","updateWallIds","afterWallId","moveWalls","newSize","fillSectorWalls","_wallset","fillWallSet","s1","s2","getJoinedWallsLoops","wallset","it","loopstart","addWall","isJoinedSectors","looppoints","addWalls","getWalls","wallRefs","nextWallPtrs","loopIter","loopEnd","pointsLength","wallPtr","newFirstWall","loops","newFirstWallLoop","currentLoop","firstWallLoopPos","cyclicRange","deleteSectors","sectorRefs","secs","chain","matchWall","loopInPolygon","loopId","polygon","inPolygon","checkSplitSector","fx","fy","lx","ly","lastWall","splitSectorImpl","refWall","lengthWoLast","newWalls","existedWalls","loopPoly","getSplitLoop","oldSectorBuilder","newSectorBuilder","firstLoopLength","lid","wallEnd","reversedWoLast","reversed","take","POINT_MAPPER","butLast","checkPointsOrder","moveSprite","ornamentWall","selectOrnamentWall","nextSectorId","nextSector","f1z","c1z","f2z","c2z","tryMoveSprite","tsectorId","findFirst","ow","reprate","fixpoint2xpan","insertWall","lenperrep","nwall","nextwallId","doMoveWall","len","alwaysNewPoints","prev1","n2","next2","extent1","cross2d","extent2","isTJunction","wall2Id","lastWallId","lwall","NULL_SECTOR_SET","findSectorsAtPoint","reduce","intersect","pointInterpolator","interpolated","interpolate","inter","dy2","dx2","pivot","findSectorAll","wallidx","SectorStats","slopped","unk","Sector","visibility","filler","lotag","hitag","extra","WallStats","blocking","blocking2","Wall","SpriteStats","noautoshading","reserved","Sprite","clipdist","statnum","owner","xvel","yvel","zvel","Header1","startX","startY","startZ","startAng","startSec","packWallSectorId","wallSectorId","unpackSectorId","SectorCollector","pred","visitor","WallCollector","SpriteCollector","createSpriteCollector","secv","wallv","endwall","sprv","TopDownBoardVisitorResult","visibleSectors","prescan","wallBehind","ms","fwd","prepvs","pvs","entryWalls","angCache","init","ensureEntryWalls","ewalls","fillPVS","U","getAngForWall","monoatan2","visibleFromEntryWalls","ew","a1s","a1e","a2s","a2e","arcsIntersects","sec2spr","sprs","NO_ANIMATION","ANIMATE_FORWARD","OSCILLATING_ANIMATION","ANIMATE_BACKWARD","anumStruct","struct","field","bits","byte","stream","offsets","hs","anums","readUInt","numtiles","array","ushort","Array","setOffset","anum","pixels","atomic_array","ubyte","getStart","getEnd","getArt","buf","count","loadFiles","fname","readByteString","subView","readArrayBuffer","readUByte","skip","readUShort","refPlu","SPRITE_OFF","pointOnRay","out","targetPoint","zs","testHit","hitPoint","hitSector","intersectSectorPlanes","ndx","ndy","angk","ceilk","dk","ceildz","dk1","floordz","intersectWall","rayIntersect","ix","iy","iz","nextsecId","nextsec","intersectFaceSprite","vl","sqrLen2d","intz","intx","inty","intersectWallSprite","points_","intersectFloorSprite","cosang","sinang","intersectSprite","artInfo","resetStack","cliptype","groupSprites","sectorStats","sectorStruct","short","wallStats","wallStruct","spriteStats","spriteStruct","boardStruct","uint","brd","ArrayBuffer","fixSectorSlopes","initWallStats","initWall","initSectorStats","initSector","initSpriteStats","initSprite","sectorCopy","assign","wallCopy","spriteCopy","vec","fakePlayerStart_","fakePlayerStart","pz","ph","sectorPicnum","ln","lineIntersect","sz","x21","x34","y21","y34","x31","y31","topt","topu","_normal","_wn","_up","_down","negate","lerp","atan","PI2","minx","minwall","wall0","cw","reverse","addLogAppender","CONSOLE","createContextFromCanvas","alpha","antialias","stencil","RootModule","mainLoop","EPSILON","ARRAY_TYPE","Float32Array","RANDOM","random","setMatrixArrayType","degree","toRadian","equals","hypot","arguments","sqrt","glMatrix","m00","m01","m10","m11","transpose","a1","a0","a2","a3","det","adjoint","determinant","multiply","b0","b1","b2","b3","rad","v0","v1","fromRotation","fromScaling","frob","LDU","L","D","subtract","multiplyScalar","multiplyScalarAndAdd","mul","tx","ty","aa","ab","ac","ad","atx","aty","a4","a5","b4","b5","fromTranslation","fromMat4","m02","m12","m20","m21","m22","a01","a02","a12","a00","a10","a11","a20","a21","a22","b01","b11","b21","b00","b02","b10","b12","b20","b22","fromMat2d","fromQuat","q","xx","yx","yy","zx","zy","wx","wy","wz","normalFromMat4","a03","a13","a23","a30","a31","a32","a33","b03","b04","b05","b06","b07","b08","b09","projection","a6","a7","a8","b6","b7","b8","m03","m13","m23","m30","m31","m32","m33","axis","fromXRotation","fromYRotation","fromZRotation","fromRotationTranslation","xy","xz","yz","fromQuat2","translation","bx","by","bz","bw","ax","ay","az","aw","magnitude","getTranslation","mat","getScaling","getRotation","scaling","is1","is2","is3","sm11","sm12","sm13","sm21","sm22","sm23","sm31","sm32","sm33","trace","S","fromRotationTranslationScale","fromRotationTranslationScaleOrigin","o","ox","oy","oz","out0","out1","out2","out4","out5","out6","out8","out9","out10","frustum","right","near","far","rl","tb","nf","perspective","fovy","tan","Infinity","perspectiveFromFieldOfView","fov","upTan","upDegrees","downTan","downDegrees","leftTan","leftDegrees","rightTan","rightDegrees","xScale","yScale","ortho","lr","bt","lookAt","eye","center","up","z0","eyex","eyey","eyez","upx","upy","upz","centerx","centery","centerz","targetTo","a9","a14","a15","b9","b13","b14","b15","setAxisAngle","getAxisAngle","out_axis","acos","getAngle","dotproduct","calculateW","exp","et","log","pow","slerp","omega","cosom","sinom","scale0","scale1","u1","u2","u3","sqrt1MinusU1","sqrtU1","invDot","conjugate","fromMat3","fTrace","fRoot","fromEuler","halfToRad","squaredLength","sqrLen","rotationTo","tmpvec3","xUnitVec3","yUnitVec3","sqlerp","temp1","temp2","setAxes","matr","mat3","dq","fromRotationTranslationValues","outer","quat","getReal","getDual","setReal","setDual","ax1","ay1","az1","aw1","bx1","by1","bz1","ax2","ay2","az2","aw2","rotateByQuatAppend","qx","qy","qz","qw","rotateByQuatPrepend","rotateAroundAxis","axisLength","ax0","ay0","az0","aw0","bw1","bx0","by0","bz0","bw0","mt","sqlen","a_dot_b","divide","scaleAndAdd","squaredDistance","inverse","cross","transformMat2","transformMat3","p0","sinC","cosC","len1","len2","cosine","zero","sqrDist","stride","fn","arg","hermite","factorTimes2","factor1","factor2","factor3","factor4","bezier","inverseFactor","inverseFactorTimesTwo","zScale","transformQuat","uvx","uvy","uvz","uuvx","uuvy","uuvz","tempA","tempB","A","B","C","E","F","G","H","I","J","v2","v3","v4","iw","Place","Bag","holes","getSuitablePlace","hole","terminator","tryMerge","node","insertAfter","newHole","insertBefore","prev","freeSpace","segments","results","fill","ds","hstart","hend","dr","BagController","bag","places","place","optimize","createController","supplier","cached","Camera","transform","angleX","angleY","needUpdate","setPositionXYZ","forward","side","updateAngles","setAngles","deg2rad","camera","oldX","oldY","wscale","hscale","invertTrans","invTP","getFov","getMatrix","MU","sideways","TERMINAL_ITERATOR_RESULT","EMPTY_ITERATOR","iteratorResult","isDone","ArrayWrapper","index","hasAny","iterIsEmpty","ii","def","iter1","iter2","di","rangeIter","Iter","of","pairs","skipWhile","rgb2hsl","rd","gd","bd","delta","hsl2rgb","lf","sf","rgb2xyz","xyz2rgb","xn","yn","zn","xyz2lab","convertPal","srcPal","conv","labDist","findLab","mindist1","resizeIndexed","dstw","dsth","srcw","srch","labpal","convoluteIndexed","imgw","sum","colors","weight","xyz","lab","dither","ditherMatrix","scale3resample","px","mx","py","my","rsize","sqrsize","rgb2lum","scale2x","save","fileName","url","URL","createObjectURL","Blob","href","download","revokeObjectURL","accepts","extensions","writable","createWritable","fetch","arrayBuffer","Pointerimpl","vtxBuffers","spacing","createVertexBuffer","blockSize","vtxBag","idxBag","idxBuffer","vtxRegions","idxRegions","createIndexBuffer","UNSIGNED_SHORT","noffset","getData","getSpacing","subarray","offdiff","idxData","idxs","vdata","idata","mergeRegions","regions","region","currentend","nextstart","updateBuffer","updateRegion","VertexBufferImpl","normalized","getBuffer","getType","getNormalized","getStride","getOffset","IndexBufferImpl","genIndexBuffer","pattern","bufIdx","createBuffer","Uint16Array","bindBuffer","ELEMENT_ARRAY_BUFFER","bufferData","STATIC_DRAW","GlType2ArrayType","glType","BYTE","Int8Array","UNSIGNED_BYTE","SHORT","Int16Array","INT","Int32Array","UNSIGNED_INT","Uint32Array","ArrayType2GlType","arrayType","VertexBufferDynamic","usage","STREAM_DRAW","ARRAY_BUFFER","bufferSubData","sizeof","BYTES_PER_ELEMENT","DynamicIndexBuffer","norm","DYNAMIC_DRAW","arrtype","wrapIndexBuffer","createContext","overflow","displayWidth","displayHeight","viewport","Date","getTime","requestAnimationFrame","pixel","readId","readPixels","ShaderImpl","prog","program","definitions","uniforms","attribs","uniformIndex","attributeIndex","initUniformLocations","initAttributeLocations","uniform","getUniformLocation","attributes","attrib","getAttribLocation","getAttributeLocation","getProgram","getUniforms","getAttributes","getSamplers","samplers","defines","deftext","vsh","fsh","preprocess","pvhs","pfsh","compileProgram","processShaders","createProgram","attachShader","compileSource","VERTEX_SHADER","FRAGMENT_SHADER","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","source","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","DefinitionImpl","Definitions","ACTIVE_ATTRIBUTES","getActiveAttrib","convertToDefinition","ACTIVE_UNIFORMS","getActiveUniform","type2String","SAMPLER_2D","FLOAT_MAT4","FLOAT_MAT3","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","INT_VEC2","INT_VEC3","INT_VEC4","match","setters","loc","uniformMatrix4fv","ivec2","uniform2iv","uniform2fv","uniform3fv","uniform4fv","uniform1i","float","uniform1f","sampler2D","setter","createStateValue","changecb","StateValueMatrix","StateValueGeneric","Profile","shaderSwaps","uniqTextures","changeShader","swap","changeTexture","nextBatch","batch","nb","ShaderConfig","batchUniform","lastBuffer","lastShader","selectedShader","indexBuffer","changeIndexBuffer","shaders","states","stateIndex","attribNames","attribIndex","uniformDefinitions","textureIndex","changedVertexBuffersIds","changedTextures","changedUniformIdxs","chainOffset","chainSize","chainMode","registerState","drawElements","tryChain","sameState","registerUniforms","existedId","registerSamplers","shaderSamplers","sampler","registerAttributes","getUniformValue","setShader","getTextureValue","setIndexBuffer","setVertexBuffer","getVertexBufferValue","rebindShader","newShader","shaderConfig","useProgram","rebindVertexBuffers","vertexBufferIdxs","vbuf","location","enableVertexAttribArray","vertexAttribPointer","rebindIndexBuffer","rebindTextures","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","updateUniforms","uniformsIdxs","SHADER","call","cmp","TextureStub","getFormat","getMagFilter","NEAREST_MIPMAP_LINEAR","LINEAR","LINEAR_MIPMAP_LINEAR","LINEAR_MIPMAP_NEAREST","TextureImpl","texParameteri","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","TEXTURE_WRAP_T","aniso","ext","getExtension","getParameter","MAX_TEXTURE_MAX_ANISOTROPY_EXT","texParameterf","TEXTURE_MAX_ANISOTROPY_EXT","texImage2D","reload","texSubImage2D","DrawTexture","putPixel","putSubImage","createDrawTexture","RenderTexture","framebuffer","renderbuffer","createFramebuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","drawTo","VIEWPORT","bindFramebuffer","FRAMEBUFFER","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","createRenderTexture","xyzpal","createEmptyCanvas","createCanvas","BlendNormal","Uint8ClampedArray","ImageData","getImageData","putImageData","clearCanvas","blob","urlCreator","imageUrl","Image","evt","drawImage","image","multi","CircularDependencyError","dependencies","ChildInjector","dependency","getInstanceParent","DependencyNode","Graph","nodes","ensureNode","checkCycles","paint","child","unshift","providers","promises","executables","submodule","executable","RootInjector","graph","current","ctr","d1","d2","d3","d4","d5","d6","d7","d8","create8","create7","create6","create5","create4","create3","create2","create1","i3","i4","i5","i6","i7","i8","named","mapKeyCode","code","String","fromCharCode","mousemove","mouseup","mousedown","wheelevent","keyup","keydown","altKey","shiftKey","ctrlKey","keyCode","preventDefault","offsetX","offsetY","Vec3Interpolator","Vec4Interpolator","interpolator","PointComparator","Range","FastList","insert","binaryIndexOf1","localT","advance","steps","searchElement","refMin","currentElement","cmpVal","binaryIndexOf","minIndex","maxIndex","refMinIndex","currentIndex","rulesIndex","rules","lastOffset","eoi","matchedRule","matchedValue","exec","subsrc","Node","ret","insertNodeBefore","insertNodeAfter","elements","nextIdx","lastIdx","after","before","lastId","SortedHeap","sortValues","sortValue","ERROR","WARN","INFO","TRACE","DEBUG","appenders","debug","appender","console","warn","radsInDeg","degInRad","EPS","eq","gte","deg","rad2deg","ispow2","fract","nextpow2","l1x","l1y","l2x","l2y","ldx","ldy","pdx","pdy","llensqr","len3d","angInArc","arcStart","arcEnd","mod","ubyte2byte","minus","int2vec4","int2vec4norm","tuple3","tuple4","productValue","srcoff","BlendAlpha","_a","getPixel","ConstPixelProvider","RGBAArrayPixelProvider","transIdx","shadowColor","RectPixelProvider","ex","ey","paddColor","origw","origh","ResizePixelProvider","AxisSwapPixelProvider","FlipPixelProvider","xswap","yswap","OffsetPixelProvider","rx","ry","fromPal","xyflip","paddColod","fit","Section","startTime","subSections","pause","currentTime","createSubsection","amount","mainSection","currentSection","startProfile","subsec","startGlobalProfile","incCount","endProfile","parts","section","isLE","littleEndian","aligned","currentBit","currentByte","DataView","checkBitAlignment","readByte","getInt8","writeByte","setInt8","getUint8","writeUByte","setUint8","readShort","getInt16","writeShort","setInt16","getUint16","writeUShort","setUint16","readInt","getInt32","writeInt","setInt32","getUint32","writeUInt","setUint32","readFloat","getFloat32","writeFloat","setFloat32","writeByteString","bytes","writeArrayBuffer","readBit","bit","writeBit","readBits","signed","toSigned","writeBits","fromSigned","mask","accessor","atomicReader","atomicArrayConstructor","string","readArray","writeArray","readAtomicArray","writeAtomicArray","StructBuilder","fields","reader","tiles","entries","constTimed","timed","startValue","endTime","endValue","delayed","delay","drawGrid","widgets","ch","bg","wcells","hcells","cells","beginPath","clip","restore","ScrollType","idsProvider","selectCallback","cellW","cellH","pageIds","onclick","calcIdx","onwheel","scroll","PAGE","ROW","prepareIds","cellsOnPage","horizontalCells","verticalCells","getDelta","ITEM","found","deselect","newOffset","font","textAlign","fillText","strokeRect","dataRow","shift","newSelected","renderMenu","suggestModel","searchBar","inst","model","sugg","Element","element","textContent","html","setAttribute","oninput","tbody","thead","cols","tr","td","removeRow","deleteRow","Properties","prop","el","refresh","props","caption","panel","Progress","VerticalPanel","verticalPanel","elment","startx","starty","onmouseup","onmousemove","onmousedown","dragMouseDown","clientX","clientY","closeDragElement","elementDrag","offsetTop","offsetLeft","closeModal","stopPropagation","dropHandler","newchild","intersect2d","p1s","p1e","p2s","p2e","intersect2dT","res0","res1","dot1","dot2","direction3d","ps","pe","direction2d","projectXY","projectXZ","projectYZ","intersect3d","dir1","dir2","p1s_","p2s_","p1e_","p2e_","reflectVec3d","mirrorD","point","oside","oup","oforward","mirroredPos"],"mappings":"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AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+D;AACN;AACQ;AACJ;AACE;AACR;AACZ;AACkB;AAClB;AACgB;AACV;AACK;AACpB;AACP;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qEAAqE,aAAa;AAClF;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C;AAC7C,uBAAuB;AACvB;AACA;AACA;AACA,OAAO;AACP,oBAAoB;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE;AACpE;AACA,qBAAqB,2EAAS,cAAc,+EAAiB,yCAAyC,+EAAiB;AACvH,kBAAkB,+EAAiB;AACnC,UAAU;AACV;;AAEA,+BAA+B,wEAAc,CAAC,sEAAW,wDAAwD;;AAEjH;AACA;AACA,SAAS,EAAE;AACX;;AAEA,YAAY,IAAqC;AACjD,0BAA0B,kEAAQ;AAClC;AACA;AACA,WAAW;AACX,UAAU,2EAAiB;;AAE3B,cAAc,0EAAgB,8BAA8B,+CAAI;AAChE;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;;AAEA,kCAAkC,8EAAgB;AAClD;AACA;AACA;AACA,wDAAwD;AACxD;;;AAGA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;AAC5C;;AAEA;AACA,cAAc,IAAqC;AACnD;AACA;;AAEA;AACA,SAAS;;;AAGT;AACA,qBAAqB,8EAAgB,YAAY,6EAAe;AAChE,kBAAkB,2EAAa;AAC/B,UAAU;AACV;AACA;AACA;AACA;;AAEA;AACA,kDAAkD;AAClD;AACA;AACA,6CAA6C,KAAK;;AAElD;AACA,sEAAsE;AACtE,SAAS;AACT;;AAEA,2BAA2B,uCAAuC;AAClE,cAAc,IAAqC;AACnD;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+DAA+D;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,OAAO;AACP;AACA;AACA,cAAc,kEAAQ;AACtB;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU,IAAqC;AAC/C;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK,EAAE;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;;AAEA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;AACO,kD;;;;;;;;;;;;AC/PP;AAAA;AAAA;AAAsD;AACK;AAC3D;;AAEA;AACA;AACA;AACA;AACA;AACA,uCAAuC;;AAEvC,SAAS,8EAAa,cAAc,yEAAW;AAC/C;AACA,KAAK;AACL;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sHAAsH;;AAEtH;AACA;AACA;AACA,OAAO,IAAI,EAAE;;AAEb,WAAW,8EAAa,cAAc,yEAAW;AACjD;AACA,OAAO;AACP;AACA;;;AAGA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;ACrFD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4D;AACF;AACV;AACc;AACc;AACpC;AACwB;AACN;AACa;AACZ;;AAE3D;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAsB,0EAAgB;AACtC,aAAa,kFAAwB;AACrC,oBAAoB,8CAAI,EAAE,+CAAK;AAC/B;;AAEA;AACA;AACA;;AAEA;AACA,kBAAkB,2EAAa;AAC/B,+BAA+B,6CAAG,GAAG,8CAAI;AACzC,+BAA+B,gDAAM,GAAG,+CAAK;AAC7C;AACA;AACA,0BAA0B,6EAAe;AACzC;AACA,sDAAsD;AACtD;;AAEA;AACA;AACA;AACA,eAAe,gEAAM,mBAAmB;;AAExC;AACA,yDAAyD;AACzD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;;AAGH;AACA;;AAEA;AACA;AACA;AACA;;AAEA,MAAM,IAAqC;AAC3C,SAAS,8EAAa;AACtB;AACA;AACA;;AAEA,OAAO,sEAAQ;AACf,QAAQ,IAAqC;AAC7C;AACA;;AAEA;AACA;;AAEA;AACA;AACA,aAAa,4EAAkB,yCAAyC,yEAAe,UAAU,wDAAc;AAC/G;AACA,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;AClGD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAuD;AACO;AACZ;AACkB;AACJ;AACJ;;AAE5D;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc,8CAAI;AAClB,cAAc,6CAAG;AACjB;;AAEA;AACA,uBAAuB,6EAAe;;AAEtC,yBAAyB,uEAAS;AAClC,qBAAqB,gFAAkB;AACvC,KAAK;;AAEL,gDAAgD;;;AAGhD,sBAAsB,6CAAG;AACzB,cAAc,gDAAM;AACpB;AACA;AACA;;AAEA,sBAAsB,8CAAI;AAC1B,cAAc,+CAAK;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA,yCAAyC,mBAAmB,sBAAsB;AAClF;;AAEA,uCAAuC,mBAAmB,uBAAuB;AACjF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAM,IAAqC;AAC3C,6BAA6B,8EAAgB;;AAE7C;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA,eAAe,0EAAgB;AAC/B;AACA;AACA;AACA;;AAEA;AACA,wDAAwD,kEAAkE,mBAAmB;AAC7I;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA,uDAAuD,iEAAiE,mBAAmB;AAC3I;AACA;AACA;AACA,KAAK;AACL;;AAEA,0DAA0D,8BAA8B;AACxF;AACA,GAAG;AACH,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;ACzID;AAAA;AAAkD;;AAElD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,uEAAS;AACxB;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;AAGc;AACf;AACA;AACA;AACA,sBAAsB;AACtB;AACA;AACA,CAAC,E;;;;;;;;;;;;AChDD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAoE;AACR;AAC0B;AAC9B;AACY;AACA;AAChB;;AAEpD;AACA,MAAM,0EAAgB,gBAAgB,8CAAI;AAC1C;AACA;;AAEA,0BAA0B,8EAAoB;AAC9C,UAAU,uFAA6B,gCAAgC,uFAA6B;AACpG;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,0EAAgB;AACtC;AACA,iGAAiG,8EAAoB;AACrH;AACA,sBAAsB,0EAAgB,gBAAgB,8CAAI,GAAG,8EAAoB;AACjF;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,uBAAuB;AACxC;;AAEA,yBAAyB,0EAAgB;;AAEzC,2BAA2B,sEAAY,gBAAgB,+CAAK;AAC5D,sBAAsB,6CAAG,EAAE,gDAAM;AACjC;AACA,mBAAmB,wEAAc;AACjC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,4DAA4D,+CAAK,GAAG,8CAAI,sBAAsB,gDAAM,GAAG,6CAAG;;AAE1G;AACA,0BAA0B,8EAAoB;AAC9C;;AAEA,2BAA2B,8EAAoB;AAC/C;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;;AAEA,iCAAiC,QAAQ;AACzC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;AClJD;AAAA;AAAA;AAAuD;AACC;;AAExD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU,6CAAG,EAAE,+CAAK,EAAE,gDAAM,EAAE,8CAAI;AAClC;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,wEAAc;AACxC;AACA,GAAG;AACH,0BAA0B,wEAAc;AACxC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,8BAA8B;AACxF;AACA;AACA,GAAG;AACH,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;AC5DD;AAAA;AAAA;AAAA;AAA4D;AACD;AACpD;AACP,sBAAsB,0EAAgB;AACtC,wBAAwB,8CAAI,EAAE,6CAAG;;AAEjC,iFAAiF,YAAY;AAC7F;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA,UAAU,8CAAI,EAAE,+CAAK;AACrB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oDAAU;AACvB;AACA;AACA,GAAG,IAAI;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;ACpDD;AAAA;AAAwD;;AAExD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,wEAAc;AAC5C;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC;;;AAGc;AACf;AACA;AACA;AACA;AACA;AACA,CAAC,E;;;;;;;;;;;;ACxBD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8D;AACF;AACgB;AAC5B;AACR;AACkB;AACI;AACN;AACJ;AACY;;AAEhE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,wEAAc;AAC/B;AACA;AACA;AACA;AACA,GAAG;AACH,sBAAsB,0EAAgB;AACtC,kBAAkB,sEAAY;AAC9B;AACA,iBAAiB,kFAAwB;AACzC,gBAAgB,oEAAU;AAC1B;AACA;AACA;AACA,0GAA0G,kBAAkB;AAC5H;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,sCAAsC,6CAAG,GAAG,8CAAI;AAChD,qCAAqC,gDAAM,GAAG,+CAAK;AACnD;AACA;AACA;AACA;AACA;AACA,+BAA+B,+CAAK;AACpC,+BAA+B,+CAAK,0CAA0C;AAC9E;;AAEA;AACA,6CAA6C,2EAAa;AAC1D;AACA;AACA;AACA,yHAAyH,4EAAkB;AAC3I;AACA,sDAAsD;AACtD;AACA;AACA;AACA;;AAEA,mBAAmB,gEAAM;AACzB;AACA;AACA,oDAAoD,6EAAe;AACnE;AACA;AACA;AACA;AACA,0BAA0B,gEAAM;AAChC;AACA;AACA;;AAEA;AACA,uCAAuC,6CAAG,GAAG,8CAAI;;AAEjD,sCAAsC,gDAAM,GAAG,+CAAK;;AAEpD;;AAEA;;AAEA;;AAEA,2BAA2B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A0B,0DAAM;AAChC;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;;AAEA;AACA;AACA;AACA,SAAS;AACT,wBAAwB,0DAAM;AAC9B;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH,C;;;;;;;;;;;;AC3EA;AAAA;AAAe;AACf;AACA,C;;;;;;;;;;;;ACFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA4G;AACkF;;AAE9L;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS,4DAAU;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;AACA;;AAEA;AACA,wEAAwE;AACxE;AACA;AACA,EAAE,4DAAU;AACZ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0GAA0G,YAAY,MAAM,KAAK;AACjI;AACA;AACA;AACA;AACA;AACA,wCAAwC,OAAO;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE;AACnE;AACA;AACA,gFAAgF;AAChF;AACA;AACA;AACA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA,gDAAgD,aAAa;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,8DAAY;AAChB,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,8DAAY;AACd;AACA,gEAAgE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,oBAAoB,KAAK;AACzB,oBAAoB,KAAK;AACzB,SAAS,gBAAgB,KAAK;AAC9B;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA,oDAAoD;AACpD,8DAA8D;AAC9D,OAAO,2DAA2D,mBAAmB;AACrF,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,yCAAyC,SAAS;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA,uBAAuB;AACvB,iBAAiB,EAAE,GAAG,uBAAuB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,gBAAgB;AAC5C,OAAO;AACP,4BAA4B,oBAAoB;AAChD,OAAO;AACP;AACA,qBAAqB,IAAI,IAAI,oBAAoB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA,uBAAuB;AACvB;AACA;AACA,sBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,KAAK;AACN,iBAAiB,aAAa,iCAAiC,sHAAsH,2DAA2D,kEAAkE,IAAI,uBAAuB,8CAA8C,IAAI;AAC/X;AACA,gBAAgB,yBAAyB,QAAQ,2BAA2B,aAAa,oBAAoB,iBAAiB,uBAAuB,mBAAmB,OAAO,4BAA4B,gBAAgB,sCAAsC,EAAE,IAAI;AACvQ;AACA,4DAA4D,0CAA0C,EAAE,GAAG;AAC3G;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,2BAA2B,IAAI;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,qDAAqD;AACrD;AACA,IAAI,8DAAY;AAChB;AACA,EAAE,8DAAY;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH,IAAI,8DAAY;AAChB;AACA,GAAG;AACH;AACA;AACA,MAAM,8DAAY;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA,KAAK,4DAA4D;AACjE;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,qCAAqC,SAAS;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,QAAQ;AAC5C;AACA;AACA;AACA,0GAA0G;AAC1G,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,6CAA6C,mBAAmB;AACrE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA,0EAA0E;AAC1E,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,4DAAU;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,4DAAU;AACnB;AACA;AACA,MAAM,4DAAU;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,IAAI,2DAAS;AACb;AACA;AACA;AACA;AACA,sBAAsB,4DAAU;AAChC,SAAS,yDAAO;AAChB;AACA;AACA;AACA,mCAAmC,yDAAO,qBAAqB;AAC/D;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAE2W;;;;;;;;;;;;;ACj2B3W;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,4BAA4B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4GAA4G,wDAAwD;AACpK;AACA;AACA;AACA,kHAAkH;AAClH;AACA,IAAI,4DAA4D;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qHAAqH;AACrH,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,yBAAyB;AAC1C;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA,iBAAiB,2BAA2B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,uBAAuB;AACtC;AACA;AACA;AACA,eAAe,0BAA0B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,eAAe;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA,GAAG;AACH,sDAAsD;AACtD;AACA;AACA,oCAAoC,OAAO;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA,KAAK;AACL,qBAAqB,oBAAoB;AACzC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP,wBAAwB,SAAS;AACjC;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qEAAqE,0GAA0G;AAC/K;AACA;AACA;AACA;AACA,iEAAiE,4HAA4H;AAC7L;AACA;AACA;AACA,uBAAuB,aAAa;AACpC,cAAc,mBAAmB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,YAAY;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,UAAU;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA,4CAA4C,SAAS;AACrD;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,YAAY;AAC1D,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,qBAAqB,YAAY;AACjC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,sDAAsD,iDAAiD;AACvG,kDAAkD,oEAAoE;AACtH;AACA;AACA;AACA;AACA;AACA,yBAAyB,YAAY;AACrC;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,YAAY;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,aAAa;AACxC,kBAAkB,YAAY;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,YAAY;AACtC;AACA;AACA;AACA;AACA;AACA,yBAAyB,UAAU;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,yBAAyB,YAAY;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,YAAY;AAC1D,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,gDAAgD;AAChD;AACA;AACA,kGAAkG,aAAa,GAAG,SAAS;AAC3H;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kFAAkF,aAAa,GAAG,SAAS;AAC3G;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA,oFAAoF,aAAa,GAAG,EAAE;AACtG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB,GAAG,0BAA0B;AAC7D;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,mBAAmB,uBAAuB;AAC1C;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,0CAA0C,SAAS;AACnD;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA,mDAAmD;;AAE8gB;;;;;;;;;;;;;;;;;ACjzCjkB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEO;AACP;AACA;AACA;;AAEA;AACO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,gEAAC;;;;;;;;;;;;;ACjFhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AAC8C;;AAE9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,8BAA8B;AAC9B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,wCAAwC;AACxC;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6BAA6B,GAAG;AAChC;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kBAAkB,kBAAkB,mBAAmB;AACvD;AACA,kBAAkB;AAClB,CAAC;;AAED;;AAEA,IAAI,IAAqC;AACzC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C;AAC5C,8CAA8C;AAC9C,kCAAkC;AAClC,oCAAoC;AACpC,kCAAkC;AAClC,8BAA8B;AAC9B,gCAAgC;AAChC,8BAA8B;AAC9B,gCAAgC;AAChC,oCAAoC;AACpC,wCAAwC;AACxC,8CAA8C;AAC9C;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA,CAAC,iBAAiB;AAClB;AACA;AACA;AACA,MAAM,IAAqC;AAC3C;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG,IAAI;AACP,yBAAyB,iBAAiB;AAC1C;AACA;AACA,8EAA8E;AAC9E;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA,GAAG,IAAI;AACP;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,GAAG,6BAA6B;AAChC,6BAA6B,uBAAuB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,mEAAmE;;AAEnE;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC,wEAAwE;AACzE;;AAEA;;AAEA;AACA,4BAA4B;;AAE5B;AACA;AACA,uDAAuD,kBAAkB,wCAAwC;AACjH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D;AAC/D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;;AAEA;AACA,QAAQ,IAAqC;AAC7C;AACA;;AAEA;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;;AAGA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB;AACA;;AAEA;AACA;AACA;AACA,OAAO,EAAE;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;;;AAGL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,eAAe;AACf;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,8BAA8B,mEAAY,4CAA4C;AACtF;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA,QAAQ,IAAqC;AAC7C;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ,IAAqC;AAC7C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,6DAA6D,oBAAoB;AACjF;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA,QAAQ,IAAqC;AAC7C;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iCAAiC;;AAEjC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;;AAEA;AACA;AACA,QAAQ,IAAqC;AAC7C;AACA,KAAK;;;AAGL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,QAAQ,IAAqC;AAC7C;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ,IAAqC;AAC7C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,4BAA4B;AAC5B;AACA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA,QAAQ,IAAqC;AAC7C;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,MAAM,IAAqC;AAC3C;AACA;AACA;;AAEA;AACA,oCAAoC;AACpC;AACA,GAAG;AACH;AACA;;AAEA,MAAM,IAAqC;AAC3C;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,kCAAkC;AAClC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA,MAAM,IAAqC;AAC3C;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,iDAAiD;;AAEjD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,4CAA4C;AAC5C;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,MAAM,IAAqC;AAC3C;AACA;;AAEA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA,GAAG;AACH,mCAAmC;AACnC;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;;AAGA,yGAAyG;;AAEzG;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,IAAqC;AAC/C;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA;AACA;AACA,sEAAsE;AACtE;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,mCAAmC;AACnC;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAEc,oEAAK,EAAC;AAC0G;AAC/H;;;;;;;;;;;;;ACprEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcO,IAAMA,QAAQ,GAAG,IAAIC,0DAAJ,CAAyB,UAAzB,CAAjB;AAMA,IAAMC,GAAG,GAAG,IAAID,0DAAJ,CAA4B,aAA5B,CAAZ;AAQA,IAAME,IAAI,GAAG,IAAIF,0DAAJ,CAAqB,MAArB,CAAb;AAEA,IAAMG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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/builded.ts\");\n","export default function contains(parent, child) {\n  // $FlowFixMe: hasOwnProperty doesn't seem to work in tests\n  var isShadow = Boolean(child.getRootNode && child.getRootNode().host); // First, attempt with faster native method\n\n  if (parent.contains(child)) {\n    return true;\n  } // then fallback to custom implementation with Shadow DOM support\n  else if (isShadow) {\n      var next = child;\n\n      do {\n        if (next && parent.isSameNode(next)) {\n          return true;\n        } // $FlowFixMe: need a better way to handle this...\n\n\n        next = next.parentNode || next.host;\n      } while (next);\n    } // Give up, the result is false\n\n\n  return false;\n}","export default function getBoundingClientRect(element) {\n  var rect = element.getBoundingClientRect();\n  return {\n    width: rect.width,\n    height: rect.height,\n    top: rect.top,\n    right: rect.right,\n    bottom: rect.bottom,\n    left: rect.left,\n    x: rect.left,\n    y: rect.top\n  };\n}","import { viewport } from \"../enums.js\";\nimport getViewportRect from \"./getViewportRect.js\";\nimport getDocumentRect from \"./getDocumentRect.js\";\nimport listScrollParents from \"./listScrollParents.js\";\nimport getOffsetParent from \"./getOffsetParent.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isElement, isHTMLElement } from \"./instanceOf.js\";\nimport getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport contains from \"./contains.js\";\nimport rectToClientRect from \"../utils/rectToClientRect.js\";\n\nfunction getInnerBoundingClientRect(element) {\n  var rect = getBoundingClientRect(element);\n  rect.top = rect.top + element.clientTop;\n  rect.left = rect.left + element.clientLeft;\n  rect.bottom = rect.top + element.clientHeight;\n  rect.right = rect.left + element.clientWidth;\n  rect.width = element.clientWidth;\n  rect.height = element.clientHeight;\n  rect.x = rect.left;\n  rect.y = rect.top;\n  return rect;\n}\n\nfunction getClientRectFromMixedType(element, clippingParent) {\n  return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isHTMLElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));\n} // A \"clipping parent\" is an overflowable container with the characteristic of\n// clipping (or hiding) overflowing elements with a position different from\n// `initial`\n\n\nfunction getClippingParents(element) {\n  var clippingParents = listScrollParents(element);\n  var canEscapeClipping = ['absolute', 'fixed'].indexOf(getComputedStyle(element).position) >= 0;\n  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;\n\n  if (!isElement(clipperElement)) {\n    return [];\n  } // $FlowFixMe: https://github.com/facebook/flow/issues/1414\n\n\n  return clippingParents.filter(function (clippingParent) {\n    return isElement(clippingParent) && contains(clippingParent, clipperElement);\n  });\n} // Gets the maximum area that the element is visible in due to any number of\n// clipping parents\n\n\nexport default function getClippingRect(element, boundary, rootBoundary) {\n  var mainClippingParents = boundary === 'clippingParents' ? getClippingParents(element) : [].concat(boundary);\n  var clippingParents = [].concat(mainClippingParents, [rootBoundary]);\n  var firstClippingParent = clippingParents[0];\n  var clippingRect = clippingParents.reduce(function (accRect, clippingParent) {\n    var rect = getClientRectFromMixedType(element, clippingParent);\n    accRect.top = Math.max(rect.top, accRect.top);\n    accRect.right = Math.min(rect.right, accRect.right);\n    accRect.bottom = Math.min(rect.bottom, accRect.bottom);\n    accRect.left = Math.max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromMixedType(element, firstClippingParent));\n  clippingRect.width = clippingRect.right - clippingRect.left;\n  clippingRect.height = clippingRect.bottom - clippingRect.top;\n  clippingRect.x = clippingRect.left;\n  clippingRect.y = clippingRect.top;\n  return clippingRect;\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getNodeScroll from \"./getNodeScroll.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport isScrollParent from \"./isScrollParent.js\"; // Returns the composite rect of an element relative to its offsetParent.\n// Composite means it takes into account transforms as well as layout.\n\nexport default function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n\n  var documentElement = getDocumentElement(offsetParent);\n  var rect = getBoundingClientRect(elementOrVirtualElement);\n  var isOffsetParentAnElement = isHTMLElement(offsetParent);\n  var scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  var offsets = {\n    x: 0,\n    y: 0\n  };\n\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || // https://github.com/popperjs/popper-core/issues/1078\n    isScrollParent(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n\n    if (isHTMLElement(offsetParent)) {\n      offsets = getBoundingClientRect(offsetParent);\n      offsets.x += offsetParent.clientLeft;\n      offsets.y += offsetParent.clientTop;\n    } else if (documentElement) {\n      offsets.x = getWindowScrollBarX(documentElement);\n    }\n  }\n\n  return {\n    x: rect.left + scroll.scrollLeft - offsets.x,\n    y: rect.top + scroll.scrollTop - offsets.y,\n    width: rect.width,\n    height: rect.height\n  };\n}","import getWindow from \"./getWindow.js\";\nexport default function getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}","import { isElement } from \"./instanceOf.js\";\nexport default function getDocumentElement(element) {\n  // $FlowFixMe: assume body is always available\n  return (isElement(element) ? element.ownerDocument : element.document).documentElement;\n}","import getDocumentElement from \"./getDocumentElement.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nimport getWindowScroll from \"./getWindowScroll.js\"; // Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable\n\nexport default function getDocumentRect(element) {\n  var html = getDocumentElement(element);\n  var winScroll = getWindowScroll(element);\n  var body = element.ownerDocument.body;\n  var width = Math.max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);\n  var height = Math.max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);\n  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);\n  var y = -winScroll.scrollTop;\n\n  if (getComputedStyle(body || html).direction === 'rtl') {\n    x += Math.max(html.clientWidth, body ? body.clientWidth : 0) - width;\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x,\n    y: y\n  };\n}","export default function getHTMLElementScroll(element) {\n  return {\n    scrollLeft: element.scrollLeft,\n    scrollTop: element.scrollTop\n  };\n}","// Returns the layout rect of an element relative to its offsetParent. Layout\n// means it doesn't take into account transforms.\nexport default function getLayoutRect(element) {\n  return {\n    x: element.offsetLeft,\n    y: element.offsetTop,\n    width: element.offsetWidth,\n    height: element.offsetHeight\n  };\n}","export default function getNodeName(element) {\n  return element ? (element.nodeName || '').toLowerCase() : null;\n}","import getWindowScroll from \"./getWindowScroll.js\";\nimport getWindow from \"./getWindow.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport getHTMLElementScroll from \"./getHTMLElementScroll.js\";\nexport default function getNodeScroll(node) {\n  if (node === getWindow(node) || !isHTMLElement(node)) {\n    return getWindowScroll(node);\n  } else {\n    return getHTMLElementScroll(node);\n  }\n}","import getWindow from \"./getWindow.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport getComputedStyle from \"./getComputedStyle.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nimport isTableElement from \"./isTableElement.js\";\nimport getParentNode from \"./getParentNode.js\";\n\nfunction getTrueOffsetParent(element) {\n  if (!isHTMLElement(element) || // https://github.com/popperjs/popper-core/issues/837\n  getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n\n  return element.offsetParent;\n} // `.offsetParent` reports `null` for fixed elements, while absolute elements\n// return the containing block\n\n\nfunction getContainingBlock(element) {\n  var currentNode = getParentNode(element);\n\n  while (isHTMLElement(currentNode) && ['html', 'body'].indexOf(getNodeName(currentNode)) < 0) {\n    var css = getComputedStyle(currentNode); // This is non-exhaustive but covers the most common CSS properties that\n    // create a containing block.\n\n    if (css.transform !== 'none' || css.perspective !== 'none' || css.willChange !== 'auto') {\n      return currentNode;\n    } else {\n      currentNode = currentNode.parentNode;\n    }\n  }\n\n  return null;\n} // Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\n\n\nexport default function getOffsetParent(element) {\n  var window = getWindow(element);\n  var offsetParent = getTrueOffsetParent(element);\n\n  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === 'static') {\n    offsetParent = getTrueOffsetParent(offsetParent);\n  }\n\n  if (offsetParent && getNodeName(offsetParent) === 'body' && getComputedStyle(offsetParent).position === 'static') {\n    return window;\n  }\n\n  return offsetParent || getContainingBlock(element) || window;\n}","import getNodeName from \"./getNodeName.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nexport default function getParentNode(element) {\n  if (getNodeName(element) === 'html') {\n    return element;\n  }\n\n  return (// $FlowFixMe: this is a quicker (but less type safe) way to save quite some bytes from the bundle\n    element.assignedSlot || // step into the shadow DOM of the parent of a slotted node\n    element.parentNode || // DOM Element detected\n    // $FlowFixMe: need a better way to handle this...\n    element.host || // ShadowRoot detected\n    // $FlowFixMe: HTMLElement is a Node\n    getDocumentElement(element) // fallback\n\n  );\n}","import getParentNode from \"./getParentNode.js\";\nimport isScrollParent from \"./isScrollParent.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport { isHTMLElement } from \"./instanceOf.js\";\nexport default function getScrollParent(node) {\n  if (['html', 'body', '#document'].indexOf(getNodeName(node)) >= 0) {\n    // $FlowFixMe: assume body is always available\n    return node.ownerDocument.body;\n  }\n\n  if (isHTMLElement(node) && isScrollParent(node)) {\n    return node;\n  }\n\n  return getScrollParent(getParentNode(node));\n}","import getWindow from \"./getWindow.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScrollBarX from \"./getWindowScrollBarX.js\";\nexport default function getViewportRect(element) {\n  var win = getWindow(element);\n  var html = getDocumentElement(element);\n  var visualViewport = win.visualViewport;\n  var width = html.clientWidth;\n  var height = html.clientHeight;\n  var x = 0;\n  var y = 0; // NB: This isn't supported on iOS <= 12. If the keyboard is open, the popper\n  // can be obscured underneath it.\n  // Also, `html.clientHeight` adds the bottom bar height in Safari iOS, even\n  // if it isn't open, so if this isn't available, the popper will be detected\n  // to overflow the bottom of the screen too early.\n\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height; // Uses Layout Viewport (like Chrome; Safari does not currently)\n    // In Chrome, it returns a value very close to 0 (+/-) but contains rounding\n    // errors due to floating point numbers, so we need to check precision.\n    // Safari returns a number <= 0, usually < -1 when pinch-zoomed\n    // Feature detection fails in mobile emulation mode in Chrome.\n    // Math.abs(win.innerWidth / visualViewport.scale - visualViewport.width) <\n    // 0.001\n    // Fallback here: \"Not Safari\" userAgent\n\n    if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n\n  return {\n    width: width,\n    height: height,\n    x: x + getWindowScrollBarX(element),\n    y: y\n  };\n}","/*:: import type { Window } from '../types'; */\n\n/*:: declare function getWindow(node: Node | Window): Window; */\nexport default function getWindow(node) {\n  if (node.toString() !== '[object Window]') {\n    var ownerDocument = node.ownerDocument;\n    return ownerDocument ? ownerDocument.defaultView : window;\n  }\n\n  return node;\n}","import getWindow from \"./getWindow.js\";\nexport default function getWindowScroll(node) {\n  var win = getWindow(node);\n  var scrollLeft = win.pageXOffset;\n  var scrollTop = win.pageYOffset;\n  return {\n    scrollLeft: scrollLeft,\n    scrollTop: scrollTop\n  };\n}","import getBoundingClientRect from \"./getBoundingClientRect.js\";\nimport getDocumentElement from \"./getDocumentElement.js\";\nimport getWindowScroll from \"./getWindowScroll.js\";\nexport default function getWindowScrollBarX(element) {\n  // If <html> has a CSS width greater than the viewport, then this will be\n  // incorrect for RTL.\n  // Popper 1 is broken in this case and never had a bug report so let's assume\n  // it's not an issue. I don't think anyone ever specifies width on <html>\n  // anyway.\n  // Browsers where the left scrollbar doesn't cause an issue report `0` for\n  // this (e.g. Edge 2019, IE11, Safari)\n  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;\n}","import getWindow from \"./getWindow.js\";\n/*:: declare function isElement(node: mixed): boolean %checks(node instanceof\n  Element); */\n\nfunction isElement(node) {\n  var OwnElement = getWindow(node).Element;\n  return node instanceof OwnElement || node instanceof Element;\n}\n/*:: declare function isHTMLElement(node: mixed): boolean %checks(node instanceof\n  HTMLElement); */\n\n\nfunction isHTMLElement(node) {\n  var OwnElement = getWindow(node).HTMLElement;\n  return node instanceof OwnElement || node instanceof HTMLElement;\n}\n\nexport { isElement, isHTMLElement };","import getComputedStyle from \"./getComputedStyle.js\";\nexport default function isScrollParent(element) {\n  // Firefox wants us to check `-x` and `-y` variations as well\n  var _getComputedStyle = getComputedStyle(element),\n      overflow = _getComputedStyle.overflow,\n      overflowX = _getComputedStyle.overflowX,\n      overflowY = _getComputedStyle.overflowY;\n\n  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);\n}","import getNodeName from \"./getNodeName.js\";\nexport default function isTableElement(element) {\n  return ['table', 'td', 'th'].indexOf(getNodeName(element)) >= 0;\n}","import getScrollParent from \"./getScrollParent.js\";\nimport getParentNode from \"./getParentNode.js\";\nimport getNodeName from \"./getNodeName.js\";\nimport getWindow from \"./getWindow.js\";\nimport isScrollParent from \"./isScrollParent.js\";\n/*\ngiven a DOM element, return the list of all scroll parents, up the list of ancesors\nuntil we get to the top window object. This list is what we attach scroll listeners\nto, because if any of these parent elements scroll, we'll need to re-calculate the \nreference element's position.\n*/\n\nexport default function listScrollParents(element, list) {\n  if (list === void 0) {\n    list = [];\n  }\n\n  var scrollParent = getScrollParent(element);\n  var isBody = getNodeName(scrollParent) === 'body';\n  var win = getWindow(scrollParent);\n  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;\n  var updatedList = list.concat(target);\n  return isBody ? updatedList : // $FlowFixMe: isBody tells us target will be an HTMLElement here\n  updatedList.concat(listScrollParents(getParentNode(target)));\n}","export var top = 'top';\nexport var bottom = 'bottom';\nexport var right = 'right';\nexport var left = 'left';\nexport var auto = 'auto';\nexport var basePlacements = [top, bottom, right, left];\nexport var start = 'start';\nexport var end = 'end';\nexport var clippingParents = 'clippingParents';\nexport var viewport = 'viewport';\nexport var popper = 'popper';\nexport var reference = 'reference';\nexport var variationPlacements = /*#__PURE__*/basePlacements.reduce(function (acc, placement) {\n  return acc.concat([placement + \"-\" + start, placement + \"-\" + end]);\n}, []);\nexport var placements = /*#__PURE__*/[].concat(basePlacements, [auto]).reduce(function (acc, placement) {\n  return acc.concat([placement, placement + \"-\" + start, placement + \"-\" + end]);\n}, []); // modifiers that need to read the DOM\n\nexport var beforeRead = 'beforeRead';\nexport var read = 'read';\nexport var afterRead = 'afterRead'; // pure-logic modifiers\n\nexport var beforeMain = 'beforeMain';\nexport var main = 'main';\nexport var afterMain = 'afterMain'; // modifier with the purpose to write to the DOM (or write into a framework state)\n\nexport var beforeWrite = 'beforeWrite';\nexport var write = 'write';\nexport var afterWrite = 'afterWrite';\nexport var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];","import getCompositeRect from \"./dom-utils/getCompositeRect.js\";\nimport getLayoutRect from \"./dom-utils/getLayoutRect.js\";\nimport listScrollParents from \"./dom-utils/listScrollParents.js\";\nimport getOffsetParent from \"./dom-utils/getOffsetParent.js\";\nimport getComputedStyle from \"./dom-utils/getComputedStyle.js\";\nimport orderModifiers from \"./utils/orderModifiers.js\";\nimport debounce from \"./utils/debounce.js\";\nimport validateModifiers from \"./utils/validateModifiers.js\";\nimport uniqueBy from \"./utils/uniqueBy.js\";\nimport getBasePlacement from \"./utils/getBasePlacement.js\";\nimport mergeByName from \"./utils/mergeByName.js\";\nimport { isElement } from \"./dom-utils/instanceOf.js\";\nimport { auto } from \"./enums.js\";\nexport * from \"./enums.js\";\nvar INVALID_ELEMENT_ERROR = 'Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.';\nvar INFINITE_LOOP_ERROR = 'Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.';\nvar DEFAULT_OPTIONS = {\n  placement: 'bottom',\n  modifiers: [],\n  strategy: 'absolute'\n};\n\nfunction areValidElements() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  return !args.some(function (element) {\n    return !(element && typeof element.getBoundingClientRect === 'function');\n  });\n}\n\nexport function popperGenerator(generatorOptions) {\n  if (generatorOptions === void 0) {\n    generatorOptions = {};\n  }\n\n  var _generatorOptions = generatorOptions,\n      _generatorOptions$def = _generatorOptions.defaultModifiers,\n      defaultModifiers = _generatorOptions$def === void 0 ? [] : _generatorOptions$def,\n      _generatorOptions$def2 = _generatorOptions.defaultOptions,\n      defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;\n  return function createPopper(reference, popper, options) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    var state = {\n      placement: 'bottom',\n      orderedModifiers: [],\n      options: Object.assign(Object.assign({}, DEFAULT_OPTIONS), defaultOptions),\n      modifiersData: {},\n      elements: {\n        reference: reference,\n        popper: popper\n      },\n      attributes: {},\n      styles: {}\n    };\n    var effectCleanupFns = [];\n    var isDestroyed = false;\n    var instance = {\n      state: state,\n      setOptions: function setOptions(options) {\n        cleanupModifierEffects();\n        state.options = Object.assign(Object.assign(Object.assign({}, defaultOptions), state.options), options);\n        state.scrollParents = {\n          reference: isElement(reference) ? listScrollParents(reference) : reference.contextElement ? listScrollParents(reference.contextElement) : [],\n          popper: listScrollParents(popper)\n        }; // Orders the modifiers based on their dependencies and `phase`\n        // properties\n\n        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers, state.options.modifiers))); // Strip out disabled modifiers\n\n        state.orderedModifiers = orderedModifiers.filter(function (m) {\n          return m.enabled;\n        }); // Validate the provided modifiers so that the consumer will get warned\n        // if one of the modifiers is invalid for any reason\n\n        if (process.env.NODE_ENV !== \"production\") {\n          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function (_ref) {\n            var name = _ref.name;\n            return name;\n          });\n          validateModifiers(modifiers);\n\n          if (getBasePlacement(state.options.placement) === auto) {\n            var flipModifier = state.orderedModifiers.find(function (_ref2) {\n              var name = _ref2.name;\n              return name === 'flip';\n            });\n\n            if (!flipModifier) {\n              console.error(['Popper: \"auto\" placements require the \"flip\" modifier be', 'present and enabled to work.'].join(' '));\n            }\n          }\n\n          var _getComputedStyle = getComputedStyle(popper),\n              marginTop = _getComputedStyle.marginTop,\n              marginRight = _getComputedStyle.marginRight,\n              marginBottom = _getComputedStyle.marginBottom,\n              marginLeft = _getComputedStyle.marginLeft; // We no longer take into account `margins` on the popper, and it can\n          // cause bugs with positioning, so we'll warn the consumer\n\n\n          if ([marginTop, marginRight, marginBottom, marginLeft].some(function (margin) {\n            return parseFloat(margin);\n          })) {\n            console.warn(['Popper: CSS \"margin\" styles cannot be used to apply padding', 'between the popper and its reference element or boundary.', 'To replicate margin, use the `offset` modifier, as well as', 'the `padding` option in the `preventOverflow` and `flip`', 'modifiers.'].join(' '));\n          }\n        }\n\n        runModifierEffects();\n        return instance.update();\n      },\n      // Sync update – it will always be executed, even if not necessary. This\n      // is useful for low frequency updates where sync behavior simplifies the\n      // logic.\n      // For high frequency updates (e.g. `resize` and `scroll` events), always\n      // prefer the async Popper#update method\n      forceUpdate: function forceUpdate() {\n        if (isDestroyed) {\n          return;\n        }\n\n        var _state$elements = state.elements,\n            reference = _state$elements.reference,\n            popper = _state$elements.popper; // Don't proceed if `reference` or `popper` are not valid elements\n        // anymore\n\n        if (!areValidElements(reference, popper)) {\n          if (process.env.NODE_ENV !== \"production\") {\n            console.error(INVALID_ELEMENT_ERROR);\n          }\n\n          return;\n        } // Store the reference and popper rects to be read by modifiers\n\n\n        state.rects = {\n          reference: getCompositeRect(reference, getOffsetParent(popper), state.options.strategy === 'fixed'),\n          popper: getLayoutRect(popper)\n        }; // Modifiers have the ability to reset the current update cycle. The\n        // most common use case for this is the `flip` modifier changing the\n        // placement, which then needs to re-run all the modifiers, because the\n        // logic was previously ran for the previous placement and is therefore\n        // stale/incorrect\n\n        state.reset = false;\n        state.placement = state.options.placement; // On each update cycle, the `modifiersData` property for each modifier\n        // is filled with the initial data specified by the modifier. This means\n        // it doesn't persist and is fresh on each update.\n        // To ensure persistent data, use `${name}#persistent`\n\n        state.orderedModifiers.forEach(function (modifier) {\n          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);\n        });\n        var __debug_loops__ = 0;\n\n        for (var index = 0; index < state.orderedModifiers.length; index++) {\n          if (process.env.NODE_ENV !== \"production\") {\n            __debug_loops__ += 1;\n\n            if (__debug_loops__ > 100) {\n              console.error(INFINITE_LOOP_ERROR);\n              break;\n            }\n          }\n\n          if (state.reset === true) {\n            state.reset = false;\n            index = -1;\n            continue;\n          }\n\n          var _state$orderedModifie = state.orderedModifiers[index],\n              fn = _state$orderedModifie.fn,\n              _state$orderedModifie2 = _state$orderedModifie.options,\n              _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2,\n              name = _state$orderedModifie.name;\n\n          if (typeof fn === 'function') {\n            state = fn({\n              state: state,\n              options: _options,\n              name: name,\n              instance: instance\n            }) || state;\n          }\n        }\n      },\n      // Async and optimistically optimized update – it will not be executed if\n      // not necessary (debounced to run at most once-per-tick)\n      update: debounce(function () {\n        return new Promise(function (resolve) {\n          instance.forceUpdate();\n          resolve(state);\n        });\n      }),\n      destroy: function destroy() {\n        cleanupModifierEffects();\n        isDestroyed = true;\n      }\n    };\n\n    if (!areValidElements(reference, popper)) {\n      if (process.env.NODE_ENV !== \"production\") {\n        console.error(INVALID_ELEMENT_ERROR);\n      }\n\n      return instance;\n    }\n\n    instance.setOptions(options).then(function (state) {\n      if (!isDestroyed && options.onFirstUpdate) {\n        options.onFirstUpdate(state);\n      }\n    }); // Modifiers have the ability to execute arbitrary code before the first\n    // update cycle runs. They will be executed in the same order as the update\n    // cycle. This is useful when a modifier adds some persistent data that\n    // other modifiers need to use, but the modifier is run after the dependent\n    // one.\n\n    function runModifierEffects() {\n      state.orderedModifiers.forEach(function (_ref3) {\n        var name = _ref3.name,\n            _ref3$options = _ref3.options,\n            options = _ref3$options === void 0 ? {} : _ref3$options,\n            effect = _ref3.effect;\n\n        if (typeof effect === 'function') {\n          var cleanupFn = effect({\n            state: state,\n            name: name,\n            instance: instance,\n            options: options\n          });\n\n          var noopFn = function noopFn() {};\n\n          effectCleanupFns.push(cleanupFn || noopFn);\n        }\n      });\n    }\n\n    function cleanupModifierEffects() {\n      effectCleanupFns.forEach(function (fn) {\n        return fn();\n      });\n      effectCleanupFns = [];\n    }\n\n    return instance;\n  };\n}\nexport var createPopper = /*#__PURE__*/popperGenerator();","import getNodeName from \"../dom-utils/getNodeName.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // This modifier takes the styles prepared by the `computeStyles` modifier\n// and applies them to the HTMLElements such as popper and arrow\n\nfunction applyStyles(_ref) {\n  var state = _ref.state;\n  Object.keys(state.elements).forEach(function (name) {\n    var style = state.styles[name] || {};\n    var attributes = state.attributes[name] || {};\n    var element = state.elements[name]; // arrow is optional + virtual elements\n\n    if (!isHTMLElement(element) || !getNodeName(element)) {\n      return;\n    } // Flow doesn't support to extend this property, but it's the most\n    // effective way to apply styles to an HTMLElement\n    // $FlowFixMe\n\n\n    Object.assign(element.style, style);\n    Object.keys(attributes).forEach(function (name) {\n      var value = attributes[name];\n\n      if (value === false) {\n        element.removeAttribute(name);\n      } else {\n        element.setAttribute(name, value === true ? '' : value);\n      }\n    });\n  });\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state;\n  var initialStyles = {\n    popper: {\n      position: state.options.strategy,\n      left: '0',\n      top: '0',\n      margin: '0'\n    },\n    arrow: {\n      position: 'absolute'\n    },\n    reference: {}\n  };\n  Object.assign(state.elements.popper.style, initialStyles.popper);\n\n  if (state.elements.arrow) {\n    Object.assign(state.elements.arrow.style, initialStyles.arrow);\n  }\n\n  return function () {\n    Object.keys(state.elements).forEach(function (name) {\n      var element = state.elements[name];\n      var attributes = state.attributes[name] || {};\n      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]); // Set all values to an empty string to unset them\n\n      var style = styleProperties.reduce(function (style, property) {\n        style[property] = '';\n        return style;\n      }, {}); // arrow is optional + virtual elements\n\n      if (!isHTMLElement(element) || !getNodeName(element)) {\n        return;\n      } // Flow doesn't support to extend this property, but it's the most\n      // effective way to apply styles to an HTMLElement\n      // $FlowFixMe\n\n\n      Object.assign(element.style, style);\n      Object.keys(attributes).forEach(function (attribute) {\n        element.removeAttribute(attribute);\n      });\n    });\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'applyStyles',\n  enabled: true,\n  phase: 'write',\n  fn: applyStyles,\n  effect: effect,\n  requires: ['computeStyles']\n};","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport contains from \"../dom-utils/contains.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport within from \"../utils/within.js\";\nimport mergePaddingObject from \"../utils/mergePaddingObject.js\";\nimport expandToHashMap from \"../utils/expandToHashMap.js\";\nimport { left, right, basePlacements, top, bottom } from \"../enums.js\";\nimport { isHTMLElement } from \"../dom-utils/instanceOf.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction arrow(_ref) {\n  var _state$modifiersData$;\n\n  var state = _ref.state,\n      name = _ref.name;\n  var arrowElement = state.elements.arrow;\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var basePlacement = getBasePlacement(state.placement);\n  var axis = getMainAxisFromPlacement(basePlacement);\n  var isVertical = [left, right].indexOf(basePlacement) >= 0;\n  var len = isVertical ? 'height' : 'width';\n\n  if (!arrowElement || !popperOffsets) {\n    return;\n  }\n\n  var paddingObject = state.modifiersData[name + \"#persistent\"].padding;\n  var arrowRect = getLayoutRect(arrowElement);\n  var minProp = axis === 'y' ? top : left;\n  var maxProp = axis === 'y' ? bottom : right;\n  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets[axis] - state.rects.popper[len];\n  var startDiff = popperOffsets[axis] - state.rects.reference[axis];\n  var arrowOffsetParent = getOffsetParent(arrowElement);\n  var clientSize = arrowOffsetParent ? axis === 'y' ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;\n  var centerToReference = endDiff / 2 - startDiff / 2; // Make sure the arrow doesn't overflow the popper if the center point is\n  // outside of the popper bounds\n\n  var min = paddingObject[minProp];\n  var max = clientSize - arrowRect[len] - paddingObject[maxProp];\n  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;\n  var offset = within(min, center, max); // Prevents breaking syntax highlighting...\n\n  var axisProp = axis;\n  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset, _state$modifiersData$.centerOffset = offset - center, _state$modifiersData$);\n}\n\nfunction effect(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options,\n      name = _ref2.name;\n  var _options$element = options.element,\n      arrowElement = _options$element === void 0 ? '[data-popper-arrow]' : _options$element,\n      _options$padding = options.padding,\n      padding = _options$padding === void 0 ? 0 : _options$padding;\n\n  if (arrowElement == null) {\n    return;\n  } // CSS selector\n\n\n  if (typeof arrowElement === 'string') {\n    arrowElement = state.elements.popper.querySelector(arrowElement);\n\n    if (!arrowElement) {\n      return;\n    }\n  }\n\n  if (process.env.NODE_ENV !== \"production\") {\n    if (!isHTMLElement(arrowElement)) {\n      console.error(['Popper: \"arrow\" element must be an HTMLElement (not an SVGElement).', 'To use an SVG arrow, wrap it in an HTMLElement that will be used as', 'the arrow.'].join(' '));\n    }\n  }\n\n  if (!contains(state.elements.popper, arrowElement)) {\n    if (process.env.NODE_ENV !== \"production\") {\n      console.error(['Popper: \"arrow\" modifier\\'s `element` must be a child of the popper', 'element.'].join(' '));\n    }\n\n    return;\n  }\n\n  state.elements.arrow = arrowElement;\n  state.modifiersData[name + \"#persistent\"] = {\n    padding: mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements))\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'arrow',\n  enabled: true,\n  phase: 'main',\n  fn: arrow,\n  effect: effect,\n  requires: ['popperOffsets'],\n  requiresIfExists: ['preventOverflow']\n};","import { top, left, right, bottom } from \"../enums.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport getWindow from \"../dom-utils/getWindow.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport getComputedStyle from \"../dom-utils/getComputedStyle.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar unsetSides = {\n  top: 'auto',\n  right: 'auto',\n  bottom: 'auto',\n  left: 'auto'\n}; // Round the offsets to the nearest suitable subpixel based on the DPR.\n// Zooming can change the DPR, but it seems to report a value that will\n// cleanly divide the values into the appropriate subpixels.\n\nfunction roundOffsets(_ref) {\n  var x = _ref.x,\n      y = _ref.y;\n  var win = window;\n  var dpr = win.devicePixelRatio || 1;\n  return {\n    x: Math.round(x * dpr) / dpr || 0,\n    y: Math.round(y * dpr) / dpr || 0\n  };\n}\n\nexport function mapToStyles(_ref2) {\n  var _Object$assign2;\n\n  var popper = _ref2.popper,\n      popperRect = _ref2.popperRect,\n      placement = _ref2.placement,\n      offsets = _ref2.offsets,\n      position = _ref2.position,\n      gpuAcceleration = _ref2.gpuAcceleration,\n      adaptive = _ref2.adaptive;\n\n  var _roundOffsets = roundOffsets(offsets),\n      x = _roundOffsets.x,\n      y = _roundOffsets.y;\n\n  var hasX = offsets.hasOwnProperty('x');\n  var hasY = offsets.hasOwnProperty('y');\n  var sideX = left;\n  var sideY = top;\n  var win = window;\n\n  if (adaptive) {\n    var offsetParent = getOffsetParent(popper);\n\n    if (offsetParent === getWindow(popper)) {\n      offsetParent = getDocumentElement(popper);\n    } // $FlowFixMe: force type refinement, we compare offsetParent with window above, but Flow doesn't detect it\n\n    /*:: offsetParent = (offsetParent: Element); */\n\n\n    if (placement === top) {\n      sideY = bottom;\n      y -= offsetParent.clientHeight - popperRect.height;\n      y *= gpuAcceleration ? 1 : -1;\n    }\n\n    if (placement === left) {\n      sideX = right;\n      x -= offsetParent.clientWidth - popperRect.width;\n      x *= gpuAcceleration ? 1 : -1;\n    }\n  }\n\n  var commonStyles = Object.assign({\n    position: position\n  }, adaptive && unsetSides);\n\n  if (gpuAcceleration) {\n    var _Object$assign;\n\n    return Object.assign(Object.assign({}, commonStyles), {}, (_Object$assign = {}, _Object$assign[sideY] = hasY ? '0' : '', _Object$assign[sideX] = hasX ? '0' : '', _Object$assign.transform = (win.devicePixelRatio || 1) < 2 ? \"translate(\" + x + \"px, \" + y + \"px)\" : \"translate3d(\" + x + \"px, \" + y + \"px, 0)\", _Object$assign));\n  }\n\n  return Object.assign(Object.assign({}, commonStyles), {}, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + \"px\" : '', _Object$assign2[sideX] = hasX ? x + \"px\" : '', _Object$assign2.transform = '', _Object$assign2));\n}\n\nfunction computeStyles(_ref3) {\n  var state = _ref3.state,\n      options = _ref3.options;\n  var _options$gpuAccelerat = options.gpuAcceleration,\n      gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat,\n      _options$adaptive = options.adaptive,\n      adaptive = _options$adaptive === void 0 ? true : _options$adaptive;\n\n  if (process.env.NODE_ENV !== \"production\") {\n    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || '';\n\n    if (adaptive && ['transform', 'top', 'right', 'bottom', 'left'].some(function (property) {\n      return transitionProperty.indexOf(property) >= 0;\n    })) {\n      console.warn(['Popper: Detected CSS transitions on at least one of the following', 'CSS properties: \"transform\", \"top\", \"right\", \"bottom\", \"left\".', '\\n\\n', 'Disable the \"computeStyles\" modifier\\'s `adaptive` option to allow', 'for smooth transitions, or remove these properties from the CSS', 'transition declaration on the popper element if only transitioning', 'opacity or background-color for example.', '\\n\\n', 'We recommend using the popper element as a wrapper around an inner', 'element that can have any CSS property transitioned for animations.'].join(' '));\n    }\n  }\n\n  var commonStyles = {\n    placement: getBasePlacement(state.placement),\n    popper: state.elements.popper,\n    popperRect: state.rects.popper,\n    gpuAcceleration: gpuAcceleration\n  };\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.styles.popper = Object.assign(Object.assign({}, state.styles.popper), mapToStyles(Object.assign(Object.assign({}, commonStyles), {}, {\n      offsets: state.modifiersData.popperOffsets,\n      position: state.options.strategy,\n      adaptive: adaptive\n    })));\n  }\n\n  if (state.modifiersData.arrow != null) {\n    state.styles.arrow = Object.assign(Object.assign({}, state.styles.arrow), mapToStyles(Object.assign(Object.assign({}, commonStyles), {}, {\n      offsets: state.modifiersData.arrow,\n      position: 'absolute',\n      adaptive: false\n    })));\n  }\n\n  state.attributes.popper = Object.assign(Object.assign({}, state.attributes.popper), {}, {\n    'data-popper-placement': state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'computeStyles',\n  enabled: true,\n  phase: 'beforeWrite',\n  fn: computeStyles,\n  data: {}\n};","import getWindow from \"../dom-utils/getWindow.js\"; // eslint-disable-next-line import/no-unused-modules\n\nvar passive = {\n  passive: true\n};\n\nfunction effect(_ref) {\n  var state = _ref.state,\n      instance = _ref.instance,\n      options = _ref.options;\n  var _options$scroll = options.scroll,\n      scroll = _options$scroll === void 0 ? true : _options$scroll,\n      _options$resize = options.resize,\n      resize = _options$resize === void 0 ? true : _options$resize;\n  var window = getWindow(state.elements.popper);\n  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);\n\n  if (scroll) {\n    scrollParents.forEach(function (scrollParent) {\n      scrollParent.addEventListener('scroll', instance.update, passive);\n    });\n  }\n\n  if (resize) {\n    window.addEventListener('resize', instance.update, passive);\n  }\n\n  return function () {\n    if (scroll) {\n      scrollParents.forEach(function (scrollParent) {\n        scrollParent.removeEventListener('scroll', instance.update, passive);\n      });\n    }\n\n    if (resize) {\n      window.removeEventListener('resize', instance.update, passive);\n    }\n  };\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'eventListeners',\n  enabled: true,\n  phase: 'write',\n  fn: function fn() {},\n  effect: effect,\n  data: {}\n};","import getOppositePlacement from \"../utils/getOppositePlacement.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getOppositeVariationPlacement from \"../utils/getOppositeVariationPlacement.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport computeAutoPlacement from \"../utils/computeAutoPlacement.js\";\nimport { bottom, top, start, right, left, auto } from \"../enums.js\";\nimport getVariation from \"../utils/getVariation.js\"; // eslint-disable-next-line import/no-unused-modules\n\nfunction getExpandedFallbackPlacements(placement) {\n  if (getBasePlacement(placement) === auto) {\n    return [];\n  }\n\n  var oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];\n}\n\nfunction flip(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n\n  if (state.modifiersData[name]._skip) {\n    return;\n  }\n\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis,\n      specifiedFallbackPlacements = options.fallbackPlacements,\n      padding = options.padding,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      _options$flipVariatio = options.flipVariations,\n      flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio,\n      allowedAutoPlacements = options.allowedAutoPlacements;\n  var preferredPlacement = state.options.placement;\n  var basePlacement = getBasePlacement(preferredPlacement);\n  var isBasePlacement = basePlacement === preferredPlacement;\n  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));\n  var placements = [preferredPlacement].concat(fallbackPlacements).reduce(function (acc, placement) {\n    return acc.concat(getBasePlacement(placement) === auto ? computeAutoPlacement(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding,\n      flipVariations: flipVariations,\n      allowedAutoPlacements: allowedAutoPlacements\n    }) : placement);\n  }, []);\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var checksMap = new Map();\n  var makeFallbackChecks = true;\n  var firstFittingPlacement = placements[0];\n\n  for (var i = 0; i < placements.length; i++) {\n    var placement = placements[i];\n\n    var _basePlacement = getBasePlacement(placement);\n\n    var isStartVariation = getVariation(placement) === start;\n    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;\n    var len = isVertical ? 'width' : 'height';\n    var overflow = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      altBoundary: altBoundary,\n      padding: padding\n    });\n    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;\n\n    if (referenceRect[len] > popperRect[len]) {\n      mainVariationSide = getOppositePlacement(mainVariationSide);\n    }\n\n    var altVariationSide = getOppositePlacement(mainVariationSide);\n    var checks = [];\n\n    if (checkMainAxis) {\n      checks.push(overflow[_basePlacement] <= 0);\n    }\n\n    if (checkAltAxis) {\n      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);\n    }\n\n    if (checks.every(function (check) {\n      return check;\n    })) {\n      firstFittingPlacement = placement;\n      makeFallbackChecks = false;\n      break;\n    }\n\n    checksMap.set(placement, checks);\n  }\n\n  if (makeFallbackChecks) {\n    // `2` may be desired in some cases – research later\n    var numberOfChecks = flipVariations ? 3 : 1;\n\n    var _loop = function _loop(_i) {\n      var fittingPlacement = placements.find(function (placement) {\n        var checks = checksMap.get(placement);\n\n        if (checks) {\n          return checks.slice(0, _i).every(function (check) {\n            return check;\n          });\n        }\n      });\n\n      if (fittingPlacement) {\n        firstFittingPlacement = fittingPlacement;\n        return \"break\";\n      }\n    };\n\n    for (var _i = numberOfChecks; _i > 0; _i--) {\n      var _ret = _loop(_i);\n\n      if (_ret === \"break\") break;\n    }\n  }\n\n  if (state.placement !== firstFittingPlacement) {\n    state.modifiersData[name]._skip = true;\n    state.placement = firstFittingPlacement;\n    state.reset = true;\n  }\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'flip',\n  enabled: true,\n  phase: 'main',\n  fn: flip,\n  requiresIfExists: ['offset'],\n  data: {\n    _skip: false\n  }\n};","import { top, bottom, left, right } from \"../enums.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\n\nfunction getSideOffsets(overflow, rect, preventedOffsets) {\n  if (preventedOffsets === void 0) {\n    preventedOffsets = {\n      x: 0,\n      y: 0\n    };\n  }\n\n  return {\n    top: overflow.top - rect.height - preventedOffsets.y,\n    right: overflow.right - rect.width + preventedOffsets.x,\n    bottom: overflow.bottom - rect.height + preventedOffsets.y,\n    left: overflow.left - rect.width - preventedOffsets.x\n  };\n}\n\nfunction isAnySideFullyClipped(overflow) {\n  return [top, right, bottom, left].some(function (side) {\n    return overflow[side] >= 0;\n  });\n}\n\nfunction hide(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var preventedOffsets = state.modifiersData.preventOverflow;\n  var referenceOverflow = detectOverflow(state, {\n    elementContext: 'reference'\n  });\n  var popperAltOverflow = detectOverflow(state, {\n    altBoundary: true\n  });\n  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);\n  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);\n  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);\n  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);\n  state.modifiersData[name] = {\n    referenceClippingOffsets: referenceClippingOffsets,\n    popperEscapeOffsets: popperEscapeOffsets,\n    isReferenceHidden: isReferenceHidden,\n    hasPopperEscaped: hasPopperEscaped\n  };\n  state.attributes.popper = Object.assign(Object.assign({}, state.attributes.popper), {}, {\n    'data-popper-reference-hidden': isReferenceHidden,\n    'data-popper-escaped': hasPopperEscaped\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'hide',\n  enabled: true,\n  phase: 'main',\n  requiresIfExists: ['preventOverflow'],\n  fn: hide\n};","import getBasePlacement from \"../utils/getBasePlacement.js\";\nimport { top, left, right, placements } from \"../enums.js\";\nexport function distanceAndSkiddingToXY(placement, rects, offset) {\n  var basePlacement = getBasePlacement(placement);\n  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;\n\n  var _ref = typeof offset === 'function' ? offset(Object.assign(Object.assign({}, rects), {}, {\n    placement: placement\n  })) : offset,\n      skidding = _ref[0],\n      distance = _ref[1];\n\n  skidding = skidding || 0;\n  distance = (distance || 0) * invertDistance;\n  return [left, right].indexOf(basePlacement) >= 0 ? {\n    x: distance,\n    y: skidding\n  } : {\n    x: skidding,\n    y: distance\n  };\n}\n\nfunction offset(_ref2) {\n  var state = _ref2.state,\n      options = _ref2.options,\n      name = _ref2.name;\n  var _options$offset = options.offset,\n      offset = _options$offset === void 0 ? [0, 0] : _options$offset;\n  var data = placements.reduce(function (acc, placement) {\n    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset);\n    return acc;\n  }, {});\n  var _data$state$placement = data[state.placement],\n      x = _data$state$placement.x,\n      y = _data$state$placement.y;\n\n  if (state.modifiersData.popperOffsets != null) {\n    state.modifiersData.popperOffsets.x += x;\n    state.modifiersData.popperOffsets.y += y;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'offset',\n  enabled: true,\n  phase: 'main',\n  requires: ['popperOffsets'],\n  fn: offset\n};","import computeOffsets from \"../utils/computeOffsets.js\";\n\nfunction popperOffsets(_ref) {\n  var state = _ref.state,\n      name = _ref.name;\n  // Offsets are the actual position the popper needs to have to be\n  // properly positioned near its reference element\n  // This is the most basic placement, and will be adjusted by\n  // the modifiers in the next step\n  state.modifiersData[name] = computeOffsets({\n    reference: state.rects.reference,\n    element: state.rects.popper,\n    strategy: 'absolute',\n    placement: state.placement\n  });\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'popperOffsets',\n  enabled: true,\n  phase: 'read',\n  fn: popperOffsets,\n  data: {}\n};","import { top, left, right, bottom, start } from \"../enums.js\";\nimport getBasePlacement from \"../utils/getBasePlacement.js\";\nimport getMainAxisFromPlacement from \"../utils/getMainAxisFromPlacement.js\";\nimport getAltAxis from \"../utils/getAltAxis.js\";\nimport within from \"../utils/within.js\";\nimport getLayoutRect from \"../dom-utils/getLayoutRect.js\";\nimport getOffsetParent from \"../dom-utils/getOffsetParent.js\";\nimport detectOverflow from \"../utils/detectOverflow.js\";\nimport getVariation from \"../utils/getVariation.js\";\nimport getFreshSideObject from \"../utils/getFreshSideObject.js\";\n\nfunction preventOverflow(_ref) {\n  var state = _ref.state,\n      options = _ref.options,\n      name = _ref.name;\n  var _options$mainAxis = options.mainAxis,\n      checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis,\n      _options$altAxis = options.altAxis,\n      checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis,\n      boundary = options.boundary,\n      rootBoundary = options.rootBoundary,\n      altBoundary = options.altBoundary,\n      padding = options.padding,\n      _options$tether = options.tether,\n      tether = _options$tether === void 0 ? true : _options$tether,\n      _options$tetherOffset = options.tetherOffset,\n      tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;\n  var overflow = detectOverflow(state, {\n    boundary: boundary,\n    rootBoundary: rootBoundary,\n    padding: padding,\n    altBoundary: altBoundary\n  });\n  var basePlacement = getBasePlacement(state.placement);\n  var variation = getVariation(state.placement);\n  var isBasePlacement = !variation;\n  var mainAxis = getMainAxisFromPlacement(basePlacement);\n  var altAxis = getAltAxis(mainAxis);\n  var popperOffsets = state.modifiersData.popperOffsets;\n  var referenceRect = state.rects.reference;\n  var popperRect = state.rects.popper;\n  var tetherOffsetValue = typeof tetherOffset === 'function' ? tetherOffset(Object.assign(Object.assign({}, state.rects), {}, {\n    placement: state.placement\n  })) : tetherOffset;\n  var data = {\n    x: 0,\n    y: 0\n  };\n\n  if (!popperOffsets) {\n    return;\n  }\n\n  if (checkMainAxis) {\n    var mainSide = mainAxis === 'y' ? top : left;\n    var altSide = mainAxis === 'y' ? bottom : right;\n    var len = mainAxis === 'y' ? 'height' : 'width';\n    var offset = popperOffsets[mainAxis];\n    var min = popperOffsets[mainAxis] + overflow[mainSide];\n    var max = popperOffsets[mainAxis] - overflow[altSide];\n    var additive = tether ? -popperRect[len] / 2 : 0;\n    var minLen = variation === start ? referenceRect[len] : popperRect[len];\n    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len]; // We need to include the arrow in the calculation so the arrow doesn't go\n    // outside the reference bounds\n\n    var arrowElement = state.elements.arrow;\n    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {\n      width: 0,\n      height: 0\n    };\n    var arrowPaddingObject = state.modifiersData['arrow#persistent'] ? state.modifiersData['arrow#persistent'].padding : getFreshSideObject();\n    var arrowPaddingMin = arrowPaddingObject[mainSide];\n    var arrowPaddingMax = arrowPaddingObject[altSide]; // If the reference length is smaller than the arrow length, we don't want\n    // to include its full size in the calculation. If the reference is small\n    // and near the edge of a boundary, the popper can overflow even if the\n    // reference is not overflowing as well (e.g. virtual elements with no\n    // width or height)\n\n    var arrowLen = within(0, referenceRect[len], arrowRect[len]);\n    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - tetherOffsetValue : minLen - arrowLen - arrowPaddingMin - tetherOffsetValue;\n    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + tetherOffsetValue : maxLen + arrowLen + arrowPaddingMax + tetherOffsetValue;\n    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);\n    var clientOffset = arrowOffsetParent ? mainAxis === 'y' ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;\n    var offsetModifierValue = state.modifiersData.offset ? state.modifiersData.offset[state.placement][mainAxis] : 0;\n    var tetherMin = popperOffsets[mainAxis] + minOffset - offsetModifierValue - clientOffset;\n    var tetherMax = popperOffsets[mainAxis] + maxOffset - offsetModifierValue;\n    var preventedOffset = within(tether ? Math.min(min, tetherMin) : min, offset, tether ? Math.max(max, tetherMax) : max);\n    popperOffsets[mainAxis] = preventedOffset;\n    data[mainAxis] = preventedOffset - offset;\n  }\n\n  if (checkAltAxis) {\n    var _mainSide = mainAxis === 'x' ? top : left;\n\n    var _altSide = mainAxis === 'x' ? bottom : right;\n\n    var _offset = popperOffsets[altAxis];\n\n    var _min = _offset + overflow[_mainSide];\n\n    var _max = _offset - overflow[_altSide];\n\n    var _preventedOffset = within(_min, _offset, _max);\n\n    popperOffsets[altAxis] = _preventedOffset;\n    data[altAxis] = _preventedOffset - _offset;\n  }\n\n  state.modifiersData[name] = data;\n} // eslint-disable-next-line import/no-unused-modules\n\n\nexport default {\n  name: 'preventOverflow',\n  enabled: true,\n  phase: 'main',\n  fn: preventOverflow,\n  requiresIfExists: ['offset']\n};","import { popperGenerator } from \"./index.js\";\nimport eventListeners from \"./modifiers/eventListeners.js\";\nimport popperOffsets from \"./modifiers/popperOffsets.js\";\nimport computeStyles from \"./modifiers/computeStyles.js\";\nimport applyStyles from \"./modifiers/applyStyles.js\";\nimport offset from \"./modifiers/offset.js\";\nimport flip from \"./modifiers/flip.js\";\nimport preventOverflow from \"./modifiers/preventOverflow.js\";\nimport arrow from \"./modifiers/arrow.js\";\nimport hide from \"./modifiers/hide.js\";\nimport detectOverflow from \"./utils/detectOverflow.js\";\nvar defaultModifiers = [eventListeners, popperOffsets, computeStyles, applyStyles, offset, flip, preventOverflow, arrow, hide];\nvar createPopper = /*#__PURE__*/popperGenerator({\n  defaultModifiers: defaultModifiers\n}); // eslint-disable-next-line import/no-unused-modules\n\nexport { createPopper, popperGenerator, defaultModifiers, detectOverflow };","import getVariation from \"./getVariation.js\";\nimport { variationPlacements, basePlacements, placements as allPlacements } from \"../enums.js\";\nimport detectOverflow from \"./detectOverflow.js\";\nimport getBasePlacement from \"./getBasePlacement.js\";\n\n/*:: type OverflowsMap = { [ComputedPlacement]: number }; */\n\n/*;; type OverflowsMap = { [key in ComputedPlacement]: number }; */\nexport default function computeAutoPlacement(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      placement = _options.placement,\n      boundary = _options.boundary,\n      rootBoundary = _options.rootBoundary,\n      padding = _options.padding,\n      flipVariations = _options.flipVariations,\n      _options$allowedAutoP = _options.allowedAutoPlacements,\n      allowedAutoPlacements = _options$allowedAutoP === void 0 ? allPlacements : _options$allowedAutoP;\n  var variation = getVariation(placement);\n  var placements = (variation ? flipVariations ? variationPlacements : variationPlacements.filter(function (placement) {\n    return getVariation(placement) === variation;\n  }) : basePlacements).filter(function (placement) {\n    return allowedAutoPlacements.indexOf(placement) >= 0;\n  }); // $FlowFixMe: Flow seems to have problems with two array unions...\n\n  var overflows = placements.reduce(function (acc, placement) {\n    acc[placement] = detectOverflow(state, {\n      placement: placement,\n      boundary: boundary,\n      rootBoundary: rootBoundary,\n      padding: padding\n    })[getBasePlacement(placement)];\n    return acc;\n  }, {});\n  return Object.keys(overflows).sort(function (a, b) {\n    return overflows[a] - overflows[b];\n  });\n}","import getBasePlacement from \"./getBasePlacement.js\";\nimport getVariation from \"./getVariation.js\";\nimport getMainAxisFromPlacement from \"./getMainAxisFromPlacement.js\";\nimport { top, right, bottom, left, start, end } from \"../enums.js\";\nexport default function computeOffsets(_ref) {\n  var reference = _ref.reference,\n      element = _ref.element,\n      placement = _ref.placement;\n  var basePlacement = placement ? getBasePlacement(placement) : null;\n  var variation = placement ? getVariation(placement) : null;\n  var commonX = reference.x + reference.width / 2 - element.width / 2;\n  var commonY = reference.y + reference.height / 2 - element.height / 2;\n  var offsets;\n\n  switch (basePlacement) {\n    case top:\n      offsets = {\n        x: commonX,\n        y: reference.y - element.height\n      };\n      break;\n\n    case bottom:\n      offsets = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n\n    case right:\n      offsets = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n\n    case left:\n      offsets = {\n        x: reference.x - element.width,\n        y: commonY\n      };\n      break;\n\n    default:\n      offsets = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n\n  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;\n\n  if (mainAxis != null) {\n    var len = mainAxis === 'y' ? 'height' : 'width';\n\n    switch (variation) {\n      case start:\n        offsets[mainAxis] = Math.floor(offsets[mainAxis]) - Math.floor(reference[len] / 2 - element[len] / 2);\n        break;\n\n      case end:\n        offsets[mainAxis] = Math.floor(offsets[mainAxis]) + Math.ceil(reference[len] / 2 - element[len] / 2);\n        break;\n\n      default:\n    }\n  }\n\n  return offsets;\n}","export default function debounce(fn) {\n  var pending;\n  return function () {\n    if (!pending) {\n      pending = new Promise(function (resolve) {\n        Promise.resolve().then(function () {\n          pending = undefined;\n          resolve(fn());\n        });\n      });\n    }\n\n    return pending;\n  };\n}","import getBoundingClientRect from \"../dom-utils/getBoundingClientRect.js\";\nimport getClippingRect from \"../dom-utils/getClippingRect.js\";\nimport getDocumentElement from \"../dom-utils/getDocumentElement.js\";\nimport computeOffsets from \"./computeOffsets.js\";\nimport rectToClientRect from \"./rectToClientRect.js\";\nimport { clippingParents, reference, popper, bottom, top, right, basePlacements, viewport } from \"../enums.js\";\nimport { isElement } from \"../dom-utils/instanceOf.js\";\nimport mergePaddingObject from \"./mergePaddingObject.js\";\nimport expandToHashMap from \"./expandToHashMap.js\"; // eslint-disable-next-line import/no-unused-modules\n\nexport default function detectOverflow(state, options) {\n  if (options === void 0) {\n    options = {};\n  }\n\n  var _options = options,\n      _options$placement = _options.placement,\n      placement = _options$placement === void 0 ? state.placement : _options$placement,\n      _options$boundary = _options.boundary,\n      boundary = _options$boundary === void 0 ? clippingParents : _options$boundary,\n      _options$rootBoundary = _options.rootBoundary,\n      rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary,\n      _options$elementConte = _options.elementContext,\n      elementContext = _options$elementConte === void 0 ? popper : _options$elementConte,\n      _options$altBoundary = _options.altBoundary,\n      altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary,\n      _options$padding = _options.padding,\n      padding = _options$padding === void 0 ? 0 : _options$padding;\n  var paddingObject = mergePaddingObject(typeof padding !== 'number' ? padding : expandToHashMap(padding, basePlacements));\n  var altContext = elementContext === popper ? reference : popper;\n  var referenceElement = state.elements.reference;\n  var popperRect = state.rects.popper;\n  var element = state.elements[altBoundary ? altContext : elementContext];\n  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);\n  var referenceClientRect = getBoundingClientRect(referenceElement);\n  var popperOffsets = computeOffsets({\n    reference: referenceClientRect,\n    element: popperRect,\n    strategy: 'absolute',\n    placement: placement\n  });\n  var popperClientRect = rectToClientRect(Object.assign(Object.assign({}, popperRect), popperOffsets));\n  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect; // positive = overflowing the clipping rect\n  // 0 or negative = within the clipping rect\n\n  var overflowOffsets = {\n    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,\n    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,\n    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,\n    right: elementClientRect.right - clippingClientRect.right + paddingObject.right\n  };\n  var offsetData = state.modifiersData.offset; // Offsets can be applied only to the popper element\n\n  if (elementContext === popper && offsetData) {\n    var offset = offsetData[placement];\n    Object.keys(overflowOffsets).forEach(function (key) {\n      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;\n      var axis = [top, bottom].indexOf(key) >= 0 ? 'y' : 'x';\n      overflowOffsets[key] += offset[axis] * multiply;\n    });\n  }\n\n  return overflowOffsets;\n}","export default function expandToHashMap(value, keys) {\n  return keys.reduce(function (hashMap, key) {\n    hashMap[key] = value;\n    return hashMap;\n  }, {});\n}","export default function format(str) {\n  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    args[_key - 1] = arguments[_key];\n  }\n\n  return [].concat(args).reduce(function (p, c) {\n    return p.replace(/%s/, c);\n  }, str);\n}","export default function getAltAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}","import { auto } from \"../enums.js\";\nexport default function getBasePlacement(placement) {\n  return placement.split('-')[0];\n}","export default function getFreshSideObject() {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0\n  };\n}","export default function getMainAxisFromPlacement(placement) {\n  return ['top', 'bottom'].indexOf(placement) >= 0 ? 'x' : 'y';\n}","var hash = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nexport default function getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, function (matched) {\n    return hash[matched];\n  });\n}","var hash = {\n  start: 'end',\n  end: 'start'\n};\nexport default function getOppositeVariationPlacement(placement) {\n  return placement.replace(/start|end/g, function (matched) {\n    return hash[matched];\n  });\n}","export default function getVariation(placement) {\n  return placement.split('-')[1];\n}","export default function mergeByName(modifiers) {\n  var merged = modifiers.reduce(function (merged, current) {\n    var existing = merged[current.name];\n    merged[current.name] = existing ? Object.assign(Object.assign(Object.assign({}, existing), current), {}, {\n      options: Object.assign(Object.assign({}, existing.options), current.options),\n      data: Object.assign(Object.assign({}, existing.data), current.data)\n    }) : current;\n    return merged;\n  }, {}); // IE11 does not support Object.values\n\n  return Object.keys(merged).map(function (key) {\n    return merged[key];\n  });\n}","import getFreshSideObject from \"./getFreshSideObject.js\";\nexport default function mergePaddingObject(paddingObject) {\n  return Object.assign(Object.assign({}, getFreshSideObject()), paddingObject);\n}","import { modifierPhases } from \"../enums.js\"; // source: https://stackoverflow.com/questions/49875255\n\nfunction order(modifiers) {\n  var map = new Map();\n  var visited = new Set();\n  var result = [];\n  modifiers.forEach(function (modifier) {\n    map.set(modifier.name, modifier);\n  }); // On visiting object, check for its dependencies and visit them recursively\n\n  function sort(modifier) {\n    visited.add(modifier.name);\n    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);\n    requires.forEach(function (dep) {\n      if (!visited.has(dep)) {\n        var depModifier = map.get(dep);\n\n        if (depModifier) {\n          sort(depModifier);\n        }\n      }\n    });\n    result.push(modifier);\n  }\n\n  modifiers.forEach(function (modifier) {\n    if (!visited.has(modifier.name)) {\n      // check for visited object\n      sort(modifier);\n    }\n  });\n  return result;\n}\n\nexport default function orderModifiers(modifiers) {\n  // order based on dependencies\n  var orderedModifiers = order(modifiers); // order based on phase\n\n  return modifierPhases.reduce(function (acc, phase) {\n    return acc.concat(orderedModifiers.filter(function (modifier) {\n      return modifier.phase === phase;\n    }));\n  }, []);\n}","export default function rectToClientRect(rect) {\n  return Object.assign(Object.assign({}, rect), {}, {\n    left: rect.x,\n    top: rect.y,\n    right: rect.x + rect.width,\n    bottom: rect.y + rect.height\n  });\n}","export default function uniqueBy(arr, fn) {\n  var identifiers = new Set();\n  return arr.filter(function (item) {\n    var identifier = fn(item);\n\n    if (!identifiers.has(identifier)) {\n      identifiers.add(identifier);\n      return true;\n    }\n  });\n}","import format from \"./format.js\";\nimport { modifierPhases } from \"../enums.js\";\nvar INVALID_MODIFIER_ERROR = 'Popper: modifier \"%s\" provided an invalid %s property, expected %s but got %s';\nvar MISSING_DEPENDENCY_ERROR = 'Popper: modifier \"%s\" requires \"%s\", but \"%s\" modifier is not available';\nvar VALID_PROPERTIES = ['name', 'enabled', 'phase', 'fn', 'effect', 'requires', 'options'];\nexport default function validateModifiers(modifiers) {\n  modifiers.forEach(function (modifier) {\n    Object.keys(modifier).forEach(function (key) {\n      switch (key) {\n        case 'name':\n          if (typeof modifier.name !== 'string') {\n            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '\"name\"', '\"string\"', \"\\\"\" + String(modifier.name) + \"\\\"\"));\n          }\n\n          break;\n\n        case 'enabled':\n          if (typeof modifier.enabled !== 'boolean') {\n            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '\"enabled\"', '\"boolean\"', \"\\\"\" + String(modifier.enabled) + \"\\\"\"));\n          }\n\n        case 'phase':\n          if (modifierPhases.indexOf(modifier.phase) < 0) {\n            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '\"phase\"', \"either \" + modifierPhases.join(', '), \"\\\"\" + String(modifier.phase) + \"\\\"\"));\n          }\n\n          break;\n\n        case 'fn':\n          if (typeof modifier.fn !== 'function') {\n            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '\"fn\"', '\"function\"', \"\\\"\" + String(modifier.fn) + \"\\\"\"));\n          }\n\n          break;\n\n        case 'effect':\n          if (typeof modifier.effect !== 'function') {\n            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '\"effect\"', '\"function\"', \"\\\"\" + String(modifier.fn) + \"\\\"\"));\n          }\n\n          break;\n\n        case 'requires':\n          if (!Array.isArray(modifier.requires)) {\n            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '\"requires\"', '\"array\"', \"\\\"\" + String(modifier.requires) + \"\\\"\"));\n          }\n\n          break;\n\n        case 'requiresIfExists':\n          if (!Array.isArray(modifier.requiresIfExists)) {\n            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '\"requiresIfExists\"', '\"array\"', \"\\\"\" + String(modifier.requiresIfExists) + \"\\\"\"));\n          }\n\n          break;\n\n        case 'options':\n        case 'data':\n          break;\n\n        default:\n          console.error(\"PopperJS: an invalid property has been provided to the \\\"\" + modifier.name + \"\\\" modifier, valid properties are \" + VALID_PROPERTIES.map(function (s) {\n            return \"\\\"\" + s + \"\\\"\";\n          }).join(', ') + \"; but \\\"\" + key + \"\\\" was provided.\");\n      }\n\n      modifier.requires && modifier.requires.forEach(function (requirement) {\n        if (modifiers.find(function (mod) {\n          return mod.name === requirement;\n        }) == null) {\n          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));\n        }\n      });\n    });\n  });\n}","export default function within(min, value, max) {\n  return Math.max(min, Math.min(value, max));\n}","import { createMemo, createRoot, createEffect, onCleanup, splitProps, suspend, untrack } from '../index.js';\nexport { ErrorBoundary, For, Index, Match, Show, Suspense, SuspenseList, Switch, assignProps, createComponent, getContextOwner as currentContext, createEffect as effect } from '../index.js';\n\nconst Types = {\n  ATTRIBUTE: \"attribute\",\n  PROPERTY: \"property\"\n},\n      Attributes = {\n  href: {\n    type: Types.ATTRIBUTE\n  },\n  style: {\n    type: Types.PROPERTY,\n    alias: \"style.cssText\"\n  },\n  for: {\n    type: Types.PROPERTY,\n    alias: \"htmlFor\"\n  },\n  class: {\n    type: Types.PROPERTY,\n    alias: \"className\"\n  },\n  role: {\n    type: Types.ATTRIBUTE\n  },\n  spellCheck: {\n    type: Types.PROPERTY,\n    alias: \"spellcheck\"\n  },\n  allowFullScreen: {\n    type: Types.PROPERTY,\n    alias: \"allowFullscreen\"\n  },\n  autoCapitalize: {\n    type: Types.PROPERTY,\n    alias: \"autocapitalize\"\n  },\n  autoFocus: {\n    type: Types.PROPERTY,\n    alias: \"autofocus\"\n  },\n  autoPlay: {\n    type: Types.PROPERTY,\n    alias: \"autoplay\"\n  }\n},\n      SVGAttributes = {\n  innerHTML: {\n    type: Types.PROPERTY\n  },\n  textContent: {\n    type: Types.PROPERTY\n  },\n  innerText: {\n    type: Types.PROPERTY\n  },\n  className: {\n    type: Types.ATTRIBUTE,\n    alias: \"class\"\n  },\n  htmlFor: {\n    type: Types.ATTRIBUTE,\n    alias: \"for\"\n  },\n  tabIndex: {\n    type: Types.ATTRIBUTE,\n    alias: \"tabindex\"\n  },\n  allowReorder: {\n    type: Types.ATTRIBUTE\n  },\n  attributeName: {\n    type: Types.ATTRIBUTE\n  },\n  attributeType: {\n    type: Types.ATTRIBUTE\n  },\n  autoReverse: {\n    type: Types.ATTRIBUTE\n  },\n  baseFrequency: {\n    type: Types.ATTRIBUTE\n  },\n  calcMode: {\n    type: Types.ATTRIBUTE\n  },\n  clipPathUnits: {\n    type: Types.ATTRIBUTE\n  },\n  contentScriptType: {\n    type: Types.ATTRIBUTE\n  },\n  contentStyleType: {\n    type: Types.ATTRIBUTE\n  },\n  diffuseConstant: {\n    type: Types.ATTRIBUTE\n  },\n  edgeMode: {\n    type: Types.ATTRIBUTE\n  },\n  externalResourcesRequired: {\n    type: Types.ATTRIBUTE\n  },\n  filterRes: {\n    type: Types.ATTRIBUTE\n  },\n  filterUnits: {\n    type: Types.ATTRIBUTE\n  },\n  gradientTransform: {\n    type: Types.ATTRIBUTE\n  },\n  gradientUnits: {\n    type: Types.ATTRIBUTE\n  },\n  kernelMatrix: {\n    type: Types.ATTRIBUTE\n  },\n  kernelUnitLength: {\n    type: Types.ATTRIBUTE\n  },\n  keyPoints: {\n    type: Types.ATTRIBUTE\n  },\n  keySplines: {\n    type: Types.ATTRIBUTE\n  },\n  keyTimes: {\n    type: Types.ATTRIBUTE\n  },\n  lengthAdjust: {\n    type: Types.ATTRIBUTE\n  },\n  limitingConeAngle: {\n    type: Types.ATTRIBUTE\n  },\n  markerHeight: {\n    type: Types.ATTRIBUTE\n  },\n  markerUnits: {\n    type: Types.ATTRIBUTE\n  },\n  maskContentUnits: {\n    type: Types.ATTRIBUTE\n  },\n  maskUnits: {\n    type: Types.ATTRIBUTE\n  },\n  numOctaves: {\n    type: Types.ATTRIBUTE\n  },\n  pathLength: {\n    type: Types.ATTRIBUTE\n  },\n  patternContentUnits: {\n    type: Types.ATTRIBUTE\n  },\n  patternTransform: {\n    type: Types.ATTRIBUTE\n  },\n  patternUnits: {\n    type: Types.ATTRIBUTE\n  },\n  pointsAtX: {\n    type: Types.ATTRIBUTE\n  },\n  pointsAtY: {\n    type: Types.ATTRIBUTE\n  },\n  pointsAtZ: {\n    type: Types.ATTRIBUTE\n  },\n  preserveAlpha: {\n    type: Types.ATTRIBUTE\n  },\n  preserveAspectRatio: {\n    type: Types.ATTRIBUTE\n  },\n  primitiveUnits: {\n    type: Types.ATTRIBUTE\n  },\n  refX: {\n    type: Types.ATTRIBUTE\n  },\n  refY: {\n    type: Types.ATTRIBUTE\n  },\n  repeatCount: {\n    type: Types.ATTRIBUTE\n  },\n  repeatDur: {\n    type: Types.ATTRIBUTE\n  },\n  requiredExtensions: {\n    type: Types.ATTRIBUTE\n  },\n  requiredFeatures: {\n    type: Types.ATTRIBUTE\n  },\n  specularConstant: {\n    type: Types.ATTRIBUTE\n  },\n  specularExponent: {\n    type: Types.ATTRIBUTE\n  },\n  spreadMethod: {\n    type: Types.ATTRIBUTE\n  },\n  startOffset: {\n    type: Types.ATTRIBUTE\n  },\n  stdDeviation: {\n    type: Types.ATTRIBUTE\n  },\n  stitchTiles: {\n    type: Types.ATTRIBUTE\n  },\n  surfaceScale: {\n    type: Types.ATTRIBUTE\n  },\n  systemLanguage: {\n    type: Types.ATTRIBUTE\n  },\n  tableValues: {\n    type: Types.ATTRIBUTE\n  },\n  targetX: {\n    type: Types.ATTRIBUTE\n  },\n  targetY: {\n    type: Types.ATTRIBUTE\n  },\n  textLength: {\n    type: Types.ATTRIBUTE\n  },\n  viewBox: {\n    type: Types.ATTRIBUTE\n  },\n  viewTarget: {\n    type: Types.ATTRIBUTE\n  },\n  xChannelSelector: {\n    type: Types.ATTRIBUTE\n  },\n  yChannelSelector: {\n    type: Types.ATTRIBUTE\n  },\n  zoomAndPan: {\n    type: Types.ATTRIBUTE\n  }\n};\nconst NonComposedEvents = new Set([\"abort\", \"animationstart\", \"animationend\", \"animationiteration\", \"blur\", \"change\", \"copy\", \"cut\", \"error\", \"focus\", \"gotpointercapture\", \"load\", \"loadend\", \"loadstart\", \"lostpointercapture\", \"mouseenter\", \"mouseleave\", \"paste\", \"progress\", \"reset\", \"scroll\", \"select\", \"submit\", \"transitionstart\", \"transitioncancel\", \"transitionend\", \"transitionrun\"]);\nconst SVGNamespace = {\n  xlink: \"http://www.w3.org/1999/xlink\",\n  xml: \"http://www.w3.org/XML/1998/namespace\"\n};\n\nfunction memo(fn, equal) {\n  return createMemo(fn, undefined, equal);\n}\n\nfunction reconcileArrays(parentNode, a, b) {\n  let bLength = b.length,\n      aEnd = a.length,\n      bEnd = bLength,\n      aStart = 0,\n      bStart = 0,\n      after = a[aEnd - 1].nextSibling,\n      map = null;\n  while (aStart < aEnd || bStart < bEnd) {\n    if (aEnd === aStart) {\n      const node = bEnd < bLength ? bStart ? b[bStart - 1].nextSibling : b[bEnd - bStart] : after;\n      while (bStart < bEnd) parentNode.insertBefore(b[bStart++], node);\n    } else if (bEnd === bStart) {\n      while (aStart < aEnd) {\n        if (!map || !map.has(a[aStart])) parentNode.removeChild(a[aStart]);\n        aStart++;\n      }\n    } else if (a[aStart] === b[bStart]) {\n      aStart++;\n      bStart++;\n    } else if (a[aEnd - 1] === b[bEnd - 1]) {\n      aEnd--;\n      bEnd--;\n    } else if (aEnd - aStart === 1 && bEnd - bStart === 1) {\n      if (map && map.has(a[aStart]) || a[aStart].parentNode !== parentNode) {\n        parentNode.insertBefore(b[bStart], bEnd < bLength ? b[bEnd] : after);\n      } else parentNode.replaceChild(b[bStart], a[aStart]);\n      break;\n    } else if (a[aStart] === b[bEnd - 1] && b[bStart] === a[aEnd - 1]) {\n      const node = a[--aEnd].nextSibling;\n      parentNode.insertBefore(b[bStart++], a[aStart++].nextSibling);\n      parentNode.insertBefore(b[--bEnd], node);\n      a[aEnd] = b[bEnd];\n    } else {\n      if (!map) {\n        map = new Map();\n        let i = bStart;\n        while (i < bEnd) map.set(b[i], i++);\n      }\n      if (map.has(a[aStart])) {\n        const index = map.get(a[aStart]);\n        if (bStart < index && index < bEnd) {\n          let i = aStart,\n              sequence = 1;\n          while (++i < aEnd && i < bEnd) {\n            if (!map.has(a[i]) || map.get(a[i]) !== index + sequence) break;\n            sequence++;\n          }\n          if (sequence > index - bStart) {\n            const node = a[aStart];\n            while (bStart < index) parentNode.insertBefore(b[bStart++], node);\n          } else parentNode.replaceChild(b[bStart++], a[aStart++]);\n        } else aStart++;\n      } else parentNode.removeChild(a[aStart++]);\n    }\n  }\n}\n\nconst eventRegistry = new Set(),\n      hydration = globalThis._$HYDRATION || (globalThis._$HYDRATION = {});\nfunction render(code, element) {\n  let disposer;\n  createRoot(dispose => {\n    disposer = dispose;\n    insert(element, code(), element.firstChild ? null : undefined);\n  });\n  return disposer;\n}\nfunction hydrate(code, element) {\n  hydration.context = {\n    id: \"0\",\n    count: 0,\n    registry: {}\n  };\n  const templates = element.querySelectorAll(`*[_hk]`);\n  Array.prototype.reduce.call(templates, (memo, node) => {\n    const id = node.getAttribute(\"_hk\"),\n          list = memo[id] || (memo[id] = []);\n    list.push(node);\n    return memo;\n  }, hydration.context.registry);\n  const dispose = render(code, element);\n  delete hydration.context;\n  return dispose;\n}\nfunction template(html, check, isSVG) {\n  const t = document.createElement(\"template\");\n  t.innerHTML = html;\n  if (check && t.innerHTML.split(\"<\").length - 1 !== check) throw `Template html does not match input:\\n${t.innerHTML}\\n\\n${html}`;\n  let node = t.content.firstChild;\n  if (isSVG) node = node.firstChild;\n  return node;\n}\nfunction delegateEvents(eventNames) {\n  for (let i = 0, l = eventNames.length; i < l; i++) {\n    const name = eventNames[i];\n    if (!eventRegistry.has(name)) {\n      eventRegistry.add(name);\n      document.addEventListener(name, eventHandler);\n    }\n  }\n}\nfunction clearDelegatedEvents() {\n  for (let name of eventRegistry.keys()) document.removeEventListener(name, eventHandler);\n  eventRegistry.clear();\n}\nfunction setAttribute(node, name, value) {\n  if (value === false || value == null) node.removeAttribute(name);else node.setAttribute(name, value);\n}\nfunction setAttributeNS(node, namespace, name, value) {\n  if (value === false || value == null) node.removeAttributeNS(namespace, name);else node.setAttributeNS(namespace, name, value);\n}\nfunction classList(node, value, prev) {\n  const classKeys = Object.keys(value);\n  for (let i = 0, len = classKeys.length; i < len; i++) {\n    const key = classKeys[i],\n          classValue = !!value[key],\n          classNames = key.split(/\\s+/);\n    if (!key || prev && prev[key] === classValue) continue;\n    for (let j = 0, nameLen = classNames.length; j < nameLen; j++) node.classList.toggle(classNames[j], classValue);\n  }\n  return value;\n}\nfunction style(node, value, prev) {\n  const nodeStyle = node.style;\n  if (typeof value === \"string\") return nodeStyle.cssText = value;\n  let v, s;\n  if (prev != null && typeof prev !== \"string\") {\n    for (s in value) {\n      v = value[s];\n      v !== prev[s] && nodeStyle.setProperty(s, v);\n    }\n    for (s in prev) {\n      value[s] == null && nodeStyle.removeProperty(s);\n    }\n  } else {\n    for (s in value) nodeStyle.setProperty(s, value[s]);\n  }\n  return value;\n}\nfunction spread(node, accessor, isSVG, skipChildren) {\n  if (typeof accessor === \"function\") {\n    createEffect(current => spreadExpression(node, accessor(), current, isSVG, skipChildren));\n  } else spreadExpression(node, accessor, undefined, isSVG, skipChildren);\n}\nfunction insert(parent, accessor, marker, initial) {\n  if (marker !== undefined && !initial) initial = [];\n  if (typeof accessor !== \"function\") return insertExpression(parent, accessor, initial, marker);\n  createEffect(current => insertExpression(parent, accessor(), current, marker), initial);\n}\nfunction assign(node, props, isSVG, skipChildren, prevProps = {}) {\n  let info;\n  for (const prop in props) {\n    if (prop === \"children\") {\n      if (!skipChildren) insertExpression(node, props.children);\n      continue;\n    }\n    const value = props[prop];\n    if (value === prevProps[prop]) continue;\n    if (prop === \"style\") {\n      style(node, value, prevProps[prop]);\n    } else if (prop === \"classList\") {\n      classList(node, value, prevProps[prop]);\n    } else if (prop === \"ref\") {\n      value(node);\n    } else if (prop === \"on\") {\n      for (const eventName in value) node.addEventListener(eventName, value[eventName]);\n    } else if (prop === \"onCapture\") {\n      for (const eventName in value) node.addEventListener(eventName, value[eventName], true);\n    } else if (prop.slice(0, 2) === \"on\") {\n      const lc = prop.toLowerCase();\n      if (!NonComposedEvents.has(lc.slice(2))) {\n        const name = lc.slice(2);\n        if (Array.isArray(value)) {\n          node[`__${name}`] = value[0];\n          node[`__${name}Data`] = value[1];\n        } else node[`__${name}`] = value;\n        delegateEvents([name]);\n      } else node[lc] = value;\n    } else if (!isSVG && (info = Attributes[prop])) {\n      if (info.type === \"attribute\") {\n        setAttribute(node, prop, value);\n      } else node[info.alias] = value;\n    } else if (isSVG || prop.indexOf(\"-\") > -1 || prop.indexOf(\":\") > -1) {\n      const ns = prop.indexOf(\":\") > -1 && SVGNamespace[prop.split(\":\")[0]];\n      if (ns) setAttributeNS(node, ns, prop, value);else if (info = SVGAttributes[prop]) {\n        if (info.alias) setAttribute(node, info.alias, value);else setAttribute(node, prop, value);\n      } else setAttribute(node, prop.replace(/([A-Z])/g, g => `-${g[0].toLowerCase()}`), value);\n    } else node[prop] = value;\n    prevProps[prop] = value;\n  }\n}\nfunction dynamicProperty(props, key) {\n  const src = props[key];\n  Object.defineProperty(props, key, {\n    get() {\n      return src();\n    },\n    enumerable: true\n  });\n  return props;\n}\nfunction ssrClassList(value) {\n  let classKeys = Object.keys(value),\n      result = \"\";\n  for (let i = 0, len = classKeys.length; i < len; i++) {\n    const key = classKeys[i],\n          classValue = !!value[key];\n    if (!key || !classValue) continue;\n    i && (result += \" \");\n    result += key;\n  }\n  return result;\n}\nfunction ssrStyle(value) {\n  if (typeof value === \"string\") return value;\n  let result = \"\";\n  const k = Object.keys(value);\n  for (let i = 0; i < k.length; i++) {\n    const s = k[i];\n    if (i) result += \";\";\n    result += `${s}:${escape(value[s], true)}`;\n  }\n  return result;\n}\nfunction ssrSpread(props, isSVG) {\n  return () => {\n    if (typeof props === \"function\") props = props();\n    const keys = Object.keys(props);\n    let result = \"\";\n    for (let i = 0; i < keys.length; i++) {\n      const prop = keys[i];\n      if (prop === \"children\") {\n        console.warn(`SSR currently does not support spread children.`);\n        continue;\n      }\n      const value = props[prop];\n      if (prop === \"style\") {\n        result += `style=\"${ssrStyle(value)}\"`;\n      } else if (prop === \"classList\") {\n        result += `class=\"${ssrClassList(value)}\"`;\n      } else {\n        const key = toSSRAttribute(prop, isSVG);\n        result += `${key}=\"${escape(value, true)}\"`;\n      }\n      if (i !== keys.length - 1) result += \" \";\n    }\n    return result;\n  };\n}\nconst ATTR_REGEX = /[&<\"]/,\n      CONTENT_REGEX = /[&<]/;\nfunction escape(html, attr) {\n  if (typeof html !== \"string\") return html;\n  const match = (attr ? ATTR_REGEX : CONTENT_REGEX).exec(html);\n  if (!match) return html;\n  let index = 0;\n  let lastIndex = 0;\n  let out = \"\";\n  let escape = \"\";\n  for (index = match.index; index < html.length; index++) {\n    switch (html.charCodeAt(index)) {\n      case 34:\n        if (!attr) continue;\n        escape = \"&quot;\";\n        break;\n      case 38:\n        escape = \"&amp;\";\n        break;\n      case 60:\n        escape = \"&lt;\";\n        break;\n      default:\n        continue;\n    }\n    if (lastIndex !== index) out += html.substring(lastIndex, index);\n    lastIndex = index + 1;\n    out += escape;\n  }\n  return lastIndex !== index ? out + html.substring(lastIndex, index) : out;\n}\nfunction getNextElement(template, isSSR) {\n  const hydrate = hydration.context;\n  let node, key;\n  if (!hydrate || !hydrate.registry || !((key = getHydrationKey()) && hydrate.registry[key] && (node = hydrate.registry[key].shift()))) {\n    const el = template.cloneNode(true);\n    if (isSSR && hydrate) el.setAttribute(\"_hk\", getHydrationKey());\n    return el;\n  }\n  if (hydration && hydration.completed) hydration.completed.add(node);\n  return node;\n}\nfunction getNextMarker(start) {\n  let end = start,\n      count = 0,\n      current = [];\n  if (hydration.context && hydration.context.registry) {\n    while (end) {\n      if (end.nodeType === 8) {\n        const v = end.nodeValue;\n        if (v === \"#\") count++;else if (v === \"/\") {\n          if (count === 0) return [end, current];\n          count--;\n        }\n      }\n      current.push(end);\n      end = end.nextSibling;\n    }\n  }\n  return [end, current];\n}\nfunction runHydrationEvents() {\n  if (hydration && hydration.events) {\n    const {\n      completed,\n      events\n    } = hydration;\n    while (events.length) {\n      const [el, e] = events[0];\n      if (!completed.has(el)) return;\n      eventHandler(e);\n      events.shift();\n    }\n  }\n}\nfunction getHydrationKey() {\n  return hydration.context.id;\n}\nfunction generateHydrationScript({\n  eventNames = [\"click\", \"input\", \"blur\"],\n  streaming,\n  resolved\n} = {}) {\n  let s = `(()=>{_$HYDRATION={events:[],completed:new WeakSet};const t=e=>e&&e.hasAttribute&&(e.hasAttribute(\"_hk\")&&e||t(e.host&&e.host instanceof Node?e.host:e.parentNode)),e=e=>{let o=e.composedPath&&e.composedPath()[0]||e.target,s=t(o);s&&!_$HYDRATION.completed.has(s)&&_$HYDRATION.events.push([s,e])};[\"${eventNames.join('\",\"')}\"].forEach(t=>document.addEventListener(t,e))})();`;\n  if (streaming) {\n    s += `(()=>{const e=_$HYDRATION,r={};let o=0;e.resolveResource=((e,o)=>{const t=r[e];if(!t)return r[e]=o;delete r[e],t(o)}),e.loadResource=(()=>{const e=++o,t=r[e];if(!t){let o,t=new Promise(e=>o=e);return r[e]=o,t}return delete r[e],Promise.resolve(t)})})();`;\n  }\n  if (resolved) s += `_$HYDRATION.resources = JSON.parse('${JSON.stringify(_$HYDRATION.resources || {})}');`;\n  return s;\n}\nfunction eventHandler(e) {\n  const key = `__${e.type}`;\n  let node = e.composedPath && e.composedPath()[0] || e.target;\n  if (e.target !== node) {\n    Object.defineProperty(e, \"target\", {\n      configurable: true,\n      value: node\n    });\n  }\n  Object.defineProperty(e, \"currentTarget\", {\n    configurable: true,\n    get() {\n      return node;\n    }\n  });\n  while (node !== null) {\n    const handler = node[key];\n    if (handler) {\n      const data = node[`${key}Data`];\n      data ? handler(data, e) : handler(e);\n      if (e.cancelBubble) return;\n    }\n    node = node.host && node.host instanceof Node ? node.host : node.parentNode;\n  }\n}\nfunction spreadExpression(node, props, prevProps = {}, isSVG, skipChildren) {\n  if (!skipChildren && \"children\" in props) {\n    createEffect(() => prevProps.children = insertExpression(node, props.children, prevProps.children));\n  }\n  createEffect(() => assign(node, props, isSVG, true, prevProps));\n  return prevProps;\n}\nfunction insertExpression(parent, value, current, marker, unwrapArray) {\n  while (typeof current === \"function\") current = current();\n  if (value === current) return current;\n  const t = typeof value,\n        multi = marker !== undefined;\n  parent = multi && current[0] && current[0].parentNode || parent;\n  if (t === \"string\" || t === \"number\") {\n    if (t === \"number\") value = value.toString();\n    if (multi) {\n      let node = current[0];\n      if (node && node.nodeType === 3) {\n        node.data = value;\n      } else node = document.createTextNode(value);\n      current = cleanChildren(parent, current, marker, node);\n    } else {\n      if (current !== \"\" && typeof current === \"string\") {\n        current = parent.firstChild.data = value;\n      } else current = parent.textContent = value;\n    }\n  } else if (value == null || t === \"boolean\") {\n    if (hydration.context && hydration.context.registry) return current;\n    current = cleanChildren(parent, current, marker);\n  } else if (t === \"function\") {\n    createEffect(() => current = insertExpression(parent, value(), current, marker));\n    return () => current;\n  } else if (Array.isArray(value)) {\n    const array = [];\n    if (normalizeIncomingArray(array, value, unwrapArray)) {\n      createEffect(() => current = insertExpression(parent, array, current, marker, true));\n      return () => current;\n    }\n    if (hydration.context && hydration.context.registry) return array;\n    if (array.length === 0) {\n      current = cleanChildren(parent, current, marker);\n      if (multi) return current;\n    } else {\n      if (Array.isArray(current)) {\n        if (current.length === 0) {\n          appendNodes(parent, array, marker);\n        } else reconcileArrays(parent, current, array);\n      } else if (current == null || current === \"\") {\n        appendNodes(parent, array);\n      } else {\n        reconcileArrays(parent, multi && current || [parent.firstChild], array);\n      }\n    }\n    current = array;\n  } else if (value instanceof Node) {\n    if (Array.isArray(current)) {\n      if (multi) return current = cleanChildren(parent, current, marker, value);\n      cleanChildren(parent, current, null, value);\n    } else if (current == null || current === \"\" || !parent.firstChild) {\n      parent.appendChild(value);\n    } else parent.replaceChild(value, parent.firstChild);\n    current = value;\n  } else console.warn(`Skipped inserting`, value);\n  return current;\n}\nfunction normalizeIncomingArray(normalized, array, unwrap) {\n  let dynamic = false;\n  for (let i = 0, len = array.length; i < len; i++) {\n    let item = array[i],\n        t;\n    if (item instanceof Node) {\n      normalized.push(item);\n    } else if (item == null || item === true || item === false) ; else if (Array.isArray(item)) {\n      dynamic = normalizeIncomingArray(normalized, item) || dynamic;\n    } else if ((t = typeof item) === \"string\") {\n      normalized.push(document.createTextNode(item));\n    } else if (t === \"function\") {\n      if (unwrap) {\n        const idx = item();\n        dynamic = normalizeIncomingArray(normalized, Array.isArray(idx) ? idx : [idx]) || dynamic;\n      } else {\n        normalized.push(item);\n        dynamic = true;\n      }\n    } else normalized.push(document.createTextNode(item.toString()));\n  }\n  return dynamic;\n}\nfunction appendNodes(parent, array, marker) {\n  for (let i = 0, len = array.length; i < len; i++) parent.insertBefore(array[i], marker);\n}\nfunction cleanChildren(parent, current, marker, replacement) {\n  if (marker === undefined) return parent.textContent = \"\";\n  const node = replacement || document.createTextNode(\"\");\n  if (current.length) {\n    let inserted = false;\n    for (let i = current.length - 1; i >= 0; i--) {\n      const el = current[i];\n      if (node !== el) {\n        const isParent = el.parentNode === parent;\n        if (!inserted && !i) isParent ? parent.replaceChild(node, el) : parent.insertBefore(node, marker);else isParent && parent.removeChild(el);\n      } else inserted = true;\n    }\n  } else parent.insertBefore(node, marker);\n  return [node];\n}\nfunction toSSRAttribute(key, isSVG) {\n  if (isSVG) {\n    const attr = SVGAttributes[key];\n    if (attr) {\n      if (attr.alias) key = attr.alias;\n    } else key = key.replace(/([A-Z])/g, g => `-${g[0].toLowerCase()}`);\n  } else {\n    const attr = SVGAttributes[key];\n    if (attr && attr.alias) key = attr.alias;\n    key = key.toLowerCase();\n  }\n  return key;\n}\n\nconst hydration$1 = globalThis._$HYDRATION || (globalThis._$HYDRATION = {});\nfunction renderToString(code, options = {}) {\n  options = {\n    timeoutMs: 30000,\n    ...options\n  };\n  hydration$1.context = {\n    id: \"0\",\n    count: 0\n  };\n  hydration$1.resources = {};\n  hydration$1.asyncSSR = true;\n  return createRoot(() => {\n    const rendered = code();\n    if (typeof rendered === \"object\" && \"then\" in rendered) {\n      const timeout = new Promise((_, reject) => setTimeout(() => reject(\"renderToString timed out\"), options.timeoutMs));\n      return Promise.race([rendered, timeout]).then(resolveSSRNode);\n    }\n    return resolveSSRNode(rendered);\n  });\n}\nfunction renderDOMToString(code, options = {}) {\n  options = {\n    timeoutMs: 30000,\n    ...options\n  };\n  hydration$1.context = {\n    id: \"0\",\n    count: 0\n  };\n  hydration$1.resources = {};\n  hydration$1.asyncSSR = true;\n  const container = document.createElement(\"div\");\n  document.body.appendChild(container);\n  return createRoot(d1 => {\n    const rendered = code();\n    function resolve(rendered) {\n      createRoot(d2 => (insert(container, rendered), d1(), d2()));\n      const html = container.innerHTML;\n      document.body.removeChild(container);\n      return html;\n    }\n    if (typeof rendered === \"object\" && \"then\" in rendered) {\n      const timeout = new Promise((_, reject) => setTimeout(() => reject(\"renderToString timed out\"), options.timeoutMs));\n      return Promise.race([rendered, timeout]).then(resolve);\n    }\n    return resolve(rendered);\n  });\n}\nfunction ssr(t, ...nodes) {\n  if (!nodes.length) return {\n    t\n  };\n  for (let i = 0; i < nodes.length; i++) {\n    const n = nodes[i];\n    if (typeof n === \"function\") nodes[i] = memo(() => resolveSSRNode(n()));\n  }\n  return {\n    t: () => {\n      let result = \"\";\n      for (let i = 0; i < t.length; i++) {\n        result += t[i];\n        const node = nodes[i];\n        if (node !== undefined) result += resolveSSRNode(node);\n      }\n      return result;\n    }\n  };\n}\nfunction resolveSSRNode(node) {\n  if (Array.isArray(node)) return node.map(resolveSSRNode).join(\"\");\n  const t = typeof node;\n  if (node && t === \"object\") return resolveSSRNode(node.t);\n  if (t === \"function\") return resolveSSRNode(node());\n  return t === \"string\" ? node : JSON.stringify(node);\n}\n\nfunction Portal(props) {\n  const {\n    useShadow\n  } = props,\n        marker = document.createTextNode(\"\"),\n        mount = props.mount || document.body;\n  if (mount instanceof HTMLHeadElement) {\n    insert(mount, () => props.children, null);\n  } else {\n    const container = document.createElement(\"div\"),\n          renderRoot = useShadow && container.attachShadow ? container.attachShadow({\n      mode: \"open\"\n    }) : container;\n    Object.defineProperty(container, \"host\", {\n      get() {\n        return marker.parentNode;\n      }\n    });\n    insert(renderRoot, () => props.children);\n    mount.appendChild(container);\n    props.ref && props.ref(container);\n    onCleanup(() => mount.removeChild(container));\n  }\n  return marker;\n}\nfunction Dynamic(props) {\n  const [p, others] = splitProps(props, [\"component\"]);\n  return suspend(() => {\n    const comp = p.component,\n          t = typeof comp;\n    if (comp) {\n      if (t === \"function\") return untrack(() => comp(others));else if (t === \"string\") {\n        const el = document.createElement(comp);\n        spread(el, others);\n        return el;\n      }\n    }\n  });\n}\n\nexport { Dynamic, Portal, assign, classList, clearDelegatedEvents, delegateEvents, dynamicProperty, escape, generateHydrationScript, getHydrationKey, getNextElement, getNextMarker, hydrate, insert, memo, render, renderDOMToString, renderToString, runHydrationEvents, setAttribute, setAttributeNS, spread, ssr, ssrClassList, ssrSpread, ssrStyle, style, template };\n","let taskIdCounter = 1,\n    isCallbackScheduled = false,\n    isPerformingWork = false,\n    taskQueue = [],\n    currentTask = null,\n    shouldYieldToHost = null,\n    yieldInterval = 5,\n    deadline = 0,\n    maxYieldInterval = 300,\n    scheduleCallback = null,\n    scheduledCallback = null;\nconst maxSigned31BitInt = 1073741823;\nfunction setupScheduler() {\n  if (window && window.MessageChannel) {\n    const channel = new MessageChannel(),\n          port = channel.port2;\n    scheduleCallback = () => port.postMessage(null);\n    channel.port1.onmessage = () => {\n      if (scheduledCallback !== null) {\n        const currentTime = performance.now();\n        deadline = currentTime + yieldInterval;\n        const hasTimeRemaining = true;\n        try {\n          const hasMoreWork = scheduledCallback(hasTimeRemaining, currentTime);\n          if (!hasMoreWork) {\n            scheduledCallback = null;\n          } else port.postMessage(null);\n        } catch (error) {\n          port.postMessage(null);\n          throw error;\n        }\n      }\n    };\n  } else {\n    let _callback;\n    scheduleCallback = () => {\n      if (!_callback) {\n        _callback = scheduledCallback;\n        setTimeout(() => {\n          const currentTime = performance.now();\n          deadline = currentTime + yieldInterval;\n          const hasMoreWork = _callback(true, currentTime);\n          _callback = null;\n          if (hasMoreWork) scheduleCallback();\n        }, 0);\n      }\n    };\n  }\n  if (navigator && navigator.scheduling && navigator.scheduling.isInputPending) {\n    const scheduling = navigator.scheduling;\n    shouldYieldToHost = () => {\n      const currentTime = performance.now();\n      if (currentTime >= deadline) {\n        if (scheduling.isInputPending()) {\n          return true;\n        }\n        return currentTime >= maxYieldInterval;\n      } else {\n        return false;\n      }\n    };\n  } else {\n    shouldYieldToHost = () => performance.now() >= deadline;\n  }\n}\nfunction enqueue(taskQueue, task) {\n  function findIndex() {\n    let m = 0;\n    let n = taskQueue.length - 1;\n    while (m <= n) {\n      let k = n + m >> 1;\n      let cmp = task.expirationTime - taskQueue[k].expirationTime;\n      if (cmp > 0) m = k + 1;else if (cmp < 0) n = k - 1;else return k;\n    }\n    return m;\n  }\n  taskQueue.splice(findIndex(), 0, task);\n}\nfunction requestCallback(fn, options) {\n  if (!scheduleCallback) setupScheduler();\n  let startTime = performance.now(),\n      timeout = maxSigned31BitInt;\n  if (options && options.timeout) timeout = options.timeout;\n  const newTask = {\n    id: taskIdCounter++,\n    fn,\n    startTime,\n    expirationTime: startTime + timeout\n  };\n  enqueue(taskQueue, newTask);\n  if (!isCallbackScheduled && !isPerformingWork) {\n    isCallbackScheduled = true;\n    scheduledCallback = flushWork;\n    scheduleCallback();\n  }\n  return newTask;\n}\nfunction cancelCallback(task) {\n  task.fn = null;\n}\nfunction flushWork(hasTimeRemaining, initialTime) {\n  isCallbackScheduled = false;\n  isPerformingWork = true;\n  try {\n    return workLoop(hasTimeRemaining, initialTime);\n  } finally {\n    currentTask = null;\n    isPerformingWork = false;\n  }\n}\nfunction workLoop(hasTimeRemaining, initialTime) {\n  let currentTime = initialTime;\n  currentTask = taskQueue[0] || null;\n  while (currentTask !== null) {\n    if (currentTask.expirationTime > currentTime && (!hasTimeRemaining || shouldYieldToHost())) {\n      break;\n    }\n    const callback = currentTask.fn;\n    if (callback !== null) {\n      currentTask.fn = null;\n      const didUserCallbackTimeout = currentTask.expirationTime <= currentTime;\n      callback(didUserCallbackTimeout);\n      currentTime = performance.now();\n      if (currentTask === taskQueue[0]) {\n        taskQueue.shift();\n      }\n    } else taskQueue.shift();\n    currentTask = taskQueue[0] || null;\n  }\n  return currentTask !== null;\n}\n\nconst equalFn = (a, b) => a === b;\nconst ERROR = Symbol(\"error\");\nconst NOTPENDING = {};\nconst STALE = 1;\nconst PENDING = 2;\nconst UNOWNED = {\n  owned: null,\n  cleanups: null,\n  context: null,\n  owner: null\n};\nlet Owner = null;\nlet Listener = null;\nlet Pending = null;\nlet Updates = null;\nlet Afters = [];\nlet ExecCount = 0;\nfunction createRoot(fn, detachedOwner) {\n  detachedOwner && (Owner = detachedOwner);\n  const listener = Listener,\n        owner = Owner,\n        root = fn.length === 0 ? UNOWNED : {\n    owned: null,\n    cleanups: null,\n    context: null,\n    owner\n  };\n  Owner = root;\n  Listener = null;\n  let result;\n  try {\n    result = fn(() => cleanNode(root));\n  } catch (err) {\n    handleError(err);\n  } finally {\n    while (Afters.length) Afters.shift()();\n    Listener = listener;\n    Owner = owner;\n  }\n  return result;\n}\nfunction createSignal(value, areEqual) {\n  const s = {\n    value,\n    observers: null,\n    observerSlots: null,\n    pending: NOTPENDING,\n    comparator: areEqual ? typeof areEqual === \"function\" ? areEqual : equalFn : undefined\n  };\n  return [readSignal.bind(s), writeSignal.bind(s)];\n}\nfunction createEffect(fn, value) {\n  try {\n    updateComputation(createComputation(fn, value));\n  } catch (err) {\n    handleError(err);\n  }\n}\nfunction createDependentEffect(fn, deps, defer) {\n  const resolved = Array.isArray(deps) ? callAll(deps) : deps;\n  defer = !!defer;\n  createEffect(value => {\n    const listener = Listener;\n    resolved();\n    if (defer) defer = false;else {\n      Listener = null;\n      value = fn(value);\n      Listener = listener;\n    }\n    return value;\n  });\n}\nfunction createMemo(fn, value, areEqual) {\n  const c = createComputation(fn, value);\n  c.pending = NOTPENDING;\n  c.observers = null;\n  c.observerSlots = null;\n  c.comparator = areEqual ? typeof areEqual === \"function\" ? areEqual : equalFn : undefined;\n  try {\n    updateComputation(c);\n  } catch (err) {\n    handleError(err);\n  }\n  return readSignal.bind(c);\n}\nfunction createDeferred(fn, options) {\n  let t,\n      timeout = options ? options.timeoutMs : undefined;\n  const [deferred, setDeferred] = createSignal(fn());\n  createEffect(() => {\n    fn();\n    if (!t || !t.fn) t = requestCallback(() => setDeferred(fn()), timeout !== undefined ? {\n      timeout\n    } : undefined);\n  });\n  return deferred;\n}\nfunction batch(fn) {\n  let pending = Pending,\n      q = Pending = [];\n  const result = fn();\n  Pending = pending;\n  runUpdates(() => {\n    for (let i = 0; i < q.length; i += 1) {\n      const data = q[i];\n      if (data.pending !== NOTPENDING) {\n        const pending = data.pending;\n        data.pending = NOTPENDING;\n        writeSignal.call(data, pending);\n      }\n    }\n  });\n  return result;\n}\nfunction untrack(fn) {\n  let result,\n      listener = Listener;\n  Listener = null;\n  result = fn();\n  Listener = listener;\n  return result;\n}\nfunction afterEffects(fn) {\n  Afters.push(fn);\n}\nfunction onCleanup(fn) {\n  if (Owner === null) console.warn(\"cleanups created outside a `createRoot` or `render` will never be run\");else if (Owner.cleanups === null) Owner.cleanups = [fn];else Owner.cleanups.push(fn);\n  return fn;\n}\nfunction onError(fn) {\n  if (Owner === null) console.warn(\"error handlers created outside a `createRoot` or `render` will never be run\");else if (Owner.context === null) Owner.context = {\n    [ERROR]: [fn]\n  };else if (!Owner.context[ERROR]) Owner.context[ERROR] = [fn];else Owner.context[ERROR].push(fn);\n}\nfunction getListener() {\n  return Listener;\n}\nfunction createContext(defaultValue) {\n  const id = Symbol(\"context\");\n  return {\n    id,\n    Provider: createProvider(id),\n    defaultValue\n  };\n}\nfunction useContext(context) {\n  return lookup(Owner, context.id) || context.defaultValue;\n}\nfunction getContextOwner() {\n  return Owner;\n}\nfunction readSignal() {\n  if (this.state && this.sources) {\n    const updates = Updates;\n    Updates = null;\n    this.state === STALE ? updateComputation(this) : lookDownstream(this);\n    Updates = updates;\n  }\n  if (Listener) {\n    const sSlot = this.observers ? this.observers.length : 0;\n    if (!Listener.sources) {\n      Listener.sources = [this];\n      Listener.sourceSlots = [sSlot];\n    } else {\n      Listener.sources.push(this);\n      Listener.sourceSlots.push(sSlot);\n    }\n    if (!this.observers) {\n      this.observers = [Listener];\n      this.observerSlots = [Listener.sources.length - 1];\n    } else {\n      this.observers.push(Listener);\n      this.observerSlots.push(Listener.sources.length - 1);\n    }\n  }\n  return this.value;\n}\nfunction writeSignal(value) {\n  if (this.comparator && this.comparator(this.value, value)) return value;\n  if (Pending) {\n    if (this.pending === NOTPENDING) Pending.push(this);\n    this.pending = value;\n    return value;\n  }\n  this.value = value;\n  if (this.observers && (!Updates || this.observers.length)) {\n    runUpdates(() => {\n      for (let i = 0; i < this.observers.length; i += 1) {\n        const o = this.observers[i];\n        if (o.observers && o.state !== PENDING) markUpstream(o);\n        o.state = STALE;\n        Updates.push(o);\n      }\n      if (Updates.length > 10e5) throw new Error(\"Potential Infinite Loop Detected.\");\n    });\n  }\n  return value;\n}\nfunction updateComputation(node) {\n  if (!node.fn) return;\n  cleanNode(node);\n  const owner = Owner,\n        listener = Listener,\n        time = ExecCount;\n  Listener = Owner = node;\n  const nextValue = node.fn(node.value);\n  if (!node.updatedAt || node.updatedAt <= time) {\n    if (node.observers && node.observers.length) {\n      writeSignal.call(node, nextValue);\n    } else node.value = nextValue;\n    node.updatedAt = time;\n  }\n  Listener = listener;\n  Owner = owner;\n}\nfunction createComputation(fn, init) {\n  const c = {\n    fn,\n    state: 0,\n    updatedAt: null,\n    owned: null,\n    sources: null,\n    sourceSlots: null,\n    cleanups: null,\n    value: init,\n    owner: Owner,\n    context: null\n  };\n  if (Owner === null) console.warn(\"computations created outside a `createRoot` or `render` will never be disposed\");else if (Owner !== UNOWNED) {\n    if (!Owner.owned) Owner.owned = [c];else Owner.owned.push(c);\n  }\n  return c;\n}\nfunction runTop(node) {\n  let top = node.state === STALE && node,\n      pending;\n  while (node.fn && (node = node.owner)) {\n    if (node.state === PENDING) pending = node;else if (node.state === STALE) {\n      top = node;\n      pending = undefined;\n    }\n  }\n  if (pending) {\n    const updates = Updates;\n    Updates = null;\n    lookDownstream(pending);\n    Updates = updates;\n    if (!top || top.state !== STALE) return;\n  }\n  top && updateComputation(top);\n}\nfunction runUpdates(fn) {\n  if (Updates) return fn();\n  Updates = [];\n  ExecCount++;\n  try {\n    fn();\n    for (let i = 0; i < Updates.length; i += 1) {\n      try {\n        runTop(Updates[i]);\n      } catch (err) {\n        handleError(err);\n      }\n    }\n  } finally {\n    Updates = null;\n    while (Afters.length) Afters.shift()();\n  }\n}\nfunction lookDownstream(node) {\n  node.state = 0;\n  for (let i = 0; i < node.sources.length; i += 1) {\n    const source = node.sources[i];\n    if (source.sources) {\n      if (source.state === STALE) runTop(source);else if (source.state === PENDING) lookDownstream(source);\n    }\n  }\n}\nfunction markUpstream(node) {\n  for (let i = 0; i < node.observers.length; i += 1) {\n    const o = node.observers[i];\n    if (!o.state) {\n      o.state = PENDING;\n      o.observers && markUpstream(o);\n    }\n  }\n}\nfunction cleanNode(node) {\n  let i;\n  if (node.sources) {\n    while (node.sources.length) {\n      const source = node.sources.pop(),\n            index = node.sourceSlots.pop(),\n            obs = source.observers;\n      if (obs && obs.length) {\n        const n = obs.pop(),\n              s = source.observerSlots.pop();\n        if (index < obs.length) {\n          n.sourceSlots[s] = index;\n          obs[index] = n;\n          source.observerSlots[index] = s;\n        }\n      }\n    }\n    node.state = 0;\n  }\n  if (node.owned) {\n    for (i = 0; i < node.owned.length; i++) cleanNode(node.owned[i]);\n    node.owned = null;\n  }\n  if (node.cleanups) {\n    for (i = 0; i < node.cleanups.length; i++) node.cleanups[i]();\n    node.cleanups = null;\n  }\n  node.context = null;\n}\nfunction handleError(err) {\n  const fns = lookup(Owner, ERROR);\n  if (!fns) throw err;\n  fns.forEach(f => f(err));\n}\nfunction callAll(ss) {\n  return () => {\n    for (let i = 0; i < ss.length; i++) ss[i]();\n  };\n}\nfunction lookup(owner, key) {\n  return owner && (owner.context && owner.context[key] || owner.owner && lookup(owner.owner, key));\n}\nfunction resolveChildren(children) {\n  if (typeof children === \"function\") return createMemo(() => resolveChildren(children()));\n  if (Array.isArray(children)) {\n    const results = [];\n    for (let i = 0; i < children.length; i++) {\n      let result = resolveChildren(children[i]);\n      Array.isArray(result) ? results.push.apply(results, result) : results.push(result);\n    }\n    return results;\n  }\n  return children;\n}\nfunction createProvider(id) {\n  return function provider(props) {\n    let rendered;\n    createEffect(() => {\n      Owner.context = {\n        [id]: props.value\n      };\n      rendered = untrack(() => resolveChildren(props.children));\n    });\n    return rendered;\n  };\n}\n\nconst $RAW = Symbol(\"state-raw\"),\n      $NODE = Symbol(\"state-node\"),\n      $PROXY = Symbol(\"state-proxy\");\nfunction wrap(value, traps) {\n  return value[$PROXY] || (value[$PROXY] = new Proxy(value, traps || proxyTraps));\n}\nfunction isWrappable(obj) {\n  return obj != null && typeof obj === \"object\" && (obj.__proto__ === Object.prototype || Array.isArray(obj));\n}\nfunction unwrap(item, skipGetters) {\n  let result, unwrapped, v, prop;\n  if (result = item != null && item[$RAW]) return result;\n  if (!isWrappable(item)) return item;\n  if (Array.isArray(item)) {\n    if (Object.isFrozen(item)) item = item.slice(0);\n    for (let i = 0, l = item.length; i < l; i++) {\n      v = item[i];\n      if ((unwrapped = unwrap(v, skipGetters)) !== v) item[i] = unwrapped;\n    }\n  } else {\n    if (Object.isFrozen(item)) item = Object.assign({}, item);\n    let keys = Object.keys(item),\n        desc = skipGetters && Object.getOwnPropertyDescriptors(item);\n    for (let i = 0, l = keys.length; i < l; i++) {\n      prop = keys[i];\n      if (skipGetters && desc[prop].get) continue;\n      v = item[prop];\n      if ((unwrapped = unwrap(v, skipGetters)) !== v) item[prop] = unwrapped;\n    }\n  }\n  return item;\n}\nfunction getDataNodes(target) {\n  let nodes = target[$NODE];\n  if (!nodes) target[$NODE] = nodes = {};\n  return nodes;\n}\nconst proxyTraps = {\n  get(target, property, receiver) {\n    if (property === $RAW) return target;\n    if (property === $PROXY) return receiver;\n    const value = target[property];\n    if (property === $NODE || property === \"__proto__\") return value;\n    const wrappable = isWrappable(value);\n    if (getListener() && (typeof value !== \"function\" || target.hasOwnProperty(property))) {\n      let nodes, node;\n      if (wrappable && (nodes = getDataNodes(value))) {\n        node = nodes._ || (nodes._ = createSignal());\n        node[0]();\n      }\n      nodes = getDataNodes(target);\n      node = nodes[property] || (nodes[property] = createSignal());\n      node[0]();\n    }\n    return wrappable ? wrap(value) : value;\n  },\n  set() {\n    return true;\n  },\n  deleteProperty() {\n    return true;\n  }\n};\nfunction setProperty(state, property, value, force) {\n  if (!force && state[property] === value) return;\n  const notify = Array.isArray(state) || !(property in state);\n  if (value === undefined) {\n    delete state[property];\n  } else state[property] = value;\n  let nodes = getDataNodes(state),\n      node;\n  (node = nodes[property]) && node[1]();\n  notify && (node = nodes._) && node[1]();\n}\nfunction mergeState(state, value, force) {\n  const keys = Object.keys(value);\n  for (let i = 0; i < keys.length; i += 1) {\n    const key = keys[i];\n    setProperty(state, key, value[key], force);\n  }\n}\nfunction updatePath(current, path, traversed = []) {\n  let part,\n      prev = current;\n  if (path.length > 1) {\n    part = path.shift();\n    const partType = typeof part,\n          isArray = Array.isArray(current);\n    if (Array.isArray(part)) {\n      for (let i = 0; i < part.length; i++) {\n        updatePath(current, [part[i]].concat(path), [part[i]].concat(traversed));\n      }\n      return;\n    } else if (isArray && partType === \"function\") {\n      for (let i = 0; i < current.length; i++) {\n        if (part(current[i], i)) updatePath(current, [i].concat(path), [i].concat(traversed));\n      }\n      return;\n    } else if (isArray && partType === \"object\") {\n      const {\n        from = 0,\n        to = current.length - 1,\n        by = 1\n      } = part;\n      for (let i = from; i <= to; i += by) {\n        updatePath(current, [i].concat(path), [i].concat(traversed));\n      }\n      return;\n    } else if (path.length > 1) {\n      updatePath(current[part], path, [part].concat(traversed));\n      return;\n    }\n    prev = current[part];\n    traversed = [part].concat(traversed);\n  }\n  let value = path[0];\n  if (typeof value === \"function\") {\n    value = value(prev, traversed);\n    if (value === prev) return;\n  }\n  if (part === undefined && value == undefined) return;\n  value = unwrap(value);\n  if (part === undefined || isWrappable(prev) && isWrappable(value) && !Array.isArray(value)) {\n    mergeState(prev, value);\n  } else setProperty(current, part, value);\n}\nfunction createState(state) {\n  const unwrappedState = unwrap(state || {}, true);\n  const wrappedState = wrap(unwrappedState);\n  function setState(...args) {\n    batch(() => updatePath(unwrappedState, args));\n  }\n  return [wrappedState, setState];\n}\n\nfunction applyState(target, parent, property, merge, key) {\n  let previous = parent[property];\n  if (target === previous) return;\n  if (!isWrappable(target) || !isWrappable(previous) || key && target[key] !== previous[key]) {\n    target !== previous && setProperty(parent, property, target);\n    return;\n  }\n  if (Array.isArray(target)) {\n    if (target.length && previous.length && (!merge || key && target[0][key] != null)) {\n      let i, j, start, end, newEnd, item, newIndicesNext, keyVal;\n      for (start = 0, end = Math.min(previous.length, target.length); start < end && (previous[start] === target[start] || key && previous[start][key] === target[start][key]); start++) {\n        applyState(target[start], previous, start, merge, key);\n      }\n      const temp = new Array(target.length),\n            newIndices = new Map();\n      for (end = previous.length - 1, newEnd = target.length - 1; end >= start && newEnd >= start && (previous[end] === target[newEnd] || key && previous[end][key] === target[newEnd][key]); end--, newEnd--) {\n        temp[newEnd] = previous[end];\n      }\n      if (start > newEnd || start > end) {\n        for (j = start; j <= newEnd; j++) setProperty(previous, j, target[j]);\n        for (; j < target.length; j++) {\n          setProperty(previous, j, temp[j]);\n          applyState(target[j], previous, j, merge, key);\n        }\n        if (previous.length > target.length) setProperty(previous, \"length\", target.length);\n        return;\n      }\n      newIndicesNext = new Array(newEnd + 1);\n      for (j = newEnd; j >= start; j--) {\n        item = target[j];\n        keyVal = key ? item[key] : item;\n        i = newIndices.get(keyVal);\n        newIndicesNext[j] = i === undefined ? -1 : i;\n        newIndices.set(keyVal, j);\n      }\n      for (i = start; i <= end; i++) {\n        item = previous[i];\n        keyVal = key ? item[key] : item;\n        j = newIndices.get(keyVal);\n        if (j !== undefined && j !== -1) {\n          temp[j] = previous[i];\n          j = newIndicesNext[j];\n          newIndices.set(keyVal, j);\n        }\n      }\n      for (j = start; j < target.length; j++) {\n        if (j in temp) {\n          setProperty(previous, j, temp[j]);\n          applyState(target[j], previous, j, merge, key);\n        } else setProperty(previous, j, target[j]);\n      }\n    } else {\n      for (let i = 0, len = target.length; i < len; i++) {\n        applyState(target[i], previous, i, merge, key);\n      }\n    }\n    if (previous.length > target.length) setProperty(previous, \"length\", target.length);\n    return;\n  }\n  const targetKeys = Object.keys(target);\n  for (let i = 0, len = targetKeys.length; i < len; i++) {\n    applyState(target[targetKeys[i]], previous, targetKeys[i], merge, key);\n  }\n  const previousKeys = Object.keys(previous);\n  for (let i = 0, len = previousKeys.length; i < len; i++) {\n    if (target[previousKeys[i]] === undefined) setProperty(previous, previousKeys[i], undefined);\n  }\n}\nfunction reconcile(value, options = {}) {\n  const {\n    merge,\n    key = \"id\"\n  } = options,\n        v = unwrap(value);\n  return state => {\n    if (!isWrappable(state)) return v;\n    applyState(v, {\n      state\n    }, \"state\", merge, key);\n    return state;\n  };\n}\nconst setterTraps = {\n  get(target, property) {\n    if (property === $RAW) return target;\n    const value = target[property];\n    return isWrappable(value) ? new Proxy(value, setterTraps) : value;\n  },\n  set(target, property, value) {\n    setProperty(target, property, unwrap(value));\n    return true;\n  },\n  deleteProperty(target, property) {\n    setProperty(target, property, undefined);\n    return true;\n  }\n};\nfunction produce(fn) {\n  return state => {\n    if (isWrappable(state)) fn(new Proxy(state, setterTraps));\n    return state;\n  };\n}\n\nconst FALLBACK = Symbol(\"fallback\");\nfunction mapArray(list, mapFn, options = {}) {\n  let items = [],\n      mapped = [],\n      disposers = [],\n      len = 0,\n      indexes = mapFn.length > 1 ? [] : null;\n  onCleanup(() => {\n    for (let i = 0, length = disposers.length; i < length; i++) disposers[i]();\n  });\n  return () => {\n    let newItems = list() || [],\n        i,\n        j;\n    return untrack(() => {\n      let newLen = newItems.length,\n          newIndices,\n          newIndicesNext,\n          temp,\n          tempdisposers,\n          tempIndexes,\n          start,\n          end,\n          newEnd,\n          item;\n      if (newLen === 0) {\n        if (len !== 0) {\n          for (i = 0; i < len; i++) disposers[i]();\n          disposers = [];\n          items = [];\n          mapped = [];\n          len = 0;\n          indexes && (indexes = []);\n        }\n        if (options.fallback) {\n          items = [FALLBACK];\n          mapped[0] = createRoot(disposer => {\n            disposers[0] = disposer;\n            return options.fallback();\n          });\n          len = 1;\n        }\n      }\n      else if (len === 0) {\n          for (j = 0; j < newLen; j++) {\n            items[j] = newItems[j];\n            mapped[j] = createRoot(mapper);\n          }\n          len = newLen;\n        } else {\n          temp = new Array(newLen);\n          tempdisposers = new Array(newLen);\n          indexes && (tempIndexes = new Array(newLen));\n          for (start = 0, end = Math.min(len, newLen); start < end && items[start] === newItems[start]; start++);\n          for (end = len - 1, newEnd = newLen - 1; end >= start && newEnd >= start && items[end] === newItems[newEnd]; end--, newEnd--) {\n            temp[newEnd] = mapped[end];\n            tempdisposers[newEnd] = disposers[end];\n            indexes && (tempIndexes[newEnd] = indexes[end]);\n          }\n          if (start > newEnd) {\n            for (j = end; start <= j; j--) disposers[j]();\n            const rLen = end - start + 1;\n            if (rLen > 0) {\n              mapped.splice(start, rLen);\n              disposers.splice(start, rLen);\n              if (indexes) {\n                indexes.splice(start, rLen);\n                for (j = start; j < newLen; j++) indexes[j](j);\n              }\n            }\n            items = newItems.slice(0);\n            len = newLen;\n            return mapped;\n          }\n          if (start > end) {\n            for (j = start; j <= newEnd; j++) mapped[j] = createRoot(mapper);\n            for (; j < newLen; j++) {\n              mapped[j] = temp[j];\n              disposers[j] = tempdisposers[j];\n              if (indexes) {\n                indexes[j] = tempIndexes[j];\n                indexes[j](j);\n              }\n            }\n            items = newItems.slice(0);\n            len = newLen;\n            return mapped;\n          }\n          newIndices = new Map();\n          newIndicesNext = new Array(newEnd + 1);\n          for (j = newEnd; j >= start; j--) {\n            item = newItems[j];\n            i = newIndices.get(item);\n            newIndicesNext[j] = i === undefined ? -1 : i;\n            newIndices.set(item, j);\n          }\n          for (i = start; i <= end; i++) {\n            item = items[i];\n            j = newIndices.get(item);\n            if (j !== undefined && j !== -1) {\n              temp[j] = mapped[i];\n              tempdisposers[j] = disposers[i];\n              indexes && (tempIndexes[j] = indexes[i]);\n              j = newIndicesNext[j];\n              newIndices.set(item, j);\n            } else disposers[i]();\n          }\n          for (j = start; j < newLen; j++) {\n            if (j in temp) {\n              mapped[j] = temp[j];\n              disposers[j] = tempdisposers[j];\n              if (indexes) {\n                indexes[j] = tempIndexes[j];\n                indexes[j](j);\n              }\n            } else mapped[j] = createRoot(mapper);\n          }\n          len = mapped.length = newLen;\n          items = newItems.slice(0);\n        }\n      return mapped;\n    });\n    function mapper(disposer) {\n      disposers[j] = disposer;\n      if (indexes) {\n        const [s, set] = createSignal(j, true);\n        indexes[j] = set;\n        return mapFn(newItems[j], s);\n      }\n      return mapFn(newItems[j]);\n    }\n  };\n}\nfunction indexArray(list, mapFn, options = {}) {\n  let items = [],\n      mapped = [],\n      disposers = [],\n      signals = [],\n      len = 0,\n      i;\n  onCleanup(() => {\n    for (let i = 0, length = disposers.length; i < length; i++) disposers[i]();\n  });\n  return () => {\n    const newItems = list() || [];\n    return untrack(() => {\n      if (newItems.length === 0) {\n        if (len !== 0) {\n          for (i = 0; i < len; i++) disposers[i]();\n          disposers = [];\n          items = [];\n          mapped = [];\n          len = 0;\n          signals = [];\n        }\n        if (options.fallback) {\n          items = [FALLBACK];\n          mapped[0] = createRoot(disposer => {\n            disposers[0] = disposer;\n            return options.fallback();\n          });\n          len = 1;\n        }\n        return mapped;\n      }\n      if (items[0] === FALLBACK) {\n        disposers[0]();\n        disposers = [];\n        items = [];\n        mapped = [];\n        len = 0;\n      }\n      for (i = 0; i < newItems.length; i++) {\n        if (i < items.length && items[i] !== newItems[i]) {\n          signals[i](newItems[i]);\n        } else if (i >= items.length) {\n          mapped[i] = createRoot(mapper);\n        }\n      }\n      for (; i < items.length; i++) {\n        disposers[i]();\n      }\n      len = mapped.length = signals.length = disposers.length = newItems.length;\n      items = newItems.slice(0);\n      return mapped;\n    });\n    function mapper(disposer) {\n      disposers[i] = disposer;\n      const [s, set] = createSignal(newItems[i]);\n      signals[i] = set;\n      return mapFn(s, i);\n    }\n  };\n}\n\nfunction createComponent(Comp, props) {\n  return untrack(() => Comp(props));\n}\nfunction assignProps(target, ...sources) {\n  for (let i = 0; i < sources.length; i++) {\n    const descriptors = Object.getOwnPropertyDescriptors(sources[i]);\n    Object.defineProperties(target, descriptors);\n  }\n  return target;\n}\nfunction splitProps(props, ...keys) {\n  const descriptors = Object.getOwnPropertyDescriptors(props),\n        split = k => {\n    const clone = {};\n    for (let i = 0; i < k.length; i++) {\n      const key = k[i];\n      if (descriptors[key]) {\n        Object.defineProperty(clone, key, descriptors[key]);\n        delete descriptors[key];\n      }\n    }\n    return clone;\n  };\n  return keys.map(split).concat(split(Object.keys(descriptors)));\n}\n\nfunction createActivityTracker() {\n  let count = 0;\n  const [read, trigger] = createSignal(false);\n  return [read, () => count++ === 0 && trigger(true), () => --count <= 0 && trigger(false)];\n}\nconst SuspenseContext = createContext({});\nconst [active, increment, decrement] = createActivityTracker();\nSuspenseContext.active = active;\nSuspenseContext.increment = increment;\nSuspenseContext.decrement = decrement;\nfunction awaitSuspense(fn) {\n  return () => new Promise(resolve => {\n    const res = fn();\n    createEffect(() => !SuspenseContext.active() && resolve(res));\n  });\n}\nfunction createResource(value, options = {}) {\n  const [s, set] = createSignal(value),\n        [trackPromise, triggerPromise] = createSignal(),\n        [trackLoading, triggerLoading] = createSignal(),\n        contexts = new Set(),\n        h = globalThis._$HYDRATION;\n  let loading = false,\n      error = null,\n      pr;\n  function loadEnd(v) {\n    pr = undefined;\n    batch(() => {\n      set(v);\n      if (h.asyncSSR && options.name) h.resources[options.name] = v;\n      loading && (loading = false, triggerLoading());\n      for (let c of contexts.keys()) c.decrement();\n      contexts.clear();\n    });\n  }\n  function read() {\n    const c = useContext(SuspenseContext),\n          v = s();\n    if (error) throw error;\n    trackPromise();\n    if (pr && c.increment && !contexts.has(c)) {\n      c.increment();\n      contexts.add(c);\n    }\n    return v;\n  }\n  function load(fn) {\n    error = null;\n    if (fn == null || typeof fn !== \"function\") return;\n    let p;\n    const hydrating = h.context && !!h.context.registry;\n    if (hydrating) {\n      if (h.loadResource && !options.notStreamed) {\n        fn = h.loadResource;\n      } else if (options.name && h.resources && options.name in h.resources) {\n        fn = () => {\n          const data = h.resources[options.name];\n          delete h.resources[options.name];\n          return data;\n        };\n      }\n    }\n    p = fn();\n    if (typeof p !== \"object\" || !(\"then\" in p)) {\n      loadEnd(p);\n      return p;\n    }\n    pr = p;\n    if (!loading) {\n      loading = true;\n      batch(() => {\n        triggerLoading();\n        triggerPromise();\n      });\n    }\n    return p.then(v => (pr === p && loadEnd(v), s()), err => (pr === p && (error = err, loadEnd(undefined)), s()));\n  }\n  Object.defineProperty(read, \"loading\", {\n    get() {\n      return trackLoading(), loading;\n    }\n  });\n  return [read, load];\n}\nfunction createResourceNode(v, name) {\n  const node = createSignal(),\n        [r, load] = createResource(v, {\n    name\n  });\n  return [() => (r(), node[0]()), node[1], load, () => r.loading];\n}\nfunction createResourceState(state, options = {}) {\n  const loadingTraps = {\n    get(nodes, property) {\n      const node = nodes[property] || (nodes[property] = createResourceNode(undefined, name && `${options.name}:${property}`));\n      return node[3]();\n    },\n    set() {\n      return true;\n    },\n    deleteProperty() {\n      return true;\n    }\n  };\n  const resourceTraps = {\n    get(target, property, receiver) {\n      if (property === $RAW) return target;\n      if (property === $PROXY) return receiver;\n      if (property === \"loading\") return new Proxy(getDataNodes(target), loadingTraps);\n      const value = target[property];\n      if (property === $NODE || property === \"__proto__\") return value;\n      const wrappable = isWrappable(value);\n      if (getListener() && (typeof value !== \"function\" || target.hasOwnProperty(property))) {\n        let nodes, node;\n        if (wrappable && (nodes = getDataNodes(value))) {\n          node = nodes._ || (nodes._ = createSignal());\n          node[0]();\n        }\n        nodes = getDataNodes(target);\n        node = nodes[property] || (nodes[property] = createResourceNode(value, `${options.name}:${property}`));\n        node[0]();\n      }\n      return wrappable ? wrap(value) : value;\n    },\n    set() {\n      return true;\n    },\n    deleteProperty() {\n      return true;\n    }\n  };\n  const unwrappedState = unwrap(state || {}, true),\n        wrappedState = wrap(unwrappedState, resourceTraps);\n  function setState(...args) {\n    batch(() => updatePath(unwrappedState, args));\n  }\n  function loadState(v, r) {\n    const nodes = getDataNodes(unwrappedState),\n          keys = Object.keys(v);\n    for (let i = 0; i < keys.length; i++) {\n      const k = keys[i],\n            node = nodes[k] || (nodes[k] = createResourceNode(unwrappedState[k], `${options.name}:${k}`)),\n            resolver = v => (r ? setState(k, r(v)) : setProperty(unwrappedState, k, v), v),\n            p = node[2](v[k]);\n      typeof p === \"object\" && \"then\" in p ? p.then(resolver) : resolver(p);\n    }\n  }\n  return [wrappedState, loadState, setState];\n}\nfunction lazy(fn) {\n  return props => {\n    const h = globalThis._$HYDRATION,\n          hydrating = h.context && h.context.registry,\n          ctx = nextHydrateContext(),\n          [s, l] = createResource(undefined, {\n      notStreamed: true\n    });\n    if (hydrating && h.resources) {\n      fn().then(mod => l(() => mod.default));\n    } else l(() => fn().then(mod => mod.default));\n    let Comp;\n    return createMemo(() => (Comp = s()) && untrack(() => {\n      if (!ctx) return Comp(props);\n      const c = h.context;\n      setHydrateContext(ctx);\n      const r = Comp(props);\n      !c && setHydrateContext();\n      return r;\n    }));\n  };\n}\nfunction useTransition(config) {\n  const [pending, increment, decrement] = createActivityTracker();\n  return [pending, fn => {\n    const prevTransition = SuspenseContext.transition;\n    SuspenseContext.transition = {\n      timeoutMs: config.timeoutMs,\n      increment,\n      decrement\n    };\n    increment();\n    fn();\n    decrement();\n    afterEffects(() => SuspenseContext.transition = prevTransition);\n  }];\n}\nfunction suspend(fn) {\n  const {\n    state\n  } = useContext(SuspenseContext),\n        wrapped = createMemo(fn);\n  let cached;\n  return state ? createMemo(() => state() === \"suspended\" ? cached : cached = wrapped()) : wrapped;\n}\nfunction setHydrateContext(context) {\n  globalThis._$HYDRATION.context = context;\n}\nfunction nextHydrateContext() {\n  const hydration = globalThis._$HYDRATION;\n  return hydration && hydration.context ? {\n    id: `${hydration.context.id}.${hydration.context.count++}`,\n    count: 0,\n    registry: hydration.context.registry\n  } : undefined;\n}\n\nfunction For(props) {\n  const fallback = \"fallback\" in props && {\n    fallback: () => props.fallback\n  };\n  return suspend(mapArray(() => props.each, props.children, fallback ? fallback : undefined));\n}\nfunction Index(props) {\n  const fallback = \"fallback\" in props && {\n    fallback: () => props.fallback\n  };\n  return suspend(indexArray(() => props.each, props.children, fallback ? fallback : undefined));\n}\nfunction Show(props) {\n  const childDesc = Object.getOwnPropertyDescriptor(props, \"children\").value,\n        callFn = typeof childDesc === \"function\" && childDesc.length,\n        condition = createMemo(callFn ? () => props.when : () => !!props.when, undefined, true);\n  return suspend(() => {\n    const c = condition();\n    return c ? callFn ? untrack(() => props.children(c)) : props.children : props.fallback;\n  });\n}\nfunction Switch(props) {\n  let conditions = props.children;\n  Array.isArray(conditions) || (conditions = [conditions]);\n  const evalConditions = createMemo(() => {\n    for (let i = 0; i < conditions.length; i++) {\n      const c = conditions[i].when;\n      if (c) return [i, conditions[i].keyed ? c : !!c];\n    }\n    return [-1];\n  }, undefined, (a, b) => a && a[0] === b[0] && a[1] === b[1]);\n  return suspend(() => {\n    const [index, when] = evalConditions();\n    if (index < 0) return props.fallback;\n    const c = conditions[index].children;\n    return typeof c === \"function\" && c.length ? untrack(() => c(when)) : c;\n  });\n}\nfunction Match(props) {\n  const childDesc = Object.getOwnPropertyDescriptor(props, \"children\").value;\n  props.keyed = typeof childDesc === \"function\" && !!childDesc.length;\n  return props;\n}\nfunction ErrorBoundary(props) {\n  const [errored, setErrored] = createSignal(),\n        fallbackDesc = Object.getOwnPropertyDescriptor(props, \"fallback\").value,\n        callFn = typeof fallbackDesc === \"function\" && !!fallbackDesc.length;\n  onError(setErrored);\n  let e;\n  return createMemo(() => (e = errored()) != null ? callFn ? untrack(() => props.fallback(e)) : props.fallback : props.children);\n}\nfunction Dynamic(props) {\n  const [p, others] = splitProps(props, [\"component\"]);\n  return suspend(() => {\n    const comp = p.component;\n    return comp && untrack(() => comp(others));\n  });\n}\n\nconst SuspenseListContext = createContext();\nfunction SuspenseList(props) {\n  let index = 0,\n      suspenseSetter,\n      showContent,\n      showFallback;\n  const listContext = useContext(SuspenseListContext);\n  if (listContext) {\n    const [state, stateSetter] = createSignal(\"running\", true);\n    suspenseSetter = stateSetter;\n    [showContent, showFallback] = listContext.register(state);\n  }\n  const registry = [],\n        comp = createComponent(SuspenseListContext.Provider, {\n    value: {\n      register: state => {\n        const [showingContent, showContent] = createSignal(false, true),\n              [showingFallback, showFallback] = createSignal(false, true);\n        registry[index++] = {\n          state,\n          showContent,\n          showFallback\n        };\n        return [showingContent, showingFallback];\n      }\n    },\n    get children() {\n      return props.children;\n    }\n  });\n  createEffect(() => {\n    const reveal = props.revealOrder,\n          tail = props.tail,\n          visibleContent = showContent ? showContent() : true,\n          visibleFallback = showFallback ? showFallback() : true,\n          reverse = reveal === \"backwards\";\n    if (reveal === \"together\") {\n      const all = registry.every(i => i.state() === \"running\");\n      suspenseSetter && suspenseSetter(all ? \"running\" : \"fallback\");\n      registry.forEach(i => {\n        i.showContent(all && visibleContent);\n        i.showFallback(visibleFallback);\n      });\n      return;\n    }\n    let stop = false;\n    for (let i = 0, len = registry.length; i < len; i++) {\n      const n = reverse ? len - i - 1 : i,\n            s = registry[n].state();\n      if (!stop && (s === \"running\" || s === \"suspended\")) {\n        registry[n].showContent(visibleContent);\n        registry[n].showFallback(visibleFallback);\n      } else {\n        const next = !stop;\n        if (next && suspenseSetter) suspenseSetter(\"fallback\");\n        if (!tail || next && tail === \"collapsed\") {\n          registry[n].showFallback(visibleFallback);\n        } else registry[n].showFallback(false);\n        stop = true;\n        registry[n].showContent(next);\n      }\n    }\n    if (!stop && suspenseSetter) suspenseSetter(\"running\");\n  });\n  return comp;\n}\nfunction Suspense(props) {\n  let counter = 0,\n      t,\n      showContent,\n      showFallback,\n      transition;\n  const [state, nextState] = createSignal(\"running\", true),\n        store = {\n    increment: () => {\n      if (++counter === 1) {\n        if (!store.initializing) {\n          if (SuspenseContext.transition) {\n            !transition && (transition = SuspenseContext.transition).increment();\n            t = setTimeout(() => nextState(\"fallback\"), SuspenseContext.transition.timeoutMs);\n            nextState(\"suspended\");\n          } else nextState(\"fallback\");\n        } else nextState(\"fallback\");\n        SuspenseContext.increment();\n      }\n    },\n    decrement: () => {\n      if (--counter === 0) {\n        t && clearTimeout(t);\n        transition && transition.decrement();\n        transition = undefined;\n        nextState(\"running\");\n        afterEffects(() => SuspenseContext.decrement());\n      }\n    },\n    state,\n    initializing: true\n  };\n  const listContext = useContext(SuspenseListContext);\n  if (listContext) [showContent, showFallback] = listContext.register(store.state);\n  return createComponent(SuspenseContext.Provider, {\n    value: store,\n    get children() {\n      const rendered = untrack(() => props.children);\n      return () => {\n        const value = store.state(),\n              visibleContent = showContent ? showContent() : true,\n              visibleFallback = showFallback ? showFallback() : true;\n        if (store.initializing) store.initializing = false;\n        if (value === \"running\" && visibleContent || value === \"suspended\") return rendered;\n        if (!visibleFallback) return;\n        return props.fallback;\n      };\n    }\n  });\n}\n\nif (!globalThis.Solid$$) globalThis.Solid$$ = true;else console.warn(\"You appear to have multiple instances of Solid. This can lead to unexpected behavior.\");\n\nexport { $RAW, Dynamic, ErrorBoundary, For, Index, Match, Show, Suspense, SuspenseContext, SuspenseList, Switch, afterEffects, assignProps, awaitSuspense, batch, cancelCallback, createComponent, createContext, createDeferred, createDependentEffect, createEffect, createMemo, createResource, createResourceState, createRoot, createSignal, createState, equalFn, batch as freeze, getContextOwner, getListener, indexArray, lazy, mapArray, onCleanup, onError, produce, reconcile, requestCallback, untrack as sample, splitProps, suspend, untrack, unwrap, useContext, useTransition };\n","\nfunction collector(node) {\n  if (node.nodeType !== 3) {\n    if (node.attributes !== undefined) {\n      for(let attr of Array.from(node.attributes)) {\n        let aname = attr.name\n        if (aname[0] === '#') {\n          node.removeAttribute(aname)\n          return aname.slice(1)\n        }\n      }\n    }\n    return 0\n  } else {\n    let nodeData = node.nodeValue\n    if (nodeData[0] === '#') {\n      node.nodeValue = \"\"\n      return nodeData.slice(1)\n    }\n    return 0\n  }\n}\n\nconst TREE_WALKER = document.createTreeWalker(document, NodeFilter.SHOW_ALL, null, false)\nTREE_WALKER.roll = function(n) {\n  while(--n) this.nextNode()\n  return this.currentNode\n}\n\nclass Ref {\n  constructor(idx, ref) {\n    this.idx = idx\n    this.ref = ref\n  }\n}\n\nfunction genPath(node) {\n  const w = TREE_WALKER\n  w.currentNode = node\n\n  let indices = [], ref, idx = 0\n  do {\n    if (ref = collector(node)) {\n      indices.push(new Ref(idx+1, ref))\n      idx = 1\n    } else {\n      idx++\n    }\n  } while(node = w.nextNode())\n\n  return indices\n}\n\nfunction walker(node) {\n  const refs = {}\n\n  const w = TREE_WALKER\n  w.currentNode = node\n\n  this._refPaths.map(x => refs[x.ref] = w.roll(x.idx))\n\n  return refs\n}\n\nexport function compile(node) {\n    node._refPaths = genPath(node)\n    node.collect = walker\n}\n\nconst compilerTemplate = document.createElement('template')\nexport function h(strings, ...args) {\n  const template = String.raw(strings, ...args)\n    .replace(/>\\n+/g, '>')\n    .replace(/\\s+</g, '<')\n    .replace(/>\\s+/g, '>')\n    .replace(/\\n\\s+/g, '<!-- -->')\n  compilerTemplate.innerHTML = template\n  const content = compilerTemplate.content.firstChild\n  compile(content)\n  return content\n}\nexport default h\n","/**!\n* tippy.js v6.2.3\n* (c) 2017-2020 atomiks\n* MIT License\n*/\nimport { createPopper } from '@popperjs/core';\n\nvar ROUND_ARROW = '<svg width=\"16\" height=\"6\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 6s1.796-.013 4.67-3.615C5.851.9 6.93.006 8 0c1.07-.006 2.148.887 3.343 2.385C14.233 6.005 16 6 16 6H0z\"></svg>';\nvar BOX_CLASS = \"tippy-box\";\nvar CONTENT_CLASS = \"tippy-content\";\nvar BACKDROP_CLASS = \"tippy-backdrop\";\nvar ARROW_CLASS = \"tippy-arrow\";\nvar SVG_ARROW_CLASS = \"tippy-svg-arrow\";\nvar TOUCH_OPTIONS = {\n  passive: true,\n  capture: true\n};\n\nfunction hasOwnProperty(obj, key) {\n  return {}.hasOwnProperty.call(obj, key);\n}\nfunction getValueAtIndexOrReturn(value, index, defaultValue) {\n  if (Array.isArray(value)) {\n    var v = value[index];\n    return v == null ? Array.isArray(defaultValue) ? defaultValue[index] : defaultValue : v;\n  }\n\n  return value;\n}\nfunction isType(value, type) {\n  var str = {}.toString.call(value);\n  return str.indexOf('[object') === 0 && str.indexOf(type + \"]\") > -1;\n}\nfunction invokeWithArgsOrReturn(value, args) {\n  return typeof value === 'function' ? value.apply(void 0, args) : value;\n}\nfunction debounce(fn, ms) {\n  // Avoid wrapping in `setTimeout` if ms is 0 anyway\n  if (ms === 0) {\n    return fn;\n  }\n\n  var timeout;\n  return function (arg) {\n    clearTimeout(timeout);\n    timeout = setTimeout(function () {\n      fn(arg);\n    }, ms);\n  };\n}\nfunction removeProperties(obj, keys) {\n  var clone = Object.assign({}, obj);\n  keys.forEach(function (key) {\n    delete clone[key];\n  });\n  return clone;\n}\nfunction splitBySpaces(value) {\n  return value.split(/\\s+/).filter(Boolean);\n}\nfunction normalizeToArray(value) {\n  return [].concat(value);\n}\nfunction pushIfUnique(arr, value) {\n  if (arr.indexOf(value) === -1) {\n    arr.push(value);\n  }\n}\nfunction unique(arr) {\n  return arr.filter(function (item, index) {\n    return arr.indexOf(item) === index;\n  });\n}\nfunction getBasePlacement(placement) {\n  return placement.split('-')[0];\n}\nfunction arrayFrom(value) {\n  return [].slice.call(value);\n}\n\nfunction div() {\n  return document.createElement('div');\n}\nfunction isElement(value) {\n  return ['Element', 'Fragment'].some(function (type) {\n    return isType(value, type);\n  });\n}\nfunction isNodeList(value) {\n  return isType(value, 'NodeList');\n}\nfunction isMouseEvent(value) {\n  return isType(value, 'MouseEvent');\n}\nfunction isReferenceElement(value) {\n  return !!(value && value._tippy && value._tippy.reference === value);\n}\nfunction getArrayOfElements(value) {\n  if (isElement(value)) {\n    return [value];\n  }\n\n  if (isNodeList(value)) {\n    return arrayFrom(value);\n  }\n\n  if (Array.isArray(value)) {\n    return value;\n  }\n\n  return arrayFrom(document.querySelectorAll(value));\n}\nfunction setTransitionDuration(els, value) {\n  els.forEach(function (el) {\n    if (el) {\n      el.style.transitionDuration = value + \"ms\";\n    }\n  });\n}\nfunction setVisibilityState(els, state) {\n  els.forEach(function (el) {\n    if (el) {\n      el.setAttribute('data-state', state);\n    }\n  });\n}\nfunction getOwnerDocument(elementOrElements) {\n  var _normalizeToArray = normalizeToArray(elementOrElements),\n      element = _normalizeToArray[0];\n\n  return element ? element.ownerDocument || document : document;\n}\nfunction isCursorOutsideInteractiveBorder(popperTreeData, event) {\n  var clientX = event.clientX,\n      clientY = event.clientY;\n  return popperTreeData.every(function (_ref) {\n    var popperRect = _ref.popperRect,\n        popperState = _ref.popperState,\n        props = _ref.props;\n    var interactiveBorder = props.interactiveBorder;\n    var basePlacement = getBasePlacement(popperState.placement);\n    var offsetData = popperState.modifiersData.offset;\n\n    if (!offsetData) {\n      return true;\n    }\n\n    var topDistance = basePlacement === 'bottom' ? offsetData.top.y : 0;\n    var bottomDistance = basePlacement === 'top' ? offsetData.bottom.y : 0;\n    var leftDistance = basePlacement === 'right' ? offsetData.left.x : 0;\n    var rightDistance = basePlacement === 'left' ? offsetData.right.x : 0;\n    var exceedsTop = popperRect.top - clientY + topDistance > interactiveBorder;\n    var exceedsBottom = clientY - popperRect.bottom - bottomDistance > interactiveBorder;\n    var exceedsLeft = popperRect.left - clientX + leftDistance > interactiveBorder;\n    var exceedsRight = clientX - popperRect.right - rightDistance > interactiveBorder;\n    return exceedsTop || exceedsBottom || exceedsLeft || exceedsRight;\n  });\n}\nfunction updateTransitionEndListener(box, action, listener) {\n  var method = action + \"EventListener\"; // some browsers apparently support `transition` (unprefixed) but only fire\n  // `webkitTransitionEnd`...\n\n  ['transitionend', 'webkitTransitionEnd'].forEach(function (event) {\n    box[method](event, listener);\n  });\n}\n\nvar currentInput = {\n  isTouch: false\n};\nvar lastMouseMoveTime = 0;\n/**\n * When a `touchstart` event is fired, it's assumed the user is using touch\n * input. We'll bind a `mousemove` event listener to listen for mouse input in\n * the future. This way, the `isTouch` property is fully dynamic and will handle\n * hybrid devices that use a mix of touch + mouse input.\n */\n\nfunction onDocumentTouchStart() {\n  if (currentInput.isTouch) {\n    return;\n  }\n\n  currentInput.isTouch = true;\n\n  if (window.performance) {\n    document.addEventListener('mousemove', onDocumentMouseMove);\n  }\n}\n/**\n * When two `mousemove` event are fired consecutively within 20ms, it's assumed\n * the user is using mouse input again. `mousemove` can fire on touch devices as\n * well, but very rarely that quickly.\n */\n\nfunction onDocumentMouseMove() {\n  var now = performance.now();\n\n  if (now - lastMouseMoveTime < 20) {\n    currentInput.isTouch = false;\n    document.removeEventListener('mousemove', onDocumentMouseMove);\n  }\n\n  lastMouseMoveTime = now;\n}\n/**\n * When an element is in focus and has a tippy, leaving the tab/window and\n * returning causes it to show again. For mouse users this is unexpected, but\n * for keyboard use it makes sense.\n * TODO: find a better technique to solve this problem\n */\n\nfunction onWindowBlur() {\n  var activeElement = document.activeElement;\n\n  if (isReferenceElement(activeElement)) {\n    var instance = activeElement._tippy;\n\n    if (activeElement.blur && !instance.state.isVisible) {\n      activeElement.blur();\n    }\n  }\n}\nfunction bindGlobalEventListeners() {\n  document.addEventListener('touchstart', onDocumentTouchStart, TOUCH_OPTIONS);\n  window.addEventListener('blur', onWindowBlur);\n}\n\nvar isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined';\nvar ua = isBrowser ? navigator.userAgent : '';\nvar isIE = /MSIE |Trident\\//.test(ua);\n\nfunction createMemoryLeakWarning(method) {\n  var txt = method === 'destroy' ? 'n already-' : ' ';\n  return [method + \"() was called on a\" + txt + \"destroyed instance. This is a no-op but\", 'indicates a potential memory leak.'].join(' ');\n}\nfunction clean(value) {\n  var spacesAndTabs = /[ \\t]{2,}/g;\n  var lineStartWithSpaces = /^[ \\t]*/gm;\n  return value.replace(spacesAndTabs, ' ').replace(lineStartWithSpaces, '').trim();\n}\n\nfunction getDevMessage(message) {\n  return clean(\"\\n  %ctippy.js\\n\\n  %c\" + clean(message) + \"\\n\\n  %c\\uD83D\\uDC77\\u200D This is a development-only message. It will be removed in production.\\n  \");\n}\n\nfunction getFormattedMessage(message) {\n  return [getDevMessage(message), // title\n  'color: #00C584; font-size: 1.3em; font-weight: bold;', // message\n  'line-height: 1.5', // footer\n  'color: #a6a095;'];\n} // Assume warnings and errors never have the same message\n\nvar visitedMessages;\n\nif (process.env.NODE_ENV !== \"production\") {\n  resetVisitedMessages();\n}\n\nfunction resetVisitedMessages() {\n  visitedMessages = new Set();\n}\nfunction warnWhen(condition, message) {\n  if (condition && !visitedMessages.has(message)) {\n    var _console;\n\n    visitedMessages.add(message);\n\n    (_console = console).warn.apply(_console, getFormattedMessage(message));\n  }\n}\nfunction errorWhen(condition, message) {\n  if (condition && !visitedMessages.has(message)) {\n    var _console2;\n\n    visitedMessages.add(message);\n\n    (_console2 = console).error.apply(_console2, getFormattedMessage(message));\n  }\n}\nfunction validateTargets(targets) {\n  var didPassFalsyValue = !targets;\n  var didPassPlainObject = Object.prototype.toString.call(targets) === '[object Object]' && !targets.addEventListener;\n  errorWhen(didPassFalsyValue, ['tippy() was passed', '`' + String(targets) + '`', 'as its targets (first) argument. Valid types are: String, Element,', 'Element[], or NodeList.'].join(' '));\n  errorWhen(didPassPlainObject, ['tippy() was passed a plain object which is not supported as an argument', 'for virtual positioning. Use props.getReferenceClientRect instead.'].join(' '));\n}\n\nvar pluginProps = {\n  animateFill: false,\n  followCursor: false,\n  inlinePositioning: false,\n  sticky: false\n};\nvar renderProps = {\n  allowHTML: false,\n  animation: 'fade',\n  arrow: true,\n  content: '',\n  inertia: false,\n  maxWidth: 350,\n  role: 'tooltip',\n  theme: '',\n  zIndex: 9999\n};\nvar defaultProps = Object.assign({\n  appendTo: function appendTo() {\n    return document.body;\n  },\n  aria: {\n    content: 'auto',\n    expanded: 'auto'\n  },\n  delay: 0,\n  duration: [300, 250],\n  getReferenceClientRect: null,\n  hideOnClick: true,\n  ignoreAttributes: false,\n  interactive: false,\n  interactiveBorder: 2,\n  interactiveDebounce: 0,\n  moveTransition: '',\n  offset: [0, 10],\n  onAfterUpdate: function onAfterUpdate() {},\n  onBeforeUpdate: function onBeforeUpdate() {},\n  onCreate: function onCreate() {},\n  onDestroy: function onDestroy() {},\n  onHidden: function onHidden() {},\n  onHide: function onHide() {},\n  onMount: function onMount() {},\n  onShow: function onShow() {},\n  onShown: function onShown() {},\n  onTrigger: function onTrigger() {},\n  onUntrigger: function onUntrigger() {},\n  onClickOutside: function onClickOutside() {},\n  placement: 'top',\n  plugins: [],\n  popperOptions: {},\n  render: null,\n  showOnCreate: false,\n  touch: true,\n  trigger: 'mouseenter focus',\n  triggerTarget: null\n}, pluginProps, {}, renderProps);\nvar defaultKeys = Object.keys(defaultProps);\nvar setDefaultProps = function setDefaultProps(partialProps) {\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== \"production\") {\n    validateProps(partialProps, []);\n  }\n\n  var keys = Object.keys(partialProps);\n  keys.forEach(function (key) {\n    defaultProps[key] = partialProps[key];\n  });\n};\nfunction getExtendedPassedProps(passedProps) {\n  var plugins = passedProps.plugins || [];\n  var pluginProps = plugins.reduce(function (acc, plugin) {\n    var name = plugin.name,\n        defaultValue = plugin.defaultValue;\n\n    if (name) {\n      acc[name] = passedProps[name] !== undefined ? passedProps[name] : defaultValue;\n    }\n\n    return acc;\n  }, {});\n  return Object.assign({}, passedProps, {}, pluginProps);\n}\nfunction getDataAttributeProps(reference, plugins) {\n  var propKeys = plugins ? Object.keys(getExtendedPassedProps(Object.assign({}, defaultProps, {\n    plugins: plugins\n  }))) : defaultKeys;\n  var props = propKeys.reduce(function (acc, key) {\n    var valueAsString = (reference.getAttribute(\"data-tippy-\" + key) || '').trim();\n\n    if (!valueAsString) {\n      return acc;\n    }\n\n    if (key === 'content') {\n      acc[key] = valueAsString;\n    } else {\n      try {\n        acc[key] = JSON.parse(valueAsString);\n      } catch (e) {\n        acc[key] = valueAsString;\n      }\n    }\n\n    return acc;\n  }, {});\n  return props;\n}\nfunction evaluateProps(reference, props) {\n  var out = Object.assign({}, props, {\n    content: invokeWithArgsOrReturn(props.content, [reference])\n  }, props.ignoreAttributes ? {} : getDataAttributeProps(reference, props.plugins));\n  out.aria = Object.assign({}, defaultProps.aria, {}, out.aria);\n  out.aria = {\n    expanded: out.aria.expanded === 'auto' ? props.interactive : out.aria.expanded,\n    content: out.aria.content === 'auto' ? props.interactive ? null : 'describedby' : out.aria.content\n  };\n  return out;\n}\nfunction validateProps(partialProps, plugins) {\n  if (partialProps === void 0) {\n    partialProps = {};\n  }\n\n  if (plugins === void 0) {\n    plugins = [];\n  }\n\n  var keys = Object.keys(partialProps);\n  keys.forEach(function (prop) {\n    var nonPluginProps = removeProperties(defaultProps, Object.keys(pluginProps));\n    var didPassUnknownProp = !hasOwnProperty(nonPluginProps, prop); // Check if the prop exists in `plugins`\n\n    if (didPassUnknownProp) {\n      didPassUnknownProp = plugins.filter(function (plugin) {\n        return plugin.name === prop;\n      }).length === 0;\n    }\n\n    warnWhen(didPassUnknownProp, [\"`\" + prop + \"`\", \"is not a valid prop. You may have spelled it incorrectly, or if it's\", 'a plugin, forgot to pass it in an array as props.plugins.', '\\n\\n', 'All props: https://atomiks.github.io/tippyjs/v6/all-props/\\n', 'Plugins: https://atomiks.github.io/tippyjs/v6/plugins/'].join(' '));\n  });\n}\n\nvar innerHTML = function innerHTML() {\n  return 'innerHTML';\n};\n\nfunction dangerouslySetInnerHTML(element, html) {\n  element[innerHTML()] = html;\n}\n\nfunction createArrowElement(value) {\n  var arrow = div();\n\n  if (value === true) {\n    arrow.className = ARROW_CLASS;\n  } else {\n    arrow.className = SVG_ARROW_CLASS;\n\n    if (isElement(value)) {\n      arrow.appendChild(value);\n    } else {\n      dangerouslySetInnerHTML(arrow, value);\n    }\n  }\n\n  return arrow;\n}\n\nfunction setContent(content, props) {\n  if (isElement(props.content)) {\n    dangerouslySetInnerHTML(content, '');\n    content.appendChild(props.content);\n  } else if (typeof props.content !== 'function') {\n    if (props.allowHTML) {\n      dangerouslySetInnerHTML(content, props.content);\n    } else {\n      content.textContent = props.content;\n    }\n  }\n}\nfunction getChildren(popper) {\n  var box = popper.firstElementChild;\n  var boxChildren = arrayFrom(box.children);\n  return {\n    box: box,\n    content: boxChildren.find(function (node) {\n      return node.classList.contains(CONTENT_CLASS);\n    }),\n    arrow: boxChildren.find(function (node) {\n      return node.classList.contains(ARROW_CLASS) || node.classList.contains(SVG_ARROW_CLASS);\n    }),\n    backdrop: boxChildren.find(function (node) {\n      return node.classList.contains(BACKDROP_CLASS);\n    })\n  };\n}\nfunction render(instance) {\n  var popper = div();\n  var box = div();\n  box.className = BOX_CLASS;\n  box.setAttribute('data-state', 'hidden');\n  box.setAttribute('tabindex', '-1');\n  var content = div();\n  content.className = CONTENT_CLASS;\n  content.setAttribute('data-state', 'hidden');\n  setContent(content, instance.props);\n  popper.appendChild(box);\n  box.appendChild(content);\n  onUpdate(instance.props, instance.props);\n\n  function onUpdate(prevProps, nextProps) {\n    var _getChildren = getChildren(popper),\n        box = _getChildren.box,\n        content = _getChildren.content,\n        arrow = _getChildren.arrow;\n\n    if (nextProps.theme) {\n      box.setAttribute('data-theme', nextProps.theme);\n    } else {\n      box.removeAttribute('data-theme');\n    }\n\n    if (typeof nextProps.animation === 'string') {\n      box.setAttribute('data-animation', nextProps.animation);\n    } else {\n      box.removeAttribute('data-animation');\n    }\n\n    if (nextProps.inertia) {\n      box.setAttribute('data-inertia', '');\n    } else {\n      box.removeAttribute('data-inertia');\n    }\n\n    box.style.maxWidth = typeof nextProps.maxWidth === 'number' ? nextProps.maxWidth + \"px\" : nextProps.maxWidth;\n\n    if (nextProps.role) {\n      box.setAttribute('role', nextProps.role);\n    } else {\n      box.removeAttribute('role');\n    }\n\n    if (prevProps.content !== nextProps.content || prevProps.allowHTML !== nextProps.allowHTML) {\n      setContent(content, instance.props);\n    }\n\n    if (nextProps.arrow) {\n      if (!arrow) {\n        box.appendChild(createArrowElement(nextProps.arrow));\n      } else if (prevProps.arrow !== nextProps.arrow) {\n        box.removeChild(arrow);\n        box.appendChild(createArrowElement(nextProps.arrow));\n      }\n    } else if (arrow) {\n      box.removeChild(arrow);\n    }\n  }\n\n  return {\n    popper: popper,\n    onUpdate: onUpdate\n  };\n} // Runtime check to identify if the render function is the default one; this\n// way we can apply default CSS transitions logic and it can be tree-shaken away\n\nrender.$$tippy = true;\n\nvar idCounter = 1;\nvar mouseMoveListeners = []; // Used by `hideAll()`\n\nvar mountedInstances = [];\nfunction createTippy(reference, passedProps) {\n  var props = evaluateProps(reference, Object.assign({}, defaultProps, {}, getExtendedPassedProps(passedProps))); // ===========================================================================\n  // 🔒 Private members\n  // ===========================================================================\n\n  var showTimeout;\n  var hideTimeout;\n  var scheduleHideAnimationFrame;\n  var isVisibleFromClick = false;\n  var didHideDueToDocumentMouseDown = false;\n  var didTouchMove = false;\n  var ignoreOnFirstUpdate = false;\n  var lastTriggerEvent;\n  var currentTransitionEndListener;\n  var onFirstUpdate;\n  var listeners = [];\n  var debouncedOnMouseMove = debounce(onMouseMove, props.interactiveDebounce);\n  var currentTarget;\n  var doc = getOwnerDocument(props.triggerTarget || reference); // ===========================================================================\n  // 🔑 Public members\n  // ===========================================================================\n\n  var id = idCounter++;\n  var popperInstance = null;\n  var plugins = unique(props.plugins);\n  var state = {\n    // Is the instance currently enabled?\n    isEnabled: true,\n    // Is the tippy currently showing and not transitioning out?\n    isVisible: false,\n    // Has the instance been destroyed?\n    isDestroyed: false,\n    // Is the tippy currently mounted to the DOM?\n    isMounted: false,\n    // Has the tippy finished transitioning in?\n    isShown: false\n  };\n  var instance = {\n    // properties\n    id: id,\n    reference: reference,\n    popper: div(),\n    popperInstance: popperInstance,\n    props: props,\n    state: state,\n    plugins: plugins,\n    // methods\n    clearDelayTimeouts: clearDelayTimeouts,\n    setProps: setProps,\n    setContent: setContent,\n    show: show,\n    hide: hide,\n    hideWithInteractivity: hideWithInteractivity,\n    enable: enable,\n    disable: disable,\n    unmount: unmount,\n    destroy: destroy\n  }; // TODO: Investigate why this early return causes a TDZ error in the tests —\n  // it doesn't seem to happen in the browser\n\n  /* istanbul ignore if */\n\n  if (!props.render) {\n    if (process.env.NODE_ENV !== \"production\") {\n      errorWhen(true, 'render() function has not been supplied.');\n    }\n\n    return instance;\n  } // ===========================================================================\n  // Initial mutations\n  // ===========================================================================\n\n\n  var _props$render = props.render(instance),\n      popper = _props$render.popper,\n      onUpdate = _props$render.onUpdate;\n\n  popper.setAttribute('data-tippy-root', '');\n  popper.id = \"tippy-\" + instance.id;\n  instance.popper = popper;\n  reference._tippy = instance;\n  popper._tippy = instance;\n  var pluginsHooks = plugins.map(function (plugin) {\n    return plugin.fn(instance);\n  });\n  var hasAriaExpanded = reference.hasAttribute('aria-expanded');\n  addListeners();\n  handleAriaExpandedAttribute();\n  handleStyles();\n  invokeHook('onCreate', [instance]);\n\n  if (props.showOnCreate) {\n    scheduleShow();\n  } // Prevent a tippy with a delay from hiding if the cursor left then returned\n  // before it started hiding\n\n\n  popper.addEventListener('mouseenter', function () {\n    if (instance.props.interactive && instance.state.isVisible) {\n      instance.clearDelayTimeouts();\n    }\n  });\n  popper.addEventListener('mouseleave', function (event) {\n    if (instance.props.interactive && instance.props.trigger.indexOf('mouseenter') >= 0) {\n      doc.addEventListener('mousemove', debouncedOnMouseMove);\n      debouncedOnMouseMove(event);\n    }\n  });\n  return instance; // ===========================================================================\n  // 🔒 Private methods\n  // ===========================================================================\n\n  function getNormalizedTouchSettings() {\n    var touch = instance.props.touch;\n    return Array.isArray(touch) ? touch : [touch, 0];\n  }\n\n  function getIsCustomTouchBehavior() {\n    return getNormalizedTouchSettings()[0] === 'hold';\n  }\n\n  function getIsDefaultRenderFn() {\n    var _instance$props$rende;\n\n    // @ts-ignore\n    return !!((_instance$props$rende = instance.props.render) == null ? void 0 : _instance$props$rende.$$tippy);\n  }\n\n  function getCurrentTarget() {\n    return currentTarget || reference;\n  }\n\n  function getDefaultTemplateChildren() {\n    return getChildren(popper);\n  }\n\n  function getDelay(isShow) {\n    // For touch or keyboard input, force `0` delay for UX reasons\n    // Also if the instance is mounted but not visible (transitioning out),\n    // ignore delay\n    if (instance.state.isMounted && !instance.state.isVisible || currentInput.isTouch || lastTriggerEvent && lastTriggerEvent.type === 'focus') {\n      return 0;\n    }\n\n    return getValueAtIndexOrReturn(instance.props.delay, isShow ? 0 : 1, defaultProps.delay);\n  }\n\n  function handleStyles() {\n    popper.style.pointerEvents = instance.props.interactive && instance.state.isVisible ? '' : 'none';\n    popper.style.zIndex = \"\" + instance.props.zIndex;\n  }\n\n  function invokeHook(hook, args, shouldInvokePropsHook) {\n    if (shouldInvokePropsHook === void 0) {\n      shouldInvokePropsHook = true;\n    }\n\n    pluginsHooks.forEach(function (pluginHooks) {\n      if (pluginHooks[hook]) {\n        pluginHooks[hook].apply(void 0, args);\n      }\n    });\n\n    if (shouldInvokePropsHook) {\n      var _instance$props;\n\n      (_instance$props = instance.props)[hook].apply(_instance$props, args);\n    }\n  }\n\n  function handleAriaContentAttribute() {\n    var aria = instance.props.aria;\n\n    if (!aria.content) {\n      return;\n    }\n\n    var attr = \"aria-\" + aria.content;\n    var id = popper.id;\n    var nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach(function (node) {\n      var currentValue = node.getAttribute(attr);\n\n      if (instance.state.isVisible) {\n        node.setAttribute(attr, currentValue ? currentValue + \" \" + id : id);\n      } else {\n        var nextValue = currentValue && currentValue.replace(id, '').trim();\n\n        if (nextValue) {\n          node.setAttribute(attr, nextValue);\n        } else {\n          node.removeAttribute(attr);\n        }\n      }\n    });\n  }\n\n  function handleAriaExpandedAttribute() {\n    if (hasAriaExpanded || !instance.props.aria.expanded) {\n      return;\n    }\n\n    var nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach(function (node) {\n      if (instance.props.interactive) {\n        node.setAttribute('aria-expanded', instance.state.isVisible && node === getCurrentTarget() ? 'true' : 'false');\n      } else {\n        node.removeAttribute('aria-expanded');\n      }\n    });\n  }\n\n  function cleanupInteractiveMouseListeners() {\n    doc.body.removeEventListener('mouseleave', scheduleHide);\n    doc.removeEventListener('mousemove', debouncedOnMouseMove);\n    mouseMoveListeners = mouseMoveListeners.filter(function (listener) {\n      return listener !== debouncedOnMouseMove;\n    });\n  }\n\n  function onDocumentPress(event) {\n    // Moved finger to scroll instead of an intentional tap outside\n    if (currentInput.isTouch) {\n      if (didTouchMove || event.type === 'mousedown') {\n        return;\n      }\n    } // Clicked on interactive popper\n\n\n    if (instance.props.interactive && popper.contains(event.target)) {\n      return;\n    } // Clicked on the event listeners target\n\n\n    if (getCurrentTarget().contains(event.target)) {\n      if (currentInput.isTouch) {\n        return;\n      }\n\n      if (instance.state.isVisible && instance.props.trigger.indexOf('click') >= 0) {\n        return;\n      }\n    } else {\n      invokeHook('onClickOutside', [instance, event]);\n    }\n\n    if (instance.props.hideOnClick === true) {\n      isVisibleFromClick = false;\n      instance.clearDelayTimeouts();\n      instance.hide(); // `mousedown` event is fired right before `focus` if pressing the\n      // currentTarget. This lets a tippy with `focus` trigger know that it\n      // should not show\n\n      didHideDueToDocumentMouseDown = true;\n      setTimeout(function () {\n        didHideDueToDocumentMouseDown = false;\n      }); // The listener gets added in `scheduleShow()`, but this may be hiding it\n      // before it shows, and hide()'s early bail-out behavior can prevent it\n      // from being cleaned up\n\n      if (!instance.state.isMounted) {\n        removeDocumentPress();\n      }\n    }\n  }\n\n  function onTouchMove() {\n    didTouchMove = true;\n  }\n\n  function onTouchStart() {\n    didTouchMove = false;\n  }\n\n  function addDocumentPress() {\n    doc.addEventListener('mousedown', onDocumentPress, true);\n    doc.addEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);\n    doc.addEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);\n    doc.addEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);\n  }\n\n  function removeDocumentPress() {\n    doc.removeEventListener('mousedown', onDocumentPress, true);\n    doc.removeEventListener('touchend', onDocumentPress, TOUCH_OPTIONS);\n    doc.removeEventListener('touchstart', onTouchStart, TOUCH_OPTIONS);\n    doc.removeEventListener('touchmove', onTouchMove, TOUCH_OPTIONS);\n  }\n\n  function onTransitionedOut(duration, callback) {\n    onTransitionEnd(duration, function () {\n      if (!instance.state.isVisible && popper.parentNode && popper.parentNode.contains(popper)) {\n        callback();\n      }\n    });\n  }\n\n  function onTransitionedIn(duration, callback) {\n    onTransitionEnd(duration, callback);\n  }\n\n  function onTransitionEnd(duration, callback) {\n    var box = getDefaultTemplateChildren().box;\n\n    function listener(event) {\n      if (event.target === box) {\n        updateTransitionEndListener(box, 'remove', listener);\n        callback();\n      }\n    } // Make callback synchronous if duration is 0\n    // `transitionend` won't fire otherwise\n\n\n    if (duration === 0) {\n      return callback();\n    }\n\n    updateTransitionEndListener(box, 'remove', currentTransitionEndListener);\n    updateTransitionEndListener(box, 'add', listener);\n    currentTransitionEndListener = listener;\n  }\n\n  function on(eventType, handler, options) {\n    if (options === void 0) {\n      options = false;\n    }\n\n    var nodes = normalizeToArray(instance.props.triggerTarget || reference);\n    nodes.forEach(function (node) {\n      node.addEventListener(eventType, handler, options);\n      listeners.push({\n        node: node,\n        eventType: eventType,\n        handler: handler,\n        options: options\n      });\n    });\n  }\n\n  function addListeners() {\n    if (getIsCustomTouchBehavior()) {\n      on('touchstart', onTrigger, {\n        passive: true\n      });\n      on('touchend', onMouseLeave, {\n        passive: true\n      });\n    }\n\n    splitBySpaces(instance.props.trigger).forEach(function (eventType) {\n      if (eventType === 'manual') {\n        return;\n      }\n\n      on(eventType, onTrigger);\n\n      switch (eventType) {\n        case 'mouseenter':\n          on('mouseleave', onMouseLeave);\n          break;\n\n        case 'focus':\n          on(isIE ? 'focusout' : 'blur', onBlurOrFocusOut);\n          break;\n\n        case 'focusin':\n          on('focusout', onBlurOrFocusOut);\n          break;\n      }\n    });\n  }\n\n  function removeListeners() {\n    listeners.forEach(function (_ref) {\n      var node = _ref.node,\n          eventType = _ref.eventType,\n          handler = _ref.handler,\n          options = _ref.options;\n      node.removeEventListener(eventType, handler, options);\n    });\n    listeners = [];\n  }\n\n  function onTrigger(event) {\n    var _lastTriggerEvent;\n\n    var shouldScheduleClickHide = false;\n\n    if (!instance.state.isEnabled || isEventListenerStopped(event) || didHideDueToDocumentMouseDown) {\n      return;\n    }\n\n    var wasFocused = ((_lastTriggerEvent = lastTriggerEvent) == null ? void 0 : _lastTriggerEvent.type) === 'focus';\n    lastTriggerEvent = event;\n    currentTarget = event.currentTarget;\n    handleAriaExpandedAttribute();\n\n    if (!instance.state.isVisible && isMouseEvent(event)) {\n      // If scrolling, `mouseenter` events can be fired if the cursor lands\n      // over a new target, but `mousemove` events don't get fired. This\n      // causes interactive tooltips to get stuck open until the cursor is\n      // moved\n      mouseMoveListeners.forEach(function (listener) {\n        return listener(event);\n      });\n    } // Toggle show/hide when clicking click-triggered tooltips\n\n\n    if (event.type === 'click' && (instance.props.trigger.indexOf('mouseenter') < 0 || isVisibleFromClick) && instance.props.hideOnClick !== false && instance.state.isVisible) {\n      shouldScheduleClickHide = true;\n    } else {\n      scheduleShow(event);\n    }\n\n    if (event.type === 'click') {\n      isVisibleFromClick = !shouldScheduleClickHide;\n    }\n\n    if (shouldScheduleClickHide && !wasFocused) {\n      scheduleHide(event);\n    }\n  }\n\n  function onMouseMove(event) {\n    var target = event.target;\n    var isCursorOverReferenceOrPopper = reference.contains(target) || popper.contains(target);\n\n    if (event.type === 'mousemove' && isCursorOverReferenceOrPopper) {\n      return;\n    }\n\n    var popperTreeData = getNestedPopperTree().concat(popper).map(function (popper) {\n      var _instance$popperInsta;\n\n      var instance = popper._tippy;\n      var state = (_instance$popperInsta = instance.popperInstance) == null ? void 0 : _instance$popperInsta.state;\n\n      if (state) {\n        return {\n          popperRect: popper.getBoundingClientRect(),\n          popperState: state,\n          props: props\n        };\n      }\n\n      return null;\n    }).filter(Boolean);\n\n    if (isCursorOutsideInteractiveBorder(popperTreeData, event)) {\n      cleanupInteractiveMouseListeners();\n      scheduleHide(event);\n    }\n  }\n\n  function onMouseLeave(event) {\n    var shouldBail = isEventListenerStopped(event) || instance.props.trigger.indexOf('click') >= 0 && isVisibleFromClick;\n\n    if (shouldBail) {\n      return;\n    }\n\n    if (instance.props.interactive) {\n      instance.hideWithInteractivity(event);\n      return;\n    }\n\n    scheduleHide(event);\n  }\n\n  function onBlurOrFocusOut(event) {\n    if (instance.props.trigger.indexOf('focusin') < 0 && event.target !== getCurrentTarget()) {\n      return;\n    } // If focus was moved to within the popper\n\n\n    if (instance.props.interactive && event.relatedTarget && popper.contains(event.relatedTarget)) {\n      return;\n    }\n\n    scheduleHide(event);\n  }\n\n  function isEventListenerStopped(event) {\n    return currentInput.isTouch ? getIsCustomTouchBehavior() !== event.type.indexOf('touch') >= 0 : false;\n  }\n\n  function createPopperInstance() {\n    destroyPopperInstance();\n    var _instance$props2 = instance.props,\n        popperOptions = _instance$props2.popperOptions,\n        placement = _instance$props2.placement,\n        offset = _instance$props2.offset,\n        getReferenceClientRect = _instance$props2.getReferenceClientRect,\n        moveTransition = _instance$props2.moveTransition;\n    var arrow = getIsDefaultRenderFn() ? getChildren(popper).arrow : null;\n    var computedReference = getReferenceClientRect ? {\n      getBoundingClientRect: getReferenceClientRect,\n      contextElement: getReferenceClientRect.contextElement || getCurrentTarget()\n    } : reference;\n    var tippyModifier = {\n      name: '$$tippy',\n      enabled: true,\n      phase: 'beforeWrite',\n      requires: ['computeStyles'],\n      fn: function fn(_ref2) {\n        var state = _ref2.state;\n\n        if (getIsDefaultRenderFn()) {\n          var _getDefaultTemplateCh = getDefaultTemplateChildren(),\n              box = _getDefaultTemplateCh.box;\n\n          ['placement', 'reference-hidden', 'escaped'].forEach(function (attr) {\n            if (attr === 'placement') {\n              box.setAttribute('data-placement', state.placement);\n            } else {\n              if (state.attributes.popper[\"data-popper-\" + attr]) {\n                box.setAttribute(\"data-\" + attr, '');\n              } else {\n                box.removeAttribute(\"data-\" + attr);\n              }\n            }\n          });\n          state.attributes.popper = {};\n        }\n      }\n    };\n    var modifiers = [{\n      name: 'offset',\n      options: {\n        offset: offset\n      }\n    }, {\n      name: 'preventOverflow',\n      options: {\n        padding: {\n          top: 2,\n          bottom: 2,\n          left: 5,\n          right: 5\n        }\n      }\n    }, {\n      name: 'flip',\n      options: {\n        padding: 5\n      }\n    }, {\n      name: 'computeStyles',\n      options: {\n        adaptive: !moveTransition\n      }\n    }, tippyModifier];\n\n    if (getIsDefaultRenderFn() && arrow) {\n      modifiers.push({\n        name: 'arrow',\n        options: {\n          element: arrow,\n          padding: 3\n        }\n      });\n    }\n\n    modifiers.push.apply(modifiers, (popperOptions == null ? void 0 : popperOptions.modifiers) || []);\n    instance.popperInstance = createPopper(computedReference, popper, Object.assign({}, popperOptions, {\n      placement: placement,\n      onFirstUpdate: onFirstUpdate,\n      modifiers: modifiers\n    }));\n  }\n\n  function destroyPopperInstance() {\n    if (instance.popperInstance) {\n      instance.popperInstance.destroy();\n      instance.popperInstance = null;\n    }\n  }\n\n  function mount() {\n    var appendTo = instance.props.appendTo;\n    var parentNode; // By default, we'll append the popper to the triggerTargets's parentNode so\n    // it's directly after the reference element so the elements inside the\n    // tippy can be tabbed to\n    // If there are clipping issues, the user can specify a different appendTo\n    // and ensure focus management is handled correctly manually\n\n    var node = getCurrentTarget();\n\n    if (instance.props.interactive && appendTo === defaultProps.appendTo || appendTo === 'parent') {\n      parentNode = node.parentNode;\n    } else {\n      parentNode = invokeWithArgsOrReturn(appendTo, [node]);\n    } // The popper element needs to exist on the DOM before its position can be\n    // updated as Popper needs to read its dimensions\n\n\n    if (!parentNode.contains(popper)) {\n      parentNode.appendChild(popper);\n    }\n\n    createPopperInstance();\n    /* istanbul ignore else */\n\n    if (process.env.NODE_ENV !== \"production\") {\n      // Accessibility check\n      warnWhen(instance.props.interactive && appendTo === defaultProps.appendTo && node.nextElementSibling !== popper, ['Interactive tippy element may not be accessible via keyboard', 'navigation because it is not directly after the reference element', 'in the DOM source order.', '\\n\\n', 'Using a wrapper <div> or <span> tag around the reference element', 'solves this by creating a new parentNode context.', '\\n\\n', 'Specifying `appendTo: document.body` silences this warning, but it', 'assumes you are using a focus management solution to handle', 'keyboard navigation.', '\\n\\n', 'See: https://atomiks.github.io/tippyjs/v6/accessibility/#interactivity'].join(' '));\n    }\n  }\n\n  function getNestedPopperTree() {\n    return arrayFrom(popper.querySelectorAll('[data-tippy-root]'));\n  }\n\n  function scheduleShow(event) {\n    instance.clearDelayTimeouts();\n\n    if (event) {\n      invokeHook('onTrigger', [instance, event]);\n    }\n\n    addDocumentPress();\n    var delay = getDelay(true);\n\n    var _getNormalizedTouchSe = getNormalizedTouchSettings(),\n        touchValue = _getNormalizedTouchSe[0],\n        touchDelay = _getNormalizedTouchSe[1];\n\n    if (currentInput.isTouch && touchValue === 'hold' && touchDelay) {\n      delay = touchDelay;\n    }\n\n    if (delay) {\n      showTimeout = setTimeout(function () {\n        instance.show();\n      }, delay);\n    } else {\n      instance.show();\n    }\n  }\n\n  function scheduleHide(event) {\n    instance.clearDelayTimeouts();\n    invokeHook('onUntrigger', [instance, event]);\n\n    if (!instance.state.isVisible) {\n      removeDocumentPress();\n      return;\n    } // For interactive tippies, scheduleHide is added to a document.body handler\n    // from onMouseLeave so must intercept scheduled hides from mousemove/leave\n    // events when trigger contains mouseenter and click, and the tip is\n    // currently shown as a result of a click.\n\n\n    if (instance.props.trigger.indexOf('mouseenter') >= 0 && instance.props.trigger.indexOf('click') >= 0 && ['mouseleave', 'mousemove'].indexOf(event.type) >= 0 && isVisibleFromClick) {\n      return;\n    }\n\n    var delay = getDelay(false);\n\n    if (delay) {\n      hideTimeout = setTimeout(function () {\n        if (instance.state.isVisible) {\n          instance.hide();\n        }\n      }, delay);\n    } else {\n      // Fixes a `transitionend` problem when it fires 1 frame too\n      // late sometimes, we don't want hide() to be called.\n      scheduleHideAnimationFrame = requestAnimationFrame(function () {\n        instance.hide();\n      });\n    }\n  } // ===========================================================================\n  // 🔑 Public methods\n  // ===========================================================================\n\n\n  function enable() {\n    instance.state.isEnabled = true;\n  }\n\n  function disable() {\n    // Disabling the instance should also hide it\n    // https://github.com/atomiks/tippy.js-react/issues/106\n    instance.hide();\n    instance.state.isEnabled = false;\n  }\n\n  function clearDelayTimeouts() {\n    clearTimeout(showTimeout);\n    clearTimeout(hideTimeout);\n    cancelAnimationFrame(scheduleHideAnimationFrame);\n  }\n\n  function setProps(partialProps) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('setProps'));\n    }\n\n    if (instance.state.isDestroyed) {\n      return;\n    }\n\n    invokeHook('onBeforeUpdate', [instance, partialProps]);\n    removeListeners();\n    var prevProps = instance.props;\n    var nextProps = evaluateProps(reference, Object.assign({}, instance.props, {}, partialProps, {\n      ignoreAttributes: true\n    }));\n    instance.props = nextProps;\n    addListeners();\n\n    if (prevProps.interactiveDebounce !== nextProps.interactiveDebounce) {\n      cleanupInteractiveMouseListeners();\n      debouncedOnMouseMove = debounce(onMouseMove, nextProps.interactiveDebounce);\n    } // Ensure stale aria-expanded attributes are removed\n\n\n    if (prevProps.triggerTarget && !nextProps.triggerTarget) {\n      normalizeToArray(prevProps.triggerTarget).forEach(function (node) {\n        node.removeAttribute('aria-expanded');\n      });\n    } else if (nextProps.triggerTarget) {\n      reference.removeAttribute('aria-expanded');\n    }\n\n    handleAriaExpandedAttribute();\n    handleStyles();\n\n    if (onUpdate) {\n      onUpdate(prevProps, nextProps);\n    }\n\n    if (instance.popperInstance) {\n      createPopperInstance(); // Fixes an issue with nested tippies if they are all getting re-rendered,\n      // and the nested ones get re-rendered first.\n      // https://github.com/atomiks/tippyjs-react/issues/177\n      // TODO: find a cleaner / more efficient solution(!)\n\n      getNestedPopperTree().forEach(function (nestedPopper) {\n        // React (and other UI libs likely) requires a rAF wrapper as it flushes\n        // its work in one\n        requestAnimationFrame(nestedPopper._tippy.popperInstance.forceUpdate);\n      });\n    }\n\n    invokeHook('onAfterUpdate', [instance, partialProps]);\n  }\n\n  function setContent(content) {\n    instance.setProps({\n      content: content\n    });\n  }\n\n  function show() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('show'));\n    } // Early bail-out\n\n\n    var isAlreadyVisible = instance.state.isVisible;\n    var isDestroyed = instance.state.isDestroyed;\n    var isDisabled = !instance.state.isEnabled;\n    var isTouchAndTouchDisabled = currentInput.isTouch && !instance.props.touch;\n    var duration = getValueAtIndexOrReturn(instance.props.duration, 0, defaultProps.duration);\n\n    if (isAlreadyVisible || isDestroyed || isDisabled || isTouchAndTouchDisabled) {\n      return;\n    } // Normalize `disabled` behavior across browsers.\n    // Firefox allows events on disabled elements, but Chrome doesn't.\n    // Using a wrapper element (i.e. <span>) is recommended.\n\n\n    if (getCurrentTarget().hasAttribute('disabled')) {\n      return;\n    }\n\n    invokeHook('onShow', [instance], false);\n\n    if (instance.props.onShow(instance) === false) {\n      return;\n    }\n\n    instance.state.isVisible = true;\n\n    if (getIsDefaultRenderFn()) {\n      popper.style.visibility = 'visible';\n    }\n\n    handleStyles();\n    addDocumentPress();\n\n    if (!instance.state.isMounted) {\n      popper.style.transition = 'none';\n    } // If flipping to the opposite side after hiding at least once, the\n    // animation will use the wrong placement without resetting the duration\n\n\n    if (getIsDefaultRenderFn()) {\n      var _getDefaultTemplateCh2 = getDefaultTemplateChildren(),\n          box = _getDefaultTemplateCh2.box,\n          content = _getDefaultTemplateCh2.content;\n\n      setTransitionDuration([box, content], 0);\n    }\n\n    onFirstUpdate = function onFirstUpdate() {\n      if (!instance.state.isVisible || ignoreOnFirstUpdate) {\n        return;\n      }\n\n      ignoreOnFirstUpdate = true; // reflow\n\n      void popper.offsetHeight;\n      popper.style.transition = instance.props.moveTransition;\n\n      if (getIsDefaultRenderFn() && instance.props.animation) {\n        var _getDefaultTemplateCh3 = getDefaultTemplateChildren(),\n            _box = _getDefaultTemplateCh3.box,\n            _content = _getDefaultTemplateCh3.content;\n\n        setTransitionDuration([_box, _content], duration);\n        setVisibilityState([_box, _content], 'visible');\n      }\n\n      handleAriaContentAttribute();\n      handleAriaExpandedAttribute();\n      pushIfUnique(mountedInstances, instance);\n      instance.state.isMounted = true;\n      invokeHook('onMount', [instance]);\n\n      if (instance.props.animation && getIsDefaultRenderFn()) {\n        onTransitionedIn(duration, function () {\n          instance.state.isShown = true;\n          invokeHook('onShown', [instance]);\n        });\n      }\n    };\n\n    mount();\n  }\n\n  function hide() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hide'));\n    } // Early bail-out\n\n\n    var isAlreadyHidden = !instance.state.isVisible;\n    var isDestroyed = instance.state.isDestroyed;\n    var isDisabled = !instance.state.isEnabled;\n    var duration = getValueAtIndexOrReturn(instance.props.duration, 1, defaultProps.duration);\n\n    if (isAlreadyHidden || isDestroyed || isDisabled) {\n      return;\n    }\n\n    invokeHook('onHide', [instance], false);\n\n    if (instance.props.onHide(instance) === false) {\n      return;\n    }\n\n    instance.state.isVisible = false;\n    instance.state.isShown = false;\n    ignoreOnFirstUpdate = false;\n\n    if (getIsDefaultRenderFn()) {\n      popper.style.visibility = 'hidden';\n    }\n\n    cleanupInteractiveMouseListeners();\n    removeDocumentPress();\n    handleStyles();\n\n    if (getIsDefaultRenderFn()) {\n      var _getDefaultTemplateCh4 = getDefaultTemplateChildren(),\n          box = _getDefaultTemplateCh4.box,\n          content = _getDefaultTemplateCh4.content;\n\n      if (instance.props.animation) {\n        setTransitionDuration([box, content], duration);\n        setVisibilityState([box, content], 'hidden');\n      }\n    }\n\n    handleAriaContentAttribute();\n    handleAriaExpandedAttribute();\n\n    if (instance.props.animation) {\n      if (getIsDefaultRenderFn()) {\n        onTransitionedOut(duration, instance.unmount);\n      }\n    } else {\n      instance.unmount();\n    }\n  }\n\n  function hideWithInteractivity(event) {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('hideWithInteractivity'));\n    }\n\n    doc.body.addEventListener('mouseleave', scheduleHide);\n    doc.addEventListener('mousemove', debouncedOnMouseMove);\n    pushIfUnique(mouseMoveListeners, debouncedOnMouseMove);\n    debouncedOnMouseMove(event);\n  }\n\n  function unmount() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('unmount'));\n    }\n\n    if (instance.state.isVisible) {\n      instance.hide();\n    }\n\n    if (!instance.state.isMounted) {\n      return;\n    }\n\n    destroyPopperInstance(); // If a popper is not interactive, it will be appended outside the popper\n    // tree by default. This seems mainly for interactive tippies, but we should\n    // find a workaround if possible\n\n    getNestedPopperTree().forEach(function (nestedPopper) {\n      nestedPopper._tippy.unmount();\n    });\n\n    if (popper.parentNode) {\n      popper.parentNode.removeChild(popper);\n    }\n\n    mountedInstances = mountedInstances.filter(function (i) {\n      return i !== instance;\n    });\n    instance.state.isMounted = false;\n    invokeHook('onHidden', [instance]);\n  }\n\n  function destroy() {\n    /* istanbul ignore else */\n    if (process.env.NODE_ENV !== \"production\") {\n      warnWhen(instance.state.isDestroyed, createMemoryLeakWarning('destroy'));\n    }\n\n    if (instance.state.isDestroyed) {\n      return;\n    }\n\n    instance.clearDelayTimeouts();\n    instance.unmount();\n    removeListeners();\n    delete reference._tippy;\n    instance.state.isDestroyed = true;\n    invokeHook('onDestroy', [instance]);\n  }\n}\n\nfunction tippy(targets, optionalProps) {\n  if (optionalProps === void 0) {\n    optionalProps = {};\n  }\n\n  var plugins = defaultProps.plugins.concat(optionalProps.plugins || []);\n  /* istanbul ignore else */\n\n  if (process.env.NODE_ENV !== \"production\") {\n    validateTargets(targets);\n    validateProps(optionalProps, plugins);\n  }\n\n  bindGlobalEventListeners();\n  var passedProps = Object.assign({}, optionalProps, {\n    plugins: plugins\n  });\n  var elements = getArrayOfElements(targets);\n  /* istanbul ignore else */\n\n  if (process.env.NODE_ENV !== \"production\") {\n    var isSingleContentElement = isElement(passedProps.content);\n    var isMoreThanOneReferenceElement = elements.length > 1;\n    warnWhen(isSingleContentElement && isMoreThanOneReferenceElement, ['tippy() was passed an Element as the `content` prop, but more than', 'one tippy instance was created by this invocation. This means the', 'content element will only be appended to the last tippy instance.', '\\n\\n', 'Instead, pass the .innerHTML of the element, or use a function that', 'returns a cloned version of the element instead.', '\\n\\n', '1) content: element.innerHTML\\n', '2) content: () => element.cloneNode(true)'].join(' '));\n  }\n\n  var instances = elements.reduce(function (acc, reference) {\n    var instance = reference && createTippy(reference, passedProps);\n\n    if (instance) {\n      acc.push(instance);\n    }\n\n    return acc;\n  }, []);\n  return isElement(targets) ? instances[0] : instances;\n}\n\ntippy.defaultProps = defaultProps;\ntippy.setDefaultProps = setDefaultProps;\ntippy.currentInput = currentInput;\nvar hideAll = function hideAll(_temp) {\n  var _ref = _temp === void 0 ? {} : _temp,\n      excludedReferenceOrInstance = _ref.exclude,\n      duration = _ref.duration;\n\n  mountedInstances.forEach(function (instance) {\n    var isExcluded = false;\n\n    if (excludedReferenceOrInstance) {\n      isExcluded = isReferenceElement(excludedReferenceOrInstance) ? instance.reference === excludedReferenceOrInstance : instance.popper === excludedReferenceOrInstance.popper;\n    }\n\n    if (!isExcluded) {\n      var originalDuration = instance.props.duration;\n      instance.setProps({\n        duration: duration\n      });\n      instance.hide();\n\n      if (!instance.state.isDestroyed) {\n        instance.setProps({\n          duration: originalDuration\n        });\n      }\n    }\n  });\n};\n\nvar createSingleton = function createSingleton(tippyInstances, optionalProps) {\n  if (optionalProps === void 0) {\n    optionalProps = {};\n  }\n\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== \"production\") {\n    errorWhen(!Array.isArray(tippyInstances), ['The first argument passed to createSingleton() must be an array of', 'tippy instances. The passed value was', String(tippyInstances)].join(' '));\n  }\n\n  var mutTippyInstances = tippyInstances;\n  var references = [];\n  var currentTarget;\n  var overrides = optionalProps.overrides;\n\n  function setReferences() {\n    references = mutTippyInstances.map(function (instance) {\n      return instance.reference;\n    });\n  }\n\n  function enableInstances(isEnabled) {\n    mutTippyInstances.forEach(function (instance) {\n      if (isEnabled) {\n        instance.enable();\n      } else {\n        instance.disable();\n      }\n    });\n  }\n\n  enableInstances(false);\n  setReferences();\n  var singleton = {\n    fn: function fn() {\n      return {\n        onDestroy: function onDestroy() {\n          enableInstances(true);\n        },\n        onTrigger: function onTrigger(instance, event) {\n          var target = event.currentTarget;\n          var index = references.indexOf(target); // bail-out\n\n          if (target === currentTarget) {\n            return;\n          }\n\n          currentTarget = target;\n          var overrideProps = (overrides || []).concat('content').reduce(function (acc, prop) {\n            acc[prop] = mutTippyInstances[index].props[prop];\n            return acc;\n          }, {});\n          instance.setProps(Object.assign({}, overrideProps, {\n            getReferenceClientRect: function getReferenceClientRect() {\n              return target.getBoundingClientRect();\n            }\n          }));\n        }\n      };\n    }\n  };\n  var instance = tippy(div(), Object.assign({}, removeProperties(optionalProps, ['overrides']), {\n    plugins: [singleton].concat(optionalProps.plugins || []),\n    triggerTarget: references\n  }));\n  var originalSetProps = instance.setProps;\n\n  instance.setProps = function (props) {\n    overrides = props.overrides || overrides;\n    originalSetProps(props);\n  };\n\n  instance.setInstances = function (nextInstances) {\n    enableInstances(true);\n    mutTippyInstances = nextInstances;\n    enableInstances(false);\n    setReferences();\n    instance.setProps({\n      triggerTarget: references\n    });\n  };\n\n  return instance;\n};\n\nvar BUBBLING_EVENTS_MAP = {\n  mouseover: 'mouseenter',\n  focusin: 'focus',\n  click: 'click'\n};\n/**\n * Creates a delegate instance that controls the creation of tippy instances\n * for child elements (`target` CSS selector).\n */\n\nfunction delegate(targets, props) {\n  /* istanbul ignore else */\n  if (process.env.NODE_ENV !== \"production\") {\n    errorWhen(!(props && props.target), ['You must specity a `target` prop indicating a CSS selector string matching', 'the target elements that should receive a tippy.'].join(' '));\n  }\n\n  var listeners = [];\n  var childTippyInstances = [];\n  var target = props.target;\n  var nativeProps = removeProperties(props, ['target']);\n  var parentProps = Object.assign({}, nativeProps, {\n    trigger: 'manual',\n    touch: false\n  });\n  var childProps = Object.assign({}, nativeProps, {\n    showOnCreate: true\n  });\n  var returnValue = tippy(targets, parentProps);\n  var normalizedReturnValue = normalizeToArray(returnValue);\n\n  function onTrigger(event) {\n    if (!event.target) {\n      return;\n    }\n\n    var targetNode = event.target.closest(target);\n\n    if (!targetNode) {\n      return;\n    } // Get relevant trigger with fallbacks:\n    // 1. Check `data-tippy-trigger` attribute on target node\n    // 2. Fallback to `trigger` passed to `delegate()`\n    // 3. Fallback to `defaultProps.trigger`\n\n\n    var trigger = targetNode.getAttribute('data-tippy-trigger') || props.trigger || defaultProps.trigger; // @ts-ignore\n\n    if (targetNode._tippy) {\n      return;\n    }\n\n    if (event.type === 'touchstart' && typeof childProps.touch === 'boolean') {\n      return;\n    }\n\n    if (event.type !== 'touchstart' && trigger.indexOf(BUBBLING_EVENTS_MAP[event.type])) {\n      return;\n    }\n\n    var instance = tippy(targetNode, childProps);\n\n    if (instance) {\n      childTippyInstances = childTippyInstances.concat(instance);\n    }\n  }\n\n  function on(node, eventType, handler, options) {\n    if (options === void 0) {\n      options = false;\n    }\n\n    node.addEventListener(eventType, handler, options);\n    listeners.push({\n      node: node,\n      eventType: eventType,\n      handler: handler,\n      options: options\n    });\n  }\n\n  function addEventListeners(instance) {\n    var reference = instance.reference;\n    on(reference, 'touchstart', onTrigger);\n    on(reference, 'mouseover', onTrigger);\n    on(reference, 'focusin', onTrigger);\n    on(reference, 'click', onTrigger);\n  }\n\n  function removeEventListeners() {\n    listeners.forEach(function (_ref) {\n      var node = _ref.node,\n          eventType = _ref.eventType,\n          handler = _ref.handler,\n          options = _ref.options;\n      node.removeEventListener(eventType, handler, options);\n    });\n    listeners = [];\n  }\n\n  function applyMutations(instance) {\n    var originalDestroy = instance.destroy;\n\n    instance.destroy = function (shouldDestroyChildInstances) {\n      if (shouldDestroyChildInstances === void 0) {\n        shouldDestroyChildInstances = true;\n      }\n\n      if (shouldDestroyChildInstances) {\n        childTippyInstances.forEach(function (instance) {\n          instance.destroy();\n        });\n      }\n\n      childTippyInstances = [];\n      removeEventListeners();\n      originalDestroy();\n    };\n\n    addEventListeners(instance);\n  }\n\n  normalizedReturnValue.forEach(applyMutations);\n  return returnValue;\n}\n\nvar animateFill = {\n  name: 'animateFill',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var _instance$props$rende;\n\n    // @ts-ignore\n    if (!((_instance$props$rende = instance.props.render) == null ? void 0 : _instance$props$rende.$$tippy)) {\n      if (process.env.NODE_ENV !== \"production\") {\n        errorWhen(instance.props.animateFill, 'The `animateFill` plugin requires the default render function.');\n      }\n\n      return {};\n    }\n\n    var _getChildren = getChildren(instance.popper),\n        box = _getChildren.box,\n        content = _getChildren.content;\n\n    var backdrop = instance.props.animateFill ? createBackdropElement() : null;\n    return {\n      onCreate: function onCreate() {\n        if (backdrop) {\n          box.insertBefore(backdrop, box.firstElementChild);\n          box.setAttribute('data-animatefill', '');\n          box.style.overflow = 'hidden';\n          instance.setProps({\n            arrow: false,\n            animation: 'shift-away'\n          });\n        }\n      },\n      onMount: function onMount() {\n        if (backdrop) {\n          var transitionDuration = box.style.transitionDuration;\n          var duration = Number(transitionDuration.replace('ms', '')); // The content should fade in after the backdrop has mostly filled the\n          // tooltip element. `clip-path` is the other alternative but is not\n          // well-supported and is buggy on some devices.\n\n          content.style.transitionDelay = Math.round(duration / 10) + \"ms\";\n          backdrop.style.transitionDuration = transitionDuration;\n          setVisibilityState([backdrop], 'visible');\n        }\n      },\n      onShow: function onShow() {\n        if (backdrop) {\n          backdrop.style.transitionDuration = '0ms';\n        }\n      },\n      onHide: function onHide() {\n        if (backdrop) {\n          setVisibilityState([backdrop], 'hidden');\n        }\n      }\n    };\n  }\n};\n\nfunction createBackdropElement() {\n  var backdrop = div();\n  backdrop.className = BACKDROP_CLASS;\n  setVisibilityState([backdrop], 'hidden');\n  return backdrop;\n}\n\nvar followCursor = {\n  name: 'followCursor',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var reference = instance.reference;\n    var doc = getOwnerDocument(instance.props.triggerTarget || reference);\n    var initialMouseCoords = null;\n\n    function getIsManual() {\n      return instance.props.trigger.trim() === 'manual';\n    }\n\n    function getIsEnabled() {\n      // #597\n      var isValidMouseEvent = getIsManual() ? true : // Check if a keyboard \"click\"\n      initialMouseCoords !== null && !(initialMouseCoords.clientX === 0 && initialMouseCoords.clientY === 0);\n      return instance.props.followCursor && isValidMouseEvent;\n    }\n\n    function getIsInitialBehavior() {\n      return currentInput.isTouch || instance.props.followCursor === 'initial' && instance.state.isVisible;\n    }\n\n    function unsetReferenceClientRect(shouldUnset) {\n      if (shouldUnset) {\n        instance.setProps({\n          getReferenceClientRect: null\n        });\n      }\n    }\n\n    function handleMouseMoveListener() {\n      if (getIsEnabled()) {\n        addListener();\n      } else {\n        unsetReferenceClientRect(instance.props.followCursor);\n      }\n    }\n\n    function triggerLastMouseMove() {\n      if (getIsEnabled()) {\n        onMouseMove(initialMouseCoords);\n      }\n    }\n\n    function addListener() {\n      doc.addEventListener('mousemove', onMouseMove);\n    }\n\n    function removeListener() {\n      doc.removeEventListener('mousemove', onMouseMove);\n    }\n\n    function onMouseMove(event) {\n      initialMouseCoords = {\n        clientX: event.clientX,\n        clientY: event.clientY\n      }; // If the instance is interactive, avoid updating the position unless it's\n      // over the reference element\n\n      var isCursorOverReference = event.target ? reference.contains(event.target) : true;\n      var followCursor = instance.props.followCursor;\n      var clientX = event.clientX,\n          clientY = event.clientY;\n      var rect = reference.getBoundingClientRect();\n      var relativeX = clientX - rect.left;\n      var relativeY = clientY - rect.top;\n\n      if (isCursorOverReference || !instance.props.interactive) {\n        instance.setProps({\n          getReferenceClientRect: function getReferenceClientRect() {\n            var rect = reference.getBoundingClientRect();\n            var x = clientX;\n            var y = clientY;\n\n            if (followCursor === 'initial') {\n              x = rect.left + relativeX;\n              y = rect.top + relativeY;\n            }\n\n            var top = followCursor === 'horizontal' ? rect.top : y;\n            var right = followCursor === 'vertical' ? rect.right : x;\n            var bottom = followCursor === 'horizontal' ? rect.bottom : y;\n            var left = followCursor === 'vertical' ? rect.left : x;\n            return {\n              width: right - left,\n              height: bottom - top,\n              top: top,\n              right: right,\n              bottom: bottom,\n              left: left\n            };\n          }\n        });\n      }\n\n      if (getIsInitialBehavior()) {\n        removeListener();\n      }\n    }\n\n    return {\n      onAfterUpdate: function onAfterUpdate(_, _ref) {\n        var followCursor = _ref.followCursor;\n\n        if (followCursor !== undefined && !followCursor) {\n          unsetReferenceClientRect(true);\n        }\n      },\n      onMount: function onMount() {\n        triggerLastMouseMove();\n      },\n      onShow: function onShow() {\n        if (getIsManual()) {\n          // Since there's no trigger event to use, we have to use these as\n          // baseline coords\n          initialMouseCoords = {\n            clientX: 0,\n            clientY: 0\n          };\n          handleMouseMoveListener();\n        }\n      },\n      onTrigger: function onTrigger(_, event) {\n        // Tapping on touch devices can trigger `mouseenter` then `focus`\n        if (initialMouseCoords) {\n          return;\n        }\n\n        if (isMouseEvent(event)) {\n          initialMouseCoords = {\n            clientX: event.clientX,\n            clientY: event.clientY\n          };\n        }\n\n        handleMouseMoveListener();\n      },\n      onUntrigger: function onUntrigger() {\n        // If untriggered before showing (`onHidden` will never be invoked)\n        if (!instance.state.isVisible) {\n          removeListener();\n          initialMouseCoords = null;\n        }\n      },\n      onHidden: function onHidden() {\n        removeListener();\n        initialMouseCoords = null;\n      }\n    };\n  }\n};\n\nfunction getProps(props, modifier) {\n  var _props$popperOptions;\n\n  return {\n    popperOptions: Object.assign({}, props.popperOptions, {\n      modifiers: [].concat((((_props$popperOptions = props.popperOptions) == null ? void 0 : _props$popperOptions.modifiers) || []).filter(function (_ref) {\n        var name = _ref.name;\n        return name !== modifier.name;\n      }), [modifier])\n    })\n  };\n}\n\nvar inlinePositioning = {\n  name: 'inlinePositioning',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var reference = instance.reference;\n\n    function isEnabled() {\n      return !!instance.props.inlinePositioning;\n    }\n\n    var placement;\n    var cursorRectIndex = -1;\n    var isInternalUpdate = false;\n    var modifier = {\n      name: 'tippyInlinePositioning',\n      enabled: true,\n      phase: 'afterWrite',\n      fn: function fn(_ref2) {\n        var state = _ref2.state;\n\n        if (isEnabled()) {\n          if (placement !== state.placement) {\n            instance.setProps({\n              getReferenceClientRect: function getReferenceClientRect() {\n                return _getReferenceClientRect(state.placement);\n              }\n            });\n          }\n\n          placement = state.placement;\n        }\n      }\n    };\n\n    function _getReferenceClientRect(placement) {\n      return getInlineBoundingClientRect(getBasePlacement(placement), reference.getBoundingClientRect(), arrayFrom(reference.getClientRects()), cursorRectIndex);\n    }\n\n    function setInternalProps(partialProps) {\n      isInternalUpdate = true;\n      instance.setProps(partialProps);\n      isInternalUpdate = false;\n    }\n\n    function addModifier() {\n      if (!isInternalUpdate) {\n        setInternalProps(getProps(instance.props, modifier));\n      }\n    }\n\n    return {\n      onCreate: addModifier,\n      onAfterUpdate: addModifier,\n      onTrigger: function onTrigger(_, event) {\n        if (isMouseEvent(event)) {\n          var rects = arrayFrom(instance.reference.getClientRects());\n          var cursorRect = rects.find(function (rect) {\n            return rect.left - 2 <= event.clientX && rect.right + 2 >= event.clientX && rect.top - 2 <= event.clientY && rect.bottom + 2 >= event.clientY;\n          });\n          cursorRectIndex = rects.indexOf(cursorRect);\n        }\n      },\n      onUntrigger: function onUntrigger() {\n        cursorRectIndex = -1;\n      }\n    };\n  }\n};\nfunction getInlineBoundingClientRect(currentBasePlacement, boundingRect, clientRects, cursorRectIndex) {\n  // Not an inline element, or placement is not yet known\n  if (clientRects.length < 2 || currentBasePlacement === null) {\n    return boundingRect;\n  } // There are two rects and they are disjoined\n\n\n  if (clientRects.length === 2 && cursorRectIndex >= 0 && clientRects[0].left > clientRects[1].right) {\n    return clientRects[cursorRectIndex] || boundingRect;\n  }\n\n  switch (currentBasePlacement) {\n    case 'top':\n    case 'bottom':\n      {\n        var firstRect = clientRects[0];\n        var lastRect = clientRects[clientRects.length - 1];\n        var isTop = currentBasePlacement === 'top';\n        var top = firstRect.top;\n        var bottom = lastRect.bottom;\n        var left = isTop ? firstRect.left : lastRect.left;\n        var right = isTop ? firstRect.right : lastRect.right;\n        var width = right - left;\n        var height = bottom - top;\n        return {\n          top: top,\n          bottom: bottom,\n          left: left,\n          right: right,\n          width: width,\n          height: height\n        };\n      }\n\n    case 'left':\n    case 'right':\n      {\n        var minLeft = Math.min.apply(Math, clientRects.map(function (rects) {\n          return rects.left;\n        }));\n        var maxRight = Math.max.apply(Math, clientRects.map(function (rects) {\n          return rects.right;\n        }));\n        var measureRects = clientRects.filter(function (rect) {\n          return currentBasePlacement === 'left' ? rect.left === minLeft : rect.right === maxRight;\n        });\n        var _top = measureRects[0].top;\n        var _bottom = measureRects[measureRects.length - 1].bottom;\n        var _left = minLeft;\n        var _right = maxRight;\n\n        var _width = _right - _left;\n\n        var _height = _bottom - _top;\n\n        return {\n          top: _top,\n          bottom: _bottom,\n          left: _left,\n          right: _right,\n          width: _width,\n          height: _height\n        };\n      }\n\n    default:\n      {\n        return boundingRect;\n      }\n  }\n}\n\nvar sticky = {\n  name: 'sticky',\n  defaultValue: false,\n  fn: function fn(instance) {\n    var reference = instance.reference,\n        popper = instance.popper;\n\n    function getReference() {\n      return instance.popperInstance ? instance.popperInstance.state.elements.reference : reference;\n    }\n\n    function shouldCheck(value) {\n      return instance.props.sticky === true || instance.props.sticky === value;\n    }\n\n    var prevRefRect = null;\n    var prevPopRect = null;\n\n    function updatePosition() {\n      var currentRefRect = shouldCheck('reference') ? getReference().getBoundingClientRect() : null;\n      var currentPopRect = shouldCheck('popper') ? popper.getBoundingClientRect() : null;\n\n      if (currentRefRect && areRectsDifferent(prevRefRect, currentRefRect) || currentPopRect && areRectsDifferent(prevPopRect, currentPopRect)) {\n        if (instance.popperInstance) {\n          instance.popperInstance.update();\n        }\n      }\n\n      prevRefRect = currentRefRect;\n      prevPopRect = currentPopRect;\n\n      if (instance.state.isMounted) {\n        requestAnimationFrame(updatePosition);\n      }\n    }\n\n    return {\n      onMount: function onMount() {\n        if (instance.props.sticky) {\n          updatePosition();\n        }\n      }\n    };\n  }\n};\n\nfunction areRectsDifferent(rectA, rectB) {\n  if (rectA && rectB) {\n    return rectA.top !== rectB.top || rectA.right !== rectB.right || rectA.bottom !== rectB.bottom || rectA.left !== rectB.left;\n  }\n\n  return true;\n}\n\ntippy.setDefaultProps({\n  render: render\n});\n\nexport default tippy;\nexport { animateFill, createSingleton, delegate, followCursor, hideAll, inlinePositioning, ROUND_ARROW as roundArrow, sticky };\n//# sourceMappingURL=tippy.esm.js.map\n","import { Board } from \"../../build/board/structs\";\r\nimport { ArtInfoProvider } from \"../../build/formats/art\";\r\nimport { Ray, Target } from \"../../build/hitscan\";\r\nimport { MoveStruct } from \"../../build/utils\";\r\nimport { Texture } from \"../../utils/gl/drawstruct\";\r\nimport { Dependency } from \"../../utils/injector\";\r\nimport { MessageHandler } from \"./handler\";\r\nimport { ReferenceTracker } from \"./referencetracker\";\r\nimport { Renderable } from \"./renderable\";\r\nimport { EngineApi } from \"../../build/board/mutations/api\"\r\n\r\nexport interface Storage {\r\n  get(key: string): Promise<any>;\r\n  set(key: string, value: any): Promise<any>;\r\n  delete(key: string): Promise<void>;\r\n  clear(): Promise<void>;\r\n  keys(): Promise<string[]>;\r\n}\r\nexport type Storages = (name: string) => Promise<Storage>;\r\nexport const STORAGES = new Dependency<Storages>('Storages');\r\n\r\nexport interface ArtProvider extends ArtInfoProvider {\r\n  get(picnum: number): Texture;\r\n  getParallaxTexture(picnum: number): Texture\r\n}\r\nexport const ART = new Dependency<ArtProvider>('ArtProvider');\r\n\r\nexport interface View extends MoveStruct, MessageHandler {\r\n  drawTools(renderables: Iterable<Renderable>): void;\r\n  target(): Target;\r\n  snapTarget(): Target;\r\n  dir(): Ray;\r\n}\r\nexport const VIEW = new Dependency<View>('View');\r\n\r\nexport const ENGINE_API = new Dependency<EngineApi>(\"Engine Api\");\r\nexport type BoardProvider = () => Board;\r\nexport const BOARD = new Dependency<BoardProvider>('Borad');\r\nexport const DEFAULT_BOARD = new Dependency<Board>('Default Board');\r\n\r\nexport interface State {\r\n  register<T>(name: string, defaultValue: T): void;\r\n  set<T>(name: string, value: T): void;\r\n  get<T>(name: string): T;\r\n  has(name: string): boolean;\r\n}\r\nexport const STATE = new Dependency<State>('State');\r\n\r\nexport interface BuildReferenceTracker {\r\n  readonly walls: ReferenceTracker<number, number>;\r\n  readonly sectors: ReferenceTracker<number, number>;\r\n  readonly sprites: ReferenceTracker<number, number>;\r\n}\r\nexport const REFERENCE_TRACKER = new Dependency<BuildReferenceTracker>('BuildReferenceTracker');\r\n\r\nexport interface BuildResources {\r\n  get(name: string): Promise<ArrayBuffer>;\r\n  list(): Promise<string[]>;\r\n}\r\nexport const RESOURCES = new Dependency<BuildResources>('Build Resources');\r\n\r\n\r\nexport interface GridController {\r\n  setGridSize(size: number): void;\r\n  getGridSize(): number;\r\n  incGridSize(): void;\r\n  decGridSize(): void;\r\n  snap(x: number): number;\r\n}\r\nexport const GRID = new Dependency<GridController>('GridController');\r\n\r\n\r\nexport type SchedulerTask = Generator<void, void, TaskHandle>;\r\n\r\nexport interface TaskHandle {\r\n  stop(): void;\r\n  getDescription(): string;\r\n  getProgress(): number;\r\n  setDescription(s: string): void;\r\n  setProgress(p: number): void;\r\n}\r\n\r\nexport interface ScheddulerHandler {\r\n  onTaskAdd(task: TaskHandle): void;\r\n  onTaskStop(task: TaskHandle): void;\r\n  onTaskUpdate(task: TaskHandle): void;\r\n}\r\n\r\nexport interface Scheduler {\r\n  addTask(task: SchedulerTask): TaskHandle;\r\n  addHandler(handler: ScheddulerHandler): void;\r\n  removeHandler(handler: ScheddulerHandler): void;\r\n  currentTasks(): Iterable<TaskHandle>;\r\n}\r\nexport const SCHEDULER = new Dependency<Scheduler>('Scheduler');","import { DrawCallConsumer, Renderable, } from \"./renderable\";\r\n\r\nexport interface Builder extends Renderable {\r\n  reset(): void;\r\n  get(): Renderable;\r\n  needToRebuild(): void;\r\n}\r\n\r\nexport class Builders implements Builder {\r\n  constructor(builders: Iterable<Builder>, private copy = [...builders]) { }\r\n  get() { return this }\r\n  reset() { let size = this.copy.length - 1; while (size >= 0) this.copy[size--].reset() }\r\n  drawCall(consumer: DrawCallConsumer) { let size = this.copy.length - 1; while (size >= 0) this.copy[size--].get().drawCall(consumer) }\r\n  needToRebuild() { let size = this.copy.length - 1; while (size >= 0) this.copy[size--].needToRebuild() }\r\n}","import { Deck } from \"../../utils/collections\";\r\nimport { Dependency, Injector } from \"../../utils/injector\";\r\nimport { error } from \"../../utils/logger\";\r\n\r\nexport interface Message { }\r\nexport interface Context { }\r\nexport interface MessageHandler { handle(message: Message): void; }\r\nexport interface MessageBus extends MessageHandler { connect(handler: MessageHandler): void }\r\nexport const BUS = new Dependency<MessageBus>('Message Bus');\r\n\r\nexport async function DefaultMessageBus(injector: Injector): Promise<MessageBus> {\r\n  const list = new MessageHandlerList();\r\n  return {\r\n    connect: h => list.list().push(h),\r\n    handle: msg => {\r\n      try {\r\n        list.handle(msg)\r\n      } catch (e) {\r\n        error(e, e.stack);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nconst messageBox: [Message] = [null];\r\nexport function handleReflective(obj: Object, message: Message) {\r\n  let name = message.constructor.name;\r\n  let handler = obj[name];\r\n  if (handler != undefined) {\r\n    messageBox[0] = message;\r\n    handler.apply(obj, messageBox);\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nexport function handleCollection(handlers: Iterable<MessageHandler>, message: Message) {\r\n  for (const h of handlers) {\r\n    h.handle(message);\r\n  }\r\n}\r\n\r\nexport class MessageHandlerReflective {\r\n  public handle(message: Message) { if (!handleReflective(this, message)) this.handleDefault(message) }\r\n  protected handleDefault(message: Message) { }\r\n}\r\n\r\nexport class MessageHandlerList implements MessageHandler {\r\n  constructor(\r\n    private handlers: Deck<MessageHandler> = new Deck<MessageHandler>()\r\n  ) { }\r\n\r\n  handle(message: Message) { handleCollection(this.handlers, message); }\r\n  list(): Deck<MessageHandler> { return this.handlers; }\r\n  clone(): MessageHandlerList { return new MessageHandlerList(this.handlers.clone()); }\r\n}","import { List, Node } from \"../../utils/list\";\r\nimport { IndexedDeck } from \"../../utils/collections\";\r\n\r\nexport type ReferenceUpdater<T> = (value: T) => T;\r\n\r\nexport interface ReferenceTracker<T, R> {\r\n  ref(value: T): R;\r\n  val(ref: R): T;\r\n  update(updater: ReferenceUpdater<T>): void;\r\n  start(): ReferenceTracker<T, R>;\r\n  stop(): void;\r\n}\r\n\r\nexport function track<T, R>(refs: ReferenceTracker<T, R>, f: (refs: ReferenceTracker<T, R>) => void): void {\r\n  const crefs = refs.start();\r\n  f(crefs);\r\n  crefs.stop();\r\n}\r\n\r\nexport class ReferenceTrackerImpl<T> implements ReferenceTracker<T, number>{\r\n  constructor(\r\n    private readonly nil: T,\r\n    private readonly parent: ReferenceTrackerImpl<T> = null,\r\n    private parentNode: Node<ReferenceTrackerImpl<T>> = null,\r\n    private refs = new IndexedDeck<T>(),\r\n    private nested = new List<ReferenceTrackerImpl<T>>(),\r\n    private stopped = false\r\n  ) { }\r\n\r\n  ref(value: T): number {\r\n    if (this.stopped) return -1;\r\n    let ref = this.refs.indexOf(value);\r\n    if (ref == -1) {\r\n      this.refs.push(value);\r\n      ref = this.refs.length() - 1;\r\n    }\r\n    return ref;\r\n  }\r\n\r\n  val(ref: number): T {\r\n    if (this.stopped) return this.nil;\r\n    const val = this.refs.get(ref);\r\n    return val == undefined ? this.nil : val;\r\n  }\r\n\r\n  update(updater: ReferenceUpdater<T>): void {\r\n    if (this.stopped) return;\r\n    for (let i = 0; i < this.refs.length(); i++) {\r\n      const r = this.refs.get(i);\r\n      if (r == this.nil) continue;\r\n      this.refs.set(i, updater(r));\r\n    }\r\n    for (const n of this.nested) n.update(updater);\r\n  }\r\n\r\n  start(): ReferenceTracker<T, number> {\r\n    if (this.stopped) throw new Error('Tracker already stopped');\r\n    const tracker = new ReferenceTrackerImpl<T>(this.nil, this);\r\n    tracker.parentNode = this.nested.push(tracker);\r\n    return tracker;\r\n  }\r\n\r\n  stop(): void {\r\n    if (this.stopped) return;\r\n    if (this.parent == null) throw new Error('Cannot stop root trackers');\r\n    this.parent.nested.remove(this.parentNode);\r\n    for (const n of this.nested) n.stop();\r\n    this.nested = null;\r\n    this.refs = null;\r\n    this.stopped = true;\r\n  }\r\n}","import { DrawCall, State } from '../../utils/gl/stategl';\r\n\r\nexport type DrawCallConsumer = (d: DrawCall) => void;\r\nexport interface Renderable {\r\n  drawCall(consumer: DrawCallConsumer): void;\r\n}\r\n\r\nexport const NULL_RENDERABLE: Renderable = { drawCall: (consumer: DrawCallConsumer) => { } }\r\n\r\nexport const SPRITE_LABEL = 1 << 0;\r\nexport const HELPER_GRID = 1 << 1;\r\n\r\nconst sorter = (l: DrawCall, r: DrawCall): number => l.hint - r.hint;\r\nexport class SortingRenderable implements Renderable {\r\n  private drawList: DrawCall[] = [];\r\n\r\n  constructor(\r\n    private renderables: Iterable<Renderable>,\r\n    private filter: (kind: number) => boolean = () => true\r\n  ) { }\r\n\r\n  drawCall(consumer: DrawCallConsumer): void {\r\n    this.drawList = [];\r\n    for (const r of this.renderables) r.drawCall(dc => {\r\n      if (this.filter(dc.kind)) this.drawList.push(dc);\r\n    });\r\n    const sorted = this.drawList.sort(sorter);\r\n    for (const dc of sorted) consumer(dc);\r\n  }\r\n}\r\n\r\nexport class Renderables implements Renderable {\r\n  constructor(private renderables: Iterable<Renderable>) { }\r\n  public drawCall(consumer: DrawCallConsumer): void { for (const r of this.renderables) r.drawCall(consumer) }\r\n}\r\n\r\nexport interface SectorRenderable extends Renderable {\r\n  readonly ceiling: Renderable;\r\n  readonly floor: Renderable;\r\n}\r\n\r\nexport interface WallRenderable extends Renderable {\r\n  readonly top: Renderable;\r\n  readonly mid: Renderable;\r\n  readonly bot: Renderable;\r\n}\r\n\r\nexport interface ClusterRenderable {\r\n  readonly solids: Renderable;\r\n  readonly sprites: Renderable;\r\n  readonly transSolids: Renderable;\r\n  readonly transSprites: Renderable;\r\n}\r\n\r\nexport interface BuildRenderableProvider {\r\n  sector(id: number): SectorRenderable;\r\n  sectorCluster(id: number): ClusterRenderable;\r\n  wall(id: number): WallRenderable;\r\n  wallPoint(id: number): Renderable;\r\n  sprite(id: number): Renderable;\r\n}\r\n","import { Deck } from '../../utils/collections';\r\nimport { Injector } from '../../utils/injector';\r\nimport { iter } from '../../utils/iter';\r\nimport { PostFrame } from '../edit/messages';\r\nimport { ScheddulerHandler, Scheduler, SchedulerTask, TaskHandle } from './app';\r\nimport { BUS, MessageHandlerReflective } from './handler';\r\n\r\nexport async function DefaultScheduler(injector: Injector) {\r\n  const bus = await injector.getInstance(BUS);\r\n  const scheduler = new SchedulerImpl();\r\n  bus.connect(scheduler);\r\n  return scheduler;\r\n}\r\n\r\nclass TaskHandleImpl implements TaskHandle {\r\n  constructor(\r\n    private stopped = false,\r\n    public description = \"\",\r\n    public progress = -1\r\n  ) { }\r\n\r\n\r\n  stop(): void { this.stopped = true }\r\n  isStopped() { return this.stopped }\r\n  getDescription(): string { return this.description }\r\n  getProgress(): number { return this.progress }\r\n  setDescription(s: string): void { this.description = s }\r\n  setProgress(p: number): void { this.progress = p }\r\n}\r\n\r\nclass SchedulerImpl extends MessageHandlerReflective implements Scheduler {\r\n  private tasks = new Deck<[TaskHandleImpl, SchedulerTask]>();\r\n  private nextTasks = new Deck<[TaskHandleImpl, SchedulerTask]>();\r\n  private handlers: ScheddulerHandler[] = [];\r\n\r\n  addTask(task: SchedulerTask) {\r\n    const handle = new TaskHandleImpl();\r\n    this.tasks.push([handle, task]);\r\n    this.handleAdd(handle);\r\n    return handle;\r\n  }\r\n\r\n  addHandler(handler: ScheddulerHandler): void {\r\n    this.handlers.push(handler);\r\n  }\r\n\r\n  removeHandler(handler: ScheddulerHandler): void {\r\n    const idx = this.handlers.indexOf(handler);\r\n    if (idx != -1) this.handlers.splice(idx, 1);\r\n  }\r\n\r\n  currentTasks(): Iterable<TaskHandle> {\r\n    return iter(this.tasks).map(t => t[0]);\r\n  }\r\n\r\n  private handleAdd(task: TaskHandleImpl) { for (const h of this.handlers) h.onTaskAdd(task) }\r\n  private handleStop(task: TaskHandleImpl) { for (const h of this.handlers) h.onTaskStop(task) }\r\n  private handleUpdate(task: TaskHandleImpl) { for (const h of this.handlers) h.onTaskUpdate(task) }\r\n\r\n  PostFrame(msg: PostFrame) {\r\n    this.nextTasks.clear();\r\n    for (const ent of this.tasks) {\r\n      const [handle, task] = ent;\r\n      if (!handle.isStopped()) {\r\n        const result = task.next(handle);\r\n        this.handleUpdate(handle);\r\n        if (result.done) handle.stop();\r\n      }\r\n      if (handle.isStopped()) this.handleStop(handle);\r\n      else this.nextTasks.push(ent);\r\n    }\r\n    [this.nextTasks, this.tasks] = [this.tasks, this.nextTasks];\r\n  }\r\n}","import { Dependency } from \"../../utils/injector\";\r\n\r\nexport interface Window {\r\n  readonly contentElement: HTMLElement;\r\n  readonly winElement: HTMLElement;\r\n  onclose: () => void;\r\n  show(): void;\r\n  hide(): void;\r\n  setPosition(x: number | string, y: string | number): void;\r\n}\r\n\r\nexport interface WindowBuilder {\r\n  id(id: string): WindowBuilder;\r\n  title(title: string): WindowBuilder;\r\n  draggable(draggable: boolean): WindowBuilder;\r\n  centered(centered: boolean): WindowBuilder;\r\n  closeable(closeable: boolean): WindowBuilder;\r\n  size(width: number, height: number): WindowBuilder;\r\n  onclose(h: () => void): WindowBuilder;\r\n  toolbar(builder: ToolbarBuilder): WindowBuilder;\r\n  content(content: HTMLElement): WindowBuilder;\r\n  build(): Window;\r\n}\r\n\r\nexport interface ToolbarBuilder {\r\n  startGroup(): ToolbarBuilder;\r\n  endGroup(): ToolbarBuilder;\r\n  button(icon: string, click: () => void): ToolbarBuilder;\r\n  search(hint: string, change: (s: string, sugg: HTMLElement) => void): ToolbarBuilder;\r\n  menuButton(icon: string, menu: MenuBuilder): ToolbarBuilder;\r\n  widget(widget: HTMLElement): ToolbarBuilder;\r\n}\r\n\r\nexport interface MenuBuilder {\r\n  item(text: string, click: () => void): MenuBuilder\r\n  build(elem: HTMLElement): void;\r\n}\r\n\r\nexport interface UiBuilder {\r\n  window(): WindowBuilder;\r\n  toolbar(): ToolbarBuilder;\r\n  menu(): MenuBuilder;\r\n}\r\n\r\nexport interface Ui {\r\n  readonly builder: UiBuilder;\r\n}\r\nexport const UI = new Dependency<Ui>('UI');","import { EngineApi } from \"../../build/board/mutations/api\";\r\nimport { Entity } from \"../../build/hitscan\";\r\nimport { Dependency, Injector } from \"../../utils/injector\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, BuildReferenceTracker, REFERENCE_TRACKER, State, STATE, View, VIEW, GridController, GRID, ENGINE_API } from \"../apis/app\";\r\nimport { BUS, MessageBus } from \"../apis/handler\";\r\nimport { SectorEnt } from \"./sector\";\r\nimport { SpriteEnt } from \"./sprite\";\r\nimport { WallEnt } from \"./wall\";\r\nimport { WallSegmentsEnt } from \"./wallsegment\";\r\n\r\nexport class EditContext {\r\n  readonly board: BoardProvider;\r\n  readonly api: EngineApi;\r\n  readonly view: View\r\n  readonly gridController: GridController;\r\n  readonly bus: MessageBus;\r\n  readonly state: State;\r\n  readonly refs: BuildReferenceTracker;\r\n  readonly art: ArtProvider;\r\n}\r\n\r\nexport async function EditContextConstructor(injector: Injector): Promise<EditContext> {\r\n  const [board, api, view, gridController, bus, state, refs, art] = await Promise.all([\r\n    injector.getInstance(BOARD),\r\n    injector.getInstance(ENGINE_API),\r\n    injector.getInstance(VIEW),\r\n    injector.getInstance(GRID),\r\n    injector.getInstance(BUS),\r\n    injector.getInstance(STATE),\r\n    injector.getInstance(REFERENCE_TRACKER),\r\n    injector.getInstance(ART),\r\n  ]);\r\n  return { board, api, view, gridController, bus, state, refs, art }\r\n}\r\n\r\nexport class EntityFactory {\r\n  constructor(readonly ctx: EditContext) { }\r\n\r\n  public sector(ent: Entity): SectorEnt { return new SectorEnt(ent, this.ctx) }\r\n  public sprite(id: number): SpriteEnt { return new SpriteEnt(id, this.ctx) }\r\n  public wall(id: number): WallEnt { return new WallEnt(id, this.ctx) }\r\n  public wallSegment(ids: Iterable<number>, hids: Iterable<number> = ids, bottom = false): WallSegmentsEnt { return new WallSegmentsEnt(ids, hids, bottom, this.ctx) }\r\n}\r\nexport const ENTITY_FACTORY = new Dependency<EntityFactory>('Entity Factory');\r\n\r\nexport async function EntityFactoryConstructor(injector: Injector): Promise<EntityFactory> {\r\n  const ctx = await EditContextConstructor(injector);\r\n  return new EntityFactory(ctx);\r\n}\r\n\r\n","import { Entity, EntityType } from \"../../build/hitscan\";\r\nimport { Board } from \"../../build/board/structs\";\r\nimport { slope } from \"../../build/utils\";\r\nimport { tuple2 } from \"../../utils/mathutils\";\r\nimport { MessageBus } from \"../apis/handler\";\r\nimport { BoardInvalidate } from \"./messages\";\r\n\r\nexport function invalidateSectorAndWalls(sectorId: number, board: Board, bus: MessageBus) {\r\n  bus.handle(new BoardInvalidate(new Entity(sectorId, EntityType.CEILING)));\r\n  let sec = board.sectors[sectorId];\r\n  let end = sec.wallnum + sec.wallptr;\r\n  for (let w = sec.wallptr; w < end; w++) {\r\n    bus.handle(new BoardInvalidate(new Entity(w, EntityType.WALL_POINT)));\r\n    bus.handle(new BoardInvalidate(new Entity(board.walls[w].nextwall, EntityType.WALL_POINT)));\r\n  }\r\n}\r\n\r\nlet sectorZesult: [EntityType, number] = [null, 0];\r\nexport function getClosestSectorZ(board: Board, sectorId: number, x: number, y: number, z: number): [EntityType, number] {\r\n  let sector = board.sectors[sectorId];\r\n  let fz = slope(board, sectorId, x, y, sector.floorheinum) + sector.floorz;\r\n  let cz = slope(board, sectorId, x, y, sector.ceilingheinum) + sector.ceilingz;\r\n  return Math.abs(z - fz) < Math.abs(z - cz) ? tuple2(sectorZesult, EntityType.FLOOR, fz) : tuple2(sectorZesult, EntityType.CEILING, cz);\r\n}\r\n\r\n","import { vec3, Vec3Array } from \"../../libs_js/glmatrix\";\r\nimport { len2d } from \"../../utils/mathutils\";\r\n\r\nexport class MovingHandle {\r\n  private startPoint = vec3.create();\r\n  private currentPoint = vec3.create();\r\n  private dzoff = 0;\r\n  private active = false;\r\n  private vertical = false;\r\n  private parallel = false;\r\n\r\n  public start(pos: Vec3Array) {\r\n    vec3.copy(this.startPoint, pos);\r\n    vec3.copy(this.currentPoint, this.startPoint);\r\n    this.dzoff = 0;\r\n    this.active = true;\r\n  }\r\n\r\n  public update(vertical: boolean, parallel: boolean, start: Vec3Array, dir: Vec3Array) {\r\n    this.parallel = parallel;\r\n    this.vertical = vertical;\r\n    if (vertical) {\r\n      let dx = this.currentPoint[0] - start[0];\r\n      let dy = this.currentPoint[2] - start[2];\r\n      let t = len2d(dx, dy) / len2d(dir[0], dir[2]);\r\n      this.dzoff = dir[1] * t + start[1] - this.currentPoint[1];\r\n    } else {\r\n      this.dzoff = 0;\r\n      let dz = this.startPoint[1] - start[1];\r\n      let t = dz / dir[1];\r\n      vec3.copy(this.currentPoint, dir);\r\n      vec3.scale(this.currentPoint, this.currentPoint, t);\r\n      vec3.add(this.currentPoint, this.currentPoint, start);\r\n    }\r\n  }\r\n\r\n  public isActive() { return this.active; }\r\n  public stop() { this.active = false; }\r\n  public get dx() { return this.parallel && Math.abs(this.dx_()) < Math.abs(this.dy_()) ? 0 : this.dx_(); }\r\n  public get dy() { return this.parallel && Math.abs(this.dy_()) < Math.abs(this.dx_()) ? 0 : this.dy_(); }\r\n  public get dz() { return this.vertical ? this.currentPoint[1] - this.startPoint[1] + this.dzoff : 0; }\r\n  private dx_() { return this.currentPoint[0] - this.startPoint[0]; }\r\n  private dy_() { return this.currentPoint[2] - this.startPoint[2]; }\r\n}\r\n","import { Board } from \"../../build/board/structs\";\r\nimport { Entity } from \"../../build/hitscan\";\r\nimport { Message, MessageHandler } from \"../apis/handler\";\r\nimport { Renderable } from \"../apis/renderable\";\r\n\r\nexport class NamedMessage implements Message { constructor(public name: string) { } }\r\nexport class LoadBoard implements Message { constructor(public board: Board) { } }\r\nexport class StartMove implements Message { }\r\nexport class Move implements Message { constructor(public dx: number, public dy: number, public dz: number) { } }\r\nexport class EndMove implements Message { }\r\nexport class Rotate implements Message { constructor(public da: number) { } };\r\nexport class Highlight implements Message { constructor(public set: Set<number> = new Set()) { } }\r\nexport class Render implements Message { constructor(public consumer: (r: Renderable) => void) { } }\r\nexport class SetPicnum implements Message { constructor(public picnum: number) { } }\r\nexport class Shade implements Message { constructor(public value: number, public absolute = false) { } }\r\nexport class PanRepeat implements Message { constructor(public xpan: number, public ypan: number, public xrepeat: number, public yrepeat: number, public absolute = false) { } }\r\nexport class ResetPanRepeat implements Message { }\r\nexport class Palette implements Message { constructor(public value: number, public max: number, public absolute = false) { } }\r\nexport class Flip implements Message { constructor() { } }\r\nexport class SpriteMode implements Message { }\r\nexport class Frame implements Message { constructor(public dt: number) { } }\r\nexport class BoardInvalidate implements Message { constructor(public ent: Entity) { } }\r\nexport class PostFrame implements Message { }\r\nexport class Mouse implements Message { constructor(public x: number, public y: number) { } }\r\nexport class SetWallCstat implements Message { constructor(public name: string, public value = false, public toggle = true) { } }\r\nexport class SetSectorCstat implements Message { constructor(public name: string, public value = false, public toggle = true) { } }\r\nexport class SetSpriteCstat implements Message { constructor(public name: string, public value = false, public toggle = true) { } }\r\n\r\nexport const COMMIT = new NamedMessage('commit');\r\nexport const INVALIDATE_ALL = new BoardInvalidate(null);\r\n\r\nexport function namedMessageHandler(name: string, handler: () => void): MessageHandler {\r\n  return { handle: (msg: Message) => { if (msg instanceof NamedMessage && msg.name == name) handler() } }\r\n}","import { deleteSector } from \"../../build/board/mutations/internal\";\r\nimport { Entity, EntityType } from \"../../build/hitscan\";\r\nimport { sectorHeinum, sectorZ, setSectorHeinum, setSectorPicnum, setSectorZ, ZSCALE } from \"../../build/utils\";\r\nimport * as GLM from \"../../libs_js/glmatrix\";\r\nimport { cyclic, tuple } from \"../../utils/mathutils\";\r\nimport { Message, MessageHandlerReflective } from \"../apis/handler\";\r\nimport { EditContext } from \"./context\";\r\nimport { invalidateSectorAndWalls } from \"./editutils\";\r\nimport { BoardInvalidate, COMMIT, Highlight, Move, NamedMessage, Palette, PanRepeat, ResetPanRepeat, Rotate, SetPicnum, SetSectorCstat, Shade, StartMove } from \"./messages\";\r\nimport { MOVE_VERTICAL } from \"./tools/selection\";\r\n\r\nconst resetPanrepeat = new PanRepeat(0, 0, 0, 0, true);\r\n\r\nexport type SectorEntFactory = (ent: Entity) => SectorEnt;\r\n\r\n\r\n\r\nexport class SectorEnt extends MessageHandlerReflective {\r\n  constructor(\r\n    public sectorEnt: Entity,\r\n    private ctx: EditContext,\r\n    public originz = 0,\r\n    public origin = GLM.vec2.create(),\r\n    private valid = true\r\n  ) { super() }\r\n\r\n  public StartMove(msg: StartMove) {\r\n    let [x, y] = this.ctx.view.target().coords;\r\n    // let sec = ctx.board.sectors[this.sectorId];\r\n    // let slope = createSlopeCalculator(sec, ctx.board.walls);\r\n    // this.originz = slope(x, y, this.type == HitType.CEILING ? sec.ceilingheinum : sec.floorheinum) + sectorZ(ctx.board, this.sectorId, this.type)) / ZSCALE;\r\n    this.originz = sectorZ(this.ctx.board(), this.sectorEnt) / ZSCALE;\r\n    GLM.vec2.set(this.origin, x, y);\r\n  }\r\n\r\n  public Move(msg: Move) {\r\n    if (this.ctx.state.get(MOVE_VERTICAL)) {\r\n      const ent = this.ctx.view.target().entity;\r\n      let z = ent != null && ent.isSector() && ent.id != this.sectorEnt.id\r\n        ? sectorZ(this.ctx.board(), ent) / ZSCALE\r\n        : this.ctx.gridController.snap(this.originz + msg.dz);\r\n      if (setSectorZ(this.ctx.board(), this.sectorEnt, z * ZSCALE))\r\n        invalidateSectorAndWalls(this.sectorEnt.id, this.ctx.board(), this.ctx.bus);\r\n    }\r\n  }\r\n\r\n  public Rotate(msg: Rotate) {\r\n    const board = this.ctx.board();\r\n    const h = sectorHeinum(board, this.sectorEnt);\r\n    setSectorHeinum(board, this.sectorEnt, h + msg.da);\r\n    invalidateSectorAndWalls(this.sectorEnt.id, board, this.ctx.bus);\r\n  }\r\n\r\n  public Highlight(msg: Highlight) {\r\n    msg.set.add(tuple(this.sectorEnt.type == EntityType.CEILING ? 0 : 1, this.sectorEnt.id));\r\n  }\r\n\r\n  public SetPicnum(msg: SetPicnum) {\r\n    if (setSectorPicnum(this.ctx.board(), this.sectorEnt, msg.picnum))\r\n      this.ctx.bus.handle(new BoardInvalidate(this.sectorEnt));\r\n  }\r\n\r\n  public Shade(msg: Shade) {\r\n    let sector = this.ctx.board().sectors[this.sectorEnt.id];\r\n    let shade = this.sectorEnt.type == EntityType.CEILING ? sector.ceilingshade : sector.floorshade;\r\n    if (msg.absolute && msg.value == shade) return;\r\n    if (msg.absolute) {\r\n      if (this.sectorEnt.type == EntityType.CEILING) sector.ceilingshade = msg.value; else sector.floorshade = msg.value;\r\n    } else {\r\n      if (this.sectorEnt.type == EntityType.CEILING) sector.ceilingshade += msg.value; else sector.floorshade += msg.value;\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(this.sectorEnt));\r\n  }\r\n\r\n  public ResetPanRepeat(msg: ResetPanRepeat) {\r\n    this.PanRepeat(resetPanrepeat);\r\n  }\r\n\r\n  public PanRepeat(msg: PanRepeat) {\r\n    let sector = this.ctx.board().sectors[this.sectorEnt.id];\r\n    if (msg.absolute) {\r\n      if (this.sectorEnt.type == EntityType.CEILING) {\r\n        if (sector.ceilingxpanning == msg.xpan && sector.ceilingypanning == msg.ypan) return;\r\n        sector.ceilingxpanning = msg.xpan;\r\n        sector.ceilingypanning = msg.ypan;\r\n      } else {\r\n        if (sector.floorxpanning == msg.xpan && sector.floorypanning == msg.ypan) return;\r\n        sector.floorxpanning = msg.xpan;\r\n        sector.floorypanning = msg.ypan;\r\n      }\r\n    } else {\r\n      if (this.sectorEnt.type == EntityType.CEILING) {\r\n        sector.ceilingxpanning += msg.xpan;\r\n        sector.ceilingypanning += msg.ypan;\r\n      } else {\r\n        sector.floorxpanning += msg.xpan;\r\n        sector.floorypanning += msg.ypan;\r\n      }\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(this.sectorEnt));\r\n  }\r\n\r\n  public Palette(msg: Palette) {\r\n    let sector = this.ctx.board().sectors[this.sectorEnt.id];\r\n    if (msg.absolute) {\r\n      if (this.sectorEnt.type == EntityType.CEILING) {\r\n        if (msg.value == sector.ceilingpal) return;\r\n        sector.ceilingpal = msg.value;\r\n      } else {\r\n        if (msg.value == sector.floorpal) return;\r\n        sector.floorpal = msg.value;\r\n      }\r\n    } else {\r\n      if (this.sectorEnt.type == EntityType.CEILING) {\r\n        sector.ceilingpal = cyclic(sector.ceilingpal + msg.value, msg.max);\r\n      } else {\r\n        sector.floorpal = cyclic(sector.floorpal + msg.value, msg.max);\r\n      }\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(this.sectorEnt));\r\n  }\r\n\r\n  public SetSectorCstat(msg: SetSectorCstat) {\r\n    let sector = this.ctx.board().sectors[this.sectorEnt.id];\r\n    let stat = this.sectorEnt.type == EntityType.CEILING ? sector.ceilingstat[msg.name] : sector.floorstat[msg.name];\r\n    if (msg.toggle) {\r\n      let nstat = stat ? 0 : 1;\r\n      if (this.sectorEnt.type == EntityType.CEILING) sector.ceilingstat[msg.name] = nstat; else sector.floorstat[msg.name] = nstat;\r\n    } else {\r\n      if (stat == msg.value) return;\r\n      if (this.sectorEnt.type == EntityType.CEILING) sector.ceilingstat[msg.name] = msg.value; else sector.floorstat[msg.name] = msg.value;\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(this.sectorEnt));\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    switch (msg.name) {\r\n      case 'delete':\r\n        deleteSector(this.ctx.board(), this.sectorEnt.id, this.ctx.refs);\r\n        this.ctx.bus.handle(COMMIT);\r\n        this.ctx.bus.handle(new BoardInvalidate(null));\r\n        return;\r\n    }\r\n  }\r\n\r\n  public BoardInvalidate(msg: BoardInvalidate) {\r\n    if (msg.ent == null) this.valid = false;\r\n  }\r\n\r\n  public handle(msg: Message) {\r\n    if (this.valid) super.handle(msg);\r\n  }\r\n}\r\n","import { addSprite, deleteSprite } from \"../../build/board/mutations/internal\";\r\nimport { moveSpriteX } from \"../../build/board/mutations/sprites\";\r\nimport { Entity, EntityType } from \"../../build/hitscan\";\r\nimport { ZSCALE } from \"../../build/utils\";\r\nimport * as GLM from \"../../libs_js/glmatrix\";\r\nimport { cyclic, tuple } from \"../../utils/mathutils\";\r\nimport { Message, MessageHandlerReflective } from \"../apis/handler\";\r\nimport { EditContext } from \"./context\";\r\nimport { BoardInvalidate, COMMIT, Flip, Highlight, Move, NamedMessage, Palette, PanRepeat, Rotate, SetPicnum, SetSpriteCstat, Shade, SpriteMode, StartMove } from \"./messages\";\r\nimport { MOVE_COPY } from \"./tools/selection\";\r\n\r\nexport class SpriteEnt extends MessageHandlerReflective {\r\n\r\n  constructor(\r\n    public spriteId: number,\r\n    private ctx: EditContext,\r\n    public origin = GLM.vec3.create(),\r\n    public origAng = 0,\r\n    private valid = true) { super() }\r\n\r\n  public StartMove(msg: StartMove) {\r\n    const board = this.ctx.board();\r\n    const spr = board.sprites[this.spriteId];\r\n    if (this.ctx.state.get(MOVE_COPY)) {\r\n      const newSprite = this.ctx.api.cloneSprite(spr);\r\n      this.spriteId = addSprite(board, newSprite);\r\n    }\r\n    GLM.vec3.set(this.origin, spr.x, spr.z / ZSCALE, spr.y);\r\n    this.origAng = spr.ang;\r\n  }\r\n\r\n  public Move(msg: Move) {\r\n    const board = this.ctx.board();\r\n    const x = this.ctx.gridController.snap(this.origin[0] + msg.dx);\r\n    const y = this.ctx.gridController.snap(this.origin[2] + msg.dy);\r\n    const z = this.ctx.gridController.snap(this.origin[1] + msg.dz) * ZSCALE;\r\n    if (moveSpriteX(board, this.spriteId, x, y, z, this.ctx.gridController)) {\r\n      this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n    }\r\n  }\r\n\r\n  public Rotate(msg: Rotate) {\r\n    const board = this.ctx.board();\r\n    const spr = board.sprites[this.spriteId];\r\n    spr.ang = this.ctx.gridController.snap(spr.ang + msg.da + Math.sign(msg.da));\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public Highlight(msg: Highlight) {\r\n    msg.set.add(tuple(4, this.spriteId));\r\n  }\r\n\r\n  public SetPicnum(msg: SetPicnum) {\r\n    const board = this.ctx.board();\r\n    const sprite = board.sprites[this.spriteId];\r\n    sprite.picnum = msg.picnum;\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public Shade(msg: Shade) {\r\n    const board = this.ctx.board();\r\n    const sprite = board.sprites[this.spriteId];\r\n    const shade = sprite.shade;\r\n    if (msg.absolute && shade == msg.value) return;\r\n    if (msg.absolute) sprite.shade = msg.value; else sprite.shade += msg.value;\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public PanRepeat(msg: PanRepeat) {\r\n    const board = this.ctx.board();\r\n    const sprite = board.sprites[this.spriteId];\r\n    if (msg.absolute) {\r\n      if (sprite.xoffset == msg.xpan && sprite.yoffset == msg.ypan && sprite.xrepeat == msg.xrepeat && sprite.yrepeat == msg.yrepeat) return;\r\n      sprite.xoffset = msg.xpan;\r\n      sprite.yoffset = msg.ypan;\r\n      sprite.xrepeat = msg.xrepeat;\r\n      sprite.yrepeat = msg.yrepeat;\r\n    } else {\r\n      sprite.xoffset += msg.xpan;\r\n      sprite.yoffset += msg.ypan;\r\n      sprite.xrepeat += msg.xrepeat;\r\n      sprite.yrepeat += msg.yrepeat;\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public Palette(msg: Palette) {\r\n    const board = this.ctx.board();\r\n    const spr = board.sprites[this.spriteId];\r\n    if (msg.absolute) {\r\n      if (msg.value == spr.pal) return;\r\n      spr.pal = msg.value;\r\n    } else {\r\n      spr.pal = cyclic(spr.pal + msg.value, msg.max);\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public SpriteMode(msg: SpriteMode) {\r\n    const board = this.ctx.board();\r\n    const spr = board.sprites[this.spriteId];\r\n    spr.cstat.type = cyclic(spr.cstat.type + 1, 3);\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public Flip(msg: Flip) {\r\n    const board = this.ctx.board();\r\n    const spr = board.sprites[this.spriteId];\r\n    const flip = spr.cstat.xflip + spr.cstat.yflip * 2;\r\n    const nflip = cyclic(flip + 1, 4);\r\n    spr.cstat.xflip = nflip & 1;\r\n    spr.cstat.yflip = (nflip & 2) >> 1;\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    const board = this.ctx.board();\r\n    switch (msg.name) {\r\n      case 'delete':\r\n        deleteSprite(board, this.spriteId);\r\n        this.ctx.bus.handle(COMMIT);\r\n        this.ctx.bus.handle(new BoardInvalidate(null));\r\n        return;\r\n    }\r\n  }\r\n\r\n  public BoardInvalidate(msg: BoardInvalidate) {\r\n    if (msg.ent == null) this.valid = false;\r\n  }\r\n\r\n  public SetSpriteCstat(msg: SetSpriteCstat) {\r\n    const board = this.ctx.board();\r\n    const spr = board.sprites[this.spriteId];\r\n    const stat = spr.cstat[msg.name];\r\n    spr.cstat[msg.name] = stat ? 0 : 1;\r\n    this.ctx.bus.handle(COMMIT);\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.spriteId, EntityType.SPRITE)));\r\n  }\r\n\r\n  public handle(msg: Message) {\r\n    if (this.valid) super.handle(msg);\r\n  }\r\n}\r\n","import { closestWallPointDist } from \"../../../build/board/distances\";\r\nimport { EngineApi } from \"../../../build/board/mutations/api\";\r\nimport { createNewSector } from \"../../../build/board/mutations/ceatesector\";\r\nimport { createInnerLoop } from \"../../../build/board/mutations/sectors\";\r\nimport { splitSector } from \"../../../build/board/mutations/splitsector\";\r\nimport { findContainingSectorMidPoints, sectorOfWall, wallInSector } from \"../../../build/board/query\";\r\nimport { Board } from \"../../../build/board/structs\";\r\nimport { Target } from \"../../../build/hitscan\";\r\nimport { ZSCALE } from \"../../../build/utils\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { Deck, wrap } from \"../../../utils/collections\";\r\nimport { create, Module } from \"../../../utils/injector\";\r\nimport { int, len2d } from \"../../../utils/mathutils\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, BuildReferenceTracker, ENGINE_API, REFERENCE_TRACKER, View, VIEW } from \"../../apis/app\";\r\nimport { BUS, MessageBus } from \"../../apis/handler\";\r\nimport { Renderables } from \"../../apis/renderable\";\r\nimport { writeText } from \"../../modules/geometry/builders/common\";\r\nimport { BuildersFactory, BUILDERS_FACTORY } from \"../../modules/geometry/common\";\r\nimport { LineBuilder, PointSpritesBuilder } from \"../../modules/gl/buffers\";\r\nimport { getClosestSectorZ } from \"../editutils\";\r\nimport { BoardInvalidate, COMMIT, Frame, NamedMessage, Render } from \"../messages\";\r\nimport { DefaultTool, TOOLS_BUS } from \"./toolsbus\";\r\n\r\nclass Contour {\r\n  private points: Array<[number, number]> = [];\r\n  private size = 0;\r\n  private z = 0;\r\n\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    private art: ArtProvider,\r\n    firstPoint: boolean = true,\r\n    private contour = factory.wireframe('utils'),\r\n    private contourPoints = factory.pointSprite('utils'),\r\n    private length = factory.pointSprite('utils'),\r\n    private renderable = new Renderables([contour, contourPoints, length])\r\n  ) { if (firstPoint) this.pushPoint(0, 0) }\r\n\r\n  public setZ(z: number) { this.z = z }\r\n  public getZ() { return this.z }\r\n  public pushPoint(x: number, y: number) { this.points[this.size++] = [x, y] }\r\n  public updateLastPoint(x: number, y: number) { this.updatePoint(this.size - 1, x, y) }\r\n  public popPoint() { this.size-- }\r\n  public clear() { this.size = 0 }\r\n\r\n  public updatePoint(idx: number, x: number, y: number) {\r\n    if (idx >= this.size) throw new Error('Invalid point id: ' + idx);\r\n    let p = this.points[idx];\r\n    p[0] = x;\r\n    p[1] = y;\r\n  }\r\n\r\n  public getRenderable() {\r\n    this.updateRenderable();\r\n    return this.renderable;\r\n  }\r\n\r\n  private updateRenderable() {\r\n    if (this.size == 0) return;\r\n    this.updateContourPoints();\r\n    this.updateContour();\r\n    this.updateLength();\r\n  }\r\n\r\n  private updateContourPoints() {\r\n    this.contourPoints.needToRebuild();\r\n    this.contourPoints.tex = this.art.get(-1);\r\n    const builder = new PointSpritesBuilder();\r\n    for (let i = 0; i < this.size; i++) {\r\n      const p = this.points[i];\r\n      builder.add(p[0], this.z, p[1]);\r\n    }\r\n    builder.build(this.contourPoints.buff, 2.5);\r\n  }\r\n\r\n  private updateContour() {\r\n    this.contour.needToRebuild();\r\n    const buff = this.contour.buff;\r\n    buff.deallocate();\r\n    const size = this.size - 1;\r\n    const builder = new LineBuilder();\r\n    for (let i = 0; i < size; i++) {\r\n      const p1 = this.points[i];\r\n      const p2 = this.points[i + 1];\r\n      builder.segment(p1[0], this.z, p1[1], p2[0], this.z, p2[1]);\r\n    }\r\n    builder.build(buff);\r\n  }\r\n\r\n  private prepareLengthLabels(): [number, string[]] {\r\n    let total = 0;\r\n    const labels: string[] = [];\r\n    for (let i = 0; i < this.size - 1; i++) {\r\n      const p = this.points[i];\r\n      const p1 = this.points[i + 1];\r\n      const label = int(len2d(p[0] - p1[0], p[1] - p1[1])) + \"\";\r\n      labels.push(label);\r\n      total += label.length * 2 + 3;\r\n    }\r\n    return [total, labels];\r\n  }\r\n\r\n  private updateLength() {\r\n    this.length.needToRebuild();\r\n    const buff = this.length.buff;\r\n    buff.deallocate();\r\n    if (this.size < 2) return;\r\n    this.length.tex = this.art.get(-2);\r\n    let size = this.size - 1;\r\n    const [total, labels] = this.prepareLengthLabels();\r\n    buff.allocate(total * 4, total * 6);\r\n    let off = 0;\r\n    for (let i = 0; i < size; i++) {\r\n      const p = this.points[i];\r\n      const p1 = this.points[i + 1];\r\n      const label = labels[i];\r\n      writeText(buff, off, label, 8, 8, p[0] + (p1[0] - p[0]) / 2, p[1] + (p1[1] - p[1]) / 2, this.z);\r\n      off += label.length * 2 + 3;\r\n    }\r\n  }\r\n}\r\n\r\nexport async function DrawSectorModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(TOOLS_BUS);\r\n    bus.connect(await create(injector, DrawSector, BUILDERS_FACTORY, ART, ENGINE_API, VIEW, BOARD, REFERENCE_TRACKER, BUS));\r\n  });\r\n}\r\n\r\nexport class DrawSector extends DefaultTool {\r\n  private points = new Deck<[number, number]>();\r\n  private pointer = vec3.create();\r\n  private isRect = true;\r\n\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    art: ArtProvider,\r\n    private api: EngineApi,\r\n    private view: View,\r\n    private board: BoardProvider,\r\n    private refs: BuildReferenceTracker,\r\n    private bus: MessageBus,\r\n    private contour = new Contour(factory, art)\r\n  ) { super() }\r\n\r\n  private update() {\r\n    if (this.predrawUpdate()) return;\r\n    const z = this.contour.getZ();\r\n    const [x, y] = this.view.snapTarget().coords;\r\n    vec3.set(this.pointer, x, y, z);\r\n\r\n    if (this.isRect) {\r\n      let fp = this.points.get(0);\r\n      let dx = x - fp[0];\r\n      let dy = y - fp[1];\r\n      let p1 = this.points.get(1);\r\n      let p2 = this.points.get(2);\r\n      let p3 = this.points.get(3);\r\n      p1[0] = fp[0] + dx;\r\n      p2[0] = fp[0] + dx;\r\n      p2[1] = fp[1] + dy;\r\n      p3[1] = fp[1] + dy;\r\n      this.contour.updatePoint(1, fp[0] + dx, fp[1]);\r\n      this.contour.updatePoint(2, fp[0] + dx, fp[1] + dy);\r\n      this.contour.updatePoint(3, fp[0], fp[1] + dy);\r\n    } else {\r\n      this.contour.updateLastPoint(x, y);\r\n    }\r\n  }\r\n\r\n  private predrawUpdate() {\r\n    if (this.points.length() > 0) return false;\r\n    const target = this.view.snapTarget();\r\n    const board = this.board();\r\n    if (target.entity == null) {\r\n      const [x, y] = target.coords;\r\n      const [w] = closestWallPointDist(board, x, y);\r\n      const z = w == -1 ? 0 : board.sectors[sectorOfWall(board, w)].ceilingz;\r\n      vec3.set(this.pointer, x, y, z);\r\n      this.contour.setZ(z / ZSCALE);\r\n      this.contour.updateLastPoint(x, y);\r\n    } else if (target.entity.isSector() || target.entity.isSprite()) {\r\n      let [x, y,] = target.coords;\r\n      let z = this.getPointerZ(board, target);\r\n      vec3.set(this.pointer, x, y, z);\r\n      this.contour.setZ(z / ZSCALE);\r\n      this.contour.updateLastPoint(x, y);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  private isSplitSector(x: number, y: number) {\r\n    let sectorId = this.findContainingSector();\r\n    if (sectorId == -1) return -1;\r\n    let fp = this.points.get(0);\r\n    const board = this.board();\r\n    return wallInSector(board, sectorId, fp[0], fp[1]) != -1\r\n      && wallInSector(board, sectorId, x, y) != -1 ? sectorId : -1;\r\n  }\r\n\r\n  private insertPoint(rect: boolean) {\r\n    this.activate();\r\n    if (this.points.length() == 0) this.isRect = rect;\r\n    if (this.checkFinish()) {\r\n      this.deactivate();\r\n      return;\r\n    }\r\n\r\n    if (this.isRect) {\r\n      for (let i = 0; i < 4; i++) {\r\n        this.points.push([this.pointer[0], this.pointer[1]]);\r\n        this.contour.pushPoint(this.pointer[0], this.pointer[1]);\r\n      }\r\n    } else {\r\n      this.points.push([this.pointer[0], this.pointer[1]]);\r\n      this.contour.pushPoint(this.pointer[0], this.pointer[1]);\r\n    }\r\n  }\r\n\r\n  private checkFinish() {\r\n    if (this.points.length() == 0) return false;\r\n\r\n    let splitSector = this.isSplitSector(this.pointer[0], this.pointer[1]);\r\n    if (splitSector != -1) {\r\n      this.splitSector(splitSector);\r\n      return true;\r\n    }\r\n    let latsPoint = this.points.get(this.points.length() - 1);\r\n    if (latsPoint[0] == this.pointer[0] && latsPoint[1] == this.pointer[1]) return false;\r\n    let firstPoint = this.points.get(0);\r\n    if (firstPoint[0] == this.pointer[0] && firstPoint[1] == this.pointer[1] || this.isRect) {\r\n      this.createSector();\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private popPoint() {\r\n    if (this.points.length() == 0) return;\r\n    if (this.isRect) {\r\n      for (let i = 0; i < 4; i++) {\r\n        this.points.pop();\r\n        this.contour.popPoint();\r\n      }\r\n    } else {\r\n      this.points.pop();\r\n      this.contour.popPoint();\r\n    }\r\n    if (this, this.points.length() == 0) this.deactivate();\r\n    this.contour.updateLastPoint(this.pointer[0], this.pointer[1]);\r\n  }\r\n\r\n  private getPointerZ(board: Board, target: Target): number {\r\n    if (target.entity.isSector()) return target.coords[2];\r\n    let sectorId = target.entity.isWall() ? sectorOfWall(board, target.entity.id) : board.sprites[target.entity.id].sectnum;\r\n    return getClosestSectorZ(board, sectorId, target.coords[0], target.coords[1], target.coords[2])[1];\r\n  }\r\n\r\n  private findContainingSector() {\r\n    const sectors = findContainingSectorMidPoints(this.board(), [...this.points, <[number, number]>this.pointer]);\r\n    return sectors.size == 1 ? sectors.values().next().value : -1;\r\n  }\r\n\r\n  private createSector() {\r\n    let sectorId = this.findContainingSector();\r\n    const board = this.board();\r\n    if (sectorId != -1)\r\n      createInnerLoop(board, sectorId, this.points, this.refs, this.api);\r\n    createNewSector(board, this.points, this.refs, this.api);\r\n    this.bus.handle(COMMIT);\r\n    this.bus.handle(new BoardInvalidate(null));\r\n    this.points.clear();\r\n    this.contour.clear();\r\n    this.contour.pushPoint(0, 0);\r\n  }\r\n\r\n  private splitSector(sectorId: number): void {\r\n    splitSector(this.board(), sectorId, wrap([...this.points, <[number, number]>this.pointer]), this.refs, this.api);\r\n    this.bus.handle(COMMIT);\r\n    this.bus.handle(new BoardInvalidate(null));\r\n    this.points.clear();\r\n    this.contour.clear();\r\n    this.contour.pushPoint(0, 0);\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    switch (msg.name) {\r\n      case 'draw_rect': this.insertPoint(true); return;\r\n      case 'draw': this.insertPoint(false); return;\r\n      case 'undo_draw': this.popPoint(); return;\r\n    }\r\n  }\r\n\r\n  public Frame(msg: Frame) { this.update() }\r\n  public Render(msg: Render) { msg.consumer(this.contour.getRenderable()) }\r\n}\r\n","import { EngineApi } from \"../../../build/board/mutations/api\";\r\nimport { buildHull, drawWall, Point, point_3d, PortalType } from \"../../../build/board/mutations/drawwall\";\r\nimport { sectorOfWall } from \"../../../build/board/query\";\r\nimport { Board } from \"../../../build/board/structs\";\r\nimport { build2gl, createSlopeCalculator, wallNormal, ZSCALE } from \"../../../build/utils\";\r\nimport { vec2, vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { Module } from \"../../../utils/injector\";\r\nimport { dot2d } from \"../../../utils/mathutils\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, BuildReferenceTracker, ENGINE_API, GRID, GridController, REFERENCE_TRACKER, View, VIEW } from \"../../apis/app\";\r\nimport { BUS, MessageBus, MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { Renderables } from \"../../apis/renderable\";\r\nimport { BuildersFactory, BUILDERS_FACTORY } from \"../../modules/geometry/common\";\r\nimport { LineBuilder } from \"../../modules/gl/buffers\";\r\nimport { MovingHandle } from \"../handle\";\r\nimport { BoardInvalidate, COMMIT, Frame, NamedMessage, Render } from \"../messages\";\r\nimport { DefaultTool, TOOLS_BUS } from \"./toolsbus\";\r\n\r\nclass PortalModel {\r\n  private wallId: number;\r\n  private wallVec = vec2.create();\r\n  private wallNormal = vec2.create();\r\n  private startPoint = vec2.create();\r\n  private type: PortalType;\r\n  private points: point_3d[] = [];\r\n  private pointer: point_3d;\r\n  private slope: (x: number, y: number) => number;\r\n  private needToUpdate = true;\r\n  private lastMove: point_3d = [0, 0, 0];\r\n  private lastDistance = 0;\r\n\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    private contour = factory.wireframe('utils'),\r\n    private contourPoints = factory.pointSprite('utils'),\r\n    private length = factory.pointSprite('utils'),\r\n    private renderable = new Renderables([contour, contourPoints, length])\r\n  ) { }\r\n\r\n  public getRenderable(distance: number) {\r\n    if (this.lastDistance != distance) {\r\n      this.lastDistance = distance;\r\n      this.needToUpdate = true;\r\n    }\r\n    this.update();\r\n    return this.renderable\r\n  }\r\n\r\n  public start(board: Board, wallId: number, x: number, y: number, z: number) {\r\n    this.pointer = [x, y, z];\r\n    this.points = [];\r\n    this.wallId = wallId;\r\n    const wall = board.walls[wallId];\r\n    const wall2 = board.walls[wall.point2];\r\n    vec2.set(this.wallVec, wall2.x - wall.x, wall2.y - wall.y);\r\n    vec2.normalize(this.wallVec, this.wallVec);\r\n    const [nx, , ny] = wallNormal(vec3.create(), board, wallId);\r\n    vec2.set(this.wallNormal, nx, ny);\r\n    vec2.set(this.startPoint, wall.x, wall.y);\r\n    const sectorId = sectorOfWall(board, wallId);\r\n    const sector = board.sectors[sectorId];\r\n    if (wall.nextsector == -1) {\r\n      this.type = PortalType.MID;\r\n    } else {\r\n      const nextsectorId = wall.nextsector;\r\n      const nextsector = board.sectors[nextsectorId];\r\n      const curslope = createSlopeCalculator(board, sectorId);\r\n      const nextslope = createSlopeCalculator(board, nextsectorId);\r\n      const cz = curslope(x, y, sector.ceilingheinum) + sector.ceilingz;\r\n      const cnz = nextslope(x, y, nextsector.ceilingheinum) + nextsector.ceilingz;\r\n      const fz = curslope(x, y, sector.floorheinum) + sector.floorz;\r\n      const fnz = nextslope(x, y, nextsector.floorheinum) + nextsector.floorz;\r\n      if (z >= fnz && z <= fz) {\r\n        this.type = PortalType.DOWN;\r\n        this.slope = (x: number, y: number) => (curslope(x, y, sector.floorheinum) + sector.floorz) / ZSCALE;\r\n      } else if (z <= cnz && z >= cz) {\r\n        this.type = PortalType.UP;\r\n        this.slope = (x: number, y: number) => (curslope(x, y, sector.ceilingheinum) + sector.ceilingz) / ZSCALE;\r\n      } else throw new Error(`Invalid point`);\r\n    }\r\n    this.move(x, y, z);\r\n    this.addPoint();\r\n  }\r\n\r\n  private buildHull() {\r\n    return buildHull([...this.points, this.pointer], (x, y) => this.project(x, y));\r\n  }\r\n\r\n  public stop(board: Board, art: ArtProvider, refs: BuildReferenceTracker, api: EngineApi, dist: number) {\r\n    drawWall(board, this.wallId, this.type, this.buildHull(), art, refs, api, dist);\r\n  }\r\n\r\n  private project(x: number, y: number): point_3d {\r\n    const t = vec2.fromValues(x, y);\r\n    vec2.sub(t, t, this.startPoint);\r\n    const off = vec2.dot(this.wallVec, t);\r\n    vec2.copy(t, this.wallVec);\r\n    vec2.scale(t, t, off);\r\n    vec2.add(t, t, this.startPoint);\r\n    return [t[0], t[1], off];\r\n  }\r\n\r\n  public move(x: number, y: number, z: number) {\r\n    const [xp, yp, _] = this.project(x, y);\r\n    if (this.needToMove(xp, yp, z)) return;\r\n    this.pointer[0] = xp;\r\n    this.pointer[1] = yp;\r\n    this.pointer[2] = z / ZSCALE;\r\n    this.needToUpdate = true;\r\n    this.updateLastMove(xp, yp, z);\r\n  }\r\n\r\n  private needToMove(x: number, y: number, z: number) {\r\n    return this.lastMove[0] == x && this.lastMove[1] == y && this.lastMove[2] == z;\r\n  }\r\n\r\n  private updateLastMove(x: number, y: number, z: number) {\r\n    this.lastMove[0] = x;\r\n    this.lastMove[1] = y;\r\n    this.lastMove[2] = z;\r\n  }\r\n\r\n  public addPoint() {\r\n    this.points.push(this.pointer);\r\n    this.pointer = [...this.pointer];\r\n    this.needToUpdate = true;\r\n  }\r\n\r\n  public popPoint() {\r\n    this.points.pop();\r\n    this.needToUpdate = true;\r\n  }\r\n\r\n  public hasPoints() {\r\n    return this.points.length != 0;\r\n  }\r\n\r\n  public onLastPoint() {\r\n    if (this.points.length == 0) return false;\r\n    const lastPoint = this.points[this.points.length - 1];\r\n    return vec3.exactEquals(lastPoint, this.pointer);\r\n  }\r\n\r\n  private update() {\r\n    if (!this.needToUpdate) return;\r\n    this.updateContour();\r\n    this.updateContourPoints();\r\n    this.needToUpdate = false;\r\n  }\r\n\r\n  private updateContourPoints() {\r\n  }\r\n\r\n  private updateContour() {\r\n    this.contour.needToRebuild();\r\n    const hull = this.buildHull();\r\n    const line = new LineBuilder();\r\n    if (this.type == PortalType.DOWN) this.buildNonMid(line, hull, true);\r\n    else if (this.type == PortalType.UP) this.buildNonMid(line, hull, false);\r\n    else if (this.type == PortalType.MID) this.buildMid(line, hull);\r\n    // for (const [p1, p2] of loopPairs([...this.points, this.pointer])) line.segment(p1[0], p1[2], p1[1], p2[0], p2[2], p2[1])\r\n    line.build(this.contour.buff);\r\n  }\r\n\r\n  private buildMid(line: LineBuilder, hull: Point[],) {\r\n    const last = hull[hull.length - 1];\r\n    const first = hull[0];\r\n    this.addSegment(line, last.x, last.zdown, last.y, last.x, last.zup, last.y);\r\n    this.addSegment(line, first.x, first.zdown, first.y, first.x, first.zup, first.y);\r\n    for (let i = 0; i < hull.length - 1; i++) {\r\n      const p1 = hull[i];\r\n      const p2 = hull[i + 1];\r\n      this.addSegment(line, p1.x, p1.zup, p1.y, p1.x, p1.zup + p1.zupoff, p1.y);\r\n      this.addSegment(line, p1.x, p1.zdown, p1.y, p1.x, p1.zdown + p1.zdownoff, p1.y);\r\n      this.addSegment(line, p1.x, p1.zup + p1.zupoff, p1.y, p2.x, p2.zup, p2.y);\r\n      this.addSegment(line, p1.x, p1.zdown + p1.zdownoff, p1.y, p2.x, p2.zdown, p2.y);\r\n    }\r\n  }\r\n\r\n  private buildNonMid(line: LineBuilder, hull: Point[], down: boolean) {\r\n    const last = hull[hull.length - 1];\r\n    const first = hull[0];\r\n    const lastz = this.slope(last.x, last.y);\r\n    const firstz = this.slope(first.x, first.y);\r\n    this.addSegment(line, last.x, lastz, last.y, last.x, down ? last.zup : last.zdown, last.y);\r\n    this.addSegment(line, first.x, firstz, first.y, first.x, down ? first.zup : first.zdown, first.y);\r\n    this.addSegment(line, last.x, lastz, last.y, first.x, firstz, first.y);\r\n    for (let i = 0; i < hull.length - 1; i++) {\r\n      const p1 = hull[i];\r\n      const p2 = hull[i + 1];\r\n      this.addSegment(line, p1.x, down ? p1.zup : p1.zdown, p1.y, p1.x, down ? p1.zup + p1.zupoff : p1.zdown + p1.zdownoff, p1.y);\r\n      this.addSegment(line, p1.x, down ? p1.zup + p1.zupoff : p1.zdown + p1.zdownoff, p1.y, p2.x, down ? p2.zup : p2.zdown, p2.y);\r\n    }\r\n  }\r\n\r\n  private addSegment(line: LineBuilder, x1: number, z1: number, y1: number, x2: number, z2: number, y2: number) {\r\n    const dx = this.lastDistance * this.wallNormal[0];\r\n    const dy = this.lastDistance * this.wallNormal[1];\r\n    line.segment(x1, z1, y1, x2, z2, y2);\r\n    line.segment(x1 + dx, z1, y1 + dy, x2 + dx, z2, y2 + dy);\r\n    line.segment(x1 + dx, z1, y1 + dy, x1, z1, y1);\r\n    line.segment(x2 + dx, z2, y2 + dy, x2, z2, y2);\r\n  }\r\n}\r\n\r\nexport async function DrawWallModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const [bus, toolsBus, api, builders, view, board, refs, art, grid] = await Promise.all([\r\n      injector.getInstance(BUS),\r\n      injector.getInstance(TOOLS_BUS),\r\n      injector.getInstance(ENGINE_API),\r\n      injector.getInstance(BUILDERS_FACTORY),\r\n      injector.getInstance(VIEW),\r\n      injector.getInstance(BOARD),\r\n      injector.getInstance(REFERENCE_TRACKER),\r\n      injector.getInstance(ART),\r\n      injector.getInstance(GRID),\r\n    ]);\r\n    toolsBus.connect(new DrawWall(builders, api, view, board, refs, bus, art, grid));\r\n  });\r\n}\r\n\r\nexport class DrawWall extends DefaultTool {\r\n  private wallId = -1;\r\n  private movingHandle = new MovingHandle();\r\n\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    private api: EngineApi,\r\n    private view: View,\r\n    private board: BoardProvider,\r\n    private refs: BuildReferenceTracker,\r\n    private bus: MessageBus,\r\n    private art: ArtProvider,\r\n    private grid: GridController,\r\n    private portal = new PortalModel(factory),\r\n  ) { super() }\r\n\r\n  private start() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null || !target.entity.isWall()) return;\r\n    this.activate();\r\n    const [x, y, z] = target.coords;\r\n    this.portal.start(this.board(), target.entity.id, x, y, z);\r\n    this.wallId = target.entity.id;\r\n  }\r\n\r\n  private stop() {\r\n    this.portal.stop(this.board(), this.art, this.refs, this.api, this.getDistance());\r\n    this.wallId = -1;\r\n    this.bus.handle(COMMIT);\r\n    this.bus.handle(new BoardInvalidate(null));\r\n    this.movingHandle.stop();\r\n    this.deactivate();\r\n  }\r\n\r\n  private abort() {\r\n    this.wallId = -1;\r\n    this.movingHandle.stop();\r\n    this.deactivate();\r\n  }\r\n\r\n  private insertPoint() {\r\n    if (this.wallId == -1) this.start();\r\n    else if (this.movingHandle.isActive()) this.stop();\r\n    else if (this.portal.onLastPoint()) this.pushPortal();\r\n    else this.portal.addPoint();\r\n  }\r\n\r\n  private popPoint() {\r\n    if (this.wallId == -1) return;\r\n    else {\r\n      this.portal.popPoint();\r\n      if (!this.portal.hasPoints()) this.abort();\r\n    }\r\n  }\r\n\r\n  private pushPortal() {\r\n    const target = this.view.snapTarget();\r\n    this.movingHandle.start(build2gl(vec3.create(), target.coords));\r\n  }\r\n\r\n  private _wallNormal = vec3.create();\r\n  private getDistance(): number {\r\n    if (!this.movingHandle.isActive()) return 0;\r\n    const dx = this.movingHandle.dx;\r\n    const dy = this.movingHandle.dy;\r\n    const [nx, , ny] = wallNormal(this._wallNormal, this.board(), this.wallId);\r\n    return this.grid.snap(dot2d(nx, ny, dx, dy));\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    switch (msg.name) {\r\n      case 'draw': this.insertPoint(); return;\r\n      case 'undo_draw': this.popPoint(); return;\r\n    }\r\n  }\r\n\r\n  private _start = vec3.create();\r\n  private _dir = vec3.create();\r\n  public Frame(msg: Frame) {\r\n    if (this.wallId == -1) return;\r\n    if (this.movingHandle.isActive()) {\r\n      const { start, dir } = this.view.dir();\r\n      this.movingHandle.update(false, false, build2gl(this._start, start), build2gl(this._dir, dir));\r\n    } else {\r\n      const target = this.view.snapTarget();\r\n      const [x, y, z] = target.coords;\r\n      this.portal.move(x, y, z);\r\n    }\r\n  }\r\n\r\n  public Render(msg: Render) {\r\n    if (this.wallId == -1) return;\r\n    msg.consumer(this.portal.getRenderable(this.getDistance()));\r\n  }\r\n}","import { joinSectors } from \"../../../build/board/mutations/joinsectors\";\r\nimport { create, Module } from \"../../../utils/injector\";\r\nimport { BOARD, BoardProvider, BuildReferenceTracker, REFERENCE_TRACKER, VIEW, View } from \"../../apis/app\";\r\nimport { BUS, MessageBus } from \"../../apis/handler\";\r\nimport { COMMIT, INVALIDATE_ALL, NamedMessage } from \"../messages\";\r\nimport { DefaultTool, TOOLS_BUS } from \"./toolsbus\";\r\n\r\nexport function JoinSectorsModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(TOOLS_BUS);\r\n    bus.connect(await create(injector, JoinSectors, BUS, VIEW, BOARD, REFERENCE_TRACKER));\r\n  });\r\n}\r\n\r\nexport class JoinSectors extends DefaultTool {\r\n  private sectorId1 = -1;\r\n  private sectorId2 = -1;\r\n\r\n  constructor(\r\n    private bus: MessageBus,\r\n    private view: View,\r\n    private board: BoardProvider,\r\n    private refs: BuildReferenceTracker,\r\n  ) { super() }\r\n\r\n  private join() {\r\n    const target = this.view.target();\r\n    if (target.entity == null || !target.entity.isSector()) return;\r\n    const sectorId = target.entity.id;\r\n    if (this.sectorId1 == -1) {\r\n      this.activate();\r\n      this.sectorId1 = sectorId;\r\n    } else if (this.sectorId2 == -1) {\r\n      this.sectorId2 = sectorId;\r\n    }\r\n\r\n    if (this.sectorId1 != -1 && this.sectorId2 != -1) {\r\n      let result = joinSectors(this.board(), this.sectorId1, this.sectorId2, this.refs);\r\n      if (result == 0) {\r\n        this.bus.handle(COMMIT);\r\n        this.bus.handle(INVALIDATE_ALL);\r\n      }\r\n      this.sectorId1 = -1;\r\n      this.sectorId2 = -1;\r\n      this.deactivate();\r\n    }\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    if (msg.name == 'join_sectors') this.join();\r\n  }\r\n}","import { EngineApi } from \"../../../build/board/mutations/api\";\r\nimport { pushWall } from \"../../../build/board/mutations/walls\";\r\nimport { sectorOfWall } from \"../../../build/board/query\";\r\nimport { build2gl, createSlopeCalculator, wallNormal, ZSCALE } from \"../../../build/utils\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { Module } from \"../../../utils/injector\";\r\nimport { dot2d, int } from \"../../../utils/mathutils\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, BuildReferenceTracker, ENGINE_API, GRID, GridController, REFERENCE_TRACKER, View, VIEW } from \"../../apis/app\";\r\nimport { BUS, MessageBus, MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { BuildersFactory, BUILDERS_FACTORY } from \"../../modules/geometry/common\";\r\nimport { LineBuilder } from \"../../modules/gl/buffers\";\r\nimport { MovingHandle } from \"../handle\";\r\nimport { COMMIT, Frame, INVALIDATE_ALL, NamedMessage, Render } from \"../messages\";\r\nimport { DefaultTool, Tool, TOOLS_BUS } from \"./toolsbus\";\r\n\r\nconst wallNormal_ = vec3.create();\r\nconst wallNormal1_ = vec3.create();\r\nconst target_ = vec3.create();\r\nconst start_ = vec3.create();\r\nconst dir_ = vec3.create();\r\n\r\nexport async function PushWallModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const [bus, toolsBus, api, builders, view, art, board, refs, grid] = await Promise.all([\r\n      injector.getInstance(BUS),\r\n      injector.getInstance(TOOLS_BUS),\r\n      injector.getInstance(ENGINE_API),\r\n      injector.getInstance(BUILDERS_FACTORY),\r\n      injector.getInstance(VIEW),\r\n      injector.getInstance(ART),\r\n      injector.getInstance(BOARD),\r\n      injector.getInstance(REFERENCE_TRACKER),\r\n      injector.getInstance(GRID),\r\n    ])\r\n    toolsBus.connect(new PushWall(builders, api, view, art, board, refs, bus, grid));\r\n  });\r\n}\r\n\r\nexport class PushWall extends DefaultTool {\r\n  private wallId = -1;\r\n  private copy = false;\r\n  private movingHandle = new MovingHandle();\r\n\r\n  constructor(\r\n    builders: BuildersFactory,\r\n    private api: EngineApi,\r\n    private view: View,\r\n    private art: ArtProvider,\r\n    private board: BoardProvider,\r\n    private refs: BuildReferenceTracker,\r\n    private bus: MessageBus,\r\n    private grid: GridController,\r\n    private wireframe = builders.wireframe('utils')\r\n  ) { super(); }\r\n\r\n  private start(copy: boolean) {\r\n    this.activate();\r\n    this.copy = copy;\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null || !target.entity.isWall()) return;\r\n    this.wallId = target.entity.id;\r\n    this.movingHandle.start(build2gl(target_, target.coords));\r\n  }\r\n\r\n  private abort() {\r\n    this.deactivate();\r\n    this.wallId = -1;\r\n    this.movingHandle.stop();\r\n  }\r\n\r\n  private stop() {\r\n    pushWall(this.board(), this.wallId, this.getDistance(), this.art, this.copy, this.refs, this.api);\r\n    this.bus.handle(COMMIT);\r\n    this.bus.handle(INVALIDATE_ALL);\r\n    this.abort();\r\n  }\r\n\r\n  private getDistance(): number {\r\n    const dx = this.movingHandle.dx;\r\n    const dy = this.movingHandle.dy;\r\n    const [nx, , ny] = wallNormal(wallNormal1_, this.board(), this.wallId);\r\n    return this.grid.snap(dot2d(nx, ny, dx, dy));\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage,) {\r\n    switch (msg.name) {\r\n      case 'push_wall': this.movingHandle.isActive() ? this.stop() : this.start(false); return;\r\n      case 'push_wall_copy': this.movingHandle.isActive() ? this.stop() : this.start(true); return;\r\n      case 'push_wall_stop': this.abort(); return;\r\n    }\r\n  }\r\n\r\n  public Frame(msg: Frame) {\r\n    if (this.movingHandle.isActive()) {\r\n      const { start, dir } = this.view.dir();\r\n      this.movingHandle.update(false, false, build2gl(start_, start), build2gl(dir_, dir));\r\n    }\r\n  }\r\n\r\n  public Render(msg: Render) {\r\n    if (!this.movingHandle.isActive()) return;\r\n    this.updateWireframe();\r\n    msg.consumer(this.wireframe);\r\n  }\r\n\r\n  private updateWireframe() {\r\n    const board = this.board();\r\n    const normal = wallNormal(wallNormal_, board, this.wallId);\r\n    const [nx, , ny] = vec3.scale(normal, normal, this.getDistance());\r\n    const wall = board.walls[this.wallId];\r\n    const wall2 = board.walls[wall.point2];\r\n    const sectorId = sectorOfWall(board, this.wallId);\r\n    const sector = board.sectors[sectorId];\r\n    const x1 = int(wall.x + nx), y1 = int(wall.y + ny);\r\n    const x2 = int(wall2.x + nx), y2 = int(wall2.y + ny);\r\n    const slopeCalc = createSlopeCalculator(board, sectorId);\r\n    const z1 = (slopeCalc(x1, y1, sector.floorheinum) + sector.floorz) / ZSCALE;\r\n    const z2 = (slopeCalc(x1, y1, sector.ceilingheinum) + sector.ceilingz) / ZSCALE;\r\n    const z3 = (slopeCalc(x2, y2, sector.ceilingheinum) + sector.ceilingz) / ZSCALE;\r\n    const z4 = (slopeCalc(x2, y2, sector.floorheinum) + sector.floorz) / ZSCALE;\r\n    const z5 = (slopeCalc(wall.x, wall.y, sector.floorheinum) + sector.floorz) / ZSCALE;\r\n    const z6 = (slopeCalc(wall.x, wall.y, sector.ceilingheinum) + sector.ceilingz) / ZSCALE;\r\n    const z7 = (slopeCalc(wall2.x, wall2.y, sector.ceilingheinum) + sector.ceilingz) / ZSCALE;\r\n    const z8 = (slopeCalc(wall2.x, wall2.y, sector.floorheinum) + sector.floorz) / ZSCALE;\r\n\r\n    const line = new LineBuilder();\r\n    this.wireframe.needToRebuild();\r\n    line.rect(x1, z1, y1, x1, z2, y1, x2, z3, y2, x2, z4, y2);\r\n    line.segment(x1, z1, y1, wall.x, z5, wall.y);\r\n    line.segment(x1, z2, y1, wall.x, z6, wall.y);\r\n    line.segment(x2, z3, y2, wall2.x, z7, wall2.y);\r\n    line.segment(x2, z4, y2, wall2.x, z8, wall2.y);\r\n    line.build(this.wireframe.buff);\r\n  }\r\n}","import { innerWalls, loopWalls } from \"../../../build/board/loops\";\r\nimport { nextwall } from \"../../../build/board/query\";\r\nimport { Board } from \"../../../build/board/structs\";\r\nimport { Entity, EntityType, Target } from \"../../../build/hitscan\";\r\nimport { build2gl } from \"../../../build/utils\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { Deck, isEmpty } from \"../../../utils/collections\";\r\nimport { create, Dependency, Injector, Module } from \"../../../utils/injector\";\r\nimport { error } from \"../../../utils/logger\";\r\nimport { detuple0, detuple1 } from \"../../../utils/mathutils\";\r\nimport { BUS, Message, MessageHandler, MessageHandlerList, MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { RenderablesCache, RENDRABLES_CACHE } from \"../../modules/geometry/cache\";\r\nimport { EntityFactory, ENTITY_FACTORY } from \"../context\";\r\nimport { MovingHandle } from \"../handle\";\r\nimport { COMMIT, EndMove, Frame, Highlight, Move, NamedMessage, Render, SetPicnum, Shade, StartMove } from \"../messages\";\r\nimport { SectorEnt } from \"../sector\";\r\nimport { SpriteEnt } from \"../sprite\";\r\nimport { WallEnt } from \"../wall\";\r\nimport { WallSegmentsEnt } from \"../wallsegment\";\r\nimport { DefaultTool, TOOLS_BUS } from \"./toolsbus\";\r\n\r\nexport type PicNumCallback = (picnum: number) => void;\r\nexport type PicNumSelector = (cb: PicNumCallback) => void;\r\nexport const PICNUM_SELECTOR = new Dependency<PicNumSelector>('PicNumSelector');\r\n\r\nconst handle = new MovingHandle();\r\nconst MOVE = new Move(0, 0, 0);\r\nconst START_MOVE = new StartMove();\r\nconst END_MOVE = new EndMove();\r\nconst SET_PICNUM = new SetPicnum(-1);\r\nconst HIGHLIGHT = new Highlight();\r\n\r\nconst MOVE_STATE = 'move';\r\nconst LOOP_STATE = 'select_loop_mod';\r\nconst FULL_LOOP_STATE = 'select_full_loop_mod';\r\n\r\nexport const MOVE_COPY = 'move.copy';\r\nexport const MOVE_VERTICAL = 'move.vertical';\r\nexport const MOVE_PARALLEL = 'move.parallel';\r\n\r\nconst clipboardPicnum = new SetPicnum(0);\r\nconst clipboardShade = new Shade(0, true);\r\n\r\nconst list = new Deck<MessageHandler>();\r\nexport function getFromHitscan(factory: EntityFactory): Deck<MessageHandler> {\r\n  const target = factory.ctx.view.snapTarget();\r\n  list.clear();\r\n  if (target.entity == null) return list;\r\n  const fullLoop = factory.ctx.state.get<boolean>(FULL_LOOP_STATE)\r\n    ? innerWalls\r\n    : factory.ctx.state.get<boolean>(LOOP_STATE)\r\n      ? loopWalls\r\n      : null;\r\n  const board = factory.ctx.board();\r\n  if (target.entity.type == EntityType.WALL_POINT) {\r\n    const w = target.entity.id;\r\n    list.push(fullLoop ? factory.wallSegment(fullLoop(board, w)) : factory.wall(w));\r\n  } else if (target.entity.isWall()) {\r\n    wallSegment(fullLoop, factory, target.entity.id, target.entity.type == EntityType.LOWER_WALL);\r\n  } else if (target.entity.isSector()) {\r\n    sector(fullLoop, target, factory);\r\n  } else if (target.entity.isSprite()) {\r\n    list.push(factory.sprite(target.entity.id));\r\n  }\r\n  return list;\r\n}\r\n\r\nfunction sector(fullLoop: (board: Board, wallId: number) => Iterable<number>, target: Target, factory: EntityFactory) {\r\n  const board = factory.ctx.board();\r\n  if (fullLoop) {\r\n    const firstWall = board.sectors[target.entity.id].wallptr;\r\n    list.push(factory.wallSegment(fullLoop(board, firstWall)));\r\n    const type = target.entity.type == EntityType.CEILING ? EntityType.FLOOR : EntityType.CEILING;\r\n    list.push(factory.sector(new Entity(target.entity.id, type)));\r\n  }\r\n  list.push(factory.sector(target.entity.clone()));\r\n}\r\n\r\nfunction wallSegment(fullLoop: (board: Board, wallId: number) => Iterable<number>, factory: EntityFactory, w: number, bottom: boolean) {\r\n  const board = factory.ctx.board();\r\n  if (fullLoop) {\r\n    const loop = fullLoop(board, w);\r\n    list.push(factory.wallSegment(loop, loop, bottom));\r\n  } else {\r\n    const w1 = nextwall(board, w);\r\n    list.push(factory.wallSegment([w, w1], [w], bottom));\r\n  }\r\n}\r\n\r\nconst target_ = vec3.create();\r\nconst start_ = vec3.create();\r\nconst dir_ = vec3.create();\r\n\r\nexport async function SelectionModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(TOOLS_BUS);\r\n    bus.connect(await create(injector, Selection, PICNUM_SELECTOR, RENDRABLES_CACHE, ENTITY_FACTORY));\r\n  });\r\n}\r\n\r\nexport class Selection extends DefaultTool {\r\n  private selection = new MessageHandlerList();\r\n  private highlighted = new MessageHandlerList();\r\n  private valid = true;\r\n\r\n  constructor(\r\n    private picnumSelector: PicNumSelector,\r\n    private renderables: RenderablesCache,\r\n    private factory: EntityFactory,\r\n    private ctx = factory.ctx) {\r\n    super();\r\n    ctx.state.register(MOVE_STATE, false);\r\n    ctx.state.register(MOVE_COPY, false);\r\n    ctx.state.register(MOVE_VERTICAL, false);\r\n    ctx.state.register(MOVE_PARALLEL, false);\r\n    ctx.state.register(LOOP_STATE, false);\r\n    ctx.state.register(FULL_LOOP_STATE, false);\r\n  }\r\n\r\n  public Frame(msg: Frame) {\r\n    if (!handle.isActive()) this.updateSelection();\r\n    if (isEmpty(this.selection.list()) && isEmpty(this.highlighted.list())) return;\r\n    if (this.activeMove()) {\r\n      this.activate();\r\n      this.updateHandle();\r\n      try {\r\n        this.updateMove();\r\n      } catch (e) {\r\n        this.valid = false;\r\n        error(e);\r\n      }\r\n    }\r\n  }\r\n\r\n  private updateSelection() {\r\n    const underCursor = getFromHitscan(this.factory);\r\n    this.highlighted.list().clear().pushAll(underCursor.clone());\r\n  }\r\n\r\n  private checkSelected(ent: Entity, s: any) {\r\n    if (ent.isSector() && s instanceof SectorEnt && ent.id == s.sectorEnt.id && ent.type == s.sectorEnt.type) return true;\r\n    if (ent.isSprite() && s instanceof SpriteEnt && ent.id == s.spriteId) return true;\r\n    if (ent.isWall()) {\r\n      if (s instanceof WallEnt && ent.id == s.wallId) return true;\r\n      if (s instanceof WallSegmentsEnt) for (const w of s.highlighted) if (w == ent.id) return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  private selectedUnderCursor(): boolean {\r\n    const snapTarget = this.ctx.view.snapTarget();\r\n    if (snapTarget.entity == null) return false;\r\n    const ent = snapTarget.entity;\r\n    for (const s of this.selection.list()) if (this.checkSelected(ent, s)) return true;\r\n    for (const s of this.highlighted.list()) if (this.checkSelected(ent, s)) return true;\r\n    return false;\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    switch (msg.name) {\r\n      case 'set_picnum': this.setTexture(); return;\r\n      case 'copy': this.copy(); return;\r\n      case 'paste_shade': this.handleSelected(clipboardShade); this.commit(); return;\r\n      case 'paste_picnum': this.handleSelected(clipboardPicnum); this.commit(); return;\r\n      case 'replace_selection': if (!handle.isActive()) this.selection.list().clear().pushAll(this.highlighted.list().clone()); return;\r\n      case 'add_selection': this.selection.list().pushAll(this.highlighted.list().clone()); return;\r\n      case 'clear_selection': this.selection.list().clear(); return;\r\n      default: this.handleSelected(msg);\r\n    }\r\n  }\r\n\r\n  public handleDefault(msg: Message) {\r\n    this.handleSelected(msg);\r\n  }\r\n\r\n  private handleSelected(msg: Message) {\r\n    this.highlighted.handle(msg);\r\n    this.selection.handle(msg);\r\n  }\r\n\r\n  private commit() {\r\n    this.ctx.bus.handle(COMMIT);\r\n  }\r\n\r\n  private cloneSelected() {\r\n    const selected = this.highlighted.clone();\r\n    selected.list().pushAll(this.selection.list());\r\n    return selected;\r\n  }\r\n\r\n  private isStartMove() {\r\n    return !handle.isActive() && this.ctx.state.get(MOVE_STATE) && this.selectedUnderCursor();\r\n  }\r\n\r\n  private activeMove() {\r\n    const start = this.isStartMove();\r\n    if (this.valid == false && start) this.valid = true;\r\n    const move = handle.isActive() && this.ctx.state.get(MOVE_STATE);\r\n    const end = handle.isActive() && !this.ctx.state.get(MOVE_STATE);\r\n    return this.valid && (start || move || end);\r\n  }\r\n\r\n  private updateHandle() {\r\n    const vertical = this.ctx.state.get<boolean>(MOVE_VERTICAL);\r\n    const parallel = this.ctx.state.get<boolean>(MOVE_PARALLEL);\r\n    const { start, dir } = this.ctx.view.dir();\r\n    handle.update(vertical, parallel, build2gl(start_, start), build2gl(dir_, dir));\r\n  }\r\n\r\n  private updateMove() {\r\n    if (this.isStartMove()) {\r\n      handle.start(build2gl(target_, this.ctx.view.target().coords));\r\n      this.handleSelected(START_MOVE);\r\n    } else if (!this.ctx.state.get(MOVE_STATE)) {\r\n      handle.stop();\r\n      this.handleSelected(END_MOVE);\r\n      this.commit();\r\n      this.deactivate();\r\n      return;\r\n    }\r\n\r\n    if (Math.abs(MOVE.dx - handle.dx) >= this.ctx.gridController.getGridSize() / 2\r\n      || Math.abs(MOVE.dy - handle.dy) >= this.ctx.gridController.getGridSize() / 2\r\n      || Math.abs(MOVE.dz - handle.dz) >= this.ctx.gridController.getGridSize() / 2) {\r\n      MOVE.dx = handle.dx;\r\n      MOVE.dy = handle.dy;\r\n      MOVE.dz = handle.dz;\r\n      this.handleSelected(MOVE);\r\n    }\r\n  }\r\n\r\n  private setTexture() {\r\n    const sel = this.cloneSelected();\r\n    this.picnumSelector((picnum: number) => {\r\n      if (picnum == -1) return;\r\n      SET_PICNUM.picnum = picnum;\r\n      sel.handle(SET_PICNUM);\r\n      this.commit();\r\n    })\r\n  }\r\n\r\n  private copy() {\r\n    const target = this.ctx.view.target();\r\n    const board = this.ctx.board();\r\n    if (target.entity == null) return;\r\n    switch (target.entity.type) {\r\n      case EntityType.CEILING:\r\n        clipboardShade.value = board.sectors[target.entity.id].ceilingshade;\r\n        clipboardPicnum.picnum = board.sectors[target.entity.id].ceilingpicnum;\r\n        break;\r\n      case EntityType.FLOOR:\r\n        clipboardShade.value = board.sectors[target.entity.id].floorshade;\r\n        clipboardPicnum.picnum = board.sectors[target.entity.id].floorpicnum;\r\n        break;\r\n      case EntityType.LOWER_WALL:\r\n      case EntityType.MID_WALL:\r\n      case EntityType.UPPER_WALL:\r\n        clipboardShade.value = board.walls[target.entity.id].shade;\r\n        clipboardPicnum.picnum = board.walls[target.entity.id].picnum;\r\n        break;\r\n      case EntityType.SPRITE:\r\n        clipboardShade.value = board.sprites[target.entity.id].shade;\r\n        clipboardPicnum.picnum = board.sprites[target.entity.id].picnum;\r\n        break;\r\n    }\r\n  }\r\n\r\n  public Render(msg: Render) {\r\n    HIGHLIGHT.set.clear();\r\n    this.handleSelected(HIGHLIGHT);\r\n    for (const v of HIGHLIGHT.set.keys()) {\r\n      const type = detuple0(v);\r\n      const id = detuple1(v);\r\n      const rs = this.renderables.helpers;\r\n      switch (type) {\r\n        case 0: msg.consumer(rs.sector(id).ceiling); break;\r\n        case 1: msg.consumer(rs.sector(id).floor); break;\r\n        case 2: msg.consumer(rs.wall(id)); break;\r\n        case 3: msg.consumer(rs.wallPoint(id)); break;\r\n        case 4: msg.consumer(rs.sprite(id)); break;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\n","import { forEach } from \"../../../utils/collections\";\r\nimport { Dependency, Injector } from \"../../../utils/injector\";\r\nimport { BUS, Message, MessageBus, MessageHandler, MessageHandlerReflective } from \"../../apis/handler\";\r\n\r\nexport const TOOLS_BUS = new Dependency<ToolsMessageBus>(\"ToolsBus\");\r\n\r\nexport async function ToolsBusConstructor(injector: Injector) {\r\n  const bus = await injector.getInstance(BUS);\r\n  const toolsBus = new ToolsMessageBus();\r\n  bus.connect(toolsBus);\r\n  return toolsBus;\r\n}\r\n\r\nexport interface Tool extends MessageHandler {\r\n  activateHandler(handler: (tool: Tool) => void): void;\r\n  deactivateHandler(handler: (tool: Tool) => void): void;\r\n};\r\n\r\nexport class DefaultTool extends MessageHandlerReflective implements Tool {\r\n  private activateH: (tool: Tool) => void;\r\n  private deactivateH: (tool: Tool) => void;\r\n  activateHandler(handler: (tool: Tool) => void): void { this.activateH = handler }\r\n  deactivateHandler(handler: (tool: Tool) => void): void { this.deactivateH = handler }\r\n  protected activate() { this.activateH(this) }\r\n  protected deactivate() { this.deactivateH(this) }\r\n}\r\n\r\nclass ToolsMessageBus implements MessageHandler {\r\n  private tools: Tool[] = [];\r\n  private activeTool: Tool = null;\r\n\r\n  public connect(tool: Tool) {\r\n    if (this.tools.indexOf(tool) != -1) throw new Error(`Tool ${tool} already bound`);\r\n    this.tools.push(tool);\r\n    tool.activateHandler(tool => this.activateTool(tool));\r\n    tool.deactivateHandler(tool => this.deactivateTool(tool));\r\n  }\r\n\r\n  private activateTool(tool: Tool) {\r\n    if (this.activeTool != null && this.activeTool != tool) throw new Error('');\r\n    this.activeTool = tool;\r\n  }\r\n\r\n  private deactivateTool(tool: Tool) {\r\n    if (this.activeTool != tool) throw new Error();\r\n    this.activeTool = null;\r\n  }\r\n\r\n  handle(message: Message): void {\r\n    if (this.activeTool != null) this.activeTool.handle(message);\r\n    else forEach(this.tools, t => t.handle(message));\r\n  }\r\n}","import { EngineApi } from \"../../../build/board/mutations/api\";\r\nimport { addSprite } from \"../../../build/board/mutations/internal\";\r\nimport { deleteLoop, deleteLoopFull, deleteSectorFull, fillInnerLoop, setFirstWall } from \"../../../build/board/mutations/sectors\";\r\nimport { splitWall } from \"../../../build/board/mutations/walls\";\r\nimport { sectorOfWall } from \"../../../build/board/query\";\r\nimport { Board, WALL_SPRITE } from \"../../../build/board/structs\";\r\nimport { EntityType } from \"../../../build/hitscan\";\r\nimport { slope, vec2ang, wallNormal } from \"../../../build/utils\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { Module } from \"../../../utils/injector\";\r\nimport { info } from \"../../../utils/logger\";\r\nimport { int } from \"../../../utils/mathutils\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, BuildReferenceTracker, ENGINE_API, GRID, GridController, REFERENCE_TRACKER, View, VIEW } from \"../../apis/app\";\r\nimport { BUS, MessageBus, MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { invalidateSectorAndWalls } from \"../editutils\";\r\nimport { COMMIT, INVALIDATE_ALL, NamedMessage } from \"../messages\";\r\nimport { PicNumSelector, PICNUM_SELECTOR } from \"./selection\";\r\n\r\nexport async function UtilsModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const [board, api, art, view, bus, refs, grid, pics] = await Promise.all([\r\n      injector.getInstance(BOARD),\r\n      injector.getInstance(ENGINE_API),\r\n      injector.getInstance(ART),\r\n      injector.getInstance(VIEW),\r\n      injector.getInstance(BUS),\r\n      injector.getInstance(REFERENCE_TRACKER),\r\n      injector.getInstance(GRID),\r\n      injector.getInstance(PICNUM_SELECTOR),\r\n    ])\r\n    bus.connect(new Utils(board, api, art, view, bus, refs, grid, pics));\r\n  });\r\n}\r\n\r\nclass Utils extends MessageHandlerReflective {\r\n  constructor(\r\n    private board: BoardProvider,\r\n    private api: EngineApi,\r\n    private art: ArtProvider,\r\n    private view: View,\r\n    private bus: MessageBus,\r\n    private refs: BuildReferenceTracker,\r\n    private gridController: GridController,\r\n    private picnumSelector: PicNumSelector\r\n  ) { super() }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    switch (msg.name) {\r\n      case 'insert_sprite': this.insertSprite(); return;\r\n      // case 'print_selected': this.print(); return;\r\n      case 'set_first_wall': this.setFirstWall(); return;\r\n      case 'fill_inner_sector': this.fillInnerLoop(); return;\r\n      case 'delete_loop': this.deleteLoop(); return;\r\n      case 'delete_full': this.deleteFull(); return;\r\n      case 'print_usage': this.printPicUsage(); return;\r\n      case 'split_wall': this.splitWall(); return;\r\n    }\r\n  }\r\n\r\n  private insertSprite() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null) return;\r\n    const [x, y, z] = target.coords;\r\n    const ent = target.entity;\r\n    this.picnumSelector((picnum: number) => {\r\n      if (picnum == -1) return;\r\n      const board = this.board();\r\n      if (ent.isWall()) {\r\n        const normal = wallNormal(vec3.create(), board, ent.id);\r\n        const offx = normal[0] * 4;\r\n        const offy = normal[2] * 4;\r\n        const sprite = this.api.newSprite();\r\n        sprite.x = int(x + offx);\r\n        sprite.y = int(y + offy)\r\n        sprite.z = this.gridController.snap(z);\r\n        sprite.sectnum = sectorOfWall(board, ent.id);\r\n        sprite.picnum = picnum;\r\n        sprite.cstat.type = WALL_SPRITE;\r\n        sprite.ang = vec2ang(normal[0], normal[2]);\r\n        addSprite(board, sprite);\r\n      } else {\r\n        const sectorId = ent.isSector() ? ent.id : ent.isSprite() ? board.sprites[ent.id].sectnum : -1;\r\n        const sprite = this.api.newSprite();\r\n        sprite.x = int(x);\r\n        sprite.y = int(y)\r\n        sprite.z = int(z);\r\n        sprite.sectnum = sectorId;\r\n        sprite.picnum = picnum;\r\n        addSprite(board, sprite);\r\n      }\r\n      this.commit();\r\n    });\r\n  }\r\n\r\n  private setFirstWall() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null || !target.entity.isWall()) return;\r\n    setFirstWall(this.board(), sectorOfWall(this.board(), target.entity.id), target.entity.id, this.refs);\r\n    this.commit();\r\n    this.invalidateAll();\r\n  }\r\n\r\n  private fillInnerLoop() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null || !target.entity.isWall()) return;\r\n    fillInnerLoop(this.board(), target.entity.id, this.refs, this.api);\r\n    this.commit();\r\n    this.invalidateAll();\r\n  }\r\n\r\n  private deleteLoop() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null || !target.entity.isWall()) return;\r\n    deleteLoop(this.board(), target.entity.id, this.refs);\r\n    this.commit();\r\n    this.invalidateAll();\r\n  }\r\n\r\n  private deleteFull() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null) return;\r\n    if (target.entity.isWall()) deleteLoopFull(this.board(), target.entity.id, this.refs);\r\n    else if (target.entity.isSector()) deleteSectorFull(this.board(), target.entity.id, this.refs);\r\n    else return;\r\n    this.commit();\r\n    this.invalidateAll();\r\n  }\r\n\r\n  private splitWall() {\r\n    const target = this.view.snapTarget();\r\n    if (target.entity == null || !target.entity.isWall()) return;\r\n    const [x, y] = target.coords;\r\n    const id = target.entity.id;\r\n    const board = this.board();\r\n\r\n    splitWall(board, id, x, y, this.art, this.refs, this.api.cloneWall);\r\n    this.commit();\r\n    const s = sectorOfWall(board, id);\r\n    invalidateSectorAndWalls(s, board, this.bus);\r\n    const nextsector = board.walls[id].nextsector;\r\n    if (nextsector != -1) {\r\n      invalidateSectorAndWalls(nextsector, board, this.bus);\r\n    }\r\n  }\r\n\r\n  private print() {\r\n    const target = this.view.target();\r\n    const board = this.board();\r\n    if (target.entity == null) return;\r\n    switch (target.entity.type) {\r\n      case EntityType.CEILING:\r\n      case EntityType.FLOOR:\r\n        info(target.entity.id, board.sectors[target.entity.id]);\r\n        break;\r\n      case EntityType.UPPER_WALL:\r\n      case EntityType.MID_WALL:\r\n      case EntityType.LOWER_WALL:\r\n        info(target.entity.id, board.walls[target.entity.id]);\r\n        break;\r\n      case EntityType.SPRITE:\r\n        info(target.entity.id, board.sprites[target.entity.id]);\r\n        break;\r\n    }\r\n  }\r\n\r\n  private getSectorPics(board: Board, sectorId: number) {\r\n    const sector = board.sectors[sectorId];\r\n    const pics = new Set<number>();\r\n    pics.add(sector.ceilingpicnum);\r\n    pics.add(sector.floorpicnum);\r\n    const wallend = sector.wallptr + sector.wallnum;\r\n    for (let w = sector.wallptr; w < wallend; w++) {\r\n      const wall = board.walls[w];\r\n      if (wall.nextwall == -1) {\r\n        pics.add(wall.picnum);\r\n      } else {\r\n        const wall2 = board.walls[wall.point2];\r\n        const nextwall = board.walls[wall.nextwall];\r\n        const nextwall2 = board.walls[nextwall.nextwall];\r\n        const nextsectorId = wall.nextsector;\r\n        const nextsector = board.sectors[nextsectorId];\r\n        const cz1 = slope(board, sectorId, wall.x, wall.y, sector.ceilingheinum) + sector.ceilingz;\r\n        const cz2 = slope(board, sectorId, wall2.x, wall2.y, sector.ceilingheinum) + sector.ceilingz;\r\n        const czn1 = slope(board, nextsectorId, nextwall.x, nextwall.y, nextsector.ceilingheinum) + sector.ceilingz;\r\n        const czn2 = slope(board, nextsectorId, nextwall2.x, nextwall2.y, nextsector.ceilingheinum) + sector.ceilingz;\r\n        if (cz1 < czn1 || cz2 < czn2) pics.add(wall.picnum);\r\n\r\n        const fz1 = slope(board, sectorId, wall.x, wall.y, sector.floorheinum) + sector.floorz;\r\n        const fz2 = slope(board, sectorId, wall2.x, wall2.y, sector.floorheinum) + sector.floorz;\r\n        const fzn1 = slope(board, nextsectorId, nextwall.x, nextwall.y, nextsector.floorheinum) + sector.floorz;\r\n        const fzn2 = slope(board, nextsectorId, nextwall2.x, nextwall2.y, nextsector.floorheinum) + sector.floorz;\r\n        if (fz1 > fzn1 || fz2 > fzn2) {\r\n          if (wall.cstat.swapBottoms) pics.add(wall2.picnum);\r\n          else pics.add(wall.picnum);\r\n        }\r\n\r\n        if (wall.cstat.masking) pics.add(wall.overpicnum);\r\n      }\r\n    }\r\n    return pics;\r\n  }\r\n\r\n  private printPicUsage() {\r\n    // const board = this.board();\r\n    // const results: [string, number][] = [];\r\n    // const picsStat = new Map<number, Set<number>>();\r\n    // for (let s = 0; s < board.numsectors; s++) {\r\n    //   const pics = [...this.getSectorPics(board, s)];\r\n    //   results.push([pics.sort().join(','), s]);\r\n    //   pics.forEach(p => {\r\n    //     let sectors = picsStat.get(p);\r\n    //     if (sectors == undefined) {\r\n    //       sectors = new Set();\r\n    //       picsStat.set(p, sectors);\r\n    //     }\r\n    //     sectors.add(s);\r\n    //   })\r\n    // }\r\n    // info([...picsStat.values()].sort((l, r) => l.size - r.size));\r\n\r\n    // const imgStats = new Map<string, Set<number>>();\r\n    // const art = this.art;\r\n    // for (let i = 0; i < 4096; i++) {\r\n    //   const info = art.getInfo(i);\r\n    //   if (info == null) continue;\r\n    //   const key = `${info.w}x${info.h}`;\r\n    //   let ids = imgStats.get(key);\r\n    //   if (ids == undefined) {\r\n    //     ids = new Set();\r\n    //     imgStats.set(key, ids);\r\n    //   }\r\n    //   ids.add(i);\r\n    // }\r\n    // info([...imgStats.entries()].sort((l, r) => l[1].size - r[1].size));\r\n    const target = this.view.target();\r\n    if (!target.entity.isSector()) return;\r\n    const board = this.board();\r\n    const art = this.art;\r\n    const sectorId = target.entity.id;\r\n    const pics = new Set<number>();\r\n    const sectors = new Set<number>();\r\n    const sizes = new Set<string>();\r\n\r\n    const sector = board.sectors[sectorId];\r\n    const pf = (p: number) => { pics.add(p); const i = art.getInfo(p); sizes.add(`${i.w}x${i.h}`) };\r\n    this.getSectorPics(board, sectorId).forEach(pf);\r\n    const wallend = sector.wallptr + sector.wallnum;\r\n    for (let w = sector.wallptr; w < wallend; w++) {\r\n      const wall = board.walls[w];\r\n      if (wall.nextsector == -1) continue;\r\n      const nextsector = wall.nextsector;\r\n      if (sectors.has(nextsector)) continue;\r\n      this.getSectorPics(board, nextsector).forEach(pf);\r\n      sectors.add(nextsector);\r\n    }\r\n    info(pics, sectors, sizes);\r\n  }\r\n\r\n  private commit() { this.bus.handle(COMMIT) }\r\n  private invalidateAll() { this.bus.handle(INVALIDATE_ALL) }\r\n}","import { connectedWalls as connected } from \"../../build/board/loops\";\r\nimport { splitWall, moveWall, mergePoints, deleteWall } from \"../../build/board/mutations/walls\";\r\nimport { lastwall, sectorOfWall } from \"../../build/board/query\";\r\nimport { Entity, EntityType } from \"../../build/hitscan\";\r\nimport { vec2 } from \"../../libs_js/glmatrix\";\r\nimport { IndexedDeck } from \"../../utils/collections\";\r\nimport { cyclic, tuple } from \"../../utils/mathutils\";\r\nimport { Message, MessageHandlerReflective } from \"../apis/handler\";\r\nimport { EditContext } from \"./context\";\r\nimport { invalidateSectorAndWalls } from \"./editutils\";\r\nimport { BoardInvalidate, COMMIT, EndMove, Flip, Highlight, Move, NamedMessage, Palette, PanRepeat, SetPicnum, Shade, StartMove } from \"./messages\";\r\nimport { MOVE_COPY } from \"./tools/selection\";\r\n\r\n\r\nexport class WallEnt extends MessageHandlerReflective {\r\n  private static invalidatedSectors = new IndexedDeck<number>();\r\n\r\n  constructor(\r\n    public wallId: number,\r\n    private ctx: EditContext,\r\n    public origin = vec2.create(),\r\n    public active = false,\r\n    public connectedWalls = connected(ctx.board(), wallId),\r\n    private valid = true) { super() }\r\n\r\n  public StartMove(msg: StartMove) {\r\n    const board = this.ctx.board();\r\n    const wall = board.walls[this.wallId];\r\n    if (this.ctx.state.get(MOVE_COPY)) {\r\n      this.wallId = splitWall(board, this.wallId, wall.x, wall.y, this.ctx.art, this.ctx.refs, this.ctx.api.cloneWall);\r\n      this.connectedWalls = connected(board, this.wallId);\r\n    }\r\n    vec2.set(this.origin, wall.x, wall.y);\r\n    this.active = true;\r\n  }\r\n\r\n  private invalidate() {\r\n    WallEnt.invalidatedSectors.clear();\r\n    const cwalls = this.connectedWalls;\r\n    const board = this.ctx.board();\r\n    for (let w of cwalls) {\r\n      let s = sectorOfWall(board, w);\r\n      if (WallEnt.invalidatedSectors.indexOf(s) == -1) {\r\n        invalidateSectorAndWalls(s, board, this.ctx.bus);\r\n        WallEnt.invalidatedSectors.push(s);\r\n      }\r\n    }\r\n  }\r\n\r\n  public Move(msg: Move) {\r\n    let x = this.ctx.gridController.snap(this.origin[0] + msg.dx);\r\n    let y = this.ctx.gridController.snap(this.origin[1] + msg.dy);\r\n    if (moveWall(this.ctx.board(), this.wallId, x, y)) {\r\n      this.invalidate();\r\n    }\r\n  }\r\n\r\n  public EndMove(msg: EndMove) {\r\n    this.active = false;\r\n    mergePoints(this.ctx.board(), this.wallId, this.ctx.refs);\r\n  }\r\n\r\n  public Highlight(msg: Highlight) {\r\n    if (this.active) {\r\n      const board = this.ctx.board();\r\n      for (const w of this.connectedWalls) {\r\n        const p = lastwall(board, w);\r\n        msg.set.add(tuple(2, w));\r\n        msg.set.add(tuple(3, w));\r\n        msg.set.add(tuple(2, p));\r\n      }\r\n    } else {\r\n      msg.set.add(tuple(3, this.wallId));\r\n    }\r\n  }\r\n\r\n  public SetPicnum(msg: SetPicnum) {\r\n    let wall = this.ctx.board().walls[this.wallId];\r\n    wall.picnum = msg.picnum;\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.wallId, EntityType.WALL_POINT)));\r\n  }\r\n\r\n  public Shade(msg: Shade) {\r\n    let wall = this.ctx.board().walls[this.wallId];\r\n    let shade = wall.shade;\r\n    if (msg.absolute && shade == msg.value) return;\r\n    if (msg.absolute) wall.shade = msg.value; else wall.shade += msg.value;\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.wallId, EntityType.WALL_POINT)));\r\n  }\r\n\r\n  public PanRepeat(msg: PanRepeat) {\r\n    let wall = this.ctx.board().walls[this.wallId];\r\n    if (msg.absolute) {\r\n      if (wall.xpanning == msg.xpan && wall.ypanning == msg.ypan && wall.xrepeat == msg.xrepeat && wall.yrepeat == msg.yrepeat) return;\r\n      wall.xpanning = msg.xpan;\r\n      wall.ypanning = msg.ypan;\r\n      wall.xrepeat = msg.xrepeat;\r\n      wall.yrepeat = msg.yrepeat;\r\n    } else {\r\n      wall.xpanning += msg.xpan;\r\n      wall.ypanning += msg.ypan;\r\n      wall.xrepeat += msg.xrepeat;\r\n      wall.yrepeat += msg.yrepeat;\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.wallId, EntityType.WALL_POINT)));\r\n  }\r\n\r\n  public Palette(msg: Palette) {\r\n    let wall = this.ctx.board().walls[this.wallId];\r\n    if (msg.absolute) {\r\n      if (msg.value == wall.pal) return;\r\n      wall.pal = msg.value;\r\n    } else {\r\n      wall.pal = cyclic(wall.pal + msg.value, msg.max);\r\n    }\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.wallId, EntityType.WALL_POINT)));\r\n  }\r\n\r\n  public Flip(msg: Flip) {\r\n    let wall = this.ctx.board().walls[this.wallId];\r\n    let flip = wall.cstat.xflip + wall.cstat.yflip * 2;\r\n    let nflip = cyclic(flip + 1, 4);\r\n    wall.cstat.xflip = nflip & 1;\r\n    wall.cstat.yflip = (nflip & 2) >> 1;\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(this.wallId, EntityType.WALL_POINT)));\r\n  }\r\n\r\n  public NamedMessage(msg: NamedMessage) {\r\n    if (msg.name == 'delete') {\r\n      deleteWall(this.ctx.board(), this.wallId, this.ctx.refs);\r\n      this.ctx.bus.handle(COMMIT);\r\n      this.ctx.bus.handle(new BoardInvalidate(null));\r\n    }\r\n  }\r\n\r\n  public BoardInvalidate(msg: BoardInvalidate) {\r\n    if (msg.ent == null) this.valid = false;\r\n  }\r\n\r\n  public handle(msg: Message) {\r\n    if (this.valid) super.handle(msg);\r\n  }\r\n}\r\n","import { canonicalWall, connectedWalls } from \"../../build/board/loops\";\r\nimport { sectorOfWall } from \"../../build/board/query\";\r\nimport { Board } from \"../../build/board/structs\";\r\nimport { Entity, EntityType, Target } from \"../../build/hitscan\";\r\nimport { mat2d, vec2 } from \"../../libs_js/glmatrix\";\r\nimport { IndexedDeck } from \"../../utils/collections\";\r\nimport { iter } from \"../../utils/iter\";\r\nimport { cyclic, int, len2d, tuple } from \"../../utils/mathutils\";\r\nimport { Message, MessageHandlerReflective } from \"../apis/handler\";\r\nimport { EditContext } from \"./context\";\r\nimport { invalidateSectorAndWalls } from \"./editutils\";\r\nimport { BoardInvalidate, EndMove, Flip, Highlight, Move, Palette, PanRepeat, ResetPanRepeat, Rotate, SetPicnum, SetWallCstat, Shade, StartMove } from \"./messages\";\r\nimport { fixxrepeat, mergePoints, moveWall } from \"../../build/board/mutations/walls\"\r\n\r\nfunction getClosestWallByIds(board: Board, target: Target, ids: Iterable<number>): number {\r\n  let id = -1;\r\n  let mindist = Number.MAX_VALUE;\r\n  const [x, y] = target.coords;\r\n  for (const w of ids) {\r\n    const wall = board.walls[w];\r\n    const dist = len2d(wall.x - x, wall.y - y);\r\n    if (dist < mindist) {\r\n      id = w;\r\n      mindist = dist;\r\n    }\r\n  }\r\n  return id == -1 ? ids[Symbol.iterator]().next().value : id;\r\n}\r\n\r\nfunction collectConnectedWalls(board: Board, walls: Iterable<number>) {\r\n  const result = new Set<number>();\r\n  for (const w of walls) connectedWalls(board, w, result);\r\n  return result;\r\n}\r\n\r\nexport class WallSegmentsEnt extends MessageHandlerReflective {\r\n  private static invalidatedSectors = new IndexedDeck<number>();\r\n\r\n  constructor(\r\n    public wallIds: Iterable<number>,\r\n    public highlighted: Iterable<number>,\r\n    public bottom: boolean,\r\n    public ctx: EditContext,\r\n    public origin = vec2.create(),\r\n    public refwall = -1,\r\n    public active = false,\r\n    public connectedWalls = collectConnectedWalls(ctx.board(), wallIds),\r\n    public canonicalWalls = iter(wallIds).map(w => canonicalWall(ctx.board(), w)).set(),\r\n    private valid = true) { super() }\r\n\r\n  private invalidate() {\r\n    const invalidatedSectors = WallSegmentsEnt.invalidatedSectors.clear();\r\n    const board = this.ctx.board();\r\n    for (const w of this.connectedWalls) {\r\n      const s = sectorOfWall(board, w);\r\n      if (invalidatedSectors.indexOf(s) == -1) {\r\n        invalidateSectorAndWalls(s, board, this.ctx.bus);\r\n        invalidatedSectors.push(s);\r\n      }\r\n    }\r\n  }\r\n\r\n  private getWall(w: number) {\r\n    const board = this.ctx.board();\r\n    const wall = board.walls[w];\r\n    return wall.cstat.swapBottoms && this.bottom && wall.nextwall != -1\r\n      ? board.walls[wall.nextwall]\r\n      : wall;\r\n  }\r\n\r\n  private invalidateWall(w: number) {\r\n    const board = this.ctx.board();\r\n    this.ctx.bus.handle(new BoardInvalidate(new Entity(w, EntityType.WALL_POINT)));\r\n    const wall = board.walls[w];\r\n    if (wall.cstat.swapBottoms && wall.nextwall != -1 ||\r\n      wall.nextwall != -1 && board.walls[wall.nextwall].cstat.swapBottoms)\r\n      this.ctx.bus.handle(new BoardInvalidate(new Entity(wall.nextwall, EntityType.WALL_POINT)));\r\n  }\r\n\r\n  public StartMove(msg: StartMove) {\r\n    const board = this.ctx.board();\r\n    this.refwall = getClosestWallByIds(board, this.ctx.view.target(), this.canonicalWalls);\r\n    const wall = board.walls[this.refwall];\r\n    vec2.set(this.origin, wall.x, wall.y);\r\n    this.active = true;\r\n  }\r\n\r\n  public Move(msg: Move) {\r\n    const board = this.ctx.board();\r\n    const x = this.ctx.gridController.snap(this.origin[0] + msg.dx);\r\n    const y = this.ctx.gridController.snap(this.origin[1] + msg.dy);\r\n    const refwall = board.walls[this.refwall];\r\n    const dx = x - refwall.x;\r\n    const dy = y - refwall.y;\r\n    if (moveWall(board, this.refwall, x, y)) {\r\n      for (const w of this.canonicalWalls) {\r\n        if (w == this.refwall) continue;\r\n        const wall = board.walls[w];\r\n        moveWall(board, w, wall.x + dx, wall.y + dy);\r\n      }\r\n      this.invalidate();\r\n    }\r\n  }\r\n\r\n  public EndMove(msg: EndMove) {\r\n    this.active = false;\r\n    for (let w of this.wallIds) mergePoints(this.ctx.board(), w, this.ctx.refs);\r\n  }\r\n\r\n  public Rotate(msg: Rotate) {\r\n    const board = this.ctx.board();\r\n    const target = this.ctx.view.snapTarget();\r\n    const [cx, cy] = target.coords;\r\n    const ang = (msg.da / 128) * (Math.PI / 8);\r\n    const matrix = mat2d.create();\r\n    mat2d.translate(matrix, matrix, [cx, cy]);\r\n    mat2d.rotate(matrix, matrix, ang);\r\n    mat2d.translate(matrix, matrix, [-cx, -cy]);\r\n    for (const w of this.canonicalWalls) {\r\n      const wall = board.walls[w];\r\n      const [x, y] = vec2.transformMat2d([], [wall.x, wall.y], matrix);\r\n      moveWall(board, w, int(x), int(y));\r\n    }\r\n    this.invalidate();\r\n  }\r\n\r\n  public Highlight(msg: Highlight) {\r\n    // const board = this.ctx.board();\r\n    // if (this.active) {\r\n    //   let cwalls = this.connectedWalls;\r\n    //   for (let w of cwalls) {\r\n    //     let s = sectorOfWall(board, w);\r\n    //     let p = lastwall(board, w);\r\n    //     msg.set.add(tuple(2, w));\r\n    //     msg.set.add(tuple(3, w));\r\n    //     msg.set.add(tuple(2, p));\r\n    //     msg.set.add(tuple(0, s));\r\n    //     msg.set.add(tuple(1, s));\r\n    //   }\r\n    // } else {\r\n    const hwalls = this.highlighted;\r\n    for (const w of hwalls) msg.set.add(tuple(2, w));\r\n    // }\r\n  }\r\n\r\n  public SetPicnum(msg: SetPicnum) {\r\n    for (const w of this.highlighted) {\r\n      const wall = this.getWall(w);\r\n      wall.picnum = msg.picnum;\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public Shade(msg: Shade) {\r\n    for (const w of this.highlighted) {\r\n      const wall = this.getWall(w);\r\n      const shade = wall.shade;\r\n      if (msg.absolute && shade == msg.value) return;\r\n      if (msg.absolute) wall.shade = msg.value; else wall.shade += msg.value;\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public ResetPanRepeat(msg: ResetPanRepeat) {\r\n    for (const w of this.highlighted) {\r\n      const wall = this.getWall(w);\r\n      wall.xpanning = 0;\r\n      wall.ypanning = 0;\r\n      wall.yrepeat = 8;\r\n      fixxrepeat(this.ctx.board(), w);\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public PanRepeat(msg: PanRepeat) {\r\n    for (const w of this.highlighted) {\r\n      const wall = this.getWall(w);\r\n      if (msg.absolute) {\r\n        if (wall.xpanning == msg.xpan && wall.ypanning == msg.ypan && wall.xrepeat == msg.xrepeat && wall.yrepeat == msg.yrepeat) return;\r\n        wall.xpanning = msg.xpan;\r\n        wall.ypanning = msg.ypan;\r\n        wall.xrepeat = msg.xrepeat;\r\n        wall.yrepeat = msg.yrepeat;\r\n      } else {\r\n        wall.xpanning += msg.xpan;\r\n        wall.ypanning += msg.ypan;\r\n        wall.xrepeat += msg.xrepeat;\r\n        wall.yrepeat += msg.yrepeat;\r\n      }\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public Palette(msg: Palette) {\r\n    for (const w of this.highlighted) {\r\n      const wall = this.getWall(w);\r\n      if (msg.absolute) {\r\n        if (msg.value == wall.pal) return;\r\n        wall.pal = msg.value;\r\n      } else {\r\n        wall.pal = cyclic(wall.pal + msg.value, msg.max);\r\n      }\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public Flip(msg: Flip) {\r\n    for (const w of this.highlighted) {\r\n      const wall = this.getWall(w);\r\n      const flip = wall.cstat.xflip + wall.cstat.yflip * 2;\r\n      const nflip = cyclic(flip + 1, 4);\r\n      wall.cstat.xflip = nflip & 1;\r\n      wall.cstat.yflip = (nflip & 2) >> 1;\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public SetWallCstat(msg: SetWallCstat) {\r\n    const board = this.ctx.board();\r\n    for (const w of this.highlighted) {\r\n      const wall = msg.name == 'swapBottoms' ? board.walls[w] : this.getWall(w);\r\n      const stat = wall.cstat[msg.name];\r\n      wall.cstat[msg.name] = stat ? 0 : 1;\r\n      this.invalidateWall(w);\r\n    }\r\n  }\r\n\r\n  public BoardInvalidate(msg: BoardInvalidate) {\r\n    if (msg.ent == null) this.valid = false;\r\n  }\r\n\r\n  public handle(msg: Message) {\r\n    if (this.valid) super.handle(msg);\r\n  }\r\n}\r\n","import { Collection, Deck, EMPTY_COLLECTION } from \"../../utils/collections\";\r\nimport { InputState } from \"../../utils/input\";\r\nimport { warning } from \"../../utils/logger\";\r\nimport { Message } from \"../apis/handler\";\r\nimport { State } from \"../apis/app\";\r\n\r\ntype InputHandler = (state: InputState) => boolean;\r\n\r\nexport function keyPress(key: string): InputHandler { return (state) => state.keysPress[key]; }\r\nexport function key(key: string): InputHandler { return (state) => state.keys[key]; }\r\nexport function mouseClick(button: number): InputHandler { return (state) => state.mouseClicks[button]; }\r\nexport function mouseButton(button: number): InputHandler { return (state) => state.mouseButtons[button]; }\r\nexport function combination(lh: InputHandler, rh: InputHandler): InputHandler { return (state) => lh(state) && rh(state) }\r\nexport const wheelUp: InputHandler = (state) => state.wheel > 0;\r\nexport const wheelDown: InputHandler = (state) => state.wheel < 0;\r\n\r\n\r\nfunction parseMod(str: string): InputHandler {\r\n  if (str == 'mouse0') return mouseButton(0);\r\n  if (str == 'mouse1') return mouseButton(1);\r\n  if (str == 'mouse2') return mouseButton(2);\r\n  return key(str.toUpperCase());\r\n}\r\n\r\nfunction parseKey(str: string): InputHandler {\r\n  if (str == 'wheelup') return wheelUp;\r\n  if (str == 'wheeldown') return wheelDown;\r\n  if (str == 'mouse0') return mouseClick(0);\r\n  if (str == 'mouse1') return mouseClick(1);\r\n  if (str == 'mouse2') return mouseClick(2);\r\n  return keyPress(str.toUpperCase());\r\n}\r\n\r\nfunction canonizeBind(key: string, mods: string[]) {\r\n  key = key.toLowerCase();\r\n  mods = mods.map((s) => s.toLowerCase());\r\n  mods.sort();\r\n  return [...mods, key].join('+');\r\n}\r\n\r\nfunction createHandler(key: string, mods: string[]): InputHandler {\r\n  let handler = parseKey(key);\r\n  for (let i = 0; i < mods.length; i++) handler = combination(handler, parseMod(mods[i]));\r\n  return handler;\r\n}\r\n\r\nexport class Binder {\r\n  private binds: string[] = [];\r\n  private handlers: InputHandler[] = [];\r\n  private messages: Deck<Message>[] = [];\r\n  private sorttable: number[] = [];\r\n\r\n  private stateBinds: string[] = [];\r\n  private stateHandlers: InputHandler[] = [];\r\n  private stateValues: [string, any, any][][] = [];\r\n\r\n  public poolEvents(state: InputState): Iterable<Message> {\r\n    for (let i = this.handlers.length - 1; i >= 0; i--) {\r\n      if (this.handlers[i](state)) return this.messages[i];\r\n    }\r\n    return EMPTY_COLLECTION;\r\n  }\r\n\r\n  public updateState(input: InputState, state: State) {\r\n    for (let i = 0; i < this.stateHandlers.length; i++) {\r\n      const handler = this.stateHandlers[i];\r\n      const values = this.stateValues[i];\r\n      for (const [name, on, off] of values) {\r\n        if (state.has(name)) state.set(name, handler(input) ? on : off);\r\n      }\r\n    }\r\n  }\r\n\r\n  public addStateBind(name: string, enabled: any, disabled: any, ...keys: string[]) {\r\n    const last = keys.pop();\r\n    const bindName = canonizeBind(last, keys);\r\n    const idx = this.stateBinds.indexOf(bindName);\r\n    if (idx == -1) {\r\n      this.stateBinds.push(bindName);\r\n      let handler = parseMod(last);\r\n      for (const key of keys) handler = combination(handler, parseMod(key));\r\n      this.stateHandlers.push(handler);\r\n      this.stateValues.push([[name, enabled, disabled]]);\r\n    } else {\r\n      this.stateValues[idx].push([name, enabled, disabled]);\r\n    }\r\n  }\r\n\r\n  public addBind(messages: Collection<Message>, key: string, ...mods: string[]) {\r\n    const bindName = canonizeBind(key, mods);\r\n    const bindIdx = this.findBind(bindName, mods.length);\r\n    if (bindIdx == -1) {\r\n      const handler = createHandler(key, mods);\r\n      this.insertBind(bindName, handler, messages, mods.length);\r\n    } else {\r\n      this.messages[bindIdx].pushAll(messages);\r\n    }\r\n  }\r\n\r\n  private insertBind(bindName: string, handler: InputHandler, messages: Collection<Message>, mods: number): void {\r\n    this.ensureSortTable(mods);\r\n    const pos = this.sorttable[mods];\r\n    this.binds.splice(pos, 0, bindName);\r\n    this.handlers.splice(pos, 0, handler);\r\n    this.messages.splice(pos, 0, new Deck<Message>().pushAll(messages));\r\n    for (let i = this.sorttable.length - 1; i >= mods; i--) {\r\n      this.sorttable[i]++;\r\n    }\r\n  }\r\n\r\n  private findBind(bindName: string, mods: number) {\r\n    this.ensureSortTable(mods);\r\n    const start = mods == 0 ? 0 : this.sorttable[mods - 1]\r\n    for (let i = start; i < this.sorttable[mods]; i++)\r\n      if (this.binds[i] == bindName) return i;\r\n    return -1;\r\n  }\r\n\r\n  private ensureSortTable(mods: number) {\r\n    for (let i = mods; i >= 0; i--)\r\n      if (this.sorttable[i] == undefined)\r\n        this.sorttable[i] = this.binds.length;\r\n      else break;\r\n  }\r\n}\r\n\r\nexport type EventParser = (str: string) => Collection<Message>;\r\n\r\nexport function loadBinds(binds: string, binder: Binder, messageParser: EventParser) {\r\n  const lines = binds.split(/\\r?\\n/);\r\n  for (let line of lines) {\r\n    line = line.trim();\r\n    if (line.length == 0) continue;\r\n    const idx = line.indexOf(' ');\r\n    if (idx == -1) {\r\n      warning(`Skipping bind line: ${line}`);\r\n      continue;\r\n    }\r\n    let keys = line.substr(0, idx).toLowerCase();\r\n    if (keys.startsWith('+')) {\r\n      keys = keys.substr(1);\r\n      const keyParts = keys.split('+');\r\n      binder.addStateBind(line.substr(idx + 1).trim(), true, false, ...keyParts);\r\n    } else {\r\n      const str = line.substr(idx + 1).trim();\r\n      const messages = messageParser(str);\r\n      if (messages == null) {\r\n        warning(`'${str}' failed to parse`);\r\n        continue;\r\n      }\r\n      const keyParts = keys.split('+');\r\n      binder.addBind(messages, keyParts.pop(), ...keyParts);\r\n    }\r\n  }\r\n}\r\n","import { Collection, Deck, isEmpty } from \"../../utils/collections\";\r\nimport { Lexer, LexerRule } from \"../../utils/lexer\";\r\nimport { error } from \"../../utils/logger\";\r\nimport { EndMove, Flip, Move, NamedMessage, Palette, PanRepeat, ResetPanRepeat, SetPicnum, SetSectorCstat, SetWallCstat, Shade, SpriteMode, StartMove, SetSpriteCstat, Rotate } from \"../edit/messages\";\r\nimport { Message } from \"../apis/handler\";\r\n\r\nclass MessageParser {\r\n  private lexer = new Lexer();\r\n\r\n  constructor() {\r\n    this.lexer.addRule(new LexerRule(/^[ \\t\\r\\v\\n]+/, 'WS'));\r\n    this.lexer.addRule(new LexerRule(/^[a-zA-Z_][a-zA-Z0-9_]+/, 'ID'));\r\n    this.lexer.addRule(new LexerRule(/^,/, 'COMA'));\r\n    this.lexer.addRule(new LexerRule(/^(false|true)/, 'BOOLEAN', 0, (s) => s == 'true'));\r\n    this.lexer.addRule(new LexerRule(/^\\-?[0-9]*(\\.[0-9]+)?([eE][\\+\\-][0-9]+)?/, 'FLOAT', 0, (s) => parseFloat(s)));\r\n    this.lexer.addRule(new LexerRule(/^\\-?[0-9]+/, 'INT', 0, (s) => parseInt(s)));\r\n    this.lexer.addRule(new LexerRule(/^\"([^\"]*)\"/, 'STRING', 1));\r\n    this.lexer.addRule(new LexerRule(/^\\{([^\\}]*)\\}/, 'MACRO', 1));\r\n  }\r\n\r\n  public setSource(src: string): void {\r\n    this.lexer.setSource(src);\r\n  }\r\n\r\n  public get<T>(expected: string, value: T = null): T {\r\n    for (; this.lexer.next() == 'WS';);\r\n    if (this.lexer.isEoi()) throw new Error();\r\n    let tokenId = this.lexer.rule().name;\r\n    let actual = this.lexer.value();\r\n    if (tokenId != expected || value != null && value != actual) throw new Error();\r\n    return this.lexer.value();\r\n  }\r\n\r\n  public tryGet<T>(expected: string, value: T = null): T {\r\n    let mark = this.lexer.mark();\r\n    try {\r\n      return this.get(expected, value);\r\n    } catch (e) {\r\n      this.lexer.reset(mark);\r\n      return null;\r\n    }\r\n  }\r\n}\r\nlet parser = new MessageParser();\r\n\r\nfunction parseArgs(...types: string[]) {\r\n  let args = new Deck<any>();\r\n  for (let type of types) {\r\n    args.push(parser.get(type));\r\n  }\r\n  return args;\r\n}\r\n\r\nconst NOOP_MESSAGE: Message = {};\r\nlet factArgs = new Deck<any>();\r\nfunction createMessage(constr: Function, ...types: string[]) {\r\n  let args = parseArgs(...types);\r\n  factArgs.clear();\r\n  for (let v of args) factArgs.push(v);\r\n  try {\r\n    return Reflect.construct(constr, [...factArgs]);\r\n  } catch (e) {\r\n    error(`Invalid message constructor ${constr.name} (${types})`, factArgs);\r\n    return NOOP_MESSAGE;\r\n  }\r\n}\r\n\r\nlet parsdMessages = new Deck<Message>();\r\nfunction tryParseMessage(): Collection<Message> {\r\n  parsdMessages.clear();\r\n  switch (parser.get('ID')) {\r\n    case 'picnum': return parsdMessages.push(createMessage(SetPicnum, 'INT'));\r\n    case 'shade': return parsdMessages.push(createMessage(Shade, 'INT', 'BOOLEAN'));\r\n    case 'panrepeat': return parsdMessages.push(createMessage(PanRepeat, 'INT', 'INT', 'INT', 'INT', 'BOOLEAN'));\r\n    case 'pal': return parsdMessages.push(createMessage(Palette, 'INT', 'INT', 'BOOLEAN'));\r\n    case 'wallcstat': return parsdMessages.push(createMessage(SetWallCstat, 'ID', 'BOOLEAN', 'BOOLEAN'));\r\n    case 'sectorcstat': return parsdMessages.push(createMessage(SetSectorCstat, 'ID', 'BOOLEAN', 'BOOLEAN'));\r\n    case 'spritecstat': return parsdMessages.push(createMessage(SetSpriteCstat, 'ID', 'BOOLEAN', 'BOOLEAN'));\r\n    case 'rotate': return parsdMessages.push(createMessage(Rotate, 'INT'));\r\n    case 'flip': return parsdMessages.push(new Flip());\r\n    case 'sprite_mode': return parsdMessages.push(new SpriteMode());\r\n    case 'reset_panrepeat': return parsdMessages.push(new ResetPanRepeat());\r\n    case 'move': return parsdMessages\r\n      .push(new StartMove())\r\n      .push(createMessage(Move, 'INT', 'INT', 'INT'))\r\n      .push(new EndMove());\r\n    default: return parsdMessages;\r\n  }\r\n}\r\n\r\nfunction tryParse(src: string, messages: Deck<Message>): Collection<Message> {\r\n  try {\r\n    parser.setSource(src);\r\n    parser.get('ID', 'msg');\r\n    let parsedMessages = tryParseMessage();\r\n    while (!isEmpty(parsedMessages)) {\r\n      messages.pushAll(parsedMessages);\r\n      try { parser.get('COMA') } catch (e) { break }\r\n      parsedMessages = tryParseMessage();\r\n    }\r\n    return messages;\r\n  } catch (e) {\r\n    return messages.clear();\r\n  }\r\n}\r\n\r\nlet messages = new Deck<Message>();\r\nexport function messageParser(str: string): Collection<Message> {\r\n  let result = tryParse(str, messages.clear());\r\n  if (result.length() == 0) return messages.push(new NamedMessage(str));\r\n  return result;\r\n}","import { ArtPixelProvider } from \"../../build/artpixelprovider\";\r\nimport { animate, ArtInfoProvider } from \"../../build/formats/art\";\r\nimport { range } from \"../../utils/collections\";\r\nimport { drawToCanvas } from \"../../utils/imgutils\";\r\nimport { create, Module } from \"../../utils/injector\";\r\nimport { iter } from \"../../utils/iter\";\r\nimport { int } from \"../../utils/mathutils\";\r\nimport { resize } from \"../../utils/pixelprovider\";\r\nimport { DrawPanel, PixelDataProvider } from \"../../utils/ui/drawpanel\";\r\nimport { menuButton, search, SerachBar, sugggestionsMenu } from \"../../utils/ui/renderers\";\r\nimport { div } from \"../../utils/ui/ui\";\r\nimport { ART } from \"../apis/app\";\r\nimport { BUS } from \"../apis/handler\";\r\nimport { Ui, UI, Window } from \"../apis/ui\";\r\nimport { namedMessageHandler } from \"../edit/messages\";\r\nimport { PicNumCallback } from \"../edit/tools/selection\";\r\nimport { PicTags, PIC_TAGS, RAW_PAL, RAW_PLUs } from \"./artselector\";\r\n\r\nfunction createDrawPanel(arts: ArtInfoProvider, pal: Uint8Array, plu: (x: number) => number, canvas: HTMLCanvasElement, cb: PicNumCallback, iter: () => Iterable<number>) {\r\n  const provider = new PixelDataProvider(1024 * 10, (i: number) => {\r\n    const info = arts.getInfo(i);\r\n    if (info == null) return null;\r\n    return new ArtPixelProvider(info, pal, plu);\r\n  });\r\n  return new DrawPanel(canvas, iter, provider, cb);\r\n}\r\n\r\nexport async function ArtEditorModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    const editor = await create(injector, ArtEditor, UI, ART, RAW_PAL, RAW_PLUs, PIC_TAGS);\r\n    bus.connect(namedMessageHandler('show_artedit', () => editor.show()));\r\n  });\r\n}\r\n\r\nexport class ArtEditor {\r\n  private window: Window;\r\n  private drawPanel: DrawPanel;\r\n  private filter = \"\";\r\n  private view: HTMLCanvasElement;\r\n  private searchWidget: SerachBar;\r\n  private currentId = -1;\r\n  private centerX = 320;\r\n  private centerY = 320;\r\n  private frame = 0;\r\n  private animation = -1;\r\n  private scale = 2.0;\r\n  private currentPlu = 0;\r\n  private pluProvider = (x: number) => this.plus[this.currentPlu][x];\r\n\r\n  constructor(\r\n    private ui: Ui,\r\n    private arts: ArtInfoProvider,\r\n    private pal: Uint8Array,\r\n    private plus: Uint8Array[],\r\n    private tags: PicTags) {\r\n\r\n    this.searchWidget = search('Search', s => { this.updateFilter(s); this.updateSuggestions(s) });\r\n    const browserCanvas = document.createElement('canvas');\r\n    browserCanvas.width = 640;\r\n    browserCanvas.height = 192;\r\n    browserCanvas.style.display = 'block';\r\n    this.view = this.createView();\r\n    this.window = ui.builder.window()\r\n      .title('ART Edit')\r\n      .draggable(true)\r\n      .closeable(true)\r\n      .centered(true)\r\n      .size(640, 640)\r\n      .content(div('')\r\n        .appendHtml(this.view)\r\n        .appendHtml(browserCanvas)\r\n        .elem())\r\n      .toolbar(ui.builder.toolbar()\r\n        .widget(this.createPalSelectingMenu())\r\n        .widget(this.searchWidget.widget))\r\n      .build();\r\n\r\n    this.drawPanel = createDrawPanel(arts, pal, this.pluProvider, browserCanvas, (id: number) => this.select(id), () => this.pics());\r\n    this.window.hide();\r\n  }\r\n\r\n  private createPalSelectingMenu() {\r\n    const menu = this.ui.builder.menu();\r\n    iter(range(0, this.plus.length)).forEach(i => menu.item(i + '', () => { this.currentPlu = i; this.redraw() }))\r\n    return menuButton('icon-adjust', menu);\r\n  }\r\n\r\n  private updateSuggestions(s: string) {\r\n    const menu = iter(this.tags.allTags())\r\n      .filter(t => t.toLowerCase().startsWith(s.toLowerCase()))\r\n      .map(t => <[string, () => void]>[t, () => { this.searchWidget.setValue(t); this.updateFilter(t) }]);\r\n    this.searchWidget.updateSuggestions(sugggestionsMenu(menu));\r\n  }\r\n\r\n  private updateFilter(s: string) {\r\n    this.filter = s;\r\n    this.drawPanel.scrollToId(this.currentId);\r\n    this.drawPanel.draw();\r\n  }\r\n\r\n  private applyFilter(id: number): boolean {\r\n    const tags = iter(this.tags.tags(id));\r\n    if (this.filter.startsWith('*')) return (id + '').includes(this.filter.substr(1))\r\n    return (id + '').startsWith(this.filter) || tags.any(t => t.toLowerCase() == this.filter.toLowerCase());\r\n  }\r\n\r\n  private pics(): Iterable<number> {\r\n    return iter(range(0, 10 * 1024)).filter(i => this.applyFilter(i));\r\n  }\r\n\r\n  private createView(): HTMLCanvasElement {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = 640;\r\n    canvas.height = 640 - 192;\r\n    canvas.style.display = 'block';\r\n    canvas.addEventListener('wheel', e => {\r\n      if (e.deltaY > 0) this.scale *= 0.9;\r\n      if (e.deltaY < 0) this.scale *= 1.1;\r\n      this.updateView(false);\r\n    });\r\n    let isDrag = false;\r\n    let oldx = 0;\r\n    let oldy = 0;\r\n    canvas.addEventListener('mousemove', e => {\r\n      if (isDrag) {\r\n        const dx = e.x - oldx;\r\n        const dy = e.y - oldy;\r\n        if (dx != 0 || dy != 0) {\r\n          this.centerX += dx;\r\n          this.centerY += dy;\r\n          this.updateView(false);\r\n        }\r\n      }\r\n      oldx = e.x;\r\n      oldy = e.y;\r\n    });\r\n    canvas.addEventListener('mousedown', e => isDrag = true);\r\n    canvas.addEventListener('mouseup', e => isDrag = false);\r\n    return canvas;\r\n  }\r\n\r\n  private select(id: number) {\r\n    this.drawPanel.deselectAll();\r\n    this.drawPanel.select(id);\r\n    const info = this.arts.getInfo(id);\r\n    if (info != null && info.attrs.frames) iter(range(0, info.attrs.frames + 1)).forEach(i => this.drawPanel.select(id + i));\r\n    this.drawPanel.draw();\r\n    this.currentId = id;\r\n    this.resetAnimation();\r\n    this.updateView();\r\n  }\r\n\r\n  private resetAnimation() {\r\n    window.clearTimeout(this.animation);\r\n    this.animation = -1;\r\n    this.frame = 0;\r\n  }\r\n\r\n  private updateView(anim = true) {\r\n    const ctx = this.view.getContext('2d');\r\n    ctx.fillStyle = 'black';\r\n    ctx.strokeStyle = 'white';\r\n    ctx.fillRect(0, 0, this.view.clientWidth, this.view.clientHeight);\r\n\r\n    const mainInfo = this.arts.getInfo(this.currentId);\r\n    const frameInfo = this.arts.getInfo(this.currentId + animate(this.frame, mainInfo));\r\n    if (mainInfo == null || frameInfo == null) return;\r\n    const scaledW = int(frameInfo.w * this.scale);\r\n    const scaledH = int(frameInfo.h * this.scale);\r\n    const img = resize(new ArtPixelProvider(frameInfo, this.pal, this.pluProvider), scaledW, scaledH);\r\n    const x = this.centerX - int(((frameInfo.attrs.xoff | 0) + frameInfo.w / 2) * this.scale);\r\n    const y = this.centerY - int(((frameInfo.attrs.yoff | 0) + frameInfo.h / 2) * this.scale);\r\n    drawToCanvas(img, ctx, x, y);\r\n\r\n    if (anim && (mainInfo.attrs.frames | 0) != 0) {\r\n      this.frame++;\r\n      this.animation = window.setTimeout(() => this.updateView(), mainInfo.attrs.speed * 50);\r\n    }\r\n  }\r\n\r\n  private redraw() {\r\n    this.drawPanel.draw();\r\n    this.updateView(false);\r\n  }\r\n\r\n  public show() {\r\n    this.window.show();\r\n    this.redraw();\r\n  }\r\n}\r\n","import { ArtInfoProvider } from \"../../build/formats/art\";\r\nimport { range } from \"../../utils/collections\";\r\nimport { create, Dependency, Injector } from \"../../utils/injector\";\r\nimport { iter } from \"../../utils/iter\";\r\nimport { axisSwap, RGBPalPixelProvider } from \"../../utils/pixelprovider\";\r\nimport { DrawPanel, PixelDataProvider } from \"../../utils/ui/drawpanel\";\r\nimport { IconTextRenderer, menuButton, renderGrid, search, SerachBar, sugggestionsMenu } from \"../../utils/ui/renderers\";\r\nimport { Element } from \"../../utils/ui/ui\";\r\nimport { ART } from \"../apis/app\";\r\nimport { Ui, UI, Window } from \"../apis/ui\";\r\nimport { PicNumCallback } from \"../edit/tools/selection\";\r\n\r\nfunction createDrawPanel(arts: ArtInfoProvider, pal: Uint8Array, canvas: HTMLCanvasElement, cb: PicNumCallback, iter: () => Iterable<number>) {\r\n  let provider = new PixelDataProvider(1024 * 10, (i: number) => {\r\n    let info = arts.getInfo(i);\r\n    if (info == null) return null;\r\n    return axisSwap(new RGBPalPixelProvider(info.img, pal, info.h, info.w, 255, 255));\r\n  });\r\n  return new DrawPanel(canvas, iter, provider, cb);\r\n}\r\n\r\nexport interface PicTags {\r\n  allTags(): Iterable<string>;\r\n  tags(picnum: number): Iterable<string>;\r\n}\r\n\r\nexport const RAW_PAL = new Dependency<Uint8Array>('RawPal');\r\nexport const RAW_PLUs = new Dependency<Uint8Array[]>('Raw PLUs');\r\nexport const PIC_TAGS = new Dependency<PicTags>('Tags');\r\n\r\nexport async function SelectorConstructor(injector: Injector) {\r\n  const selector = await create(injector, Selector, UI, ART, RAW_PAL, PIC_TAGS);\r\n  return (cb: PicNumCallback) => selector.modal(cb);\r\n}\r\n\r\nfunction createTagsGridModel(tags: PicTags) {\r\n  const selected = new Set<string>();\r\n  const columns = [IconTextRenderer];\r\n  let callback: (selected: Iterable<string>) => void;\r\n  const grid = {\r\n    async rows() { return iter(tags.allTags()).map(s => [[s, selected.has(s)]]) },\r\n    columns() { return columns },\r\n    onClick(row: any[], rowElement: Element) {\r\n      const value = row[0][0];\r\n      if (selected.has(value)) selected.delete(value);\r\n      else selected.add(value);\r\n      rowElement.elem().classList.toggle('selected');\r\n      if (callback) callback(selected.values());\r\n    }\r\n  }\r\n  return {\r\n    renderGrid() { return renderGrid(grid) },\r\n    selected() { return selected },\r\n    connect(cb: (selected: Iterable<string>) => void) { callback = cb }\r\n  }\r\n}\r\n\r\nexport class Selector {\r\n  private window: Window;\r\n  private drawPanel: DrawPanel;\r\n  private cb: PicNumCallback;\r\n  private filter = \"\";\r\n  private searchWidget: SerachBar;\r\n  // private selectedTags: string[] = [];\r\n\r\n  constructor(private ui: Ui, arts: ArtInfoProvider, pal: Uint8Array, private tags: PicTags) {\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = canvas.height = 640;\r\n    // const grid = createTagsGridModel(tags);\r\n    // const gridPanel = div('pane-sm sidebar').css('width', '170px');\r\n    // grid.renderGrid().then(g => gridPanel.append(g));\r\n    // grid.connect(tags => { this.selectedTags = [...tags], this.drawPanel.draw() });\r\n    // const paneGroup = div('pane-group')\r\n    //   .append(gridPanel)\r\n    //   .append(div('pane').css('overflow', 'hidden').appendHtml(canvas));\r\n    this.searchWidget = search('Search', s => { this.updateFilter(s); this.updateSuggestions(s) });\r\n    this.window = ui.builder.window()\r\n      .id('select_tile')\r\n      .title('Tiles')\r\n      .draggable(true)\r\n      .closeable(true)\r\n      .centered(true)\r\n      .size(640, 640)\r\n      .toolbar(ui.builder.toolbar()\r\n        .widget(menuButton('icon-popup', ui.builder.menu()\r\n          .item('32', () => { this.drawPanel.setCellSize(32, 32) })\r\n          .item('64', () => { this.drawPanel.setCellSize(64, 64) })\r\n          .item('128', () => { this.drawPanel.setCellSize(128, 128) })))\r\n        .widget(this.searchWidget.widget)\r\n      )\r\n      .onclose(() => this.select(-1))\r\n      .content(canvas)\r\n      .build();\r\n\r\n    this.drawPanel = createDrawPanel(arts, pal, canvas, (id: number) => this.select(id), () => this.pics());\r\n    this.drawPanel.select(110);\r\n    this.drawPanel.select(111);\r\n    this.hide();\r\n  }\r\n\r\n  private updateFilter(s: string) {\r\n    this.filter = s;\r\n    this.drawPanel.seOffset(0);\r\n    this.drawPanel.draw();\r\n  }\r\n\r\n  private updateSuggestions(s: string) {\r\n    const menu = iter(this.tags.allTags())\r\n      .filter(t => t.toLowerCase().startsWith(s.toLowerCase()))\r\n      .map(t => <[string, () => void]>[t, () => { this.searchWidget.setValue(t); this.updateFilter(t) }]);\r\n    this.searchWidget.updateSuggestions(sugggestionsMenu(menu));\r\n  }\r\n\r\n  private applyFilter(id: number): boolean {\r\n    const tags = iter(this.tags.tags(id));\r\n    // if (!tags.isEmpty() && !tags.any(t => this.selectedTags.includes(t))) return false;\r\n    if (this.filter.startsWith('*')) return (id + '').includes(this.filter.substr(1))\r\n    return (id + '').startsWith(this.filter) || tags.any(t => t.toLowerCase() == this.filter.toLowerCase());\r\n  }\r\n\r\n  private pics(): Iterable<number> {\r\n    return iter(range(0, 10 * 1024)).filter(i => this.applyFilter(i));\r\n  }\r\n\r\n  public show() {\r\n    this.window.setPosition('50%', '50%');\r\n    this.window.show();\r\n    this.drawPanel.draw();\r\n  }\r\n\r\n  public hide() {\r\n    this.window.hide();\r\n  }\r\n\r\n  public modal(cb: PicNumCallback) {\r\n    this.cb = cb;\r\n    this.show();\r\n  }\r\n\r\n  private select(id: number) {\r\n    this.hide();\r\n    if (this.cb == null) return;\r\n    let cb = this.cb;\r\n    this.cb = null;\r\n    cb(id);\r\n  }\r\n}","import { ArtFiles, ArtInfo, Attributes } from \"../../build/formats/art\";\r\nimport { rect } from \"../../utils/collections\";\r\nimport { Texture } from \"../../utils/gl/drawstruct\";\r\nimport { createTexture, TextureImpl } from \"../../utils/gl/textures\";\r\nimport { IndexedImgLib, INDEXED_IMG_LIB } from \"../../utils/imglib\";\r\nimport { Dependency, Injector } from \"../../utils/injector\";\r\nimport { warning } from \"../../utils/logger\";\r\nimport { int } from \"../../utils/mathutils\";\r\nimport { ArtProvider } from \"../apis/app\";\r\n\r\nexport const GL = new Dependency<WebGLRenderingContext>('GL');\r\nexport const ART_FILES = new Dependency<ArtFiles>('ArtFiles');\r\nexport type TextureProvider = (id: number) => Texture;\r\nexport const TEXTURES_OVERRIDE = new Dependency<TextureProvider>('Textures Override');\r\nexport const PARALLAX_TEXTURES = new Dependency<number>('Number of parallax textures');\r\n\r\nexport function createIndexedTexture(gl: WebGLRenderingContext, w: number, h: number, arr: Uint8Array, mipmaps = true, lib: IndexedImgLib): Texture {\r\n  const repeat = WebGLRenderingContext.CLAMP_TO_EDGE;\r\n  const filter = mipmaps ? WebGLRenderingContext.NEAREST_MIPMAP_NEAREST : WebGLRenderingContext.NEAREST;\r\n  const tex = createTexture(w, h, gl, { filter: filter, repeat: repeat }, arr, gl.LUMINANCE);\r\n  if (mipmaps) addMipMaps(gl, w, h, arr, tex, lib);\r\n  return tex;\r\n}\r\n\r\n// function addMipMaps(gl: WebGLRenderingContext, w: number, h: number, arr: Uint8Array, tex: TextureImpl, lib: IndexedImgLib) {\r\n//   let div = 2;\r\n//   let level = 1;\r\n//   while (int(w / div) >= 1 || int(h / div) >= 1) {\r\n//     const dw = Math.max(1, int(w / div));\r\n//     const dh = Math.max(1, int(h / div));\r\n//     const mip = lib.resize(dw, dh, w, h, arr);\r\n//     tex.mip(gl, level, dw, dh, mip);\r\n//     div *= 2;\r\n//     level++;\r\n//   }\r\n// }\r\n\r\nfunction addMipMaps(gl: WebGLRenderingContext, w: number, h: number, arr: Uint8Array, tex: TextureImpl, lib: IndexedImgLib) {\r\n  let level = 1;\r\n  while (w >= 1 || h >= 1) {\r\n    const nw = int(w / 2);\r\n    const dw = Math.max(1, nw);\r\n    const nh = int(h / 2);\r\n    const dh = Math.max(1, nh);\r\n    const mip = lib.resize(dw, dh, w, h, arr);\r\n    tex.mip(gl, level, dw, dh, mip);\r\n    arr = mip;\r\n    w = nw;\r\n    h = nh;\r\n    level++;\r\n  }\r\n}\r\n\r\nexport async function BuildArtProviderConstructor(injector: Injector) {\r\n  const [art, util, gl, parallax, lib] = await Promise.all([\r\n    injector.getInstance(ART_FILES),\r\n    injector.getInstance(TEXTURES_OVERRIDE),\r\n    injector.getInstance(GL),\r\n    injector.getInstance(PARALLAX_TEXTURES),\r\n    injector.getInstance(INDEXED_IMG_LIB)]);\r\n  return new BuildArtProvider(art, util, gl, parallax, lib);\r\n}\r\n\r\nexport class BuildArtProvider implements ArtProvider {\r\n  private textures: Texture[] = [];\r\n  private parallaxTextures: Texture[] = [];\r\n  private infos: ArtInfo[] = [];\r\n\r\n  constructor(\r\n    private arts: ArtFiles,\r\n    private addTextures: TextureProvider,\r\n    private gl: WebGLRenderingContext,\r\n    private parallaxPics: number,\r\n    private lib: IndexedImgLib) {\r\n  }\r\n\r\n  public get(picnum: number): Texture {\r\n    const add = this.addTextures(picnum);\r\n    if (add != undefined) return add;\r\n    let tex = this.textures[picnum];\r\n    if (tex != undefined) return tex;\r\n\r\n    const info = this.arts.getInfo(picnum);\r\n    if (info.h <= 0 || info.w <= 0) return this.get(0);\r\n    const arr = this.axisSwap(info.img, info.h, info.w);\r\n    tex = createIndexedTexture(this.gl, info.w, info.h, arr, true, this.lib);\r\n\r\n    this.textures[picnum] = tex;\r\n    return tex;\r\n  }\r\n\r\n  public getParallaxTexture(picnum: number): Texture {\r\n    let tex = this.parallaxTextures[picnum];\r\n    if (tex != undefined) return tex;\r\n\r\n    const infos: ArtInfo[] = [];\r\n    const axisSwapped: Uint8Array[] = [];\r\n    for (let i = 0; i < this.parallaxPics; i++) {\r\n      infos[i] = this.arts.getInfo(picnum + i);\r\n      if (i != 0) {\r\n        if (infos[i].w != infos[i - 1].w || infos[i].h != infos[i - 1].h) {\r\n          warning(`Invalid parallax texture #${picnum}`);\r\n          return this.get(0);\r\n        }\r\n      }\r\n      axisSwapped[i] = this.axisSwap(infos[i].img, infos[i].h, infos[i].w);\r\n    }\r\n    const w = infos[0].w;\r\n    const h = infos[0].h;\r\n    const merged = this.mergeParallax(w, h, axisSwapped);\r\n    tex = createIndexedTexture(this.gl, w * this.parallaxPics, h, merged, true, this.lib);\r\n\r\n    this.parallaxTextures[picnum] = tex;\r\n    return tex;\r\n  }\r\n\r\n  private mergeParallax(w: number, h: number, arrs: Uint8Array[]): Uint8Array {\r\n    const result = new Uint8Array(w * h * this.parallaxPics);\r\n    for (let y = 0; y < h; y++) {\r\n      for (let i = 0; i < this.parallaxPics; i++) {\r\n        for (let x = 0; x < w; x++) result[y * w * this.parallaxPics + i * w + x] = arrs[i][y * w + x]\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  private axisSwap(data: Uint8Array, w: number, h: number): Uint8Array {\r\n    const result = new Uint8Array(w * h);\r\n    for (const [x, y] of rect(w, h))\r\n      result[x * h + y] = data[y * w + x];\r\n    return result;\r\n  }\r\n\r\n  public getInfo(picnum: number): ArtInfo {\r\n    let info = this.infos[picnum];\r\n    if (info != undefined) return info;\r\n    const add = this.addTextures(picnum);\r\n    info = add != undefined\r\n      ? new ArtInfo(add.getWidth(), add.getHeight(), new Attributes(), (<TextureImpl>add).data)\r\n      : this.arts.getInfo(picnum);\r\n    this.infos[picnum] = info;\r\n    return info;\r\n  }\r\n}\r\n","import { SelectorConstructor } from '../../app/modules/artselector';\r\nimport { Board } from '../../build/board/structs';\r\nimport { Deck } from '../../utils/collections';\r\nimport { loadString } from '../../utils/getter';\r\nimport { IndexedImgLibJsConstructor, INDEXED_IMG_LIB } from '../../utils/imglib';\r\nimport { create, Injector, Module } from '../../utils/injector';\r\nimport * as PROFILE from '../../utils/profiler';\r\nimport { ART, BOARD, DEFAULT_BOARD, GRID, REFERENCE_TRACKER, SCHEDULER, STATE, STORAGES, View, VIEW } from '../apis/app';\r\nimport { BUS, DefaultMessageBus, MessageBus, MessageHandlerReflective } from '../apis/handler';\r\nimport { Renderable } from '../apis/renderable';\r\nimport { DefaultScheduler } from '../apis/scheduler';\r\nimport { EntityFactoryConstructor, ENTITY_FACTORY } from '../edit/context';\r\nimport { Frame, LoadBoard, namedMessageHandler, PostFrame, Render } from '../edit/messages';\r\nimport { DrawSectorModule } from '../edit/tools/drawsector';\r\nimport { DrawWallModule } from '../edit/tools/drawwall';\r\nimport { JoinSectorsModule } from '../edit/tools/joinsectors';\r\nimport { PushWallModule } from '../edit/tools/pushwall';\r\nimport { PICNUM_SELECTOR, SelectionModule } from '../edit/tools/selection';\r\nimport { ToolsBusConstructor, TOOLS_BUS } from '../edit/tools/toolsbus';\r\nimport { UtilsModule } from '../edit/tools/utils';\r\nimport { StatusBarModule } from '../modules/statusbar';\r\nimport { TaskManagerModule } from '../modules/taskmanager';\r\nimport { BuildArtProviderConstructor, TEXTURES_OVERRIDE } from './buildartprovider';\r\nimport { DefaultGridController } from './default/grid';\r\nimport { DefaultBoardProviderConstructor } from './default/history';\r\nimport { BuildReferenceTrackerImpl } from './default/reftracker';\r\nimport { StateImpl } from './default/state';\r\nimport { DefaultAdditionalTextures } from './default/utiltex';\r\nimport { RenderablesCacheModule } from './geometry/cache';\r\nimport { BUILDERS_FACTORY, DefaultBuildersFactory } from './geometry/common';\r\nimport { BUFFER_FACTORY, DefaultBufferFactory } from './gl/buffers';\r\nimport { BuildGlConstructor, BUILD_GL } from './gl/buildgl';\r\nimport { InfoModule } from './info';\r\nimport { SwappableViewModule } from './view/view';\r\n\r\nasync function mapBackupService(module: Module) {\r\n  module.execute(async injector => {\r\n    const storages = await injector.getInstance(STORAGES);\r\n    const bus = await injector.getInstance(BUS);\r\n    const board = await injector.getInstance(BOARD);\r\n    const defaultBoard = await injector.getInstance(DEFAULT_BOARD);\r\n    const store = await storages('session');\r\n    bus.connect(namedMessageHandler('commit', () => store.set('map_bak', board())));\r\n    bus.connect(namedMessageHandler('new_board', () => {\r\n      bus.handle(new LoadBoard(defaultBoard));\r\n      store.set('map_bak', defaultBoard);\r\n    }));\r\n\r\n    const map = <Board>await store.get('map_bak');\r\n    if (map) {\r\n      const bus = await injector.getInstance(BUS);\r\n      bus.handle(new LoadBoard(map));\r\n    }\r\n  });\r\n}\r\n\r\nfunction newMap(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    const defaultBoard = await injector.getInstance(DEFAULT_BOARD);\r\n    bus.connect(namedMessageHandler('new_board', () => {\r\n      bus.handle(new LoadBoard(defaultBoard));\r\n    }));\r\n  })\r\n}\r\n\r\n\r\nexport function DefaultSetupModule(module: Module) {\r\n  module.bindInstance(REFERENCE_TRACKER, new BuildReferenceTrackerImpl());\r\n  module.bindInstance(STATE, new StateImpl());\r\n  module.bind(TEXTURES_OVERRIDE, DefaultAdditionalTextures);\r\n  module.bind(GRID, DefaultGridController);\r\n  module.bind(ART, BuildArtProviderConstructor);\r\n  module.bind(PICNUM_SELECTOR, SelectorConstructor);\r\n  module.bind(BUILD_GL, BuildGlConstructor);\r\n  module.bind(BUFFER_FACTORY, DefaultBufferFactory);\r\n  module.bind(BUILDERS_FACTORY, DefaultBuildersFactory);\r\n  module.bind(BUS, DefaultMessageBus);\r\n  module.bind(TOOLS_BUS, ToolsBusConstructor);\r\n  module.bind(BOARD, DefaultBoardProviderConstructor);\r\n  module.bind(ENTITY_FACTORY, EntityFactoryConstructor);\r\n  module.bind(INDEXED_IMG_LIB, IndexedImgLibJsConstructor);\r\n  module.bind(SCHEDULER, DefaultScheduler);\r\n\r\n  module.install(SwappableViewModule);\r\n  module.install(JoinSectorsModule);\r\n  module.install(DrawSectorModule);\r\n  module.install(DrawWallModule);\r\n  module.install(PushWallModule);\r\n  module.install(RenderablesCacheModule);\r\n  module.install(SelectionModule);\r\n  module.install(InfoModule);\r\n  module.install(StatusBarModule);\r\n  module.install(UtilsModule);\r\n  module.install(TaskManagerModule);\r\n\r\n  module.install(newMap);\r\n  // module.install(mapBackupService);\r\n}\r\n\r\nexport function MainLoopConstructor(injector: Injector) {\r\n  return create(injector, MainLoop, VIEW, BUS);\r\n}\r\n\r\nfunction createTools() {\r\n  const list = new Deck<Renderable>();\r\n  return {\r\n    consumer: (r: Renderable) => list.push(r),\r\n    clear: () => list.clear(),\r\n    provider: list,\r\n  }\r\n}\r\n\r\nconst FRAME = new Frame(0);\r\nconst POSTFRAME = new PostFrame();\r\nconst tools = createTools();\r\nconst RENDER = new Render(tools.consumer);\r\n\r\nexport class MainLoop extends MessageHandlerReflective {\r\n  constructor(\r\n    private view: View,\r\n    private bus: MessageBus,\r\n  ) {\r\n    super();\r\n    this.view = view;\r\n    this.bus = bus;\r\n    this.bus.connect(this);\r\n  }\r\n\r\n  private drawTools() {\r\n    tools.clear();\r\n    this.bus.handle(RENDER);\r\n    this.view.drawTools(tools.provider);\r\n  }\r\n\r\n  frame(dt: number) {\r\n    PROFILE.start();\r\n    FRAME.dt = dt;\r\n    this.bus.handle(FRAME);\r\n    this.drawTools();\r\n    PROFILE.endProfile();\r\n    this.bus.handle(POSTFRAME);\r\n  }\r\n}","import { Injector } from \"../../utils/injector\";\r\nimport { Storage, Storages } from \"../apis/app\";\r\n\r\nclass Db implements Storage {\r\n  private db: Promise<IDBDatabase>;\r\n\r\n  constructor(private name: string, version = 1) {\r\n    this.db = this.connect(name, version);\r\n  }\r\n\r\n  private connect(name: string, version = 1): Promise<IDBDatabase> {\r\n    return new Promise((ok, error) => {\r\n      const openRequest = indexedDB.open('BuildEd-' + name, version);\r\n      openRequest.onerror = (e) => error(e);\r\n      openRequest.onsuccess = (db) => ok(openRequest.result);\r\n      openRequest.onupgradeneeded = () => {\r\n        const db = openRequest.result;\r\n        db.onerror = (e) => error(e);\r\n        db.createObjectStore(name, { keyPath: 'key' });\r\n      }\r\n    })\r\n  }\r\n\r\n  private async request(mode: IDBTransactionMode) {\r\n    const db = await this.db;\r\n    const transaction = db.transaction(this.name, mode);\r\n    return transaction.objectStore(this.name);\r\n  }\r\n\r\n  get(key: string) {\r\n    return new Promise(async (ok, error) => {\r\n      const request = (await this.request('readonly')).get(key.toUpperCase());\r\n      request.onsuccess = () => ok(request.result ? request.result.data : null);\r\n      request.onerror = (e) => error(e);\r\n    })\r\n  }\r\n\r\n  set(key: string, value: any) {\r\n    return new Promise(async (ok, error) => {\r\n      const request = (await this.request('readwrite')).put({ key: key.toUpperCase(), name: key, data: value });\r\n      request.onsuccess = () => ok();\r\n      request.onerror = (e) => error(e);\r\n    })\r\n  }\r\n\r\n  delete(key: string): Promise<void> {\r\n    return new Promise(async (ok, error) => {\r\n      const request = (await this.request('readwrite')).delete(key.toUpperCase());\r\n      request.onsuccess = () => ok();\r\n      request.onerror = (e) => error(e);\r\n    })\r\n  }\r\n\r\n  clear(): Promise<void> {\r\n    return new Promise(async (ok, error) => {\r\n      const request = (await this.request('readwrite')).clear();\r\n      request.onsuccess = () => ok();\r\n      request.onerror = (e) => error(e);\r\n    })\r\n  }\r\n\r\n  keys(): Promise<string[]> {\r\n    return new Promise(async (ok, error) => {\r\n      const request = (await this.request('readonly')).openCursor();\r\n      const keys: string[] = [];\r\n      request.onsuccess = () => {\r\n        const cursor = request.result;\r\n        if (!cursor) return ok(keys);\r\n        keys.push(<string>cursor.value.name);\r\n        cursor.continue();\r\n      }\r\n      request.onerror = (e) => error(e);\r\n    })\r\n  }\r\n}\r\n\r\nexport async function StorageDbConstructor(injector: Injector): Promise<Storages> {\r\n  const storages: { [index: string]: Storage } = {}\r\n  return async name => {\r\n    let storage = storages[name];\r\n    if (storage == undefined) {\r\n      storage = new Db(name);\r\n      storages[name] = storage;\r\n    }\r\n    return storage;\r\n  }\r\n}","import { MessageHandlerReflective, BUS } from \"../../apis/handler\";\r\nimport { cyclic } from \"../../../utils/mathutils\";\r\nimport { NamedMessage } from \"../../edit/messages\";\r\nimport { Injector } from \"../../../utils/injector\";\r\n\r\nexport class GridControllerImpl extends MessageHandlerReflective {\r\n  private gridSizes = [16, 32, 64, 128, 256, 512, 1024];\r\n  private gridSizeIdx = 4;\r\n\r\n  public setGridSize(size: number) {\r\n    if (size < this.gridSizes[0]) this.gridSizeIdx = 0;\r\n    else if (size > this.gridSizes[this.gridSizes.length - 1]) this.gridSizeIdx = this.gridSizes.length - 1;\r\n    else {\r\n      for (let i = 0; i < this.gridSizes.length - 2; i++) {\r\n        const i1 = i + 1;\r\n        if (size > this.gridSizes[i1]) continue;\r\n        this.gridSizeIdx = (size - this.gridSizes[i]) < (this.gridSizes[i1] - size) ? i : i1;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  private snapGrid(coord: number): number { const gridSize = this.getGridSize(); return Math.round(coord / gridSize) * gridSize }\r\n  public getGridSize(): number { return this.gridSizes[this.gridSizeIdx] }\r\n  public incGridSize() { this.gridSizeIdx = cyclic(this.gridSizeIdx + 1, this.gridSizes.length) }\r\n  public decGridSize() { this.gridSizeIdx = cyclic(this.gridSizeIdx - 1, this.gridSizes.length) }\r\n  public snap(x: number) { return this.snapGrid(x) }\r\n\r\n  NamedMessage(msg: NamedMessage) {\r\n    switch (msg.name) {\r\n      case 'grid+': this.incGridSize(); return;\r\n      case 'grid-': this.decGridSize(); return;\r\n    }\r\n  }\r\n}\r\n\r\nexport async function DefaultGridController(injector: Injector) {\r\n  const bus = await injector.getInstance(BUS);\r\n  const grid = new GridControllerImpl();\r\n  bus.connect(grid);\r\n  return grid;\r\n}\r\n","import { Board } from \"../../../build/board/structs\";\r\nimport { Deck } from \"../../../utils/collections\";\r\nimport { Injector } from \"../../../utils/injector\";\r\nimport { BoardProvider, DEFAULT_BOARD, ENGINE_API } from \"../../apis/app\";\r\nimport { BUS, MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { INVALIDATE_ALL, LoadBoard, NamedMessage } from \"../../edit/messages\";\r\n\r\nclass History {\r\n  private history: Deck<Board> = new Deck();\r\n  public push(board: Board) { this.history.push(board) }\r\n  public pop() { if (this.history.length() > 1) this.history.pop() }\r\n  public top() { return this.history.top() }\r\n}\r\n\r\nexport async function DefaultBoardProviderConstructor(injector: Injector): Promise<BoardProvider> {\r\n  const bus = await injector.getInstance(BUS);\r\n  const api = await injector.getInstance(ENGINE_API);\r\n  const defaultBoard = await injector.getInstance(DEFAULT_BOARD);\r\n  const history = new History();\r\n  let activeBoard: Board = api.cloneBoard(defaultBoard);\r\n  history.push(api.cloneBoard(defaultBoard));\r\n\r\n  bus.connect(new class extends MessageHandlerReflective {\r\n    NamedMessage(msg: NamedMessage) {\r\n      switch (msg.name) {\r\n        case 'undo':\r\n          history.pop();\r\n          activeBoard = api.cloneBoard(history.top());\r\n          bus.handle(INVALIDATE_ALL);\r\n          return;\r\n        case 'commit':\r\n          history.push(api.cloneBoard(activeBoard));\r\n          return;\r\n      }\r\n    }\r\n\r\n    LoadBoard(msg: LoadBoard) {\r\n      activeBoard = api.cloneBoard(msg.board);\r\n      history.push(api.cloneBoard(msg.board));\r\n      bus.handle(INVALIDATE_ALL);\r\n    }\r\n  })\r\n\r\n  return () => activeBoard;\r\n}","import { BuildReferenceTracker } from \"../../apis/app\";\r\nimport { ReferenceTrackerImpl } from \"../../apis/referencetracker\";\r\n\r\nexport class BuildReferenceTrackerImpl implements BuildReferenceTracker {\r\n  readonly walls = new ReferenceTrackerImpl<number>(-1);\r\n  readonly sectors = new ReferenceTrackerImpl<number>(-1);\r\n  readonly sprites = new ReferenceTrackerImpl<number>(-1);\r\n}","import { State } from \"../../apis/app\";\r\n\r\nexport class StateImpl implements State {\r\n  private state: { [index: string]: any } = {};\r\n\r\n  register<T>(name: string, defaultValue: T): void {\r\n    const prevState = this.state[name];\r\n    if (prevState != undefined) throw new Error(`Redefining state ${name}`);\r\n    this.state[name] = defaultValue;\r\n  }\r\n\r\n  set<T>(name: string, value: T): void {\r\n    this.get(name);\r\n    this.state[name] = value;\r\n  }\r\n\r\n  get<T>(name: string): T {\r\n    const stateValue = this.state[name];\r\n    if (stateValue == undefined) throw new Error(`State ${name} is unregistered`);\r\n    return stateValue;\r\n  }\r\n\r\n  has(name: string): boolean {\r\n    return this.state[name] != undefined;\r\n  }\r\n}","import { Lexer, LexerRule } from \"../../../utils/lexer\";\r\nimport { Injector } from \"../../../utils/injector\";\r\nimport { Texture } from \"../../../utils/gl/drawstruct\";\r\nimport { GL, createIndexedTexture, TextureProvider } from \"../buildartprovider\";\r\nimport { FS } from \"../fs/fs\";\r\nimport { INDEXED_IMG_LIB } from \"../../../utils/imglib\";\r\nimport { loadImageFromBuffer, loadImage } from \"../../../utils/imgutils\";\r\nimport { createTexture } from \"../../../utils/gl/textures\";\r\n\r\nfunction createLexer(str: string) {\r\n  const lexer = new Lexer();\r\n  lexer.addRule(new LexerRule(/^[ \\t\\r\\v\\n]+/, 'WS'));\r\n  lexer.addRule(new LexerRule(/^[a-zA-Z_][a-zA-Z0-9_]+/, 'ID'));\r\n  lexer.addRule(new LexerRule(/^\\-?[0-9]+/, 'INT', 0, parseInt));\r\n  lexer.addRule(new LexerRule(/^\"([^\"]*)\"/, 'STRING', 1));\r\n  lexer.addRule(new LexerRule(/^;/, 'SEMICOLON'));\r\n  lexer.setSource(str);\r\n\r\n  return {\r\n    get: <T>(expected: string, value: T = null): T => {\r\n      for (; lexer.next() == 'WS';);\r\n      if (lexer.isEoi()) throw new Error();\r\n      let tokenId = lexer.rule().name;\r\n      let actual = lexer.value();\r\n      if (tokenId != expected || value != null && value != actual) throw new Error();\r\n      return lexer.value();\r\n    }\r\n  }\r\n}\r\n\r\nasync function loadTexture(gl: WebGLRenderingContext, name: string, options: any = {}, format = gl.RGBA, bpp = 4) {\r\n  return loadImage(name).then(img => createTexture(img[0], img[1], gl, options, img[2], format, bpp))\r\n}\r\n\r\nexport async function DefaultAdditionalTextures(injector: Injector): Promise<TextureProvider> {\r\n  const textures: { [index: number]: Texture } = {};\r\n  const [gl, fs, lib] = await Promise.all([injector.getInstance(GL), injector.getInstance(FS), injector.getInstance(INDEXED_IMG_LIB)]);\r\n  const file = await fs.get('texlist.lst');\r\n  const decoder = new TextDecoder('utf-8');\r\n  const list = decoder.decode(file);\r\n  const lexer = createLexer(list);\r\n\r\n  try {\r\n    for (; ;) {\r\n      const id = lexer.get<number>('INT');\r\n      const path = lexer.get<string>('STRING');\r\n      const options = lexer.get<string>('ID');\r\n      lexer.get('SEMICOLON');\r\n\r\n      if (options == 'plain') {\r\n        const opts = { filter: WebGLRenderingContext.NEAREST, repeat: WebGLRenderingContext.CLAMP_TO_EDGE };\r\n        textures[id] = await loadTexture(gl, path, opts);\r\n      } else if (options == 'palletize') {\r\n        const texture = await fs.get(path);\r\n        const [w, h, buff] = await loadImageFromBuffer(texture);\r\n        const indexed = lib.palettize(w, h, buff);\r\n        textures[id] = createIndexedTexture(gl, w, h, indexed, true, lib);\r\n      }\r\n    }\r\n  } finally {\r\n    return (id: number) => textures[id];\r\n  }\r\n}","import { Board } from \"../../../build/board/structs\";\r\nimport { cloneBoard, cloneSector, cloneSprite, cloneWall, newBoard, newSector, newSprite, newWall, loadBuildMap, saveBuildMap } from '../../../build/maploader';\r\nimport { ArtFile, ArtFiles } from \"../../../build/formats/art\";\r\nimport { createPalette, GrpFile, loadPlus, loadShadeTables } from \"../../../build/formats/grp\";\r\nimport { createTexture } from \"../../../utils/gl/textures\";\r\nimport { Dependency, Injector, Module } from \"../../../utils/injector\";\r\nimport { BUS } from \"../../apis/handler\";\r\nimport { LoadBoard, namedMessageHandler } from \"../../edit/messages\";\r\nimport { PIC_TAGS, RAW_PAL, RAW_PLUs } from \"../artselector\";\r\nimport { ART_FILES, GL, PARALLAX_TEXTURES } from \"../buildartprovider\";\r\nimport { FS } from \"../fs/fs\";\r\nimport { PALSWAPS, PAL_TEXTURE, PLU_TEXTURE, SHADOWSTEPS } from \"../gl/buildgl\";\r\nimport { MAP_NAMES, showMapSelection } from \"../selectmap\";\r\nimport { Implementation_, RorLinks } from \"../view/boardrenderer3d\";\r\nimport { FS_MANAGER } from \"../fs/manager\";\r\nimport { EngineApi } from \"../../../build/board/mutations/api\";\r\nimport { BOARD, BuildResources, DEFAULT_BOARD, ENGINE_API, RESOURCES } from \"../../apis/app\";\r\nimport { Stream } from \"../../../utils/stream\";\r\n\r\nconst GRP = new Dependency<GrpFile>('Grp File');\r\nconst SHADOW_TABLE = new Dependency<Uint8Array[]>('Shadow Table');\r\n\r\nasync function loadArtFiles(injector: Injector): Promise<ArtFiles> {\r\n  const grp = await injector.getInstance(GRP);\r\n  const artFiles: ArtFile[] = [];\r\n  for (let a = 0; a < 20; a++) artFiles.push(new ArtFile(grp.get('tiles0' + (\"00\" + a).slice(-2) + '.art')))\r\n  return new ArtFiles(artFiles);\r\n}\r\n\r\nasync function loadPal(injector: Injector) {\r\n  const grp = await injector.getInstance(GRP);\r\n  return createPalette(grp.get('PALETTE.DAT'));\r\n}\r\n\r\nasync function loadPalTexture(injector: Injector) {\r\n  return Promise.all([injector.getInstance(RAW_PAL), injector.getInstance(GL)]).then(\r\n    ([pal, gl]) => createTexture(256, 1, gl, { filter: gl.NEAREST }, pal, gl.RGB, 3))\r\n}\r\n\r\nasync function loadShadowTable(injector: Injector) {\r\n  const grp = await injector.getInstance(GRP);\r\n  return loadShadeTables(grp.get('PALETTE.DAT'));\r\n}\r\n\r\nasync function loadLookups(injector: Injector) {\r\n  const grp = await injector.getInstance(GRP);\r\n  return loadPlus(grp.get('LOOKUP.DAT'));\r\n}\r\n\r\nasync function loadPluTexture(injector: Injector) {\r\n  const [shadows, gl, lookups] = await Promise.all([\r\n    injector.getInstance(SHADOW_TABLE),\r\n    injector.getInstance(GL),\r\n    injector.getInstance(RAW_PLUs)]);\r\n\r\n  const tex = new Uint8Array(256 * shadows.length * lookups.length);\r\n  for (let i = 0; i < lookups.length; i++) {\r\n    const lookup = lookups[i];\r\n    const shadowed = new Uint8Array(256 * shadows.length);\r\n    for (let s = 0; s < shadows.length; s++) {\r\n      const shadow = shadows[s];\r\n      for (let c = 0; c < 256; c++) shadowed[s * 256 + c] = shadow[lookup[c]]\r\n    }\r\n    tex.set(shadowed, 256 * shadows.length * i);\r\n  }\r\n  return createTexture(256, shadows.length * lookups.length, gl, { filter: gl.NEAREST }, tex, gl.LUMINANCE)\r\n}\r\n\r\nfunction loadMapImpl(name: string) {\r\n  return async (injector: Injector) => {\r\n    const res = await injector.getInstance(RESOURCES)\r\n    return loadBuildMap(new Stream(await res.get(name), true));\r\n  }\r\n}\r\n\r\nfunction createBoard() {\r\n  const board = new Board();\r\n  board.walls = [];\r\n  board.sectors = [];\r\n  board.sprites = [];\r\n  board.numwalls = 0;\r\n  board.numsectors = 0;\r\n  board.numsprites = 0;\r\n  board.version = 0x0007;\r\n  board.posx = board.posy = board.posz = board.cursectnum = board.ang = 0;\r\n  return board;\r\n}\r\n\r\nfunction DukeImplementation() {\r\n  const rorLinks = new RorLinks();\r\n  return {\r\n    rorLinks: () => rorLinks,\r\n    isMirrorPic(picnum: number) { return picnum == -1 },\r\n  }\r\n}\r\n\r\nasync function loadGrp(injector: Injector) {\r\n  const fs = await injector.getInstance(FS);\r\n  const grp = await fs.get('DUKE3D.GRP');\r\n  return new GrpFile(grp);\r\n}\r\n\r\nasync function getMapNames(injector: Injector) {\r\n  const res = await injector.getInstance(RESOURCES);\r\n  return () => res.list().then(list => list.filter(f => f.toLowerCase().endsWith('.map')));\r\n}\r\n\r\nasync function shadowsteps(injector: Injector) {\r\n  const shadows = await injector.getInstance(SHADOW_TABLE);\r\n  return shadows.length;\r\n}\r\n\r\nasync function palswaps(injector: Injector) {\r\n  const lookups = await injector.getInstance(RAW_PLUs);\r\n  return lookups.length;\r\n}\r\n\r\nasync function PicTags(injector: Injector) {\r\n  return {\r\n    allTags() { return [] },\r\n    tags(id: number) { return [] }\r\n  }\r\n}\r\n\r\nasync function Resources(injector: Injector): Promise<BuildResources> {\r\n  const fs = await injector.getInstance(FS);\r\n  const grp = await injector.getInstance(GRP);\r\n  return {\r\n    get: async name => {\r\n      const file = await fs.get(name);\r\n      if (file != null) return file;\r\n      return grp.getArrayBuffer(name);\r\n    },\r\n    list: async () => {\r\n      const files = new Set<string>(Object.keys(grp.files));\r\n      (await fs.list()).forEach(f => files.add(f));\r\n      return [...files];\r\n    }\r\n  }\r\n}\r\n\r\nasync function mapLoader(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    bus.connect(namedMessageHandler('load_map', async () => {\r\n      const mapName = await showMapSelection(injector);\r\n      if (!mapName) return;\r\n      const map = await loadMapImpl(mapName)(injector);\r\n      bus.handle(new LoadBoard(map));\r\n    }));\r\n  });\r\n}\r\n\r\nasync function mapSaver(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    const fsmgr = await injector.getInstance(FS_MANAGER);\r\n    const board = await injector.getInstance(BOARD);\r\n    bus.connect(namedMessageHandler('save_map', async () => {\r\n      fsmgr.write('newboard.map', saveBuildMap(board()))\r\n    }));\r\n  });\r\n}\r\n\r\nfunction engineApi(): EngineApi {\r\n  return { cloneBoard, cloneWall, cloneSprite, cloneSector, newWall, newSector, newSprite, newBoard };\r\n}\r\n\r\nexport function DukeModule(module: Module) {\r\n  module.bindInstance(PARALLAX_TEXTURES, 5);\r\n  module.bindInstance(ENGINE_API, engineApi());\r\n  module.bindInstance(Implementation_, DukeImplementation());\r\n  module.bind(PALSWAPS, palswaps);\r\n  module.bind(SHADOWSTEPS, shadowsteps);\r\n  module.bind(GRP, loadGrp);\r\n  module.bind(ART_FILES, loadArtFiles);\r\n  module.bind(RAW_PAL, loadPal);\r\n  module.bind<Uint8Array[]>(RAW_PLUs, loadLookups);\r\n  module.bind<Uint8Array[]>(SHADOW_TABLE, loadShadowTable);\r\n  module.bind(PAL_TEXTURE, loadPalTexture);\r\n  module.bind(PLU_TEXTURE, loadPluTexture);\r\n  module.bind(MAP_NAMES, getMapNames);\r\n  module.bind(PIC_TAGS, PicTags);\r\n  module.bindInstance(DEFAULT_BOARD, createBoard());\r\n  module.bind(RESOURCES, Resources);\r\n\r\n  module.install(mapLoader);\r\n  module.install(mapSaver);\r\n}","import { Injector, Module } from \"../../../utils/injector\";\r\nimport { STORAGES, Storage } from \"../../apis/app\";\r\nimport { FileSystem, UrlFs, FS } from \"./fs\";\r\nimport { FS_MANAGER, FsManager } from \"./manager\";\r\nimport { MOUNTS, MountableFs } from \"./mount\";\r\nimport { StorageDbConstructor } from \"../db\";\r\n\r\nfunction createDb(name: string) {\r\n  let db: Storage = null;\r\n  return async (injector: Injector) => {\r\n    if (db == null) {\r\n      const storages = await injector.getInstance(STORAGES);\r\n      db = await storages(name);\r\n    }\r\n    return db;\r\n  }\r\n}\r\n\r\nconst fsProvider = createDb('filesystem');\r\nconst fsinfoProvider = createDb('filesystem-info');\r\n\r\nexport async function StorageFs(injector: Injector): Promise<FileSystem> {\r\n  const fs = await fsProvider(injector);\r\n  return {\r\n    get: async name => fs.get(name),\r\n    list: async () => fs.keys(),\r\n  }\r\n}\r\n\r\nasync function StorageFsManager(injector: Injector): Promise<FsManager> {\r\n  const fs = await fsProvider(injector);\r\n  const fsinfo = await fsinfoProvider(injector);\r\n  return {\r\n    read: name => fs.get(name),\r\n    write: async (name: string, data: ArrayBuffer) => await Promise.all([fs.set(name, data), fsinfo.set(name, { size: data.byteLength })]),\r\n    delete: async name => await Promise.all([fs.delete(name), fsinfo.delete(name)]),\r\n    list: () => fsinfo.keys(),\r\n  }\r\n}\r\n\r\nexport function DbFsModule(rom: string = null) {\r\n  return (module: Module) => {\r\n    module.bind(STORAGES, StorageDbConstructor);\r\n    module.bind(FS, MountableFs);\r\n    module.bind<FileSystem>(MOUNTS, StorageFs);\r\n    if (rom != null) module.bind<FileSystem>(MOUNTS, UrlFs(rom));\r\n    module.bind(FS_MANAGER, StorageFsManager);\r\n  }\r\n}","import { loadBin } from \"../../../utils/getter\";\r\nimport { Dependency, Injector, InstanceProvider } from \"../../../utils/injector\";\r\n\r\nexport interface FileSystem {\r\n  get(name: string): Promise<ArrayBuffer>\r\n  list(): Promise<string[]>;\r\n}\r\nexport const FS = new Dependency<FileSystem>('FileSystem');\r\n\r\nexport type FileListProvider = () => Promise<string[]>;\r\n\r\nexport function UrlFs(path: string): InstanceProvider<FileSystem> {\r\n  return async (injector: Injector) => {\r\n    return {\r\n      get: async name => loadBin(path + name),\r\n      list: async () => [],\r\n    }\r\n  }\r\n}\r\n\r\n// export function ZipFs(injector: Injector): Promise<FileProvider> {\r\n//   return new Promise(resolve => {\r\n//     const fileReader = new FileReader();\r\n//     const win = document.getElementById(\"zipfile\");\r\n//     win.classList.remove('hidden');\r\n//     win.addEventListener(\"dragenter\", drag, false);\r\n//     win.addEventListener(\"dragover\", drag, false);\r\n//     win.addEventListener(\"drop\", (e) => {\r\n//       e.stopPropagation();\r\n//       e.preventDefault();\r\n//       fileReader.readAsArrayBuffer(e.dataTransfer.files[0])\r\n//     }, false);\r\n//     fileReader.onload = async e => {\r\n//       win.classList.add('hidden');\r\n//       const zfs = await loadZip(e.target.result);\r\n//       const files = Object.keys(zfs.files);\r\n//       const nameMap = new Map<string, any>();\r\n//       files.forEach(f => nameMap.set(f.toLowerCase(), zfs.file(f)));\r\n//       resolve((name: string) => nameMap.get(name.toLowerCase()).async('arraybuffer'));\r\n//     }\r\n//   })\r\n// }\r\n","import { saveAs } from \"../../../utils/filesave\";\r\nimport { create, Dependency, Injector, Module } from \"../../../utils/injector\";\r\nimport { iter } from \"../../../utils/iter\";\r\nimport { GridModel, IconText, IconTextRenderer, renderGrid } from \"../../../utils/ui/renderers\";\r\nimport { addDragAndDrop, Element } from \"../../../utils/ui/ui\";\r\nimport { BUS } from \"../../apis/handler\";\r\nimport { UI, Ui, Window } from \"../../apis/ui\";\r\nimport { namedMessageHandler } from \"../../edit/messages\";\r\n\r\nexport interface FsManager {\r\n  read(name: string): Promise<ArrayBuffer>;\r\n  write(name: string, data: ArrayBuffer): Promise<any>;\r\n  delete(name: string): Promise<any>;\r\n  list(): Promise<string[]>\r\n}\r\nexport const FS_MANAGER = new Dependency<FsManager>('FileSystem Manager');\r\n\r\nclass FileBrowser {\r\n  private window: Window;\r\n  private selected = new Set<string>();\r\n\r\n  constructor(ui: Ui, private manager: FsManager) {\r\n    this.window = ui.builder.window()\r\n      .id('fileBrowser')\r\n      .title('Files')\r\n      .draggable(true)\r\n      .closeable(true)\r\n      .centered(true)\r\n      .size(600, 600)\r\n      .toolbar(ui.builder.toolbar()\r\n        .startGroup()\r\n        .button('icon-arrows-ccw', () => this.refreshContent())\r\n        .button('icon-download', () => this.downloadSelected())\r\n        .button('icon-trash', () => this.deleteSelected())\r\n        .endGroup())\r\n      .build();\r\n\r\n    const win = this.window.winElement;\r\n    addDragAndDrop(win, e => {\r\n      for (const file of e.dataTransfer.files) {\r\n        const fileReader = new FileReader();\r\n        const name = file.name;\r\n        fileReader.readAsArrayBuffer(file);\r\n        fileReader.onload = async e => {\r\n          const data = <ArrayBuffer>e.target.result;\r\n          await manager.write(name, data);\r\n          this.refreshContent();\r\n        }\r\n      }\r\n    })\r\n  }\r\n\r\n  private gridModel = this.createGridModel();\r\n  private createGridModel(): GridModel {\r\n    const columns = [IconTextRenderer];\r\n    const item = (f: string) => { return { text: f, icon: this.getIcon(f), style: this.selected.has(f) ? \"selected\" : \"\" } };\r\n    const self = this;\r\n    return {\r\n      async rows() { return iter(await self.manager.list()).map(f => [item(f)]) },\r\n      columns() { return columns },\r\n      onClick(row: [IconText], rowElement: Element) { self.toggleItem(rowElement.elem(), row[0].text) }\r\n    }\r\n  }\r\n\r\n  private async refreshContent() {\r\n    const table = await renderGrid(this.gridModel);\r\n    this.replaceContent(table.elem());\r\n  }\r\n\r\n  private getIcon(name: string) {\r\n    if (name.toLowerCase().endsWith('.map')) return 'icon-globe'\r\n    if (name.toLowerCase().endsWith('.art')) return 'icon-picture'\r\n    return 'icon-doc';\r\n  }\r\n\r\n  private replaceContent(newContent: HTMLElement) {\r\n    const content = this.window.contentElement.firstChild\r\n    if (content) this.window.contentElement.replaceChild(newContent, content);\r\n    else this.window.contentElement.appendChild(newContent);\r\n  }\r\n\r\n  private toggleItem(target: HTMLElement, name: string) {\r\n    target.classList.toggle('selected');\r\n    if (this.selected.has(name)) this.selected.delete(name)\r\n    else this.selected.add(name);\r\n  }\r\n\r\n  private async deleteSelected() {\r\n    for (const file of this.selected) {\r\n      await this.manager.delete(file)\r\n      this.selected.delete(file);\r\n    }\r\n    this.refreshContent();\r\n  }\r\n\r\n  private async downloadSelected() {\r\n    for (const file of this.selected) {\r\n      saveAs(await this.manager.read(file), file);\r\n      this.selected.delete(file);\r\n    }\r\n    this.refreshContent();\r\n  }\r\n\r\n  public async show() {\r\n    await this.refreshContent();\r\n    this.window.show()\r\n  }\r\n}\r\n\r\nlet browser: FileBrowser;\r\nasync function getFileBrowser(injector: Injector) {\r\n  if (browser == null) browser = await create(injector, FileBrowser, UI, FS_MANAGER);\r\n  return browser;\r\n}\r\n\r\nexport async function showFileBrowser(injector: Injector) {\r\n  const browser = await getFileBrowser(injector);\r\n  browser.show();\r\n}\r\n\r\nexport async function FileBrowserModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    bus.connect(namedMessageHandler('show_files', () => showFileBrowser(injector)));\r\n  });\r\n}\r\n","import { Dependency, Injector } from \"../../../utils/injector\";\r\nimport { FileSystem } from \"./fs\";\r\n\r\nexport const MOUNTS = new Dependency<FileSystem[]>(\"Mounts\", true);\r\n\r\n\r\nexport async function MountableFs(injector: Injector): Promise<FileSystem> {\r\n  return {\r\n    get: async name => {\r\n      const mounts = await injector.getInstance(MOUNTS);\r\n      for (const mount of mounts) {\r\n        const file = await mount.get(name);\r\n        if (file) return file;\r\n      }\r\n      return null;\r\n    },\r\n    list: async () => {\r\n      const mounts = await injector.getInstance(MOUNTS);\r\n      const files = new Set<string>();\r\n      for (const mount of mounts) {\r\n        const list = await mount.list();\r\n        list.forEach(f => files.add(f));\r\n      }\r\n      return [...files];\r\n    },\r\n  }\r\n}","import { Board, Sector, Wall } from '../../../../build/board/structs';\r\nimport { slope, ZSCALE } from '../../../../build/utils';\r\nimport { mat4, vec4 } from '../../../../libs_js/glmatrix';\r\nimport { Texture } from '../../../../utils/gl/drawstruct';\r\nimport { int, len2d } from '../../../../utils/mathutils';\r\nimport { Tiler } from '../../../../utils/tiler';\r\nimport { BuildBuffer } from '../../gl/buffers';\r\nimport { RenderablesCacheContext } from '../cache';\r\nimport { PointSpriteBuilder, WireframeBuilder } from '../common';\r\nimport { sectorOfWall, walllen } from '../../../../build/board/query';\r\nimport { DEFAULT_REPEAT_RATE } from '../../../../build/board/mutations/internal';\r\n\r\nexport const GRID_SECTOR_MATRIX = mat4.create();\r\nmat4.identity(GRID_SECTOR_MATRIX);\r\nmat4.rotateX(GRID_SECTOR_MATRIX, GRID_SECTOR_MATRIX, -Math.PI / 2);\r\n\r\nexport enum WallGridType { VOID, BOT, TOP, MID }\r\nfunction getBaseZ(type: WallGridType, wall: Wall, sector: Sector, nextsector: Sector) {\r\n  if (nextsector == undefined) return wall.cstat.alignBottom ? sector.floorz : sector.ceilingz;\r\n  switch (type) {\r\n    case WallGridType.VOID: return wall.cstat.alignBottom ? sector.floorz : sector.ceilingz;\r\n    case WallGridType.BOT: return wall.cstat.alignBottom ? sector.ceilingz : nextsector.floorz;\r\n    case WallGridType.TOP: return wall.cstat.alignBottom ? sector.ceilingz : nextsector.ceilingz;\r\n    case WallGridType.MID: return wall.cstat.alignBottom ? Math.min(sector.floorz, nextsector.floorz) : Math.max(sector.ceilingz, nextsector.ceilingz);\r\n  }\r\n}\r\n\r\nlet tmp = vec4.create();\r\nlet texMat = mat4.create();\r\nexport function createGridWallMatrix(board: Board, id: number, type: WallGridType) {\r\n  const wall1 = board.walls[id];\r\n  const wall2 = board.walls[wall1.point2];\r\n  const dx = wall2.x - wall1.x;\r\n  const dy = wall2.y - wall1.y;\r\n  const sector = board.sectors[sectorOfWall(board, id)];\r\n  const nextsector = board.sectors[wall1.nextsector];\r\n  const zbase = getBaseZ(type, wall1, sector, nextsector);\r\n  const wlen = walllen(board, id);\r\n  const sx = (wall1.xrepeat * DEFAULT_REPEAT_RATE) / wlen;\r\n  const sy = wall1.yrepeat / 8;\r\n  mat4.identity(texMat);\r\n  vec4.set(tmp, sx, sy, 1, 1);\r\n  mat4.scale(texMat, texMat, tmp);\r\n  mat4.rotateY(texMat, texMat, -Math.atan2(-dy, dx));\r\n  vec4.set(tmp, -wall1.x, -zbase / ZSCALE, -wall1.y, 0);\r\n  return mat4.translate(texMat, texMat, tmp);\r\n}\r\n\r\nexport function buildCeilingHinge(ctx: RenderablesCacheContext, sectorId: number, builder: WireframeBuilder): WireframeBuilder { return prepareHinge(ctx, sectorId, true, builder) }\r\nexport function buildFloorHinge(ctx: RenderablesCacheContext, sectorId: number, builder: WireframeBuilder): WireframeBuilder { return prepareHinge(ctx, sectorId, false, builder) }\r\n\r\nfunction prepareHinge(ctx: RenderablesCacheContext, sectorId: number, ceiling: boolean, builder: WireframeBuilder): WireframeBuilder {\r\n  const board = ctx.board();\r\n  builder.mode = WebGLRenderingContext.TRIANGLES;\r\n  vec4.set(builder.color, 0.7, 0.7, 0.7, 0.7);\r\n  const size = 128;\r\n  const buff = builder.buff;\r\n  buff.allocate(6, 24);\r\n  const sec = board.sectors[sectorId];\r\n  const wall1 = board.walls[sec.wallptr];\r\n  const wall2 = board.walls[wall1.point2];\r\n  let dx = (wall2.x - wall1.x); let dy = (wall2.y - wall1.y);\r\n  const dl = len2d(dx, dy);\r\n  const x = wall1.x + dx / 2; const y = wall1.y + dy / 2;\r\n  dx /= dl; dy /= dl;\r\n  const z = (ceiling ? sec.ceilingz : sec.floorz) / ZSCALE;\r\n  const dz = ceiling ? -size / 2 : size / 2;\r\n  const x1 = x - dx * size; const y1 = y - dy * size;\r\n  const x2 = x + dx * size; const y2 = y + dy * size;\r\n  const x3 = x1 - dy * (size / 2); const y3 = y1 + dx * (size / 2);\r\n  const x4 = x2 - dy * (size / 2); const y4 = y2 + dx * (size / 2);\r\n  const heinum = ceiling ? sec.ceilingheinum : sec.floorheinum;\r\n  const s = slope(board, sectorId, x3, y3, heinum) / ZSCALE;\r\n  buff.writePos(0, x1, z, y1);\r\n  buff.writePos(1, x2, z, y2);\r\n  buff.writePos(2, x3, z + s, y3);\r\n  buff.writePos(3, x4, z + s, y4);\r\n  buff.writePos(4, x1, z + dz, y1);\r\n  buff.writePos(5, x2, z + dz, y2);\r\n  buff.writeQuad(0, 0, 1, 3, 2);\r\n  buff.writeQuad(6, 2, 3, 1, 0);\r\n  buff.writeQuad(12, 0, 1, 5, 4);\r\n  buff.writeQuad(18, 4, 5, 1, 0);\r\n  return builder;\r\n}\r\n\r\nexport function text(builder: PointSpriteBuilder, text: string, posx: number, posy: number, posz: number, charW: number, charH: number, tex: Texture) {\r\n  builder.tex = tex;\r\n  const buff = builder.buff;\r\n  buff.allocate((text.length * 2 + 3) * 4, (text.length * 2 + 3) * 6);\r\n  writeText(buff, 0, text, charW, charH, posx, posy, posz);\r\n  return builder;\r\n}\r\n\r\nexport function writeText(buff: BuildBuffer, bufferOff: number, text: string, charW: number, charH: number, posx: number, posy: number, posz: number) {\r\n  const tiler = new Tiler();\r\n  for (let i = 0; i < text.length; i++) tiler.put(i + 1, 1, text.charCodeAt(i)).put(i + 1, 0, 3);\r\n  tiler\r\n    .put(0, 0, 2)\r\n    .put(0, 1, 0)\r\n    .put(text.length + 1, 1, 1);\r\n  let vtxoff = bufferOff * 4;\r\n  let idxoff = bufferOff * 6;\r\n  const charTexSize = 1 / 16;\r\n  const centerXOff = - charW * (text.length / 2 + 1);\r\n  const centerYOff = charH / 2;\r\n  tiler.tile((x: number, y: number, tileId: number) => {\r\n    const row = int(tileId / 16) * charTexSize;\r\n    const column = (tileId % 16) * charTexSize;\r\n    const xoff = x * charW + centerXOff;\r\n    const yoff = -y * charH + centerYOff;\r\n\r\n    buff.writePos(vtxoff + 0, posx, posz, posy);\r\n    buff.writePos(vtxoff + 1, posx, posz, posy);\r\n    buff.writePos(vtxoff + 2, posx, posz, posy);\r\n    buff.writePos(vtxoff + 3, posx, posz, posy);\r\n    buff.writeTcLighting(vtxoff + 0, column, row + charTexSize);\r\n    buff.writeTcLighting(vtxoff + 1, column, row);\r\n    buff.writeTcLighting(vtxoff + 2, column + charTexSize, row);\r\n    buff.writeTcLighting(vtxoff + 3, column + charTexSize, row + charTexSize);\r\n    buff.writeNormal(vtxoff + 0, xoff, yoff, 0);\r\n    buff.writeNormal(vtxoff + 1, xoff, yoff + charH, 0);\r\n    buff.writeNormal(vtxoff + 2, xoff + charW, yoff + charH, 0);\r\n    buff.writeNormal(vtxoff + 3, xoff + charW, yoff, 0);\r\n    buff.writeQuad(idxoff, vtxoff + 0, vtxoff + 1, vtxoff + 2, vtxoff + 3);\r\n\r\n    vtxoff += 4;\r\n    idxoff += 6;\r\n  });\r\n}","import { sectorWalls } from \"../../../../build/board/loops\";\r\nimport { Board, Wall } from \"../../../../build/board/structs\";\r\nimport { ArtInfo } from \"../../../../build/formats/art\";\r\nimport { createSlopeCalculator, getFirstWallAngle, sectorNormal, ZSCALE } from \"../../../../build/utils\";\r\nimport { mat4, Mat4Array, vec3, Vec3Array, vec4 } from \"../../../../libs_js/glmatrix\";\r\nimport { Deck, last, range } from \"../../../../utils/collections\";\r\nimport { iter } from \"../../../../utils/iter\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { SectorRenderable } from \"../../../apis/renderable\";\r\nimport { BuildBuffer } from \"../../gl/buffers\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory } from \"../common\";\r\n\r\n\r\nexport class SectorBuilder extends Builders implements SectorRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly ceiling = factory.solid('sector'),\r\n    readonly floor = factory.solid('sector')\r\n  ) { super([ceiling, floor]) }\r\n}\r\n\r\nfunction applySectorTextureTransform(board: Board, sectorId: number, ceiling: boolean, info: ArtInfo, texMat: Mat4Array) {\r\n  const sector = board.sectors[sectorId];\r\n  const xpan = (ceiling ? sector.ceilingxpanning : sector.floorxpanning) / 256.0;\r\n  const ypan = (ceiling ? sector.ceilingypanning : sector.floorypanning) / 256.0;\r\n  const stats = ceiling ? sector.ceilingstat : sector.floorstat;\r\n  const scale = stats.doubleSmooshiness ? 8.0 : 16.0;\r\n  const parallaxscale = stats.parallaxing ? 6.0 : 1.0;\r\n  const tcscalex = (stats.xflip ? -1.0 : 1.0) / (info.w * scale * parallaxscale);\r\n  const tcscaley = (stats.yflip ? -1.0 : 1.0) / (info.h * scale);\r\n  mat4.identity(texMat);\r\n  mat4.translate(texMat, texMat, [xpan, ypan, 0, 0]);\r\n  mat4.scale(texMat, texMat, [tcscalex, -tcscaley, 1, 1]);\r\n  if (stats.swapXY) {\r\n    mat4.scale(texMat, texMat, [-1, -1, 1, 1]);\r\n    mat4.rotateZ(texMat, texMat, Math.PI / 2);\r\n  }\r\n  if (stats.alignToFirstWall) {\r\n    const w1 = board.walls[sector.wallptr];\r\n    mat4.rotateZ(texMat, texMat, getFirstWallAngle(board, sectorId));\r\n    mat4.translate(texMat, texMat, [-w1.x, -w1.y, 0, 0])\r\n  }\r\n  mat4.rotateX(texMat, texMat, -Math.PI / 2);\r\n}\r\n\r\nconst tc_ = vec4.create();\r\nfunction fillBuffersForSectorNormal(ceil: boolean, board: Board, sectorId: number, buff: BuildBuffer, vtxs: number[][], vidxs: number[], normal: Vec3Array, t: Mat4Array) {\r\n  const sector = board.sectors[sectorId];\r\n  const heinum = ceil ? sector.ceilingheinum : sector.floorheinum;\r\n  const shade = ceil ? sector.ceilingshade : sector.floorshade;\r\n  const pal = ceil ? sector.ceilingpal : sector.floorpal;\r\n  const z = ceil ? sector.ceilingz : sector.floorz;\r\n  const slope = createSlopeCalculator(board, sectorId);\r\n\r\n  for (let i = 0; i < vtxs.length; i++) {\r\n    const vx = vtxs[i][0];\r\n    const vy = vtxs[i][1];\r\n    const vz = (slope(vx, vy, heinum) + z) / ZSCALE;\r\n    buff.writePos(i, vx, vz, vy);\r\n    buff.writeNormal(i, normal[0], normal[1], normal[2]);\r\n    vec4.transformMat4(tc_, vec4.set(tc_, vx, vz, vy, 1), t);\r\n    buff.writeTcLighting(i, tc_[0], tc_[1], pal, shade);\r\n  }\r\n\r\n  for (let i = 0; i < vidxs.length; i += 3) {\r\n    if (ceil) {\r\n      buff.writeTriangle(i, vidxs[i + 0], vidxs[i + 1], vidxs[i + 2]);\r\n    } else {\r\n      buff.writeTriangle(i, vidxs[i + 2], vidxs[i + 1], vidxs[i + 0]);\r\n    }\r\n  }\r\n}\r\n\r\nfunction compress(triangles: point2d[]): [point2d[], number[]] {\r\n  const vtxidx: string[] = [];\r\n  const vtxset: [number, number][] = [];\r\n  const indexes: number[] = [];\r\n  iter(triangles).forEach(([x0, y0]) => {\r\n    const vtx0 = `${x0},${y0}`;\r\n    let idx = vtxidx.indexOf(vtx0);\r\n    if (idx == -1) {\r\n      idx = vtxset.length;\r\n      vtxidx.push(vtx0);\r\n      vtxset.push([x0, y0]);\r\n    }\r\n    indexes.push(idx);\r\n  });\r\n  return [vtxset, indexes];\r\n}\r\n\r\ntype point2d = [number, number];\r\ntype point2dxy = { x: number, y: number };\r\ntype zoid_t = { x: [number, number, number, number], y: [number, number], w: [Wall, Wall] };\r\ntype trap_t = { x0: number, x1: number, w: Wall }\r\nconst trapCmp = (lh: trap_t, rh: trap_t) => { return lh.x0 + lh.x1 - rh.x0 - rh.x1 }\r\n\r\nexport function triangulate(board: Board, sectorId: number) {\r\n  const secy = [...new Set(iter(sectorWalls(board, sectorId))\r\n    .map(w => board.walls[w].y)\r\n    .collect()\r\n    .sort((l, r) => l - r))];\r\n  const zoids = new Deck<zoid_t>();\r\n  for (const [sy0, sy1] of iter(range(0, secy.length - 1))\r\n    .map(i => [secy[i], secy[i + 1]])) {\r\n    const ts = new Deck<trap_t>();\r\n    for (const [w0, w1] of iter(sectorWalls(board, sectorId))\r\n      .map(w => [board.walls[w], board.walls[board.walls[w].point2]])) {\r\n      let [x0, y0, x1, y1] = w0.y > w1.y ? [w1.x, w1.y, w0.x, w0.y] : [w0.x, w0.y, w1.x, w1.y];\r\n      if ((y0 >= sy1) || (y1 <= sy0)) continue;\r\n      if (y0 < sy0) x0 = (sy0 - w0.y) * (w1.x - w0.x) / (w1.y - w0.y) + w0.x;\r\n      if (y1 > sy1) x1 = (sy1 - w0.y) * (w1.x - w0.x) / (w1.y - w0.y) + w0.x;\r\n      ts.push({ x0, x1, w: w0 });\r\n    }\r\n    const traps = [...ts].sort(trapCmp);\r\n    let j = 0;\r\n    for (let i = 0; i < traps.length; i = j + 1) {\r\n      j = i + 1;\r\n      const trapi = traps[i];\r\n      const trapi1 = traps[i + 1];\r\n      if ((trapi1.x0 <= trapi.x0) && (trapi1.x1 <= trapi.x1)) continue;\r\n      while ((j + 2 < traps.length) && (traps[j + 1].x0 <= traps[j].x0) && (traps[j + 1].x1 <= traps[j].x1)) j += 2;\r\n      const x0 = trapi.x0\r\n      const x1 = traps[j].x0;\r\n      const x2 = traps[j].x1;\r\n      const x3 = trapi.x1;\r\n      const y0 = sy0;\r\n      const y1 = sy1;\r\n      const w0 = trapi.w\r\n      const w1 = traps[j].w;\r\n      zoids.push({ x: [x0, x1, x2, x3], y: [y0, y1], w: [w0, w1] });\r\n    }\r\n  }\r\n\r\n  const triangles: point2d[] = [];\r\n  for (let i = 0; i < zoids.length(); i++) {\r\n    const pol = new Deck<point2dxy>();\r\n    for (let j = 0; j < 4; j++) {\r\n      const polx = zoids.get(i).x[j];\r\n      const poly = zoids.get(i).y[j >> 1];\r\n      if (pol.length() == 0 || (polx != last(pol).x) || (poly != last(pol).y)) pol.push({ x: polx, y: poly });\r\n    }\r\n    if (pol.length() < 3) continue;\r\n    const fp0x = pol.get(0).x;\r\n    const fp0y = pol.get(0).y;\r\n    for (let j = 2; j < pol.length(); j++) {\r\n      const fp1x = pol.get(j).x;\r\n      const fp1y = pol.get(j).y;\r\n      const fp2x = pol.get(j - 1).x;\r\n      const fp2y = pol.get(j - 1).y;\r\n      triangles.push([fp2x, fp2y]);\r\n      triangles.push([fp1x, fp1y]);\r\n      triangles.push([fp0x, fp0y]);\r\n    }\r\n  }\r\n\r\n  return compress(triangles);\r\n}\r\n\r\nfunction fillBuffersForSector(ceil: boolean, board: Board, s: number, builder: SectorBuilder, normal: Vec3Array, t: Mat4Array) {\r\n  const [vtxs, vidxs] = triangulate(board, s);\r\n  const d = ceil ? builder.ceiling : builder.floor;\r\n  d.buff.allocate(vtxs.length, vidxs.length);\r\n  fillBuffersForSectorNormal(ceil, board, s, d.buff, vtxs, vidxs, normal, t);\r\n}\r\n\r\nconst sectorNormal_ = vec3.create();\r\nconst texMat_ = mat4.create();\r\nexport function updateSector(ctx: RenderablesCacheContext, sectorId: number, builder: SectorBuilder): SectorBuilder {\r\n  builder = builder == null ? new SectorBuilder(ctx.factory) : builder;\r\n  const board = ctx.board();\r\n  const art = ctx.art;\r\n  const sector = board.sectors[sectorId];\r\n\r\n  const ceilinginfo = art.getInfo(sector.ceilingpicnum);\r\n  applySectorTextureTransform(board, sectorId, true, ceilinginfo, texMat_);\r\n  fillBuffersForSector(true, board, sectorId, builder, sectorNormal(sectorNormal_, board, sectorId, true), texMat_);\r\n  builder.ceiling.tex = sector.ceilingstat.parallaxing ? art.getParallaxTexture(sector.ceilingpicnum) : art.get(sector.ceilingpicnum);\r\n  builder.ceiling.parallax = sector.ceilingstat.parallaxing;\r\n\r\n  const floorinfo = art.getInfo(sector.floorpicnum);\r\n  applySectorTextureTransform(board, sectorId, false, floorinfo, texMat_);\r\n  fillBuffersForSector(false, board, sectorId, builder, sectorNormal(sectorNormal_, board, sectorId, false), texMat_);\r\n  builder.floor.tex = sector.floorstat.parallaxing ? art.getParallaxTexture(sector.floorpicnum) : art.get(sector.floorpicnum);\r\n  builder.floor.parallax = sector.floorstat.parallaxing;\r\n\r\n  return builder;\r\n}","import { Builders } from \"../../../apis/builder\";\r\nimport { ClusterRenderable } from \"../../../apis/renderable\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory } from \"../common\";\r\n\r\nexport class ClusterBuilder extends Builders implements ClusterRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly solids = factory.solid('cluster'),\r\n    readonly sprites = null,\r\n    readonly transSprites = null,\r\n    readonly transSolids = null\r\n  ) { super([]) }\r\n}\r\n\r\nexport function updateCluster(ctx: RenderablesCacheContext, sectorId: number, builder: ClusterBuilder): ClusterBuilder {\r\n  return null;\r\n}","import { Board, Sector } from \"../../../../build/board/structs\";\r\nimport { createSlopeCalculator, ZSCALE } from \"../../../../build/utils\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { BuildRenderableProvider, SectorRenderable, HELPER_GRID, Renderables } from \"../../../apis/renderable\";\r\nimport { BuildBuffer } from \"../../gl/buffers\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory, PointSpriteBuilder, SolidBuilder, WireframeBuilder } from \"../common\";\r\nimport { buildCeilingHinge, buildFloorHinge, GRID_SECTOR_MATRIX } from \"./common\";\r\nimport { vec4, mat4 } from \"../../../../libs_js/glmatrix\";\r\nimport { sectorOfWall } from \"../../../../build/board/query\";\r\n\r\nexport class SectorHelperBuilder extends Builders implements SectorRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly ceilpoints = factory.pointSprite('helper'),\r\n    readonly ceilwire = factory.wireframe('helper'),\r\n    readonly ceilhinge = factory.wireframe('helper'),\r\n    readonly ceilgrid = factory.grid('helper').knd(HELPER_GRID),\r\n    readonly floorpoints = factory.pointSprite('helper'),\r\n    readonly floorwire = factory.wireframe('helper'),\r\n    readonly floorhinge = factory.wireframe('helper'),\r\n    readonly floorgrid = factory.grid('helper').knd(HELPER_GRID),\r\n    readonly ceiling = new Renderables([ceilpoints, ceilwire, ceilhinge, ceilgrid]),\r\n    readonly floor = new Renderables([floorpoints, floorwire, floorhinge, floorgrid]),\r\n  ) { super([ceilpoints, ceilwire, ceilhinge, ceilgrid, floorpoints, floorwire, floorhinge, floorgrid]) }\r\n}\r\n\r\nfunction fillBufferForWallPoint(offset: number, board: Board, wallId: number, buff: BuildBuffer, d: number, z: number) {\r\n  const wall = board.walls[wallId];\r\n  const vtxOff = offset * 4;\r\n  buff.writePos(vtxOff + 0, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 1, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 2, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 3, wall.x, z, wall.y);\r\n  buff.writeNormal(vtxOff + 0, -d, d, 0);\r\n  buff.writeNormal(vtxOff + 1, d, d, 0);\r\n  buff.writeNormal(vtxOff + 2, d, -d, 0);\r\n  buff.writeNormal(vtxOff + 3, -d, -d, 0);\r\n  buff.writeTcLighting(vtxOff + 0, 0, 0);\r\n  buff.writeTcLighting(vtxOff + 1, 1, 0);\r\n  buff.writeTcLighting(vtxOff + 2, 1, 1);\r\n  buff.writeTcLighting(vtxOff + 3, 0, 1);\r\n  buff.writeQuad(offset * 6, vtxOff, vtxOff + 1, vtxOff + 2, vtxOff + 3);\r\n}\r\n\r\nfunction addWallPoint(offset: number, builder: PointSpriteBuilder, ctx: RenderablesCacheContext, ceiling: boolean, wallId: number, d: number): void {\r\n  const board = ctx.board();\r\n  const s = sectorOfWall(board, wallId);\r\n  const sec = board.sectors[s];\r\n  const slope = createSlopeCalculator(board, s);\r\n  const h = (ceiling ? sec.ceilingheinum : sec.floorheinum);\r\n  const z = (ceiling ? sec.ceilingz : sec.floorz);\r\n  const wall = board.walls[wallId];\r\n  const zz = (slope(wall.x, wall.y, h) + z) / ZSCALE;\r\n  fillBufferForWallPoint(offset, board, wallId, builder.buff, d, zz);\r\n}\r\n\r\nfunction fillBuffersForSectorWireframe(s: number, sec: Sector, heinum: number, z: number, board: Board, builder: WireframeBuilder) {\r\n  let slope = createSlopeCalculator(board, s);\r\n  const buff = builder.buff;\r\n  buff.allocate(sec.wallnum, sec.wallnum * 2);\r\n\r\n  let fw = sec.wallptr;\r\n  let off = 0;\r\n  for (let w = 0; w < sec.wallnum; w++) {\r\n    let wid = sec.wallptr + w;\r\n    let wall = board.walls[wid];\r\n    let vx = wall.x;\r\n    let vy = wall.y;\r\n    let vz = (slope(vx, vy, heinum) + z) / ZSCALE;\r\n    buff.writePos(w, vx, vz, vy);\r\n    if (fw != wid) {\r\n      off = buff.writeLine(off, w - 1, w);\r\n    }\r\n    if (wall.point2 == fw) {\r\n      off = buff.writeLine(off, w, fw - sec.wallptr);\r\n      fw = wid + 1;\r\n    }\r\n  }\r\n}\r\n\r\nexport function updateSectorHelper(cache: BuildRenderableProvider, ctx: RenderablesCacheContext, secId: number, builder: SectorHelperBuilder): SectorHelperBuilder {\r\n  builder = builder == null ? new SectorHelperBuilder(ctx.factory) : builder;\r\n  const pointTex = ctx.art.get(-1);\r\n  const board = ctx.board();\r\n  builder.ceilpoints.tex = pointTex;\r\n  builder.floorpoints.tex = pointTex;\r\n\r\n  const sec = board.sectors[secId];\r\n  const wallnum = sec.wallnum;\r\n  builder.ceilpoints.buff.allocate(wallnum * 4, wallnum * 6);\r\n  builder.floorpoints.buff.allocate(wallnum * 4, wallnum * 6);\r\n  for (let i = 0; i < wallnum; i++) {\r\n    const w = sec.wallptr + i;\r\n    addWallPoint(i, builder.ceilpoints, ctx, true, w, 2.5);\r\n    addWallPoint(i, builder.floorpoints, ctx, false, w, 2.5);\r\n  }\r\n\r\n  vec4.set(builder.ceilwire.color, 1, 1, 1, -100);\r\n  vec4.set(builder.floorwire.color, 1, 1, 1, -100);\r\n  fillBuffersForSectorWireframe(secId, sec, sec.ceilingheinum, sec.ceilingz, board, builder.ceilwire);\r\n  fillBuffersForSectorWireframe(secId, sec, sec.floorheinum, sec.floorz, board, builder.floorwire);\r\n\r\n  buildCeilingHinge(ctx, secId, builder.ceilhinge);\r\n  buildFloorHinge(ctx, secId, builder.floorhinge);\r\n\r\n  const sectorRenderable = cache.sector(secId);\r\n  mat4.copy(builder.ceilgrid.gridTexMat, GRID_SECTOR_MATRIX);\r\n  builder.ceilgrid.solid = <SolidBuilder>sectorRenderable.ceiling;\r\n\r\n  mat4.copy(builder.floorgrid.gridTexMat, GRID_SECTOR_MATRIX);\r\n  builder.floorgrid.solid = <SolidBuilder>sectorRenderable.floor;\r\n\r\n  return builder;\r\n}","import { Builders } from \"../../../apis/builder\";\r\nimport { BuildRenderableProvider, SectorRenderable, WallRenderable } from \"../../../apis/renderable\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { FlatBuilder, SolidBuilder, BuildersFactory } from \"../common\";\r\n\r\nexport class SectorSelectedBuilder extends Builders implements SectorRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly ceiling = factory.flat(''),\r\n    readonly floor = factory.flat(''),\r\n  ) { super([ceiling, floor]) }\r\n}\r\n\r\nexport class WallSelectedBuilder extends Builders implements WallRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly top = factory.flat(''),\r\n    readonly mid = factory.flat(''),\r\n    readonly bot = factory.flat('')\r\n  ) { super([top, mid, bot]) }\r\n}\r\n\r\nexport function updateSectorSelected(cache: BuildRenderableProvider, ctx: RenderablesCacheContext, id: number, builder: SectorSelectedBuilder): SectorSelectedBuilder {\r\n  builder = builder == null ? new SectorSelectedBuilder(ctx.factory) : builder;\r\n  const sector = cache.sector(id);\r\n  builder.ceiling.solid = <SolidBuilder>sector.ceiling;\r\n  builder.floor.solid = <SolidBuilder>sector.floor;\r\n  return builder;\r\n}\r\n\r\nexport function updateWallSelected(cache: BuildRenderableProvider, ctx: RenderablesCacheContext, id: number, builder: WallSelectedBuilder): WallSelectedBuilder {\r\n  builder = builder == null ? new WallSelectedBuilder(ctx.factory) : builder;\r\n  const wall = cache.wall(id);\r\n  builder.top.solid = <SolidBuilder>wall.top;\r\n  builder.mid.solid = <SolidBuilder>wall.mid;\r\n  builder.bot.solid = <SolidBuilder>wall.bot;\r\n  return builder;\r\n}\r\n\r\n","import { Mat4Array, Vec4Array } from \"../../../../libs_js/glmatrix\";\r\nimport { Deck } from \"../../../../utils/collections\";\r\nimport { Buffer } from \"../../../../utils/gl/buffergl\";\r\nimport { Texture } from \"../../../../utils/gl/drawstruct\";\r\nimport { DrawCall, State } from \"../../../../utils/gl/stategl\";\r\nimport { Builder } from \"../../../apis/builder\";\r\nimport { DrawCallConsumer } from \"../../../apis/renderable\";\r\nimport { BuildBuffer, GenericBuildBuffer } from \"../../gl/buffers\";\r\n\r\nexport interface StateSetup {\r\n  createDrawCall(kind: number): DrawCall;\r\n}\r\n\r\nexport class GenericBufferSetup implements StateSetup {\r\n  protected values = new Deck<any>();\r\n  protected buff: Buffer;\r\n  protected offset: number;\r\n  protected size: number;\r\n  protected mode: number;\r\n  protected shaderIdx: number;\r\n  protected aIndexIdx: number;\r\n  protected aPosIdx: number;\r\n\r\n  constructor(state: State) {\r\n    this.shaderIdx = this.register('shader', state);\r\n    this.aIndexIdx = this.register('aIndex', state);\r\n    this.aPosIdx = this.register('aPos', state);\r\n  }\r\n\r\n  protected register(name: string, state: State): number {\r\n    this.values.push(state.getState(name));\r\n    const valueIdx = this.values.length();\r\n    this.values.push(null);\r\n    return valueIdx;\r\n  }\r\n\r\n  createDrawCall(kind: number): DrawCall {\r\n    const hint = hash(this.values[this.shaderIdx], this.buff, this.textureHint(), this.offset);\r\n    return new DrawCall([...this.values], this.buff, this.offset, this.size, this.mode, hint, kind);\r\n  }\r\n\r\n\r\n  textureHint() { return null }\r\n  public shader(shader: string) { this.values.set(this.shaderIdx, shader); return this }\r\n  public drawMode(mode: number) { this.mode = mode; return this }\r\n\r\n  public buffer(buffer: GenericBuildBuffer) {\r\n    this.values.set(this.aIndexIdx, buffer.getIdxBuffer());\r\n    this.values.set(this.aPosIdx, buffer.getPosBuffer());\r\n    const pointer = buffer.get();\r\n    this.buff = pointer.buffer;\r\n    this.offset = pointer.idx.offset;\r\n    this.size = buffer.getSize();\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class BufferSetup extends GenericBufferSetup {\r\n  protected aNormIdx: number;\r\n  protected aTcps: number;\r\n\r\n  constructor(state: State) {\r\n    super(state);\r\n    this.aNormIdx = this.register('aNorm', state);\r\n    this.aTcps = this.register('aTcps', state);\r\n  }\r\n\r\n  public buffer(buffer: BuildBuffer) {\r\n    super.buffer(buffer);\r\n    this.values.set(this.aNormIdx, buffer.getNormBuffer())\r\n    this.values.set(this.aTcps, buffer.getTexCoordBuffer())\r\n    return this;\r\n  }\r\n}\r\n\r\nexport class SolidSetup extends BufferSetup {\r\n  protected baseIdx: number;\r\n  protected colorIdx: number;\r\n\r\n  constructor(state: State) {\r\n    super(state);\r\n    this.baseIdx = this.register('base', state);\r\n    this.colorIdx = this.register('color', state);\r\n  }\r\n\r\n  public base(tex: Texture) { this.values.set(this.baseIdx, tex); return this }\r\n  public color(color: Vec4Array) { this.values.set(this.colorIdx, color); return this }\r\n  textureHint() { return this.values.get(this.baseIdx) }\r\n}\r\n\r\nexport class GridSetup extends BufferSetup {\r\n  protected GTIdx: number;\r\n  protected gridIdx: number;\r\n\r\n  constructor(state: State) {\r\n    super(state);\r\n    this.GTIdx = this.register('GT', state);\r\n    this.gridIdx = this.register('grid', state);\r\n  }\r\n\r\n  public grid(grid: Mat4Array) { this.values.set(this.GTIdx, grid); return this }\r\n  public gridSettings(settings: Vec4Array) { this.values.set(this.gridIdx, settings); return this }\r\n}\r\n\r\nexport class WireframeSetup extends BufferSetup {\r\n  protected colorIdx: number;\r\n\r\n  constructor(state: State) {\r\n    super(state);\r\n    this.colorIdx = this.register('color', state);\r\n  }\r\n\r\n  public color(color: Vec4Array) { this.values.set(this.colorIdx, color); return this }\r\n}\r\n\r\nexport class PointSpriteSetup extends BufferSetup {\r\n  protected baseIdx: number;\r\n  protected colorIdx: number;\r\n\r\n  constructor(state: State) {\r\n    super(state);\r\n    this.baseIdx = this.register('base', state);\r\n    this.colorIdx = this.register('color', state);\r\n  }\r\n\r\n  public base(tex: Texture) { this.values.set(this.baseIdx, tex); return this }\r\n  public color(color: Vec4Array) { this.values.set(this.colorIdx, color); return this }\r\n  textureHint() { return this.values.get(this.baseIdx) }\r\n}\r\n\r\nexport abstract class BufferRenderable<T extends BufferSetup> implements Builder {\r\n  declare abstract readonly buff: BuildBuffer;\r\n  public mode: number = WebGLRenderingContext.TRIANGLES;\r\n  private cachedDrawCall: DrawCall;\r\n  public kind = 0;\r\n\r\n  constructor(private setup: T) { }\r\n\r\n  drawCall(consumer: DrawCallConsumer): void {\r\n    if (this.buff.getSize() == 0) return;\r\n    if (this.cachedDrawCall == null) {\r\n      this.setup.buffer(this.buff).drawMode(this.mode);\r\n      this.applySetup(this.setup);\r\n      this.cachedDrawCall = this.setup.createDrawCall(this.kind);\r\n    }\r\n    consumer(this.cachedDrawCall);\r\n  }\r\n\r\n  public needToRebuild() { this.cachedDrawCall = null }\r\n  public knd(kind: number) { this.kind = kind; return this }\r\n\r\n  abstract applySetup(setup: T): void;\r\n  abstract reset(): void;\r\n  protected abstract textureHint(): Texture;\r\n\r\n  public get() { return this }\r\n}\r\n\r\nconst textureMap = new Map<Texture, number>();\r\nconst bufferMap = new Map<Buffer, number>();\r\nconst shaderMap = new Map<String, number>();\r\nexport function hash(sh: String, buff: Buffer, tex: Texture, offset: number) {\r\n  let shader = shaderMap.get(sh);\r\n  if (shader == undefined) {\r\n    shader = shaderMap.size;\r\n    shaderMap.set(sh, shader);\r\n  }\r\n  let texture = textureMap.get(tex);\r\n  if (texture == undefined) {\r\n    texture = textureMap.size;\r\n    textureMap.set(tex, texture);\r\n  }\r\n  let buffer = bufferMap.get(buff);\r\n  if (buffer == undefined) {\r\n    buffer = bufferMap.size;\r\n    bufferMap.set(buff, buffer);\r\n  }\r\n  return offset + (texture << 16) + (buffer << 24) + (shader << 28);\r\n}\r\n","import { FACE_SPRITE, FLOOR_SPRITE, WALL_SPRITE } from \"../../../../build/board/structs\";\r\nimport { ang2vec, spriteAngle, ZSCALE } from \"../../../../build/utils\";\r\nimport { mat4, Mat4Array, Vec3Array, vec4 } from \"../../../../libs_js/glmatrix\";\r\nimport { BuildBuffer } from \"../../gl/buffers\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { SolidBuilder, Type } from \"../common\";\r\n\r\nfunction normals(n: Vec3Array) {\r\n  return [n[0], n[1], n[2], n[0], n[1], n[2], n[0], n[1], n[2], n[0], n[1], n[2]];\r\n}\r\n\r\nfunction writePos(buff: BuildBuffer, c: number[]) {\r\n  buff.writePos(0, c[0], c[2], c[1]);\r\n  buff.writePos(1, c[3], c[5], c[4]);\r\n  buff.writePos(2, c[6], c[8], c[7]);\r\n  buff.writePos(3, c[9], c[11], c[10]);\r\n}\r\n\r\nconst tc_ = vec4.create();\r\nfunction writeTransformTc(buff: BuildBuffer, t: Mat4Array, c: number[], pal: number, shade: number) {\r\n  vec4.transformMat4(tc_, vec4.set(tc_, c[0], c[2], c[1], 1), t);\r\n  buff.writeTcLighting(0, tc_[0], tc_[1], pal, shade);\r\n  vec4.transformMat4(tc_, vec4.set(tc_, c[3], c[5], c[4], 1), t);\r\n  buff.writeTcLighting(1, tc_[0], tc_[1], pal, shade);\r\n  vec4.transformMat4(tc_, vec4.set(tc_, c[6], c[8], c[7], 1), t);\r\n  buff.writeTcLighting(2, tc_[0], tc_[1], pal, shade);\r\n  vec4.transformMat4(tc_, vec4.set(tc_, c[9], c[11], c[10], 1), t);\r\n  buff.writeTcLighting(3, tc_[0], tc_[1], pal, shade);\r\n}\r\n\r\nfunction writeTc(buff: BuildBuffer, t: number[], pal: number, shade: number) {\r\n  buff.writeTcLighting(0, t[0], t[1], pal, shade);\r\n  buff.writeTcLighting(1, t[2], t[3], pal, shade);\r\n  buff.writeTcLighting(2, t[4], t[5], pal, shade);\r\n  buff.writeTcLighting(3, t[6], t[7], pal, shade);\r\n}\r\n\r\nfunction writeNormal(buff: BuildBuffer, n: number[]) {\r\n  buff.writeNormal(0, n[0], n[1], n[2]);\r\n  buff.writeNormal(1, n[3], n[4], n[5]);\r\n  buff.writeNormal(2, n[6], n[7], n[8]);\r\n  buff.writeNormal(3, n[9], n[10], n[11]);\r\n}\r\n\r\nfunction genQuad(c: number[], n: number[], t: Mat4Array, pal: number, shade: number, buff: BuildBuffer, onesided: number = 1) {\r\n  buff.allocate(4, onesided ? 6 : 12);\r\n\r\n  writePos(buff, c);\r\n  writeTransformTc(buff, t, c, pal, shade);\r\n  writeNormal(buff, n);\r\n\r\n  buff.writeQuad(0, 0, 1, 2, 3);\r\n  if (!onesided)\r\n    buff.writeQuad(6, 3, 2, 1, 0);\r\n}\r\n\r\nconst texMat_ = mat4.create();\r\nfunction fillbuffersForWallSprite(\r\n  x: number, y: number, z: number, xo: number, yo: number, hw: number, hh: number, ang: number, xf: number, yf: number,\r\n  onesided: number, pal: number, shade: number, renderable: SolidBuilder) {\r\n  const dx = Math.sin(ang) * hw;\r\n  const dy = Math.cos(ang) * hw;\r\n\r\n  const xs = xf ? -1.0 : 1.0;\r\n  const ys = yf ? -1.0 : 1.0;\r\n  const texMat = texMat_;\r\n  mat4.identity(texMat);\r\n  mat4.scale(texMat, texMat, [xs / (hw * 2), -ys / (hh * 2), 1, 1]);\r\n  mat4.rotateY(texMat, texMat, -ang - Math.PI / 2);\r\n  mat4.translate(texMat, texMat, [-x - xs * dx, -z - ys * hh - yo, -y - xs * dy, 0]);\r\n\r\n  genQuad([\r\n    x - dx, y - dy, z - hh + yo,\r\n    x + dx, y + dy, z - hh + yo,\r\n    x + dx, y + dy, z + hh + yo,\r\n    x - dx, y - dy, z + hh + yo],\r\n    normals(ang2vec(ang)), texMat,\r\n    pal, shade,\r\n    renderable.buff, onesided);\r\n\r\n}\r\n\r\nfunction fillbuffersForFloorSprite(x: number, y: number, z: number, xo: number, yo: number, hw: number, hh: number, ang: number, xf: number, yf: number,\r\n  onesided: number, pal: number, shade: number, renderable: SolidBuilder) {\r\n  const dwx = Math.sin(ang) * hw;\r\n  const dwy = Math.cos(ang) * hw;\r\n  const dhx = Math.sin(ang + Math.PI / 2) * hh;\r\n  const dhy = Math.cos(ang + Math.PI / 2) * hh;\r\n  const s = !(xf || yf) ? 1 : -1;\r\n\r\n  const xs = xf ? -1.0 : 1.0;\r\n  const ys = yf ? -1.0 : 1.0;\r\n  const texMat = texMat_;\r\n  mat4.identity(texMat);\r\n  mat4.scale(texMat, texMat, [xs / (hw * 2), ys / (hh * 2), 1, 1]);\r\n  mat4.translate(texMat, texMat, [hw, hh, 0, 0]);\r\n  mat4.rotateZ(texMat, texMat, ang - Math.PI / 2);\r\n  mat4.translate(texMat, texMat, [-x, -y, 0, 0]);\r\n  mat4.rotateX(texMat, texMat, -Math.PI / 2);\r\n\r\n  genQuad([\r\n    x - dwx - dhx, y - dwy - dhy, z,\r\n    x + s * (-dwx + dhx), y + s * (-dwy + dhy), z,\r\n    x + dwx + dhx, y + dwy + dhy, z,\r\n    x + s * (dwx - dhx), y + s * (dwy - dhy), z],\r\n    normals([0, s, 0]), texMat,\r\n    pal, shade,\r\n    renderable.buff, onesided);\r\n\r\n}\r\n\r\nfunction genSpriteQuad(x: number, y: number, z: number, n: number[], t: number[], pal: number, shade: number, buff: BuildBuffer) {\r\n  buff.allocate(4, 12);\r\n\r\n  writePos(buff, [x, y, z, x, y, z, x, y, z, x, y, z]);\r\n  writeTc(buff, t, pal, shade);\r\n  writeNormal(buff, n);\r\n\r\n  buff.writeQuad(0, 0, 1, 2, 3);\r\n  buff.writeQuad(6, 3, 2, 1, 0);\r\n}\r\n\r\nfunction fillBuffersForFaceSprite(x: number, y: number, z: number, xo: number, yo: number, hw: number, hh: number, xf: number, yf: number, pal: number, shade: number, renderable: SolidBuilder) {\r\n  const texMat = texMat_;\r\n  mat4.identity(texMat);\r\n  mat4.scale(texMat, texMat, [1 / (hw * 2), -1 / (hh * 2), 1, 1]);\r\n  mat4.translate(texMat, texMat, [hw - xo, -hh - yo, 0, 0]);\r\n\r\n  genSpriteQuad(x, y, z, [\r\n    -hw + xo, +hh + yo, 0,\r\n    +hw + xo, +hh + yo, 0,\r\n    +hw + xo, -hh + yo, 0,\r\n    -hw + xo, -hh + yo, 0\r\n  ], [0, 0, 1, 0, 1, 1, 0, 1],\r\n    pal, shade, renderable.buff);\r\n}\r\n\r\nexport function updateSprite(ctx: RenderablesCacheContext, sprId: number, builder: SolidBuilder): SolidBuilder {\r\n  builder = builder == null ? ctx.factory.solid('sprite') : builder;\r\n  const board = ctx.board();\r\n  const spr = board.sprites[sprId];\r\n  if (spr.picnum == 0 || spr.cstat.invisible)\r\n    return builder;\r\n\r\n  const x = spr.x; const y = spr.y; const z = spr.z / ZSCALE;\r\n  const info = ctx.art.getInfo(spr.picnum);\r\n  const tex = ctx.art.get(spr.picnum);\r\n  const w = (info.w * spr.xrepeat) / 4; const hw = w >> 1;\r\n  const h = (info.h * spr.yrepeat) / 4; const hh = h >> 1;\r\n  const ang = spriteAngle(spr.ang);\r\n  const xo = (info.attrs.xoff * spr.xrepeat) / 4;\r\n  const yo = (info.attrs.yoff * spr.yrepeat) / 4 + (spr.cstat.realCenter ? 0 : hh);\r\n  const xf = spr.cstat.xflip; const yf = spr.cstat.yflip;\r\n  const sec = board.sectors[spr.sectnum];\r\n  const sectorShade = sec ? sec.floorshade : spr.shade;\r\n  const shade = spr.shade == -8 ? sectorShade : spr.shade;\r\n  const trans = spr.cstat.translucent ? spr.cstat.tranclucentReversed ? 0.66 : 0.33 : 1;\r\n  builder.tex = tex;\r\n  builder.trans = trans;\r\n\r\n  if (spr.cstat.type == FACE_SPRITE) {\r\n    fillBuffersForFaceSprite(x, y, z, xo, yo, hw, hh, xf, yf, spr.pal, shade, builder);\r\n    builder.type = Type.FACE;\r\n  } else if (spr.cstat.type == WALL_SPRITE) {\r\n    fillbuffersForWallSprite(x, y, z, xo, yo, hw, hh, ang, xf, yf, spr.cstat.onesided, spr.pal, shade, builder);\r\n  } else if (spr.cstat.type == FLOOR_SPRITE) {\r\n    fillbuffersForFloorSprite(x, y, z, xo, yo, hw, hh, ang, xf, yf, spr.cstat.onesided, spr.pal, shade, builder);\r\n  }\r\n\r\n  return builder;\r\n}\r\n","import { FACE_SPRITE, WALL_SPRITE } from \"../../../../build/board/structs\";\r\nimport { spriteAngle, ZSCALE } from \"../../../../build/utils\";\r\nimport { vec4 } from \"../../../../libs_js/glmatrix\";\r\nimport { cyclicPairs } from \"../../../../utils/collections\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { SPRITE_LABEL } from \"../../../apis/renderable\";\r\nimport { RenderablesCacheContext, SPRITE_COLOR } from \"../cache\";\r\nimport { BuildersFactory, SolidBuilder, WireframeBuilder } from \"../common\";\r\n\r\nexport class Sprite2dBuilder extends Builders {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly ang = factory.wireframe('2d'),\r\n    // readonly label = factory.pointSprite('2d').knd(SPRITE_LABEL),\r\n    readonly lines = factory.wireframe('2d'),\r\n    readonly img = factory.solid('2d').knd(SPRITE_LABEL),\r\n  ) { super([ang, img, lines]) }\r\n}\r\n\r\nconst CIRCLE_SECTIONS = 12;\r\nconst CIRCLE_OUT_RADIUS = 96;\r\nconst CIRCLE_IN_RADIUS = 80;\r\nfunction genSpriteMarker(builder: WireframeBuilder, x: number, y: number, z: number, ang: number, color: [number, number, number, number]) {\r\n  builder.mode = WebGLRenderingContext.TRIANGLES;\r\n  vec4.copy(builder.color, color);\r\n  const buff = builder.buff;\r\n  buff.allocate(CIRCLE_SECTIONS * 2 + 4, CIRCLE_SECTIONS * 6 + 6);\r\n  let off = 0;\r\n  for (let i = 0; i < CIRCLE_SECTIONS; i++) {\r\n    const ang = Math.PI * 2 * (i / CIRCLE_SECTIONS);\r\n    const dxo = Math.sin(ang) * CIRCLE_OUT_RADIUS;\r\n    const dxi = Math.sin(ang) * CIRCLE_IN_RADIUS;\r\n    const dyo = Math.cos(ang) * CIRCLE_OUT_RADIUS;\r\n    const dyi = Math.cos(ang) * CIRCLE_IN_RADIUS;\r\n    buff.writePos(off + 0, x + dxo, z, y + dyo);\r\n    buff.writePos(off + 1, x + dxi, z, y + dyi);\r\n    off += 2;\r\n  }\r\n  const angle = spriteAngle(ang | 0);\r\n  const hw = ((CIRCLE_OUT_RADIUS - CIRCLE_IN_RADIUS) / 2);\r\n  const dx = Math.sin(angle) * hw;\r\n  const dy = Math.cos(angle) * hw;\r\n  const dx1 = Math.sin(angle + Math.PI / 2) * CIRCLE_IN_RADIUS;\r\n  const dy1 = Math.cos(angle + Math.PI / 2) * CIRCLE_IN_RADIUS;\r\n  buff.writePos(off++, x - dx + dx1, z, y - dy + dy1);\r\n  buff.writePos(off++, x + dx + dx1, z, y + dy + dy1);\r\n  buff.writePos(off++, x + dx, z, y + dy);\r\n  buff.writePos(off++, x - dx, z, y - dy);\r\n  off = 0;\r\n  for (const [i1, i2] of cyclicPairs(CIRCLE_SECTIONS)) {\r\n    const off1 = i1 * 2;\r\n    const off2 = i2 * 2;\r\n    buff.writeTriangle(off, off1, off2, off1 + 1);\r\n    buff.writeTriangle(off + 3, off1 + 1, off2, off2 + 1);\r\n    off += 6;\r\n  }\r\n  const vtxoff = CIRCLE_SECTIONS * 2;\r\n  buff.writeQuad(off, vtxoff, vtxoff + 1, vtxoff + 2, vtxoff + 3);\r\n}\r\n\r\nfunction updateSpriteAngle(ctx: RenderablesCacheContext, spriteId: number, builder: WireframeBuilder): WireframeBuilder {\r\n  builder.mode = WebGLRenderingContext.TRIANGLES;\r\n  const board = ctx.board();\r\n  const sprite = board.sprites[spriteId];\r\n  genSpriteMarker(builder, sprite.x, sprite.y, sprite.z / ZSCALE, sprite.ang, ctx.state.get(SPRITE_COLOR));\r\n  return builder;\r\n}\r\n\r\nfunction updateSpriteImage(ctx: RenderablesCacheContext, spriteId: number, builder: SolidBuilder) {\r\n  const board = ctx.board();\r\n  const sprite = board.sprites[spriteId];\r\n  if (sprite.picnum == 0 || sprite.cstat.type != FACE_SPRITE) return;\r\n  builder.tex = ctx.art.get(sprite.picnum);\r\n  const buff = builder.buff;\r\n  const x = sprite.x;\r\n  const y = sprite.y;\r\n  const z = sprite.z / ZSCALE;\r\n  const pal = sprite.pal;\r\n  const shade = -127;\r\n  const info = ctx.art.getInfo(sprite.picnum);\r\n  const w = info.w * 8;\r\n  const h = info.h * 8;\r\n  buff.allocate(4, 6);\r\n  buff.writePos(0, x - w / 2, z, y);\r\n  buff.writePos(1, x - w / 2, z, y - h);\r\n  buff.writePos(2, x + w / 2, z, y - h);\r\n  buff.writePos(3, x + w / 2, z, y);\r\n  buff.writeTcLighting(0, 0, 1, pal, shade);\r\n  buff.writeTcLighting(1, 0, 0, pal, shade);\r\n  buff.writeTcLighting(2, 1, 0, pal, shade);\r\n  buff.writeTcLighting(3, 1, 1, pal, shade);\r\n  buff.writeQuad(0, 0, 1, 2, 3);\r\n}\r\n\r\nconst WALL_SPRITE_LINE_WIDTH = 32;\r\nfunction updateSpriteLine(ctx: RenderablesCacheContext, spriteId: number, builder: WireframeBuilder) {\r\n  const board = ctx.board();\r\n  const sprite = board.sprites[spriteId];\r\n  if (sprite.picnum == 0 || sprite.cstat.type != WALL_SPRITE) return;\r\n  const info = ctx.art.getInfo(sprite.picnum);\r\n  const w = (info.w * sprite.xrepeat) / 4; const hw = w >> 1;\r\n  const ang = spriteAngle(sprite.ang);\r\n  const dx = Math.sin(ang) * hw;\r\n  const dy = Math.cos(ang) * hw;\r\n  const dxt = Math.sin(ang + Math.PI / 2) * (WALL_SPRITE_LINE_WIDTH / 2);\r\n  const dyt = Math.cos(ang + Math.PI / 2) * (WALL_SPRITE_LINE_WIDTH / 2);\r\n  const x = sprite.x;\r\n  const y = sprite.y;\r\n  const z = sprite.z / ZSCALE;\r\n  vec4.copy(builder.color, ctx.state.get(SPRITE_COLOR));\r\n  builder.mode = WebGLRenderingContext.TRIANGLES;\r\n  const buff = builder.buff;\r\n  buff.allocate(4, 6);\r\n  buff.writePos(0, x - dx + dxt, z, y - dy + dyt);\r\n  buff.writePos(1, x + dx + dxt, z, y + dy + dyt);\r\n  buff.writePos(2, x + dx - dxt, z, y + dy - dyt);\r\n  buff.writePos(3, x - dx - dxt, z, y - dy - dyt);\r\n  buff.writeQuad(0, 0, 1, 2, 3);\r\n}\r\n\r\nexport function updateSprite2d(ctx: RenderablesCacheContext, sprId: number, builder: Sprite2dBuilder): Sprite2dBuilder {\r\n  builder = builder == null ? new Sprite2dBuilder(ctx.factory) : builder;\r\n  const board = ctx.board();\r\n  const sprite = board.sprites[sprId];\r\n  // text(builder.label, sprId + \"\", sprite.x, sprite.y, sprite.z / ZSCALE, 8, 8, ctx.art.get(-2));\r\n  updateSpriteAngle(ctx, sprId, builder.ang);\r\n  updateSpriteImage(ctx, sprId, builder.img);\r\n  updateSpriteLine(ctx, sprId, builder.lines);\r\n  return builder;\r\n}\r\n","import { FACE_SPRITE, FLOOR_SPRITE, WALL_SPRITE } from \"../../../../build/board/structs\";\r\nimport { ang2vec, spriteAngle, ZSCALE } from \"../../../../build/utils\";\r\nimport { vec3, vec4 } from \"../../../../libs_js/glmatrix\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory, Type, WireframeBuilder } from \"../common\";\r\n\r\nexport class SpriteHelperBuillder extends Builders {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly wire = factory.wireframe('helper'),\r\n    readonly angle = factory.wireframe('helper')\r\n  ) { super([wire, angle]) }\r\n}\r\n\r\nfunction genQuadWireframe(coords: number[], normals: number[], builder: WireframeBuilder) {\r\n  const buff = builder.buff;\r\n  buff.allocate(4, 8);\r\n  const [x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4] = coords;\r\n  buff.writePos(0, x1, z1, y1);\r\n  buff.writePos(1, x2, z2, y2);\r\n  buff.writePos(2, x3, z3, y3);\r\n  buff.writePos(3, x4, z4, y4);\r\n  if (normals != null) {\r\n    buff.writeNormal(0, normals[0], normals[1], 0);\r\n    buff.writeNormal(1, normals[2], normals[3], 0);\r\n    buff.writeNormal(2, normals[4], normals[5], 0);\r\n    buff.writeNormal(3, normals[6], normals[7], 0);\r\n  }\r\n  buff.writeLine(0, 0, 1);\r\n  buff.writeLine(2, 1, 2);\r\n  buff.writeLine(4, 2, 3);\r\n  buff.writeLine(6, 3, 0);\r\n}\r\n\r\nfunction fillbuffersForWallSpriteWireframe(x: number, y: number, z: number, xo: number, yo: number, hw: number, hh: number, ang: number, builder: WireframeBuilder) {\r\n  let dx = Math.sin(ang) * hw;\r\n  let dy = Math.cos(ang) * hw;\r\n  genQuadWireframe([\r\n    x - dx, y - dy, z - hh + yo,\r\n    x + dx, y + dy, z - hh + yo,\r\n    x + dx, y + dy, z + hh + yo,\r\n    x - dx, y - dy, z + hh + yo],\r\n    null, builder);\r\n}\r\n\r\nfunction fillbuffersForFloorSpriteWireframe(x: number, y: number, z: number, xo: number, yo: number, hw: number, hh: number, ang: number, builder: WireframeBuilder) {\r\n  let dwx = Math.sin(ang) * hw;\r\n  let dwy = Math.cos(ang) * hw;\r\n  let dhx = Math.sin(ang + Math.PI / 2) * hh;\r\n  let dhy = Math.cos(ang + Math.PI / 2) * hh;\r\n  genQuadWireframe([\r\n    x - dwx - dhx, y - dwy - dhy, z,\r\n    x + dwx - dhx, y + dwy - dhy, z,\r\n    x + dwx + dhx, y + dwy + dhy, z,\r\n    x - dwx + dhx, y - dwy + dhy, z],\r\n    null, builder);\r\n}\r\n\r\nfunction fillBuffersForFaceSpriteWireframe(x: number, y: number, z: number, xo: number, yo: number, hw: number, hh: number, builder: WireframeBuilder) {\r\n  genQuadWireframe([\r\n    x, y, z,\r\n    x, y, z,\r\n    x, y, z,\r\n    x, y, z\r\n  ], [\r\n    -hw + xo, +hh + yo,\r\n    +hw + xo, +hh + yo,\r\n    +hw + xo, -hh + yo,\r\n    -hw + xo, -hh + yo],\r\n    builder);\r\n}\r\n\r\nfunction updateSpriteWireframe(ctx: RenderablesCacheContext, sprId: number, builder: WireframeBuilder): WireframeBuilder {\r\n  const board = ctx.board();\r\n  vec4.set(builder.color, 1, 1, 1, -100);\r\n  let spr = board.sprites[sprId];\r\n  if (spr.picnum == 0 || spr.cstat.invisible)\r\n    return builder;\r\n\r\n  let x = spr.x; let y = spr.y; let z = spr.z / ZSCALE;\r\n  let info = ctx.art.getInfo(spr.picnum);\r\n  let w = (info.w * spr.xrepeat) / 4; let hw = w >> 1;\r\n  let h = (info.h * spr.yrepeat) / 4; let hh = h >> 1;\r\n  let ang = spriteAngle(spr.ang);\r\n  let xo = (info.attrs.xoff * spr.xrepeat) / 4;\r\n  let yo = (info.attrs.yoff * spr.yrepeat) / 4 + (spr.cstat.realCenter ? 0 : hh);\r\n\r\n  if (spr.cstat.type == FACE_SPRITE) {\r\n    builder.type = Type.FACE;\r\n    fillBuffersForFaceSpriteWireframe(x, y, z, xo, yo, hw, hh, builder);\r\n  } else if (spr.cstat.type == WALL_SPRITE) {\r\n    builder.type = Type.SURFACE;\r\n    fillbuffersForWallSpriteWireframe(x, y, z, xo, yo, hw, hh, ang, builder);\r\n  } else if (spr.cstat.type == FLOOR_SPRITE) {\r\n    builder.type = Type.SURFACE;\r\n    fillbuffersForFloorSpriteWireframe(x, y, z, xo, yo, hw, hh, ang, builder);\r\n  }\r\n  return builder;\r\n}\r\n\r\nfunction updateSpriteAngle(ctx: RenderablesCacheContext, spriteId: number, renderable: WireframeBuilder): WireframeBuilder {\r\n  renderable.mode = WebGLRenderingContext.TRIANGLES;\r\n  let buff = renderable.buff;\r\n  const board = ctx.board();\r\n  buff.allocate(3, 6);\r\n  let spr = board.sprites[spriteId];\r\n  let x = spr.x, y = spr.y, z = spr.z / ZSCALE;\r\n  let ang = spriteAngle(spr.ang);\r\n  let size = 128;\r\n  let vec1 = ang2vec(ang);\r\n  vec3.scale(vec1, vec1, size);\r\n  let vec2 = ang2vec(ang + Math.PI / 2);\r\n  vec3.scale(vec2, vec2, size / 4);\r\n  buff.writePos(0, x + vec1[0], z, y + vec1[2]);\r\n  buff.writePos(1, x + vec2[0], z, y + vec2[2]);\r\n  buff.writePos(2, x - vec2[0], z, y - vec2[2]);\r\n  buff.writeTriangle(0, 0, 1, 2);\r\n  buff.writeTriangle(3, 2, 1, 0);\r\n  return renderable;\r\n}\r\n\r\nexport function updateSpriteHelper(ctx: RenderablesCacheContext, sprId: number, builder: SpriteHelperBuillder): SpriteHelperBuillder {\r\n  builder = builder == null ? new SpriteHelperBuillder(ctx.factory) : builder;\r\n  updateSpriteWireframe(ctx, sprId, builder.wire);\r\n  updateSpriteAngle(ctx, sprId, builder.angle);\r\n  return builder;\r\n}","import { sectorOfWall } from \"../../../../build/board/query\";\r\nimport { Wall } from \"../../../../build/board/structs\";\r\nimport { ArtInfo } from \"../../../../build/formats/art\";\r\nimport { createSlopeCalculator, wallNormal, ZSCALE } from \"../../../../build/utils\";\r\nimport { mat4, Mat4Array, vec3, Vec3Array, vec4 } from \"../../../../libs_js/glmatrix\";\r\nimport { len2d } from \"../../../../utils/mathutils\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { WallRenderable } from \"../../../apis/renderable\";\r\nimport { BuildBuffer } from \"../../gl/buffers\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory } from \"../common\";\r\n\r\nexport class WallBuilder extends Builders implements WallRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly top = factory.solid('wall'),\r\n    readonly mid = factory.solid('wall'),\r\n    readonly bot = factory.solid('wall')\r\n  ) { super([top, mid, bot]) }\r\n}\r\n\r\nfunction normals(n: Vec3Array) {\r\n  return [n[0], n[1], n[2], n[0], n[1], n[2], n[0], n[1], n[2], n[0], n[1], n[2]];\r\n}\r\n\r\nfunction getWallCoords(x1: number, y1: number, x2: number, y2: number,\r\n  slope: any, nextslope: any, heinum: number, nextheinum: number, z: number, nextz: number, check: boolean): number[] {\r\n  const z1 = (slope(x1, y1, heinum) + z) / ZSCALE;\r\n  const z2 = (slope(x2, y2, heinum) + z) / ZSCALE;\r\n  const z3 = (nextslope(x2, y2, nextheinum) + nextz) / ZSCALE;\r\n  const z4 = (nextslope(x1, y1, nextheinum) + nextz) / ZSCALE;\r\n  if (check && z4 >= z1 && z3 >= z2) return null;\r\n\r\n  if (z4 > z1) {\r\n    const d = 1 - 1 / ((z4 - z1) / (z2 - z3) + 1);\r\n    const x1_ = x1 + (x2 - x1) * d;\r\n    const y1_ = y1 + (y2 - y1) * d;\r\n    const z1_ = z1 + (z2 - z1) * d;\r\n    return [x1_, y1_, z1_, x2, y2, z2, x2, y2, z3, x1_, y1_, z1_];\r\n  } else if (z3 > z2) {\r\n    const d = 1 - 1 / ((z1 - z4) / (z3 - z2) + 1);\r\n    const x2_ = x1 + (x2 - x1) * d;\r\n    const y2_ = y1 + (y2 - y1) * d;\r\n    const z2_ = z1 + (z2 - z1) * d;\r\n    return [x1, y1, z1, x2_, y2_, z2_, x2_, y2_, z2_, x1, y1, z4];\r\n  }\r\n\r\n  return [x1, y1, z1, x2, y2, z2, x2, y2, z3, x1, y1, z4];\r\n}\r\n\r\nfunction applyWallTextureTransform(wall: Wall, wall2: Wall, info: ArtInfo, base: number, originalWall: Wall = wall, texMat: Mat4Array) {\r\n  let wall1 = wall;\r\n  if (originalWall.cstat.xflip) [wall1, wall2] = [wall2, wall1];\r\n  const flip = wall == originalWall ? 1 : -1;\r\n  const tw = info.w;\r\n  const th = info.h;\r\n  const dx = wall2.x - wall1.x;\r\n  const dy = wall2.y - wall1.y;\r\n  const tcscalex = (wall.xrepeat * 8.0) / (flip * len2d(dx, dy) * tw);\r\n  const tcscaley = -(wall.yrepeat / 8.0) / (th * 16.0) * (originalWall.cstat.yflip ? -1 : 1);\r\n  const tcxoff = wall.xpanning / tw;\r\n  const tcyoff = wall.ypanning / 256.0;\r\n\r\n  mat4.identity(texMat);\r\n  mat4.translate(texMat, texMat, [tcxoff, tcyoff, 0, 0]);\r\n  mat4.scale(texMat, texMat, [tcscalex, tcscaley, 1, 1]);\r\n  mat4.rotateY(texMat, texMat, -Math.atan2(-dy, dx));\r\n  mat4.translate(texMat, texMat, [-wall1.x, -base / ZSCALE, -wall1.y, 0]);\r\n}\r\n\r\nfunction writePos(buff: BuildBuffer, c: number[]) {\r\n  buff.writePos(0, c[0], c[2], c[1]);\r\n  buff.writePos(1, c[3], c[5], c[4]);\r\n  buff.writePos(2, c[6], c[8], c[7]);\r\n  buff.writePos(3, c[9], c[11], c[10]);\r\n}\r\n\r\nconst tc = vec4.create();\r\nfunction writeTransformTc(buff: BuildBuffer, t: Mat4Array, c: number[], pal: number, shade: number) {\r\n  vec4.transformMat4(tc, vec4.set(tc, c[0], c[2], c[1], 1), t);\r\n  buff.writeTcLighting(0, tc[0], tc[1], pal, shade);\r\n  vec4.transformMat4(tc, vec4.set(tc, c[3], c[5], c[4], 1), t);\r\n  buff.writeTcLighting(1, tc[0], tc[1], pal, shade);\r\n  vec4.transformMat4(tc, vec4.set(tc, c[6], c[8], c[7], 1), t);\r\n  buff.writeTcLighting(2, tc[0], tc[1], pal, shade);\r\n  vec4.transformMat4(tc, vec4.set(tc, c[9], c[11], c[10], 1), t);\r\n  buff.writeTcLighting(3, tc[0], tc[1], pal, shade);\r\n}\r\n\r\nfunction writeNormal(buff: BuildBuffer, n: number[]) {\r\n  buff.writeNormal(0, n[0], n[1], n[2]);\r\n  buff.writeNormal(1, n[3], n[4], n[5]);\r\n  buff.writeNormal(2, n[6], n[7], n[8]);\r\n  buff.writeNormal(3, n[9], n[10], n[11]);\r\n}\r\n\r\nfunction genQuad(c: number[], n: number[], t: Mat4Array, pal: number, shade: number, buff: BuildBuffer) {\r\n  buff.allocate(4, 6);\r\n  writePos(buff, c);\r\n  writeTransformTc(buff, t, c, pal, shade);\r\n  writeNormal(buff, n);\r\n  buff.writeQuad(0, 0, 1, 2, 3);\r\n}\r\n\r\nfunction getMaskedWallCoords(x1: number, y1: number, x2: number, y2: number, slope: any, nextslope: any,\r\n  ceilheinum: number, ceilnextheinum: number, ceilz: number, ceilnextz: number,\r\n  floorheinum: number, floornextheinum: number, floorz: number, floornextz: number): number[] {\r\n  const currz1 = (slope(x1, y1, ceilheinum) + ceilz) / ZSCALE;\r\n  const currz2 = (slope(x2, y2, ceilheinum) + ceilz) / ZSCALE;\r\n  const currz3 = (slope(x2, y2, floorheinum) + floorz) / ZSCALE;\r\n  const currz4 = (slope(x1, y1, floorheinum) + floorz) / ZSCALE;\r\n  const nextz1 = (nextslope(x1, y1, ceilnextheinum) + ceilnextz) / ZSCALE;\r\n  const nextz2 = (nextslope(x2, y2, ceilnextheinum) + ceilnextz) / ZSCALE;\r\n  const nextz3 = (nextslope(x2, y2, floornextheinum) + floornextz) / ZSCALE;\r\n  const nextz4 = (nextslope(x1, y1, floornextheinum) + floornextz) / ZSCALE;\r\n  const z1 = Math.min(currz1, nextz1);\r\n  const z2 = Math.min(currz2, nextz2);\r\n  const z3 = Math.max(currz3, nextz3);\r\n  const z4 = Math.max(currz4, nextz4);\r\n  return [x1, y1, z1, x2, y2, z2, x2, y2, z3, x1, y1, z4];\r\n}\r\n\r\nconst wallNormal_ = vec3.create();\r\nconst texMat_ = mat4.create();\r\nexport function updateWall(ctx: RenderablesCacheContext, wallId: number, builder: WallBuilder): WallBuilder {\r\n  builder = builder == null ? new WallBuilder(ctx.factory) : builder;\r\n  const board = ctx.board();\r\n  const art = ctx.art;\r\n  const wall = board.walls[wallId];\r\n  const sectorId = sectorOfWall(board, wallId);\r\n  const sector = board.sectors[sectorId];\r\n  const wall2 = board.walls[wall.point2];\r\n  const x1 = wall.x; const y1 = wall.y;\r\n  const x2 = wall2.x; const y2 = wall2.y;\r\n  const tex = art.get(wall.picnum);\r\n  const info = art.getInfo(wall.picnum);\r\n  const slope = createSlopeCalculator(board, sectorId);\r\n  const ceilingheinum = sector.ceilingheinum;\r\n  const ceilingz = sector.ceilingz;\r\n  const floorheinum = sector.floorheinum;\r\n  const floorz = sector.floorz;\r\n  const trans = wall.cstat.translucent ? wall.cstat.translucentReversed ? 0.66 : 0.33 : 1;\r\n  const normal = normals(wallNormal(wallNormal_, board, wallId));\r\n\r\n  if (wall.nextwall == -1 || wall.cstat.oneWay) {\r\n    const coords = getWallCoords(x1, y1, x2, y2, slope, slope, ceilingheinum, floorheinum, ceilingz, floorz, false);\r\n    const base = wall.cstat.alignBottom ? floorz : ceilingz;\r\n    applyWallTextureTransform(wall, wall2, info, base, wall, texMat_);\r\n    genQuad(coords, normal, texMat_, wall.pal, wall.shade, builder.mid.buff);\r\n    builder.mid.tex = tex;\r\n  } else {\r\n    const nextsector = board.sectors[wall.nextsector];\r\n    const nextslope = createSlopeCalculator(board, wall.nextsector);\r\n    const nextfloorz = nextsector.floorz;\r\n    const nextceilingz = nextsector.ceilingz;\r\n\r\n    const nextfloorheinum = nextsector.floorheinum;\r\n    const floorcoords = getWallCoords(x1, y1, x2, y2, nextslope, slope, nextfloorheinum, floorheinum, nextfloorz, floorz, true);\r\n    if (floorcoords != null) {\r\n      let pal = 0;\r\n      let shade = 0;\r\n      if (sector.floorstat.parallaxing && nextsector.floorstat.parallaxing && sector.floorpicnum == nextsector.floorpicnum) {\r\n        builder.bot.tex = art.getParallaxTexture(sector.floorpicnum);\r\n        shade = sector.floorshade;\r\n        pal = sector.floorpal;\r\n        builder.bot.parallax = 1;\r\n      } else {\r\n        const wall_ = wall.cstat.swapBottoms ? board.walls[wall.nextwall] : wall;\r\n        const wall2_ = wall.cstat.swapBottoms ? board.walls[wall_.point2] : wall2;\r\n        const tex_ = wall.cstat.swapBottoms ? art.get(wall_.picnum) : tex;\r\n        const info_ = wall.cstat.swapBottoms ? art.getInfo(wall_.picnum) : info;\r\n        const base = wall.cstat.alignBottom ? ceilingz : nextfloorz;\r\n        applyWallTextureTransform(wall_, wall2_, info_, base, wall, texMat_);\r\n        builder.bot.tex = tex_;\r\n        shade = wall_.shade;\r\n        pal = wall_.pal;\r\n      }\r\n      genQuad(floorcoords, normal, texMat_, pal, shade, builder.bot.buff);\r\n    }\r\n\r\n    const nextceilingheinum = nextsector.ceilingheinum;\r\n    const ceilcoords = getWallCoords(x1, y1, x2, y2, slope, nextslope, ceilingheinum, nextceilingheinum, ceilingz, nextceilingz, true);\r\n    if (ceilcoords != null) {\r\n      let pal = 0;\r\n      let shade = 0;\r\n      if (sector.ceilingstat.parallaxing && nextsector.ceilingstat.parallaxing && sector.ceilingpicnum == nextsector.ceilingpicnum) {\r\n        builder.top.tex = art.getParallaxTexture(sector.ceilingpicnum);\r\n        shade = sector.ceilingshade;\r\n        pal = sector.ceilingpal;\r\n        builder.top.parallax = 1;\r\n      } else {\r\n        const base = wall.cstat.alignBottom ? ceilingz : nextceilingz;\r\n        applyWallTextureTransform(wall, wall2, info, base, wall, texMat_);\r\n        builder.top.tex = tex;\r\n        shade = wall.shade;\r\n        pal = wall.pal;\r\n      }\r\n      genQuad(ceilcoords, normal, texMat_, pal, shade, builder.top.buff);\r\n    }\r\n\r\n    if (wall.cstat.masking) {\r\n      const tex1 = art.get(wall.overpicnum);\r\n      const info1 = art.getInfo(wall.overpicnum);\r\n      const coords = getMaskedWallCoords(x1, y1, x2, y2, slope, nextslope,\r\n        ceilingheinum, nextceilingheinum, ceilingz, nextceilingz,\r\n        floorheinum, nextfloorheinum, floorz, nextfloorz);\r\n      const base = wall.cstat.alignBottom ? Math.min(floorz, nextfloorz) : Math.max(ceilingz, nextceilingz);\r\n      applyWallTextureTransform(wall, wall2, info1, base, wall, texMat_);\r\n      genQuad(coords, normal, texMat_, wall.pal, wall.shade, builder.mid.buff);\r\n      builder.mid.tex = tex1;\r\n      builder.mid.trans = trans;\r\n    }\r\n  }\r\n\r\n  return builder;\r\n}","import { vec4 } from \"../../../../libs_js/glmatrix\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { WallRenderable } from \"../../../apis/renderable\";\r\nimport { RenderablesCacheContext, MASKED_WALL_COLOR, WALL_COLOR, INTERSECTOR_WALL_COLOR } from \"../cache\";\r\nimport { BuildersFactory } from \"../common\";\r\n\r\nexport class Wall2dBuilder extends Builders implements WallRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly top = factory.wireframe('2d'),\r\n    readonly mid = factory.wireframe('2d'),\r\n    readonly bot = factory.wireframe('2d')\r\n  ) { super([top, mid, bot]) }\r\n}\r\n\r\nexport function updateWall2d(ctx: RenderablesCacheContext, wallId: number, builder: Wall2dBuilder): Wall2dBuilder {\r\n  builder = builder == null ? new Wall2dBuilder(ctx.factory) : builder;\r\n  let board = ctx.board();\r\n  let buff = builder.mid.buff;\r\n  buff.allocate(2, 2);\r\n  let wall = board.walls[wallId];\r\n  let wall2 = board.walls[wall.point2];\r\n  buff.writePos(0, wall.x, 0, wall.y);\r\n  buff.writePos(1, wall2.x, 0, wall2.y);\r\n  buff.writeLine(0, 0, 1);\r\n  const state = ctx.state;\r\n  vec4.copy(builder.mid.color, wall.cstat.masking\r\n    ? state.get(MASKED_WALL_COLOR)\r\n    : wall.nextwall == -1\r\n      ? state.get(WALL_COLOR)\r\n      : state.get(INTERSECTOR_WALL_COLOR));\r\n  return builder;\r\n}","import { Board } from \"../../../../build/board/structs\";\r\nimport { createSlopeCalculator, slope, ZSCALE } from \"../../../../build/utils\";\r\nimport { int } from \"../../../../utils/mathutils\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { BuildRenderableProvider, WallRenderable, Renderables } from \"../../../apis/renderable\";\r\nimport { BuildBuffer } from \"../../gl/buffers\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory, PointSpriteBuilder, SolidBuilder } from \"../common\";\r\nimport { text, createGridWallMatrix, WallGridType } from \"./common\";\r\nimport { vec4, mat4 } from \"../../../../libs_js/glmatrix\";\r\nimport { sectorOfWall, walllen } from \"../../../../build/board/query\";\r\n\r\nexport class WallHelperBuilder extends Builders implements WallRenderable {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly topWire = factory.wireframe('helper'),\r\n    readonly topGrid = factory.grid('helper'),\r\n    readonly topPoints = factory.pointSprite('helper'),\r\n    readonly topLength = factory.pointSprite('helper'),\r\n    readonly midWire = factory.wireframe('helper'),\r\n    readonly midGrid = factory.grid('helper'),\r\n    readonly botWire = factory.wireframe('helper'),\r\n    readonly botGrid = factory.grid('helper'),\r\n    readonly botPoints = factory.pointSprite('helper'),\r\n    readonly botLength = factory.pointSprite('helper'),\r\n    readonly top = new Renderables([topWire, topGrid, topPoints, topLength]),\r\n    readonly mid = new Renderables([midWire, midGrid]),\r\n    readonly bot = new Renderables([botWire, botGrid, botPoints, botLength]),\r\n  ) {\r\n    super([topWire, midWire, botWire, topGrid, midGrid, botGrid, topPoints, botPoints, topLength, botLength]);\r\n  }\r\n}\r\n\r\nfunction genQuadWireframe(coords: number[], normals: number[], buff: BuildBuffer) {\r\n  buff.allocate(4, 8);\r\n  let [x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4] = coords;\r\n  buff.writePos(0, x1, z1, y1);\r\n  buff.writePos(1, x2, z2, y2);\r\n  buff.writePos(2, x3, z3, y3);\r\n  buff.writePos(3, x4, z4, y4);\r\n  if (normals != null) {\r\n    buff.writeNormal(0, normals[0], normals[1], 0);\r\n    buff.writeNormal(1, normals[2], normals[3], 0);\r\n    buff.writeNormal(2, normals[4], normals[5], 0);\r\n    buff.writeNormal(3, normals[6], normals[7], 0);\r\n  }\r\n  buff.writeLine(0, 0, 1);\r\n  buff.writeLine(2, 1, 2);\r\n  buff.writeLine(4, 2, 3);\r\n  buff.writeLine(6, 3, 0);\r\n}\r\n\r\nfunction getWallCoords(x1: number, y1: number, x2: number, y2: number,\r\n  slope: any, nextslope: any, heinum: number, nextheinum: number, z: number, nextz: number, check: boolean, line = false): number[] {\r\n  let z1 = (slope(x1, y1, heinum) + z) / ZSCALE;\r\n  let z2 = (slope(x2, y2, heinum) + z) / ZSCALE;\r\n  let z3 = (nextslope(x2, y2, nextheinum) + nextz) / ZSCALE;\r\n  let z4 = (nextslope(x1, y1, nextheinum) + nextz) / ZSCALE;\r\n  if (check) {\r\n    if (line && z4 > z1 && z3 > z2) return null;\r\n    if (!line && z4 >= z1 && z3 >= z2) return null;\r\n  }\r\n  return [x1, y1, z1, x2, y2, z2, x2, y2, z3, x1, y1, z4];\r\n}\r\n\r\nfunction getMaskedWallCoords(x1: number, y1: number, x2: number, y2: number, slope: any, nextslope: any,\r\n  ceilheinum: number, ceilnextheinum: number, ceilz: number, ceilnextz: number,\r\n  floorheinum: number, floornextheinum: number, floorz: number, floornextz: number): number[] {\r\n  let currz1 = (slope(x1, y1, ceilheinum) + ceilz) / ZSCALE;\r\n  let currz2 = (slope(x2, y2, ceilheinum) + ceilz) / ZSCALE;\r\n  let currz3 = (slope(x2, y2, floorheinum) + floorz) / ZSCALE;\r\n  let currz4 = (slope(x1, y1, floorheinum) + floorz) / ZSCALE;\r\n  let nextz1 = (nextslope(x1, y1, ceilnextheinum) + ceilnextz) / ZSCALE;\r\n  let nextz2 = (nextslope(x2, y2, ceilnextheinum) + ceilnextz) / ZSCALE;\r\n  let nextz3 = (nextslope(x2, y2, floornextheinum) + floornextz) / ZSCALE;\r\n  let nextz4 = (nextslope(x1, y1, floornextheinum) + floornextz) / ZSCALE;\r\n  let z1 = Math.min(currz1, nextz1);\r\n  let z2 = Math.min(currz2, nextz2);\r\n  let z3 = Math.max(currz3, nextz3);\r\n  let z4 = Math.max(currz4, nextz4);\r\n  return [x1, y1, z1, x2, y2, z2, x2, y2, z3, x1, y1, z4];\r\n}\r\n\r\nexport function updateWallWireframe(ctx: RenderablesCacheContext, wallId: number, builder: WallHelperBuilder): WallHelperBuilder {\r\n  const board = ctx.board();\r\n  const wall = board.walls[wallId];\r\n  const sectorId = sectorOfWall(board, wallId)\r\n  const sector = board.sectors[sectorId];\r\n  const wall2 = board.walls[wall.point2];\r\n  const x1 = wall.x; const y1 = wall.y;\r\n  const x2 = wall2.x; const y2 = wall2.y;\r\n  const slope = createSlopeCalculator(board, sectorId);\r\n  const ceilingheinum = sector.ceilingheinum;\r\n  const ceilingz = sector.ceilingz;\r\n  const floorheinum = sector.floorheinum;\r\n  const floorz = sector.floorz;\r\n  vec4.set(builder.topWire.color, 1, 1, 1, -100);\r\n  vec4.set(builder.midWire.color, 1, 1, 1, -100);\r\n  vec4.set(builder.botWire.color, 1, 1, 1, -100);\r\n\r\n  if (wall.nextwall == -1 || wall.cstat.oneWay) {\r\n    const coords = getWallCoords(x1, y1, x2, y2, slope, slope, ceilingheinum, floorheinum, ceilingz, floorz, false);\r\n    genQuadWireframe(coords, null, builder.midWire.buff);\r\n  } else {\r\n    const nextsector = board.sectors[wall.nextsector];\r\n    const nextslope = createSlopeCalculator(board, wall.nextsector);\r\n    const nextfloorz = nextsector.floorz;\r\n    const nextceilingz = nextsector.ceilingz;\r\n\r\n    const nextfloorheinum = nextsector.floorheinum;\r\n    const botcoords = getWallCoords(x1, y1, x2, y2, nextslope, slope, nextfloorheinum, floorheinum, nextfloorz, floorz, true, true);\r\n    if (botcoords != null) genQuadWireframe(botcoords, null, builder.botWire.buff);\r\n\r\n    const nextceilingheinum = nextsector.ceilingheinum;\r\n    const topcoords = getWallCoords(x1, y1, x2, y2, slope, nextslope, ceilingheinum, nextceilingheinum, ceilingz, nextceilingz, true, true);\r\n    if (topcoords != null) genQuadWireframe(topcoords, null, builder.topWire.buff);\r\n\r\n    if (wall.cstat.masking) {\r\n      const coords = getMaskedWallCoords(x1, y1, x2, y2, slope, nextslope,\r\n        ceilingheinum, nextceilingheinum, ceilingz, nextceilingz,\r\n        floorheinum, nextfloorheinum, floorz, nextfloorz);\r\n      genQuadWireframe(coords, null, builder.midWire.buff);\r\n    }\r\n  }\r\n  return builder;\r\n}\r\n\r\nfunction fillBufferForWallPoint(offset: number, board: Board, wallId: number, buff: BuildBuffer, d: number, z: number) {\r\n  const wall = board.walls[wallId];\r\n  const vtxOff = offset * 4;\r\n  buff.writePos(vtxOff + 0, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 1, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 2, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 3, wall.x, z, wall.y);\r\n  buff.writeNormal(vtxOff + 0, -d, d, 0);\r\n  buff.writeNormal(vtxOff + 1, d, d, 0);\r\n  buff.writeNormal(vtxOff + 2, d, -d, 0);\r\n  buff.writeNormal(vtxOff + 3, -d, -d, 0);\r\n  buff.writeTcLighting(vtxOff + 0, 0, 0);\r\n  buff.writeTcLighting(vtxOff + 1, 1, 0);\r\n  buff.writeTcLighting(vtxOff + 2, 1, 1);\r\n  buff.writeTcLighting(vtxOff + 3, 0, 1);\r\n  buff.writeQuad(offset * 6, vtxOff, vtxOff + 1, vtxOff + 2, vtxOff + 3);\r\n}\r\n\r\nfunction updateWallPoint(offset: number, builder: PointSpriteBuilder, ctx: RenderablesCacheContext, ceiling: boolean, wallId: number, d: number): void {\r\n  const board = ctx.board();\r\n  const s = sectorOfWall(board, wallId);\r\n  const sec = board.sectors[s];\r\n  const slope = createSlopeCalculator(board, s);\r\n  const h = (ceiling ? sec.ceilingheinum : sec.floorheinum);\r\n  const z = (ceiling ? sec.ceilingz : sec.floorz);\r\n  const wall = board.walls[wallId];\r\n  const zz = (slope(wall.x, wall.y, h) + z) / ZSCALE;\r\n  fillBufferForWallPoint(offset, board, wallId, builder.buff, d, zz);\r\n}\r\n\r\nfunction addWallPoints(ctx: RenderablesCacheContext, builder: PointSpriteBuilder, wallId: number, ceiling: boolean): void {\r\n  const pointTex = ctx.art.get(-1);\r\n  const board = ctx.board();\r\n  builder.tex = pointTex;\r\n  builder.buff.allocate(8, 12);\r\n  updateWallPoint(0, builder, ctx, ceiling, wallId, 2.5);\r\n  const wallId2 = board.walls[wallId].point2;\r\n  updateWallPoint(1, builder, ctx, ceiling, wallId2, 2.5);\r\n}\r\n\r\nfunction addLength(ctx: RenderablesCacheContext, builder: PointSpriteBuilder, wallId: number, ceiling: boolean) {\r\n  const board = ctx.board();\r\n  const wallId2 = board.walls[wallId].point2;\r\n  const wall = board.walls[wallId];\r\n  const wall2 = board.walls[wallId2];\r\n  const cx = int(wall.x + (wall2.x - wall.x) * 0.5);\r\n  const cy = int(wall.y + (wall2.y - wall.y) * 0.5);\r\n  const sectorId = sectorOfWall(board, wallId);\r\n  const sector = board.sectors[sectorId];\r\n  const fz = slope(board, sectorId, cx, cy, sector.floorheinum) + sector.floorz;\r\n  const cz = slope(board, sectorId, cx, cy, sector.ceilingheinum) + sector.ceilingz;\r\n  const length = walllen(board, wallId).toFixed(2).replace(/\\.00$/, \"\");\r\n  text(builder, length, cx, cy, (ceiling ? cz : fz) / ZSCALE, 8, 8, ctx.art.get(-2));\r\n}\r\n\r\nexport function updateWallHelper(cache: BuildRenderableProvider, ctx: RenderablesCacheContext, wallId: number, builder: WallHelperBuilder): WallHelperBuilder {\r\n  builder = builder == null ? new WallHelperBuilder(ctx.factory) : builder;\r\n\r\n  updateWallWireframe(ctx, wallId, builder);\r\n  const wallRenderable = cache.wall(wallId);\r\n  const board = ctx.board();\r\n  const wall = board.walls[wallId];\r\n\r\n  mat4.copy(builder.topGrid.gridTexMat, createGridWallMatrix(board, wallId, WallGridType.TOP));\r\n  builder.topGrid.solid = <SolidBuilder>wallRenderable.top;\r\n  addWallPoints(ctx, builder.topPoints, wallId, true);\r\n  addLength(ctx, builder.topLength, wallId, true);\r\n\r\n  mat4.copy(builder.midGrid.gridTexMat, createGridWallMatrix(board, wallId, wall.nextsector == -1 ? WallGridType.VOID : WallGridType.MID));\r\n  builder.midGrid.solid = <SolidBuilder>wallRenderable.mid;\r\n\r\n  mat4.copy(builder.botGrid.gridTexMat, createGridWallMatrix(board, wallId, WallGridType.BOT));\r\n  builder.botGrid.solid = <SolidBuilder>wallRenderable.bot;\r\n  addWallPoints(ctx, builder.botPoints, wallId, false);\r\n  addLength(ctx, builder.botLength, wallId, false);\r\n\r\n  return builder;\r\n}","import { sectorOfWall } from \"../../../../build/board/query\";\r\nimport { Board } from \"../../../../build/board/structs\";\r\nimport { createSlopeCalculator, slope, ZSCALE } from \"../../../../build/utils\";\r\nimport { Builders } from \"../../../apis/builder\";\r\nimport { BuildBuffer } from \"../../gl/buffers\";\r\nimport { RenderablesCacheContext } from \"../cache\";\r\nimport { BuildersFactory, PointSpriteBuilder, WireframeBuilder } from \"../common\";\r\n\r\nexport class WallPointHelperBuilder extends Builders {\r\n  constructor(\r\n    factory: BuildersFactory,\r\n    readonly points = factory.pointSprite('helper'),\r\n    readonly line = factory.wireframe('helper')\r\n  ) { super([points, line]) }\r\n}\r\n\r\nfunction updateWallLine(ctx: RenderablesCacheContext, wallId: number, builder: WireframeBuilder): WireframeBuilder {\r\n  const board = ctx.board();\r\n  const buff = builder.buff;\r\n  buff.allocate(2, 2);\r\n  const sectorId = sectorOfWall(board, wallId);\r\n  const sector = board.sectors[sectorId];\r\n  const wall = board.walls[wallId];\r\n  const fz = sector.floorz + slope(board, sectorId, wall.x, wall.y, sector.floorheinum);\r\n  const cz = sector.ceilingz + slope(board, sectorId, wall.x, wall.y, sector.ceilingheinum);\r\n  buff.writePos(0, wall.x, fz / ZSCALE, wall.y);\r\n  buff.writePos(1, wall.x, cz / ZSCALE, wall.y);\r\n  buff.writeLine(0, 0, 1);\r\n  return builder;\r\n}\r\n\r\nfunction fillBufferForWallPoint(offset: number, board: Board, wallId: number, buff: BuildBuffer, d: number, z: number) {\r\n  const wall = board.walls[wallId];\r\n  const vtxOff = offset * 4;\r\n  buff.writePos(vtxOff + 0, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 1, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 2, wall.x, z, wall.y);\r\n  buff.writePos(vtxOff + 3, wall.x, z, wall.y);\r\n  buff.writeNormal(vtxOff + 0, -d, d, 0);\r\n  buff.writeNormal(vtxOff + 1, d, d, 0);\r\n  buff.writeNormal(vtxOff + 2, d, -d, 0);\r\n  buff.writeNormal(vtxOff + 3, -d, -d, 0);\r\n  buff.writeTcLighting(vtxOff + 0, 0, 0);\r\n  buff.writeTcLighting(vtxOff + 1, 1, 0);\r\n  buff.writeTcLighting(vtxOff + 2, 1, 1);\r\n  buff.writeTcLighting(vtxOff + 3, 0, 1);\r\n  buff.writeQuad(offset * 6, vtxOff, vtxOff + 1, vtxOff + 2, vtxOff + 3);\r\n}\r\n\r\nfunction addWallPoint(offset: number, builder: PointSpriteBuilder, ctx: RenderablesCacheContext, ceiling: boolean, wallId: number, d: number): void {\r\n  const board = ctx.board();\r\n  const s = sectorOfWall(board, wallId);\r\n  const sec = board.sectors[s];\r\n  const slope = createSlopeCalculator(board, s);\r\n  const h = (ceiling ? sec.ceilingheinum : sec.floorheinum);\r\n  const z = (ceiling ? sec.ceilingz : sec.floorz);\r\n  const wall = board.walls[wallId];\r\n  const zz = (slope(wall.x, wall.y, h) + z) / ZSCALE;\r\n  fillBufferForWallPoint(offset, board, wallId, builder.buff, d, zz);\r\n}\r\n\r\nexport function updateWallPoint(ctx: RenderablesCacheContext, wallId: number, builder: WallPointHelperBuilder): WallPointHelperBuilder {\r\n  builder = builder == null ? new WallPointHelperBuilder(ctx.factory) : builder;\r\n  builder.points.tex = ctx.art.get(-1);\r\n  builder.points.buff.allocate(8, 12);\r\n  addWallPoint(0, builder.points, ctx, true, wallId, 2.5);\r\n  addWallPoint(1, builder.points, ctx, false, wallId, 2.5);\r\n  updateWallLine(ctx, wallId, builder.line);\r\n  return builder;\r\n}","import { create, Dependency, Injector, Module } from '../../../utils/injector';\r\nimport { ART, ArtProvider, BOARD, BoardProvider, STATE, State, SCHEDULER, Scheduler, TaskHandle, SchedulerTask } from '../../apis/app';\r\nimport { Builder } from '../../apis/builder';\r\nimport { BUS, MessageHandler, MessageHandlerReflective } from '../../apis/handler';\r\nimport { BuildRenderableProvider, ClusterRenderable, SectorRenderable, WallRenderable, Renderable } from '../../apis/renderable';\r\nimport { BoardInvalidate, NamedMessage, LoadBoard } from '../../edit/messages';\r\nimport { SectorBuilder, updateSector } from './builders/sector';\r\nimport { updateCluster } from './builders/sectorcluster';\r\nimport { SectorHelperBuilder, updateSectorHelper } from './builders/sectorhelper';\r\nimport { updateSprite } from './builders/sprite';\r\nimport { updateSprite2d } from './builders/sprite2d';\r\nimport { updateSpriteHelper } from './builders/spritehelper';\r\nimport { updateWall } from './builders/wall';\r\nimport { updateWall2d } from './builders/wall2d';\r\nimport { updateWallHelper, WallHelperBuilder } from './builders/wallhelper';\r\nimport { updateWallPoint } from './builders/wallpointhelper';\r\nimport { BuildersFactory, BUILDERS_FACTORY, FlatBuilder, SolidBuilder } from './common';\r\nimport { updateSectorSelected, SectorSelectedBuilder, updateWallSelected, WallSelectedBuilder } from './builders/selected';\r\n\r\nclass Entry<T> {\r\n  constructor(public value: T, public valid: boolean = false) { }\r\n  update(value: T) { this.value = value; this.valid = true; }\r\n}\r\n\r\nclass CacheMap<T extends Builder> {\r\n  constructor(\r\n    readonly update: (ctx: RenderablesCacheContext, id: number, value: T) => T\r\n  ) { }\r\n\r\n  private cache: { [index: number]: Entry<T> } = {};\r\n\r\n  get(id: number, ctx: RenderablesCacheContext): T {\r\n    let v = this.ensureValue(id);\r\n    if (!v.valid) {\r\n      v.update(this.update(ctx, id, v.value));\r\n      v.value.needToRebuild();\r\n    }\r\n    return v.value;\r\n  }\r\n\r\n  private ensureValue(id: number) {\r\n    let v = this.cache[id];\r\n    if (v == undefined) {\r\n      v = new Entry<T>(null);\r\n      this.cache[id] = v;\r\n    }\r\n    return v;\r\n  }\r\n\r\n  invalidate(id: number) {\r\n    let v = this.cache[id];\r\n    if (v == undefined) return;\r\n    v.value.reset();\r\n    v.valid = false;\r\n  }\r\n\r\n  invalidateAll() {\r\n    for (let id in this.cache) {\r\n      this.invalidate(<any>id);\r\n    }\r\n  }\r\n}\r\n\r\n\r\nexport class CachedTopDownBuildRenderableProvider implements BuildRenderableProvider {\r\n  private walls = new CacheMap(updateWall2d);\r\n  private sprites = new CacheMap(updateSprite2d);\r\n\r\n  constructor(\r\n    private ctx: RenderablesCacheContext,\r\n    private NULL_SECTOR_RENDERABLE = new SectorBuilder(ctx.factory)\r\n  ) { }\r\n\r\n  sector(id: number): SectorRenderable { return this.NULL_SECTOR_RENDERABLE }\r\n  sectorCluster(id: number): ClusterRenderable { throw new Error('Cant render clusters') }\r\n  wall(id: number): WallRenderable { return this.walls.get(id, this.ctx) }\r\n  wallPoint(id: number): Renderable { throw new Error('Cant render points') }\r\n  sprite(id: number): Renderable { return this.sprites.get(id, this.ctx) }\r\n  invalidateSector(id: number) { }\r\n  invalidateWall(id: number) { this.walls.invalidate(id) }\r\n  invalidateSprite(id: number) { this.sprites.invalidate(id) }\r\n\r\n  invalidateAll() {\r\n    this.walls.invalidateAll();\r\n    this.sprites.invalidateAll();\r\n  }\r\n}\r\n\r\nexport class CachedBuildRenderableProvider implements BuildRenderableProvider {\r\n  private sectors = new CacheMap(updateSector);\r\n  private walls = new CacheMap(updateWall);\r\n  private sprites = new CacheMap(updateSprite);\r\n  private clusters = new CacheMap(updateCluster);\r\n\r\n  constructor(\r\n    private ctx: RenderablesCacheContext\r\n  ) { }\r\n\r\n  sector(id: number): SectorRenderable { return this.sectors.get(id, this.ctx) }\r\n  sectorCluster(id: number): ClusterRenderable { return this.clusters.get(id, this.ctx) }\r\n  wall(id: number): WallRenderable { return this.walls.get(id, this.ctx) }\r\n  wallPoint(id: number): Renderable { throw new Error('Cant render points') }\r\n  sprite(id: number): Renderable { return this.sprites.get(id, this.ctx) }\r\n  invalidateSector(id: number) { this.sectors.invalidate(id) }\r\n  invalidateWall(id: number) { this.walls.invalidate(id) }\r\n  invalidateSprite(id: number) { this.sprites.invalidate(id) }\r\n\r\n  invalidateAll() {\r\n    this.sectors.invalidateAll();\r\n    this.walls.invalidateAll();\r\n    this.sprites.invalidateAll();\r\n  }\r\n}\r\n\r\nexport class CachedSelectedRenderableProvider implements BuildRenderableProvider {\r\n  private sectors = new CacheMap((ctx, id, value: SectorSelectedBuilder) => updateSectorSelected(this.cache, ctx, id, value));\r\n  private walls = new CacheMap((ctx, id, value: WallSelectedBuilder) => updateWallSelected(this.cache, ctx, id, value));\r\n\r\n  constructor(\r\n    private ctx: RenderablesCacheContext,\r\n    readonly cache: CachedBuildRenderableProvider\r\n  ) { }\r\n\r\n  sector(id: number): SectorRenderable { return this.sectors.get(id, this.ctx) }\r\n  sectorCluster(id: number): ClusterRenderable { throw new Error('Cant render clusters') }\r\n  wall(id: number): WallRenderable { return this.walls.get(id, this.ctx) }\r\n  wallPoint(id: number): Renderable { return null }\r\n  sprite(id: number): Renderable { return null }\r\n}\r\n\r\nexport class CachedHelperBuildRenderableProvider implements BuildRenderableProvider {\r\n  private sectors = new CacheMap((ctx: RenderablesCacheContext, id: number, value: SectorHelperBuilder) => updateSectorHelper(this.cache, ctx, id, value));\r\n  private walls = new CacheMap((ctx: RenderablesCacheContext, id: number, value: WallHelperBuilder) => updateWallHelper(this.cache, ctx, id, value));\r\n  private sprites = new CacheMap(updateSpriteHelper);\r\n  private wallPoints = new CacheMap(updateWallPoint);\r\n\r\n  constructor(\r\n    private ctx: RenderablesCacheContext,\r\n    readonly cache: CachedBuildRenderableProvider\r\n  ) { }\r\n\r\n  sector(id: number): SectorRenderable { return this.sectors.get(id, this.ctx) }\r\n  sectorCluster(id: number): ClusterRenderable { throw new Error('Cant render clusters') }\r\n  wall(id: number): WallRenderable { return this.walls.get(id, this.ctx) }\r\n  wallPoint(id: number): Renderable { return this.wallPoints.get(id, this.ctx) }\r\n  sprite(id: number): Renderable { return this.sprites.get(id, this.ctx) }\r\n  invalidateSector(id: number) { this.sectors.invalidate(id) }\r\n  invalidateSprite(id: number) { this.sprites.invalidate(id) }\r\n\r\n  invalidateWall(id: number) {\r\n    this.walls.invalidate(id);\r\n    this.wallPoints.invalidate(id);\r\n  }\r\n\r\n  invalidateAll() {\r\n    this.sectors.invalidateAll();\r\n    this.walls.invalidateAll();\r\n    this.sprites.invalidateAll();\r\n    this.wallPoints.invalidateAll();\r\n  }\r\n}\r\n\r\nexport interface RenderablesCache extends MessageHandler {\r\n  readonly geometry: CachedBuildRenderableProvider;\r\n  readonly helpers: CachedHelperBuildRenderableProvider;\r\n  readonly topdown: CachedTopDownBuildRenderableProvider;\r\n  readonly selected: CachedSelectedRenderableProvider;\r\n}\r\nexport const RENDRABLES_CACHE = new Dependency<RenderablesCache>('RenderablesCache');\r\n\r\nexport class RenderablesCacheContext {\r\n  readonly board: BoardProvider;\r\n  readonly art: ArtProvider;\r\n  readonly factory: BuildersFactory;\r\n  readonly state: State;\r\n}\r\nconst RENDERABLES_CACHE_CONTEXT = new Dependency<RenderablesCacheContext>('RenderablesCacheContext');\r\nasync function RenderablesCacheContextConstructor(injector: Injector): Promise<RenderablesCacheContext> {\r\n  const [board, art, factory, state] = await Promise.all([\r\n    injector.getInstance(BOARD),\r\n    injector.getInstance(ART),\r\n    injector.getInstance(BUILDERS_FACTORY),\r\n    injector.getInstance(STATE),\r\n  ]);\r\n  return { board, art, factory, state }\r\n}\r\n\r\nasync function RenderablesCacheConstructor(injector: Injector) {\r\n  return create(injector, RenderablesCacheImpl, RENDERABLES_CACHE_CONTEXT, SCHEDULER);\r\n}\r\n\r\nexport const WALL_COLOR = 'wallColor';\r\nexport const MASKED_WALL_COLOR = 'maskedWallColor';\r\nexport const INTERSECTOR_WALL_COLOR = 'intersectorWallColor';\r\nexport const SPRITE_COLOR = 'spriteColor';\r\n\r\nexport async function RenderablesCacheModule(module: Module) {\r\n  module.bind(RENDERABLES_CACHE_CONTEXT, RenderablesCacheContextConstructor);\r\n  module.bind(RENDRABLES_CACHE, RenderablesCacheConstructor);\r\n  module.execute(async injector => {\r\n    const state = await injector.getInstance(STATE);\r\n    state.register(WALL_COLOR, [1, 1, 1, 1]);\r\n    state.register(INTERSECTOR_WALL_COLOR, [1, 0, 0, 1]);\r\n    state.register(MASKED_WALL_COLOR, [0, 0, 1, 1]);\r\n    state.register(SPRITE_COLOR, [0, 1, 1, 1]);\r\n\r\n    const bus = await injector.getInstance(BUS);\r\n    const cache = await injector.getInstance(RENDRABLES_CACHE);\r\n    bus.connect(cache);\r\n  })\r\n}\r\n\r\nexport class RenderablesCacheImpl extends MessageHandlerReflective implements RenderablesCache {\r\n  readonly geometry: CachedBuildRenderableProvider;\r\n  readonly helpers: CachedHelperBuildRenderableProvider;\r\n  readonly topdown: CachedTopDownBuildRenderableProvider;\r\n  readonly selected: CachedSelectedRenderableProvider;\r\n\r\n  private preloadTask: TaskHandle;\r\n\r\n  constructor(\r\n    private ctx: RenderablesCacheContext,\r\n    private scheduler: Scheduler\r\n  ) {\r\n    super();\r\n    this.geometry = new CachedBuildRenderableProvider(ctx);\r\n    this.helpers = new CachedHelperBuildRenderableProvider(ctx, this.geometry);\r\n    this.topdown = new CachedTopDownBuildRenderableProvider(ctx);\r\n    this.selected = new CachedSelectedRenderableProvider(ctx, this.geometry);\r\n    this.launchPrebuild();\r\n  }\r\n\r\n  private launchPrebuild() {\r\n    if (this.preloadTask != null) this.preloadTask.stop();\r\n    this.preloadTask = this.scheduler.addTask(this.prebuild());\r\n  }\r\n\r\n  private * prebuild(): SchedulerTask {\r\n    let handle = yield;\r\n    handle.setDescription('Prebuild...');\r\n    const board = this.ctx.board();\r\n    for (let i = 0; i < board.sectors.length; i++) {\r\n      this.geometry.sector(i);\r\n      this.topdown.sector(i);\r\n      handle.setDescription(`Prebuild. Sector ${i}`);\r\n      handle = yield;\r\n    }\r\n    handle.setProgress(33);\r\n    for (let i = 0; i < board.walls.length; i++) {\r\n      this.geometry.wall(i);\r\n      this.helpers.wall(i);\r\n      handle.setDescription(`Prebuild. Wall ${i}`);\r\n      handle = yield;\r\n    }\r\n    handle.setProgress(66);\r\n    for (let i = 0; i < board.sprites.length; i++) {\r\n      this.geometry.sprite(i);\r\n      this.topdown.sprite(i);\r\n      handle.setDescription(`Prebuild. Sprite ${i}`);\r\n      handle = yield;\r\n    }\r\n  }\r\n\r\n  LoadBoard(msg: LoadBoard) {\r\n    this.invalidateAll();\r\n    this.launchPrebuild();\r\n  }\r\n\r\n  BoardInvalidate(msg: BoardInvalidate) {\r\n    if (msg.ent == null) this.invalidateAll();\r\n    else if (msg.ent.isSector()) this.invalidateSector(msg.ent.id);\r\n    else if (msg.ent.isSprite()) this.invalidateSprite(msg.ent.id);\r\n    else if (msg.ent.isWall()) this.invalidateWall(msg.ent.id);\r\n  }\r\n\r\n  private invalidateAll(): void {\r\n    this.geometry.invalidateAll();\r\n    this.helpers.invalidateAll();\r\n    this.topdown.invalidateAll();\r\n  }\r\n\r\n  private invalidateSector(id: number): void {\r\n    this.geometry.invalidateSector(id);\r\n    this.helpers.invalidateSector(id);\r\n    this.topdown.invalidateSector(id);\r\n  }\r\n\r\n  private invalidateWall(id: number): void {\r\n    this.geometry.invalidateWall(id);\r\n    this.helpers.invalidateWall(id);\r\n    this.topdown.invalidateWall(id);\r\n  }\r\n\r\n  private invalidateSprite(id: number): void {\r\n    this.geometry.invalidateSprite(id);\r\n    this.helpers.invalidateSprite(id);\r\n    this.topdown.invalidateSprite(id);\r\n  }\r\n}\r\n\r\n","import { mat4, vec4 } from \"../../../libs_js/glmatrix\";\r\nimport { Texture } from \"../../../utils/gl/drawstruct\";\r\nimport { Dependency, Injector } from \"../../../utils/injector\";\r\nimport { GRID, GridController } from \"../../apis/app\";\r\nimport { DrawCallConsumer } from \"../../apis/renderable\";\r\nimport { BUFFER_FACTORY, BuildBuffer } from \"../gl/buffers\";\r\nimport { BUILD_GL } from \"../gl/buildgl\";\r\nimport { BufferRenderable, BufferSetup, GridSetup, PointSpriteSetup, SolidSetup, WireframeSetup } from \"./builders/setups\";\r\n\r\nexport interface BuildersFactory {\r\n  solid(hint: string): SolidBuilder;\r\n  grid(hint: string): GridBuilder;\r\n  flat(hint: string): FlatBuilder;\r\n  pointSprite(hint: string): PointSpriteBuilder;\r\n  wireframe(hint: string): WireframeBuilder;\r\n}\r\nexport const BUILDERS_FACTORY = new Dependency<BuildersFactory>('Builder Factory');\r\n\r\nexport async function DefaultBuildersFactory(injector: Injector) {\r\n  const bufferFactory = await injector.getInstance(BUFFER_FACTORY);\r\n  const buildgl = await injector.getInstance(BUILD_GL);\r\n  const grid = await injector.getInstance(GRID);\r\n\r\n  const solidSetup = () => new SolidSetup(buildgl.state);\r\n  const gridSetup = () => new GridSetup(buildgl.state);\r\n  const bufferSetup = () => new BufferSetup(buildgl.state);\r\n  const pointspriteSetup = () => new PointSpriteSetup(buildgl.state);\r\n  const wireframeSetup = () => new WireframeSetup(buildgl.state);\r\n\r\n  return {\r\n    solid: (hint: string) => new SolidBuilder(solidSetup(), bufferFactory.get('solid-' + hint)),\r\n    grid: (hint: string) => new GridBuilder(gridSetup(), grid),\r\n    flat: (hint: string) => new FlatBuilder(bufferSetup()),\r\n    pointSprite: (hint: string) => new PointSpriteBuilder(pointspriteSetup(), bufferFactory.get('pointsprite-' + hint)),\r\n    wireframe: (hint: string) => new WireframeBuilder(wireframeSetup(), bufferFactory.get('wireframe-' + hint))\r\n  }\r\n}\r\n\r\nexport enum Type {\r\n  SURFACE,\r\n  FACE\r\n}\r\n\r\nexport class SolidBuilder extends BufferRenderable<SolidSetup> {\r\n  public type: Type = Type.SURFACE;\r\n  public tex: Texture;\r\n  public trans: number = 1;\r\n  public parallax: number = 0;\r\n  private color = vec4.create();\r\n\r\n  constructor(setup: SolidSetup, readonly buff: BuildBuffer) { super(setup) }\r\n  protected textureHint() { return this.tex }\r\n\r\n  public applySetup(setup: SolidSetup) {\r\n    setup.shader(this.type == Type.SURFACE ? (this.parallax ? 'parallax' : 'baseShader') : 'spriteShader')\r\n      .base(this.tex)\r\n      .color(vec4.set(this.color, 1, 1, 1, this.trans))\r\n  }\r\n\r\n  public reset() {\r\n    this.buff.deallocate();\r\n    this.type = Type.SURFACE;\r\n    this.trans = 1;\r\n    vec4.set(this.color, 1, 1, 1, 1);\r\n    this.parallax = 0;\r\n    this.tex = null;\r\n  }\r\n}\r\n\r\nexport class GridBuilder extends BufferRenderable<GridSetup> {\r\n  public solid: SolidBuilder;\r\n  public gridTexMat = mat4.create();\r\n  public range = 4.0;\r\n  private gridSettings = vec4.create();\r\n\r\n  constructor(setup: GridSetup, private grid: GridController) {\r\n    super(setup)\r\n  }\r\n\r\n  public get buff() { return this.solid.buff }\r\n  public reset() { mat4.identity(this.gridTexMat) }\r\n  protected textureHint() { return null }\r\n\r\n  public applySetup(setup: GridSetup) {\r\n    setup.shader('grid')\r\n      .grid(this.gridTexMat)\r\n      .gridSettings(vec4.set(this.gridSettings, this.grid.getGridSize(), this.range, 0, 0));\r\n  }\r\n\r\n  public drawCall(consumer: DrawCallConsumer): void {\r\n    this.needToRebuild();\r\n    super.drawCall(consumer);\r\n  }\r\n}\r\n\r\nexport class FlatBuilder extends BufferRenderable<BufferSetup> {\r\n  public solid: SolidBuilder;\r\n\r\n  constructor(setup: BufferSetup) { super(setup) }\r\n\r\n  public get buff() { return this.solid.buff }\r\n  public reset() { }\r\n  protected textureHint() { return null }\r\n  public applySetup(setup: BufferSetup) { setup.shader('baseFlatShader') }\r\n\r\n  public drawCall(consumer: DrawCallConsumer): void {\r\n    this.needToRebuild();\r\n    super.drawCall(consumer);\r\n  }\r\n}\r\n\r\nexport class PointSpriteBuilder extends BufferRenderable<PointSpriteSetup> {\r\n  public tex: Texture;\r\n  public color = vec4.fromValues(1, 1, 1, 1);\r\n\r\n  constructor(setup: PointSpriteSetup, readonly buff: BuildBuffer) { super(setup) }\r\n\r\n  public applySetup(setup: PointSpriteSetup) {\r\n    setup.shader('spriteFaceShader')\r\n      .base(this.tex)\r\n      .color(this.color);\r\n  }\r\n\r\n  protected textureHint() { return this.tex }\r\n\r\n  public reset() {\r\n    this.buff.deallocate();\r\n    this.tex = null;\r\n    vec4.set(this.color, 1, 1, 1, 1);\r\n  }\r\n}\r\n\r\nexport class WireframeBuilder extends BufferRenderable<WireframeSetup> {\r\n  public type: Type = Type.SURFACE;\r\n  public color = vec4.fromValues(1, 1, 1, 1);\r\n  public mode = WebGLRenderingContext.LINES;\r\n\r\n  constructor(setup: WireframeSetup, readonly buff: BuildBuffer) { super(setup) }\r\n\r\n  public applySetup(setup: WireframeSetup) {\r\n    setup.shader(this.type == Type.SURFACE ? 'baseFlatShader' : 'spriteFlatShader')\r\n      .color(this.color);\r\n  }\r\n\r\n  protected textureHint() { return null }\r\n  public clr(r: number, g: number, b: number, a: number) { vec4.set(this.color, r, g, b, a); return this }\r\n\r\n  public reset() {\r\n    this.buff.deallocate();\r\n    this.type = Type.SURFACE;\r\n    this.mode = WebGLRenderingContext.LINES;\r\n    vec4.set(this.color, 1, 1, 1, 1);\r\n  }\r\n}","import { Buffer, BufferBuilder, Pointer } from '../../../utils/gl/buffergl';\r\nimport { IndexBuffer, VertexBuffer } from '../../../utils/gl/drawstruct';\r\nimport { Dependency, Injector } from '../../../utils/injector';\r\nimport { GL } from '../buildartprovider';\r\n\r\nexport interface GenericBuildBuffer {\r\n  get(): Pointer;\r\n  getSize(): number;\r\n  allocate(vtxCount: number, triIndexCount: number): void;\r\n  deallocate(): void;\r\n  writePos(off: number, x: number, y: number, z: number): number;\r\n  getIdxBuffer(): IndexBuffer;\r\n  getPosBuffer(): VertexBuffer;\r\n  writeTriangle(off: number, a: number, b: number, c: number): number;\r\n  writeQuad(off: number, a: number, b: number, c: number, d: number): number;\r\n  writeLine(off: number, a: number, b: number): number;\r\n}\r\n\r\nexport interface BuildBuffer extends GenericBuildBuffer {\r\n  writeNormal(off: number, x: number, y: number, z: number): number;\r\n  writeTcLighting(off: number, u: number, v: number, pal?: number, shade?: number): number;\r\n  getNormBuffer(): VertexBuffer;\r\n  getTexCoordBuffer(): VertexBuffer;\r\n}\r\n\r\nexport interface BuildBufferFactory {\r\n  get(hint: string): BuildBuffer;\r\n}\r\nexport const BUFFER_FACTORY = new Dependency<BuildBufferFactory>('Build Buffer Factory');\r\n\r\nexport async function DefaultBufferFactory(injector: Injector) {\r\n  const gl = await injector.getInstance(GL);\r\n  return new BuildBufferFactoryImpl(gl);\r\n}\r\n\r\nexport class PointSpritesBuilder {\r\n  private sprites: [number, number, number][] = [];\r\n\r\n  public add(x: number, y: number, z: number) {\r\n    this.sprites.push([x, y, z]);\r\n  }\r\n\r\n  public build(buff: BuildBuffer, d: number) {\r\n    const size = this.sprites.length;\r\n    buff.allocate(size * 4, size * 6);\r\n    for (let i = 0; i < size; i++) {\r\n      const off = i * 4;\r\n      const [x, y, z] = this.sprites[i];\r\n      buff.writePos(off + 0, x, y, z);\r\n      buff.writePos(off + 1, x, y, z);\r\n      buff.writePos(off + 2, x, y, z);\r\n      buff.writePos(off + 3, x, y, z);\r\n      buff.writeTcLighting(off + 0, 0, 0);\r\n      buff.writeTcLighting(off + 1, 1, 0);\r\n      buff.writeTcLighting(off + 2, 1, 1);\r\n      buff.writeTcLighting(off + 3, 0, 1);\r\n      buff.writeNormal(off + 0, -d, d, 0);\r\n      buff.writeNormal(off + 1, d, d, 0);\r\n      buff.writeNormal(off + 2, d, -d, 0);\r\n      buff.writeNormal(off + 3, -d, -d, 0);\r\n      buff.writeQuad(i * 6, off, off + 1, off + 2, off + 3);\r\n    }\r\n  }\r\n}\r\n\r\nexport class LineBuilder {\r\n  private vtxIndex: Map<string, number> = new Map();\r\n  private linesIndex: Set<string> = new Set();\r\n  private vtxs: [number, number, number][] = [];\r\n  private lines: [number, number][] = [];\r\n\r\n  public segment(x1: number, y1: number, z1: number, x2: number, y2: number, z2: number) {\r\n    const idx1 = this.addVtx(x1, y1, z1);\r\n    const idx2 = this.addVtx(x2, y2, z2);\r\n    this.addLine(idx1, idx2);\r\n  }\r\n\r\n  public rect(\r\n    x1: number, y1: number, z1: number,\r\n    x2: number, y2: number, z2: number,\r\n    x3: number, y3: number, z3: number,\r\n    x4: number, y4: number, z4: number\r\n  ) {\r\n    this.segment(x1, y1, z1, x2, y2, z2);\r\n    this.segment(x2, y2, z2, x3, y3, z3);\r\n    this.segment(x3, y3, z3, x4, y4, z4);\r\n    this.segment(x4, y4, z4, x1, y1, z1);\r\n  }\r\n\r\n  public build(buff: GenericBuildBuffer) {\r\n    buff.allocate(this.vtxs.length, this.lines.length * 2);\r\n    for (let i = 0; i < this.vtxs.length; i++) {\r\n      const vtx = this.vtxs[i];\r\n      buff.writePos(i, vtx[0], vtx[1], vtx[2]);\r\n    }\r\n    for (let i = 0; i < this.lines.length; i++) {\r\n      const line = this.lines[i];\r\n      buff.writeLine(i * 2, line[0], line[1]);\r\n    }\r\n  }\r\n\r\n  private addVtx(x: number, y: number, z: number): number {\r\n    const key = `${x},${y},${z}`;\r\n    let idx = this.vtxIndex.get(key);\r\n    if (idx == undefined) {\r\n      idx = this.vtxs.length;\r\n      this.vtxIndex.set(key, idx);\r\n      this.vtxs.push([x, y, z]);\r\n    }\r\n    return idx;\r\n  }\r\n\r\n  private addLine(idx1: number, idx2: number) {\r\n    if (idx1 == idx2) return;\r\n    const key = `${idx1},${idx2}`;\r\n    this.linesIndex.has(key);\r\n    if (!this.linesIndex.has(key)) {\r\n      this.linesIndex.add(key);\r\n      this.lines.push([idx1, idx2]);\r\n    }\r\n  }\r\n}\r\n\r\nconst POSITION = 0;\r\nconst NORMAL = 1;\r\nconst TEX_SHADING = 2;\r\n\r\nclass BuildBufferFactoryImpl implements BuildBufferFactory {\r\n  private buffers = new Map<string, Buffer[]>();\r\n\r\n  constructor(private gl: WebGLRenderingContext) { }\r\n\r\n  private addNewBuffer(hint: string) {\r\n    const buffer = new Buffer(this.gl, new BufferBuilder()\r\n      .addVertexBuffer(this.gl, this.gl.FLOAT, 3)\r\n      .addVertexBuffer(this.gl, this.gl.FLOAT, 3)\r\n      .addVertexBuffer(this.gl, this.gl.FLOAT, 4));\r\n    let buffers = this.buffers.get(hint);\r\n    buffers.push(buffer);\r\n    return buffer;\r\n  }\r\n\r\n  public get(hint: string): BuildBuffer {\r\n    let buffers = this.buffers.get(hint);\r\n    if (buffers == undefined) {\r\n      buffers = [];\r\n      this.buffers.set(hint, buffers);\r\n    }\r\n    return new BuildBufferImpl(this, hint);\r\n  }\r\n\r\n  public allocate(hint: string, vtxSize: number, idxSize: number): Pointer {\r\n    for (const buff of this.buffers.get(hint)) {\r\n      const ptr = buff.allocate(vtxSize, idxSize);\r\n      if (ptr != null) return ptr;\r\n    }\r\n    return this.addNewBuffer(hint).allocate(vtxSize, idxSize);\r\n  }\r\n}\r\n\r\nexport class BuildBufferImpl implements BuildBuffer {\r\n  private ptr: Pointer;\r\n  private size = 0;\r\n\r\n  constructor(private factory: BuildBufferFactoryImpl, private hint: string) { }\r\n\r\n  public get(): Pointer { return this.ptr }\r\n  public getSize() { return this.size }\r\n  private remove() { this.ptr.buffer.deallocate(this.ptr) }\r\n\r\n  public allocate(vtxCount: number, triIndexCount: number) {\r\n    if (this.ptr != null) {\r\n      if (this.ptr.vtx.size >= vtxCount && this.ptr.idx.size >= triIndexCount) {\r\n        this.size = triIndexCount;\r\n        return;\r\n      }\r\n      this.remove();\r\n    }\r\n    this.ptr = this.factory.allocate(this.hint, vtxCount, triIndexCount);\r\n    this.size = this.ptr.idx.size;\r\n  }\r\n\r\n  public deallocate() {\r\n    if (this.ptr != null) {\r\n      this.remove();\r\n      this.ptr = null;\r\n      this.size = 0;\r\n    }\r\n  }\r\n\r\n  public writePos(off: number, x: number, y: number, z: number): number {\r\n    this.ptr.buffer.writeVertex(this.ptr, POSITION, off, [x, y, z]);\r\n    return off + 1;\r\n  }\r\n\r\n  public writeNormal(off: number, x: number, y: number, z: number): number {\r\n    this.ptr.buffer.writeVertex(this.ptr, NORMAL, off, [x, y, z]);\r\n    return off + 1;\r\n  }\r\n\r\n  public writeTcLighting(off: number, u: number, v: number, pal: number = 0, shade: number = 0): number {\r\n    this.ptr.buffer.writeVertex(this.ptr, TEX_SHADING, off, [u, v, pal, shade]);\r\n    return off + 1;\r\n  }\r\n\r\n  public writeTriangle(off: number, a: number, b: number, c: number): number {\r\n    this.ptr.buffer.writeIndex(this.ptr, off, [a, b, c]);\r\n    return off + 3;\r\n  }\r\n\r\n  public writeQuad(off: number, a: number, b: number, c: number, d: number): number {\r\n    this.ptr.buffer.writeIndex(this.ptr, off, [a, c, b, a, d, c]);\r\n    return off + 6;\r\n  }\r\n\r\n  public writeLine(off: number, a: number, b: number): number {\r\n    this.ptr.buffer.writeIndex(this.ptr, off, [a, b]);\r\n    return off + 2;\r\n  }\r\n\r\n  public getPosBuffer(): VertexBuffer {\r\n    return this.ptr.buffer.getVertexBuffer(POSITION);\r\n  }\r\n\r\n  public getNormBuffer(): VertexBuffer {\r\n    return this.ptr.buffer.getVertexBuffer(NORMAL);\r\n  }\r\n\r\n  public getTexCoordBuffer(): VertexBuffer {\r\n    return this.ptr.buffer.getVertexBuffer(TEX_SHADING);\r\n  }\r\n\r\n  public getIdxBuffer(): IndexBuffer {\r\n    return this.ptr.buffer.getIndexBuffer();\r\n  }\r\n}","import { mat4, Mat4Array, vec3, Vec3Array, vec4 } from '../../../libs_js/glmatrix';\r\nimport { Texture } from '../../../utils/gl/drawstruct';\r\nimport { createShader } from '../../../utils/gl/shaders';\r\nimport { Profile, State } from '../../../utils/gl/stategl';\r\nimport { Dependency, Injector } from '../../../utils/injector';\r\nimport { info } from '../../../utils/logger';\r\nimport * as PROFILER from '../../../utils/profiler';\r\nimport { Renderable } from '../../apis/renderable';\r\nimport { GL } from '../buildartprovider';\r\n\r\nexport const PAL_TEXTURE = new Dependency<Texture>('PAL Texture');\r\nexport const PLU_TEXTURE = new Dependency<Texture>('PLU Texture');\r\nexport const SHADOWSTEPS = new Dependency<number>('Shadowsteps');\r\nexport const PALSWAPS = new Dependency<number>('Palswaps');\r\nexport const BUILD_GL = new Dependency<BuildGl>('BuildGL');\r\n\r\nexport function BuildGlConstructor(injector: Injector): Promise<BuildGl> {\r\n  return new Promise(resolve => Promise.all([\r\n    injector.getInstance(GL),\r\n    injector.getInstance(PAL_TEXTURE),\r\n    injector.getInstance(PLU_TEXTURE),\r\n    injector.getInstance(PALSWAPS),\r\n    injector.getInstance(SHADOWSTEPS),\r\n  ]).then(([gl, pal, plus, plaswaps, shadowsteps]) => {\r\n    const buildgl = new BuildGl(plaswaps, shadowsteps, gl, pal, plus, () => resolve(buildgl))\r\n  }));\r\n}\r\n\r\nconst SHADER_NAME = 'resources/shaders/build';\r\nconst inv = mat4.create();\r\nconst pos = vec3.create();\r\nconst clipPlane = vec4.create();\r\n\r\nexport class BuildGl {\r\n  readonly state = new State();\r\n\r\n  constructor(palswaps: number, shadowsteps: number, readonly gl: WebGLRenderingContext, pal: Texture, plus: Texture, cb: () => void) {\r\n    gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\r\n    gl.enable(gl.CULL_FACE);\r\n    gl.enable(gl.DEPTH_TEST);\r\n    gl.enable(gl.POLYGON_OFFSET_FILL);\r\n    gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n\r\n    const defs = ['PALSWAPS (' + palswaps + '.0)', 'SHADOWSTEPS (' + shadowsteps + '.0)', 'PAL_LIGHTING'/*, 'DITHERING'*/]\r\n    Promise.all([\r\n      createShader(gl, SHADER_NAME, [...defs]).then(shader => this.state.registerShader('baseShader', shader)),\r\n      createShader(gl, SHADER_NAME, [...defs, 'SPRITE']).then(shader => this.state.registerShader('spriteShader', shader)),\r\n      createShader(gl, SHADER_NAME, [...defs, 'FLAT']).then(shader => this.state.registerShader('baseFlatShader', shader)),\r\n      createShader(gl, SHADER_NAME, [...defs, 'SPRITE', 'FLAT']).then(shader => this.state.registerShader('spriteFlatShader', shader)),\r\n      createShader(gl, SHADER_NAME, [...defs, 'PARALLAX']).then(shader => this.state.registerShader('parallax', shader)),\r\n      createShader(gl, SHADER_NAME, [...defs, 'GRID']).then(shader => this.state.registerShader('grid', shader)),\r\n      createShader(gl, SHADER_NAME, [...defs, 'SPRITE_FACE']).then(shader => this.state.registerShader('spriteFaceShader', shader))\r\n    ]).then(r => {\r\n      this.state.setTexture('pal', pal);\r\n      this.state.setTexture('plu', plus);\r\n      cb()\r\n    });\r\n  }\r\n\r\n  public setProjectionMatrix(proj: Mat4Array) { this.state.setUniform('P', proj) }\r\n  public setPosition(pos: Vec3Array) { this.state.setUniform('eyepos', pos) }\r\n\r\n  public setViewMatrix(view: Mat4Array) {\r\n    this.state.setUniform('V', view);\r\n    if (this.state.isUniformEnabled('IV')) this.state.setUniform('IV', mat4.invert(inv, view));\r\n  }\r\n\r\n  public setCursorPosiotion(x: number, y: number, z: number) {\r\n    vec3.set(pos, x, y, z);\r\n    this.state.setUniform('curpos', pos);\r\n  }\r\n\r\n  public setClipPlane(x: number, y: number, z: number, w: number) {\r\n    vec4.set(clipPlane, x, y, z, w);\r\n    this.state.setUniform('clipPlane', clipPlane);\r\n  }\r\n\r\n  public draw(renderable: Renderable) {\r\n    if (renderable == null) return;\r\n    renderable.drawCall(dc => this.state.run(this.gl, dc));\r\n  }\r\n\r\n  public newFrame() {\r\n    this.updateProfile(this.state.profile);\r\n    this.gl.clearColor(0.2, 0.2, 0.2, 1.0);\r\n    this.gl.clearStencil(0);\r\n    this.gl.clearDepth(1);\r\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT | this.gl.DEPTH_BUFFER_BIT | this.gl.STENCIL_BUFFER_BIT);\r\n    this.state.setUniform('sys', [performance.now(), this.gl.drawingBufferWidth, this.gl.drawingBufferHeight, 0]);\r\n    this.modulation(1, 1, 1, 1);\r\n  }\r\n\r\n  public modulation(r: number, g: number, b: number, a: number) {\r\n    if (this.state.isUniformEnabled('modulation')) this.state.setUniform('modulation', [r, g, b, a]);\r\n  }\r\n\r\n  private updateProfile(profile: Profile) {\r\n    const p = PROFILER.get(null);\r\n    p.set('drawsRequested', profile.drawsRequested);\r\n    p.set('drawsMerged', profile.drawsMerged);\r\n    p.set('shaderChanges', profile.shaderChanges);\r\n    p.set('uniformChanges', profile.uniformChanges);\r\n    p.set('textureChanges', profile.textureChanges);\r\n    p.set('bufferChanges', profile.bufferChanges);\r\n    profile.reset();\r\n  }\r\n\r\n  public printInfo() {\r\n    info(this.state.profile);\r\n  }\r\n\r\n  public flush() {\r\n    this.state.flush(this.gl);\r\n  }\r\n\r\n}\r\n","import { createState, Match, SetStateFunction, State, Switch } from \"solid-js\";\r\nimport { render } from \"solid-js/dom\";\r\nimport h from \"stage0\";\r\nimport { Sector, Sprite, Wall } from \"../../build/board/structs\";\r\nimport { EntityType, isSector, isSprite, isWall } from \"../../build/hitscan\";\r\nimport { create, Module } from \"../../utils/injector\";\r\nimport { BOARD, BoardProvider, View, VIEW } from \"../apis/app\";\r\nimport { BUS, MessageHandlerReflective } from \"../apis/handler\";\r\nimport { BoardInvalidate, Frame } from \"../edit/messages\";\r\n\r\n\r\nexport async function InfoModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    bus.connect(await create(injector, Info, VIEW, BOARD))\r\n  });\r\n}\r\n\r\nconst rowTemplate = h`<tr><td>#nameNode</td><td>#valueNode</td></tr>`;\r\nfunction createRow(name: string): [Node, (v: any) => void] {\r\n  const root = rowTemplate.cloneNode(true);\r\n  const { nameNode, valueNode } = rowTemplate.collect(root);\r\n  nameNode.nodeValue = name;\r\n  const update = (v: any) => valueNode.nodeValue = v;\r\n  return [root, update];\r\n}\r\n\r\nconst rowsTemplate = h`<table class=\"table-striped\" #table><tbody></tbody></table>`;\r\nfunction createSprite() {\r\n  const root = rowsTemplate.cloneNode(true);\r\n  const { table } = rowsTemplate.collect(root);\r\n  const [head, headUpdater] = createRow(\"Type\");\r\n  const [id, idUpdater] = createRow(\"Id\");\r\n  const [picnum, picnumUpdater] = createRow(\"Picnum\");\r\n  const [shade, shadeUpdater] = createRow(\"Shade\");\r\n  const [pal, palUpdater] = createRow(\"Palette\");\r\n  const [offset, offsetUpdater] = createRow(\"Offset\");\r\n  const [repeat, repeatUpdater] = createRow(\"Repeat\");\r\n  const [z, zUpdater] = createRow(\"Z\");\r\n  table.appendChild(head);\r\n  table.appendChild(id);\r\n  table.appendChild(picnum);\r\n  table.appendChild(shade);\r\n  table.appendChild(pal);\r\n  table.appendChild(offset);\r\n  table.appendChild(repeat);\r\n  table.appendChild(z);\r\n  headUpdater('Sprite');\r\n}\r\n\r\nconst Row = (ref: { name: string, value: any }) => {\r\n  return () => <tr>\r\n    <td>{ref.name}</td>\r\n    <td><span>{ref.value ? ref.value : \"\"}</span></td>\r\n  </tr>\r\n}\r\n\r\nconst SpriteProperties = (ref: { id: number, sprite: Sprite }) => {\r\n  return () => <>\r\n    <Row name=\"Type\" value=\"Sprite\" />\r\n    <Row name=\"Id\" value={ref.id} />\r\n    <Row name=\"Picnum\" value={ref.sprite?.picnum} />\r\n    <Row name=\"Shade\" value={ref.sprite?.shade} />\r\n    <Row name=\"Palette\" value={ref.sprite?.pal} />\r\n    <Row name=\"Offset\" value={`${ref.sprite?.xoffset ?? ''}, ${ref.sprite?.yoffset ?? ''}`} />\r\n    <Row name=\"Repeat\" value={`${ref.sprite?.xrepeat ?? ''}, ${ref.sprite?.yrepeat ?? ''}`} />\r\n    <Row name=\"Z\" value={ref.sprite?.z} />\r\n  </>\r\n}\r\n\r\nconst WallProperties = (ref: { id: number, wall: Wall }) => {\r\n  return () => <>\r\n    <Row name=\"Type\" value=\"Wall\" />\r\n    <Row name=\"Id\" value={ref.id} />\r\n    <Row name=\"Picnum\" value={ref.wall?.picnum} />\r\n    <Row name=\"Shade\" value={ref.wall?.shade} />\r\n    <Row name=\"Palette\" value={ref.wall?.pal} />\r\n    <Row name=\"Panning\" value={`${ref.wall?.xpanning ?? ''}, ${ref.wall?.ypanning ?? ''}`} />\r\n    <Row name=\"Repeat\" value={`${ref.wall?.xrepeat ?? ''}, ${ref.wall?.yrepeat ?? ''}`} />\r\n  </>\r\n}\r\n\r\nconst SectorProperties = (ref: { id: number, sector: Sector }) => {\r\n  return () => <>\r\n    <Row name=\"Type\" value=\"Sector\" />\r\n    <Row name=\"Id\" value={ref.id} />\r\n    <Row name=\"Picnum\" value={ref.sector?.floorpicnum} />\r\n    <Row name=\"Shade\" value={ref.sector?.floorshade} />\r\n    <Row name=\"Palette\" value={ref.sector?.floorpal} />\r\n    <Row name=\"Panning\" value={`${ref.sector?.floorxpanning ?? ''}, ${ref.sector?.floorypanning ?? ''}`} />\r\n    <Row name=\"Z\" value={ref.sector?.floorz} />\r\n  </>\r\n}\r\n\r\nconst InfoPanel = ({ state }: { state: InfoPanelState }) => {\r\n  return () =>\r\n    <Switch fallback={<Row name=\"Type\" value=\"Value\" />}>\r\n      <Match when={isSprite(state.type)}><SpriteProperties id={state.id} sprite={state.board().sprites[state.id]} /></Match>\r\n      <Match when={isSector(state.type)}><SectorProperties id={state.id} sector={state.board().sectors[state.id]} /></Match>\r\n      <Match when={isWall(state.type)}><WallProperties id={state.id} wall={state.board().walls[state.id]} /></Match>\r\n    </Switch>\r\n}\r\n\r\n\r\nclass InfoPanelState {\r\n  public id: number;\r\n  public type: EntityType;\r\n  constructor(public board: BoardProvider) { }\r\n}\r\n\r\nexport class Info extends MessageHandlerReflective {\r\n  private state: State<InfoPanelState>;\r\n  private setState: SetStateFunction<InfoPanelState>;\r\n\r\n  constructor(\r\n    private view: View,\r\n    private board: BoardProvider\r\n  ) {\r\n    super();\r\n    const [state, setState] = createState(new InfoPanelState(this.board));\r\n    this.state = state;\r\n    this.setState = setState;\r\n    render(() => <InfoPanel state={state} />, document.getElementById('info_panel'));\r\n  }\r\n\r\n  public Frame(msg: Frame) {\r\n    const ent = this.view.snapTarget().entity;\r\n    if (ent == null) this.setState({ id: 0, type: null });\r\n    else this.setState({ id: ent.id, type: ent.type });\r\n  }\r\n\r\n  public BoardInvalidate(msg: BoardInvalidate) {\r\n    if (msg.ent == null) this.setState('type', this.state.type);\r\n    else if (this.state.type == null) return;\r\n    else if (msg.ent.id == this.state.id) this.setState('type', this.state.type);\r\n  }\r\n}","import { Binder, loadBinds } from \"../../app/input/keymap\"\r\nimport { messageParser } from \"../../app/input/messageparser\"\r\nimport { GL } from \"../../app/modules/buildartprovider\"\r\nimport { loadString } from \"../../utils/getter\"\r\nimport { Module } from \"../../utils/injector\"\r\nimport { bind, get, InputState, postFrame } from \"../../utils/input\"\r\nimport { STATE } from \"../apis/app\"\r\nimport { BUS, MessageHandlerReflective } from \"../apis/handler\"\r\nimport { Mouse, PostFrame } from \"../edit/messages\"\r\n\r\nconst MOUSE = new Mouse(0, 0);\r\n\r\nexport function InputModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const gl = await injector.getInstance(GL);\r\n    const keybinds = await loadString('builded_binds.txt');\r\n    const bus = await injector.getInstance(BUS);\r\n    const state = await injector.getInstance(STATE);\r\n    const binder = new Binder();\r\n    loadBinds(keybinds, binder, messageParser);\r\n    bind(<HTMLCanvasElement>gl.canvas);\r\n\r\n    bus.connect(new class extends MessageHandlerReflective {\r\n      private mouseMove(input: InputState) {\r\n        if (MOUSE.x == input.mouseX && MOUSE.y == input.mouseY) return;\r\n        MOUSE.x = input.mouseX;\r\n        MOUSE.y = input.mouseY;\r\n        bus.handle(MOUSE);\r\n      }\r\n\r\n      PostFrame(msg: PostFrame) {\r\n        const inputState = get()\r\n        this.mouseMove(inputState);\r\n        binder.updateState(inputState, state);\r\n        for (const m of binder.poolEvents(inputState)) bus.handle(m);\r\n        postFrame();\r\n      }\r\n    });\r\n  });\r\n}","import tippy from \"tippy.js\";\r\nimport { Module } from \"../../utils/injector\";\r\nimport { div, dragElement, Element, span, tag } from \"../../utils/ui/ui\";\r\nimport { MenuBuilder, ToolbarBuilder, UI, UiBuilder, Window, WindowBuilder } from \"../apis/ui\";\r\n\r\nclass PhotonWindow implements Window {\r\n  public onclose: () => void;\r\n  readonly contentElement: HTMLElement;\r\n  readonly winElement: HTMLElement;\r\n  private currentButtonGroup: Element;\r\n  private toolbar: Element;\r\n\r\n  constructor(id: string, title: string, w: number, h: number, draggable = false, centered = true, closeable = true) {\r\n    const titleElem = tag('h1').className('title').text(title);\r\n    const toolbar = div('toolbar-actions hidden');\r\n    const header = tag('header').className('toolbar toolbar-header')\r\n      .append(titleElem)\r\n      .append(toolbar);\r\n    if (closeable) {\r\n      const close = span().className('icon icon-record pull-right padded-horizontally red').click(() => this.close());\r\n      titleElem.append(close);\r\n    }\r\n    const footer = tag('footer').className('toolbar toolbar-footer');\r\n    const content = div('window-content').size(w + 'px', h + 'px');\r\n    const window = div('window-frame')\r\n      .id(id)\r\n      .append(header)\r\n      .append(content)\r\n      .append(footer);\r\n\r\n    this.toolbar = toolbar;\r\n    this.contentElement = content.elem();\r\n    this.winElement = window.elem();\r\n    if (centered) this.winElement.classList.add('fixed-center');\r\n    if (draggable) dragElement(titleElem.elem(), this.winElement);\r\n    document.body.appendChild(this.winElement);\r\n  }\r\n\r\n  public addToolbarWidget(widget: HTMLElement) {\r\n    const container = this.currentButtonGroup == null\r\n      ? this.toolbar\r\n      : this.currentButtonGroup;\r\n    container.appendHtml(widget);\r\n    this.toolbar.elem().classList.remove('hidden');\r\n  }\r\n\r\n  public addToolMenuButton(icon: string, menu: MenuBuilder) {\r\n    const container = this.currentButtonGroup == null\r\n      ? this.toolbar\r\n      : this.currentButtonGroup;\r\n    const btn = tag('button').className('btn btn-default btn-dropdown').append(span().className('icon ' + icon));\r\n    container.append(btn);\r\n    menu.build(btn.elem());\r\n    this.toolbar.elem().classList.remove('hidden');\r\n  }\r\n\r\n  public addToolIconButton(icon: string, click: () => void) {\r\n    const container = this.currentButtonGroup == null\r\n      ? this.toolbar\r\n      : this.currentButtonGroup;\r\n    container.append(\r\n      tag('button').className('btn btn-default')\r\n        .append(span().className('icon ' + icon))\r\n        .click(click));\r\n    this.toolbar.elem().classList.remove('hidden');\r\n  }\r\n\r\n  public addToolSearch(hint: string, change: (s: string, sugg: HTMLElement) => void) {\r\n    const suggestContainer = div('suggest');\r\n    const container = this.currentButtonGroup == null\r\n      ? this.toolbar\r\n      : this.currentButtonGroup;\r\n    const textBox = tag('input').className('toolbar-control')\r\n      .attr('type', 'text')\r\n      .attr('placeholder', hint)\r\n      .change(s => change(s, suggestContainer.elem()));\r\n    container.append(\r\n      tag('button').className('btn btn-default btn-mini pull-right')\r\n        .append(span().className('icon icon-search'))\r\n        .append(textBox)\r\n        .click(() => { (<HTMLInputElement>textBox.elem()).value = ''; change('', suggestContainer.elem()) }));\r\n\r\n    tippy(textBox.elem(), {\r\n      allowHTML: true,\r\n      placement: 'bottom-start',\r\n      interactive: true,\r\n      content: suggestContainer.elem(),\r\n      trigger: 'focus',\r\n      arrow: false,\r\n      offset: [0, 0]\r\n    });\r\n    this.toolbar.elem().classList.remove('hidden');\r\n  }\r\n\r\n  public startButtonGroup() {\r\n    this.currentButtonGroup = div('btn-group');\r\n    this.toolbar.append(this.currentButtonGroup);\r\n  }\r\n\r\n  public endButtonGroup() {\r\n    this.currentButtonGroup = null;\r\n  }\r\n\r\n  public close() {\r\n    this.hide();\r\n    if (this.onclose) this.onclose();\r\n  }\r\n\r\n  show() { this.winElement.classList.remove('hidden') }\r\n  hide() { this.winElement.classList.add('hidden') }\r\n\r\n  setPosition(x: string | number, y: string | number): void {\r\n    const actualX = typeof x == 'number' ? x + 'px' : x;\r\n    const actualY = typeof y == 'number' ? y + 'px' : y;\r\n    this.winElement.style.left = actualX;\r\n    this.winElement.style.top = actualY;\r\n  }\r\n}\r\n\r\nclass PhotonWindowBuilder implements WindowBuilder {\r\n  private _id: string;\r\n  private _title: string;\r\n  private _draggable = false;\r\n  private _centered = true;\r\n  private _closeable = true;\r\n  private _onclose: () => void;\r\n  private _w = 250;\r\n  private _h = 250;\r\n  private _toolbar: PhotonToolbarBuilder;\r\n  private _content: HTMLElement;\r\n\r\n  public id(id: string) { this._id = id; return this }\r\n  public title(title: string) { this._title = title; return this }\r\n  public draggable(draggable: boolean) { this._draggable = draggable; return this }\r\n  public centered(centered: boolean) { this._centered = centered; return this }\r\n  public closeable(closeable: boolean) { this._closeable = closeable; return this }\r\n  public onclose(h: () => void) { this._onclose = h; return this }\r\n  public size(w: number, h: number) { this._w = w; this._h = h; return this }\r\n  public toolbar(toolbar: PhotonToolbarBuilder) { this._toolbar = toolbar; return this }\r\n  public content(content: HTMLElement) { this._content = content; return this; }\r\n\r\n  public build() {\r\n    const win = new PhotonWindow(this._id, this._title, this._w, this._h, this._draggable, this._centered, this._closeable);\r\n    win.onclose = this._onclose;\r\n    if (this._toolbar) this._toolbar.build(win);\r\n    if (this._content) win.contentElement.appendChild(this._content);\r\n    return win;\r\n  }\r\n}\r\n\r\ninterface ToolbarItemBuilder { build(window: PhotonWindow): void }\r\n\r\nclass ToolbarGroupBuilder implements ToolbarItemBuilder {\r\n  items: ToolbarItemBuilder[] = [];\r\n\r\n  add(item: ToolbarItemBuilder) {\r\n    this.items.push(item);\r\n  }\r\n\r\n  build(window: PhotonWindow): void {\r\n    window.startButtonGroup();\r\n    for (const i of this.items) i.build(window);\r\n    window.endButtonGroup();\r\n  }\r\n}\r\n\r\nclass PhotonToolbarBuilder implements ToolbarBuilder {\r\n  groups: ToolbarItemBuilder[] = [];\r\n  currentGroup: ToolbarGroupBuilder = null;\r\n\r\n  startGroup(): ToolbarBuilder {\r\n    if (this.currentGroup != null) this.groups.push(this.currentGroup);\r\n    this.currentGroup = new ToolbarGroupBuilder();\r\n    return this;\r\n  }\r\n\r\n  endGroup(): ToolbarBuilder {\r\n    this.groups.push(this.currentGroup);\r\n    this.currentGroup = null;\r\n    return this;\r\n  }\r\n\r\n  private addItem(item: ToolbarItemBuilder) {\r\n    if (this.currentGroup == null) this.groups.push(item);\r\n    else this.currentGroup.add(item);\r\n  }\r\n\r\n  button(icon: string, click: () => void): ToolbarBuilder {\r\n    const item = { build(window: PhotonWindow) { window.addToolIconButton(icon, click) } };\r\n    this.addItem(item);\r\n    return this;\r\n  }\r\n\r\n  menuButton(icon: string, menu: MenuBuilder): ToolbarBuilder {\r\n    const item = { build(window: PhotonWindow) { window.addToolMenuButton(icon, menu) } };\r\n    this.addItem(item);\r\n    return this;\r\n  }\r\n\r\n  search(hint: string, change: (s: string, sugg: HTMLElement) => void): ToolbarBuilder {\r\n    const item = { build(window: PhotonWindow) { window.addToolSearch(hint, change) } };\r\n    this.addItem(item);\r\n    return this;\r\n  }\r\n\r\n  widget(widget: HTMLElement): ToolbarBuilder {\r\n    const item = { build(window: PhotonWindow) { window.addToolbarWidget(widget) } };\r\n    this.addItem(item);\r\n    return this;\r\n  }\r\n\r\n  build(window: PhotonWindow) {\r\n    for (const group of this.groups) group.build(window);\r\n  }\r\n}\r\n\r\nclass PhotonMenuBuilder implements MenuBuilder {\r\n  private items: [string, () => void][] = [];\r\n\r\n  item(text: string, click: () => void): MenuBuilder {\r\n    this.items.push([text, click]);\r\n    return this;\r\n  }\r\n\r\n  build(elem: HTMLElement) {\r\n    const menu = div('menu menu-default');\r\n    let instance = null;\r\n    for (const [label, click] of this.items) menu.append(div('menu-item').text(label).click(() => { click(), instance.hide(); }));\r\n    instance = tippy(elem, {\r\n      content: menu.elem(),\r\n      allowHTML: true,\r\n      placement: 'bottom-start',\r\n      trigger: 'click',\r\n      interactive: true,\r\n      arrow: false,\r\n      offset: [0, 0],\r\n      duration: 100,\r\n      appendTo: document.body\r\n    });\r\n  }\r\n}\r\n\r\nclass Builder implements UiBuilder {\r\n  window() { return new PhotonWindowBuilder() }\r\n  toolbar() { return new PhotonToolbarBuilder() }\r\n  menu() { return new PhotonMenuBuilder() }\r\n}\r\n\r\nexport function PhotonUiModule(module: Module) {\r\n  document.body.oncontextmenu = () => false;\r\n  module.bindInstance(UI, { builder: new Builder() });\r\n}","import { Dependency, Injector } from \"../../utils/injector\";\r\nimport { span, Table } from \"../../utils/ui/ui\";\r\nimport { UI, Window } from \"../apis/ui\";\r\n\r\nexport const MAP_NAMES = new Dependency<() => Promise<string[]>>('MapNames');\r\n\r\nlet selectMapWindow: Window;\r\nasync function getWindow(injector: Injector) {\r\n  const ui = await injector.getInstance(UI);\r\n  if (selectMapWindow == null) {\r\n    selectMapWindow = ui.builder.window()\r\n      .id('map_select')\r\n      .title('Select Map')\r\n      .closeable(true)\r\n      .size(350, 600)\r\n      .build();\r\n  }\r\n  return selectMapWindow;\r\n}\r\n\r\nexport function showMapSelection(injector: Injector): Promise<string> {\r\n  return new Promise(async resolve => {\r\n    const mapNamesProvider = await injector.getInstance(MAP_NAMES);\r\n    const mapNames = await mapNamesProvider();\r\n    const win = await getWindow(injector);\r\n    win.onclose = () => resolve(null);\r\n    const table = new Table();\r\n    table.className(\"table-striped\");\r\n    mapNames.forEach(map => table.row([span().text(map)]).click(() => {\r\n      win.hide();\r\n      resolve(map);\r\n    }));\r\n    const lastTable = win.contentElement.firstChild;\r\n    if (lastTable) win.contentElement.removeChild(lastTable);\r\n    win.contentElement.appendChild(table.elem());\r\n    win.show();\r\n  })\r\n}","import h from \"stage0\";\r\nimport { create, Module } from \"../../utils/injector\";\r\nimport * as PROFILE from \"../../utils/profiler\";\r\nimport { View, VIEW } from \"../apis/app\";\r\nimport { BUS, MessageHandlerReflective } from \"../apis/handler\";\r\nimport { PostFrame } from \"../edit/messages\";\r\n\r\n\r\nexport async function StatusBarModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    bus.connect(await create(injector, Statusbar, VIEW));\r\n  });\r\n}\r\n\r\nconst positionBoxTemplate = h`\r\n  <span class=\"title padded-horizontally-less\">Position:\r\n    <span style=\"width: 45px; display: inline-block; text-align: right;\">#posx</span>,\r\n    <span style=\"width: 45px; display: inline-block; text-align: left;\">#posy</span>\r\n  </span>\r\n`\r\nfunction PositionBox(): [Node, (x: number, y: number) => void] {\r\n  const root = positionBoxTemplate;\r\n  const { posx, posy } = positionBoxTemplate.collect(root);\r\n  let cachedPosX = 0;\r\n  let cachedPosY = 0;\r\n  const update = (x: number, y: number) => {\r\n    if (x != cachedPosX) {\r\n      cachedPosX = x;\r\n      posx.nodeValue = `[${x}`;\r\n    }\r\n    if (y != cachedPosY) {\r\n      cachedPosY = y;\r\n      posy.nodeValue = `${y}]`;\r\n    }\r\n  }\r\n\r\n  return [root, update];\r\n}\r\n\r\nconst valueBoxTemplate = h`<span class=\"title padded-horizontally-less\">#nameNode<span style=\"display: inline-block;\">#valueNode</span></span>`;\r\nfunction ValueBox(name: String, size: number): [Node, (value: any) => void] {\r\n  const root = valueBoxTemplate.cloneNode(true);\r\n  const { nameNode, valueNode } = valueBoxTemplate.collect(root);\r\n  nameNode.nodeValue = `${name}: `;\r\n  valueNode.parentElement.style.width = `${size}px`;\r\n  let cachedValue = null;\r\n  const update = (value: any) => {\r\n    if (value != cachedValue) {\r\n      valueNode.nodeValue = value;\r\n      cachedValue = value;\r\n    }\r\n  }\r\n  return [root, update];\r\n}\r\n\r\nconst statusBarTemplate = h`<span class=\"pull-right\" #statusbar></span>`;\r\nfunction StatusBar() {\r\n  const root = statusBarTemplate;\r\n  const { statusbar } = statusBarTemplate.collect(root);\r\n  const [posBox, posUpdate] = PositionBox();\r\n  const [sectorBox, sectorUpdate] = ValueBox('Sector', 25);\r\n  const [drawsBox, drawsUpdate] = ValueBox('Draws', 85);\r\n  const [fpsBox, fpsUpdate] = ValueBox('FPS', 35);\r\n  statusbar.appendChild(posBox);\r\n  statusbar.appendChild(sectorBox);\r\n  statusbar.appendChild(drawsBox);\r\n  statusbar.appendChild(fpsBox);\r\n  return { root, updaters: { posUpdate, sectorUpdate, drawsUpdate, fpsUpdate } };\r\n}\r\n\r\nexport class Statusbar extends MessageHandlerReflective {\r\n  private updaters: {\r\n    posUpdate: (x: number, y: number) => void;\r\n    sectorUpdate: (value: any) => void;\r\n    drawsUpdate: (value: any) => void;\r\n    fpsUpdate: (value: any) => void;\r\n  };\r\n\r\n  constructor(private view: View) {\r\n    super();\r\n    const { root, updaters } = StatusBar();\r\n    document.getElementById('footer').appendChild(root);\r\n    this.updaters = updaters;\r\n  }\r\n\r\n  public PostFrame(msg: PostFrame) {\r\n    const view = this.view;\r\n    const profile = PROFILE.get(null);\r\n    const draws = profile.counts['drawsRequested'] ?? 0;\r\n    const skips = profile.counts['drawsMerged'] ?? 0;\r\n    this.updaters.posUpdate(view.x, view.y);\r\n    this.updaters.sectorUpdate(view.sec);\r\n    this.updaters.fpsUpdate((1000 / profile.time).toFixed(0));\r\n    this.updaters.drawsUpdate(draws + ' / ' + (draws - skips));\r\n  }\r\n}\r\n","import { create, Injector, Module } from \"../../utils/injector\";\r\nimport { iter } from \"../../utils/iter\";\r\nimport { GridModel, renderGrid } from \"../../utils/ui/renderers\";\r\nimport { div, Element, replaceContent, span, tag } from \"../../utils/ui/ui\";\r\nimport { ScheddulerHandler, Scheduler, SCHEDULER, SchedulerTask, TaskHandle } from \"../apis/app\";\r\nimport { BUS } from \"../apis/handler\";\r\nimport { UI, Ui, Window } from \"../apis/ui\";\r\nimport { namedMessageHandler } from \"../edit/messages\";\r\n\r\n\r\nclass TaskWidget {\r\n  private updateHandler: (s: string, progress: number) => void;\r\n  constructor(readonly handle: TaskHandle) { }\r\n  setUpdateHandler(handler: (s: string, progress: number) => void) { this.updateHandler = handler }\r\n  update() { if (this.updateHandler != null) this.updateHandler(this.handle.getDescription(), this.handle.getProgress()) }\r\n}\r\n\r\nfunction TaskWidgetRenderer(w: TaskWidget): Element {\r\n  const progress = tag('progress')\r\n    .css('width', '90%')\r\n    .css('height', '30px')\r\n    .attr('max', \"100\");\r\n  const cancel = span()\r\n    .className('icon icon-cancel-circled')\r\n    .css('font-size', '20px')\r\n    .css('color', '#666')\r\n    .css('float', 'right')\r\n    .click(() => w.handle.stop());\r\n  const descr = div('description')\r\n    .css('padding-left', '10px');\r\n  const container = div('task-container')\r\n    .css('width', 'auto')\r\n    .append(progress)\r\n    .append(descr);\r\n  w.setUpdateHandler((s, p) => {\r\n    progress.attr('value', p);\r\n    descr.text(s);\r\n  });\r\n  return div('task').append(cancel).append(container);\r\n}\r\n\r\nclass TaskManager implements ScheddulerHandler {\r\n  private tasks: TaskHandle[] = [];\r\n  private taskWidgets: TaskWidget[] = [];\r\n  private window: Window;\r\n  private active = false;\r\n\r\n  constructor(\r\n    ui: Ui,\r\n    scheduler: Scheduler\r\n  ) {\r\n    this.window = ui.builder.window()\r\n      .title('Tasks')\r\n      .draggable(true)\r\n      .closeable(true)\r\n      .centered(true)\r\n      .size(600, 600)\r\n      .build();\r\n    this.window.onclose = () => this.active = false;\r\n    scheduler.addHandler(this);\r\n    for (const task of scheduler.currentTasks()) this.onTaskAdd(task);\r\n  }\r\n\r\n  onTaskAdd(task: TaskHandle): void {\r\n    this.tasks.push(task);\r\n    this.taskWidgets.push(new TaskWidget(task));\r\n    this.refreshGrid();\r\n  }\r\n\r\n  onTaskStop(task: TaskHandle): void {\r\n    const idx = this.tasks.indexOf(task);\r\n    if (idx != -1) {\r\n      this.tasks.splice(idx, 1);\r\n      this.taskWidgets.splice(idx, 1);\r\n      this.refreshGrid();\r\n    }\r\n  }\r\n\r\n  onTaskUpdate(task: TaskHandle): void {\r\n    if (!this.active) return;\r\n    const idx = this.tasks.indexOf(task);\r\n    if (idx != -1) this.taskWidgets[idx].update();\r\n  }\r\n\r\n  private gridModel = this.createGridModel();\r\n  private createGridModel(): GridModel {\r\n    const columns = [TaskWidgetRenderer];\r\n    const self = this;\r\n    return {\r\n      async rows() { return iter(self.taskWidgets).map(f => [f]) },\r\n      columns() { return columns },\r\n      onClick(row: any[], rowElement: Element) { }\r\n    }\r\n  }\r\n\r\n  private async refreshGrid() {\r\n    if (!this.active) return;\r\n    replaceContent(this.window.contentElement, (await renderGrid(this.gridModel)).elem());\r\n  }\r\n\r\n  public async show() {\r\n    this.active = true;\r\n    await this.refreshGrid();\r\n    this.window.show()\r\n  }\r\n}\r\n\r\nlet manager: TaskManager;\r\nasync function getTaskManager(injector: Injector) {\r\n  if (manager == null) manager = await create(injector, TaskManager, UI, SCHEDULER);\r\n  return manager;\r\n}\r\n\r\nexport async function showTasks(injector: Injector) {\r\n  const browser = await getTaskManager(injector);\r\n  browser.show();\r\n}\r\n\r\nfunction* task(): SchedulerTask {\r\n  let handler = yield;\r\n  for (let i = 0; i < 100; i++) {\r\n    handler.setDescription(`Task ${i}%`);\r\n    handler.setProgress(i);\r\n    yield;\r\n  }\r\n}\r\n\r\nexport async function TaskManagerModule(module: Module) {\r\n  module.execute(async injector => {\r\n    const bus = await injector.getInstance(BUS);\r\n    const scheduler = await injector.getInstance(SCHEDULER);\r\n    bus.connect(namedMessageHandler('show_tasks', () => showTasks(injector)));\r\n    bus.connect(namedMessageHandler('add_test_task', () => scheduler.addTask(task())));\r\n  });\r\n}\r\n","import { Board } from '../../../build/board/structs';\r\nimport { AllBoardVisitorResult, VisResult } from '../../../build/boardvisitor';\r\nimport { mat4, Vec3Array } from '../../../libs_js/glmatrix';\r\nimport { Controller2D } from '../../../utils/camera/controller2d';\r\nimport { Deck } from '../../../utils/collections';\r\nimport { Injector } from '../../../utils/injector';\r\nimport * as PROFILE from '../../../utils/profiler';\r\nimport { BOARD, BoardProvider } from '../../apis/app';\r\nimport { BuildRenderableProvider, HELPER_GRID, SPRITE_LABEL, Renderable, SortingRenderable } from '../../apis/renderable';\r\nimport { GRID_SECTOR_MATRIX } from '../geometry/builders/common';\r\nimport { RENDRABLES_CACHE } from '../geometry/cache';\r\nimport { BuildersFactory, BUILDERS_FACTORY, GridBuilder } from '../geometry/common';\r\nimport { BuildGl, BUILD_GL } from '../gl/buildgl';\r\nimport { View2d } from './view2d';\r\n\r\nconst visible = new AllBoardVisitorResult();\r\n\r\nexport async function Renderer2D(injector: Injector) {\r\n  const [bgl, builders, renderables, board] = await Promise.all([\r\n    injector.getInstance(BUILD_GL),\r\n    injector.getInstance(BUILDERS_FACTORY),\r\n    injector.getInstance(RENDRABLES_CACHE),\r\n    injector.getInstance(BOARD),\r\n  ]);\r\n  return new BoardRenderer2D(bgl, builders, renderables.topdown, board);\r\n}\r\n\r\nexport class BoardRenderer2D {\r\n  private grid: GridBuilder;\r\n  private upp = 1;\r\n  private surfaces = new Deck<Renderable>();\r\n  private pass = new SortingRenderable(this.surfaces, kind => {\r\n    const spriteLabel = kind & SPRITE_LABEL && this.upp > 20;\r\n    const gridHelper = kind & HELPER_GRID;\r\n    return !spriteLabel && !gridHelper;\r\n  });\r\n\r\n  constructor(\r\n    private bgl: BuildGl,\r\n    private builders: BuildersFactory,\r\n    private renderables: BuildRenderableProvider,\r\n    private board: BoardProvider\r\n  ) { }\r\n\r\n  private getGrid() {\r\n    if (this.grid != null) return this.grid;\r\n    const gridSolid = this.builders.solid('utils');\r\n    gridSolid.trans = 0.2;\r\n    const buff = gridSolid.buff;\r\n    const size = 1024 * 1024;\r\n    buff.allocate(4, 6);\r\n    buff.writePos(0, -size, 0, size);\r\n    buff.writePos(1, size, 0, size);\r\n    buff.writePos(2, size, 0, -size);\r\n    buff.writePos(3, -size, 0, -size);\r\n    buff.writeTcLighting(0, -1, 1);\r\n    buff.writeTcLighting(1, 1, 1);\r\n    buff.writeTcLighting(2, 1, -1);\r\n    buff.writeTcLighting(3, -1, 1);\r\n    buff.writeQuad(0, 3, 2, 1, 0);\r\n    this.grid = this.builders.grid('');\r\n    this.grid.range = size;\r\n    mat4.copy(this.grid.gridTexMat, GRID_SECTOR_MATRIX);\r\n    this.grid.solid = gridSolid;\r\n    return this.grid;\r\n  }\r\n\r\n  public drawTools(p: Iterable<Renderable>) {\r\n    this.bgl.gl.disable(WebGLRenderingContext.DEPTH_TEST);\r\n    this.bgl.gl.enable(WebGLRenderingContext.BLEND);\r\n    this.surfaces.clear().pushAll(p);\r\n    this.bgl.modulation(0.984, 0.78, 0.118, 1);\r\n    this.bgl.draw(this.pass);\r\n    this.bgl.flush();\r\n    this.bgl.gl.disable(WebGLRenderingContext.BLEND);\r\n    this.bgl.gl.enable(WebGLRenderingContext.DEPTH_TEST);\r\n  }\r\n\r\n  public draw(view: View2d, campos: Vec3Array, dist: number, controller: Controller2D) {\r\n    PROFILE.startProfile('processing');\r\n    this.upp = controller.getUnitsPerPixel();\r\n    const result = visible.visit(this.board());\r\n    PROFILE.endProfile();\r\n\r\n    this.bgl.setProjectionMatrix(view.getProjectionMatrix());\r\n    this.bgl.setViewMatrix(view.getTransformMatrix());\r\n    this.bgl.setPosition(view.getPosition());\r\n\r\n    this.bgl.gl.disable(WebGLRenderingContext.DEPTH_TEST);\r\n    this.bgl.gl.enable(WebGLRenderingContext.BLEND);\r\n    this.bgl.draw(this.getGrid());\r\n    this.bgl.flush();\r\n    this.bgl.gl.disable(WebGLRenderingContext.BLEND);\r\n\r\n    this.drawRooms(result);\r\n    this.bgl.gl.enable(WebGLRenderingContext.DEPTH_TEST);\r\n  }\r\n\r\n  private clearDrawLists() {\r\n    this.surfaces.clear();\r\n  }\r\n\r\n  private sectorVisitor_ = (board: Board, sectorId: number) => this.sectorVisitor(board, sectorId);\r\n  private sectorVisitor(board: Board, sectorId: number) {\r\n    this.surfaces.push(this.renderables.sector(sectorId));\r\n    PROFILE.incCount('sectors');\r\n  }\r\n\r\n  private wallVisitor_ = (board: Board, wallId: number, sectorId: number) => this.wallVisitor(board, wallId, sectorId);\r\n  private wallVisitor(board: Board, wallId: number, sectorId: number) {\r\n    this.surfaces.push(this.renderables.wall(wallId));\r\n    PROFILE.incCount('walls');\r\n  }\r\n\r\n  private spriteVisitor_ = (board: Board, spriteId: number) => this.spriteVisitor(board, spriteId);\r\n  private spriteVisitor(board: Board, spriteId: number) {\r\n    this.surfaces.push(this.renderables.sprite(spriteId));\r\n    PROFILE.incCount('sprites');\r\n  }\r\n\r\n  private drawRooms(result: VisResult) {\r\n    PROFILE.startProfile('processing');\r\n    this.clearDrawLists();\r\n    const board = this.board();\r\n    result.forSector(board, this.sectorVisitor_);\r\n    result.forWall(board, this.wallVisitor_);\r\n    result.forSprite(board, this.spriteVisitor_);\r\n    PROFILE.endProfile();\r\n\r\n    PROFILE.startProfile('draw');\r\n    this.bgl.draw(this.pass);\r\n    this.bgl.flush();\r\n    PROFILE.endProfile();\r\n  }\r\n}\r\n\r\n\r\n\r\n","import { Board } from '../../../build/board/structs';\r\nimport { AllBoardVisitorResult, createSectorCollector, createWallCollector, PvsBoardVisitorResult, unpackWallId, VisResult } from '../../../build/boardvisitor';\r\nimport { wallVisible, ZSCALE } from '../../../build/utils';\r\nimport { mat4, vec2, vec3 } from '../../../libs_js/glmatrix';\r\nimport { Deck } from '../../../utils/collections';\r\nimport { Dependency, Injector } from '../../../utils/injector';\r\nimport { dot2d } from '../../../utils/mathutils';\r\nimport * as PROFILE from '../../../utils/profiler';\r\nimport { mirrorBasis, normal2d, reflectPoint3d } from '../../../utils/vecmath';\r\nimport { BOARD, BoardProvider } from '../../apis/app';\r\nimport { BuildRenderableProvider, DrawCallConsumer, Renderable, SortingRenderable } from '../../apis/renderable';\r\nimport { RENDRABLES_CACHE } from '../geometry/cache';\r\nimport { BuildGl, BUILD_GL } from '../gl/buildgl';\r\nimport { View3d } from './view3d';\r\n\r\nexport class RorLink {\r\n  constructor(readonly srcSpriteId: number, readonly dstSpriteId: number) { }\r\n}\r\n\r\nexport class RorLinks {\r\n  public ceilLinks: { [index: number]: RorLink } = {};\r\n  public floorLinks: { [index: number]: RorLink } = {};\r\n\r\n  public hasRor(sectorId: number) {\r\n    return this.ceilLinks[sectorId] != undefined || this.floorLinks[sectorId] != undefined;\r\n  }\r\n}\r\n\r\nexport interface Implementation {\r\n  rorLinks: () => RorLinks;\r\n  isMirrorPic(picnum: number): boolean;\r\n}\r\nexport const Implementation_ = new Dependency<Implementation>('Implementation');\r\n\r\n\r\nconst visible = new PvsBoardVisitorResult();\r\nconst all = new AllBoardVisitorResult();\r\nconst rorViss = new Map<RorLink, PvsBoardVisitorResult>();\r\nconst diff = vec3.create();\r\nconst stackTransform = mat4.create();\r\nconst srcPos = vec3.create();\r\nconst dstPos = vec3.create();\r\nconst npos = vec3.create();\r\nconst mstmp = { sec: 0, x: 0, y: 0, z: 0 };\r\nconst mirrorVis = new PvsBoardVisitorResult();\r\nconst wallNormal = vec2.create();\r\nconst mirrorNormal = vec3.create();\r\nconst mirroredTransform = mat4.create();\r\nconst mpos = vec3.create();\r\nconst polyOffsetOn = (bgl: BuildGl) => { bgl.gl.polygonOffset(0, -8) };\r\nconst polyOffsetOff = (bgl: BuildGl) => { bgl.gl.polygonOffset(0, 0) };\r\nconst blendOn = (bgl: BuildGl) => { bgl.gl.enable(WebGLRenderingContext.BLEND) };\r\nconst blendOff = (bgl: BuildGl) => { bgl.gl.disable(WebGLRenderingContext.BLEND) };\r\n\r\nfunction list() {\r\n  const list = new Deck<Renderable>();\r\n  const renderable = new SortingRenderable(list);\r\n  return {\r\n    add: (r: Renderable) => { list.push(r) },\r\n    clear: () => list.clear(),\r\n    drawCall: (consumer: DrawCallConsumer) => { renderable.drawCall(consumer) }\r\n  }\r\n}\r\n\r\nexport async function Renderer3D(injector: Injector) {\r\n  const [impl, bgl, board, renderables] = await Promise.all([\r\n    injector.getInstance(Implementation_),\r\n    injector.getInstance(BUILD_GL),\r\n    injector.getInstance(BOARD),\r\n    injector.getInstance(RENDRABLES_CACHE),\r\n  ]);\r\n  return new Boardrenderer3D(impl, bgl, board, renderables.geometry);\r\n}\r\n\r\nexport class Boardrenderer3D {\r\n  constructor(\r\n    private impl: Implementation,\r\n    private bgl: BuildGl,\r\n    private board: BoardProvider,\r\n    private renderables: BuildRenderableProvider\r\n  ) { }\r\n\r\n  public drawTools(p: Iterable<Renderable>) {\r\n    this.bgl.gl.disable(WebGLRenderingContext.DEPTH_TEST);\r\n    this.bgl.gl.enable(WebGLRenderingContext.BLEND);\r\n    this.surfaces.clear().pushAll(p);\r\n    this.bgl.modulation(0.984, 0.78, 0.118, 1);\r\n    this.bgl.draw(this.surfaces);\r\n    this.bgl.flush();\r\n    this.bgl.gl.disable(WebGLRenderingContext.BLEND);\r\n    this.bgl.gl.enable(WebGLRenderingContext.DEPTH_TEST);\r\n  }\r\n\r\n  public draw(view: View3d) {\r\n    this.drawGeometry(view);\r\n  }\r\n\r\n  private writeStencilOnly(value: number) {\r\n    this.bgl.gl.stencilFunc(WebGLRenderingContext.ALWAYS, value, 0xff);\r\n    this.bgl.gl.stencilOp(WebGLRenderingContext.KEEP, WebGLRenderingContext.KEEP, WebGLRenderingContext.REPLACE);\r\n    this.bgl.gl.stencilMask(0xff);\r\n    this.bgl.gl.depthMask(false);\r\n    this.bgl.gl.colorMask(false, false, false, false);\r\n  }\r\n\r\n  private writeStenciledOnly(value: number) {\r\n    this.bgl.gl.stencilFunc(WebGLRenderingContext.EQUAL, value, 0xff);\r\n    this.bgl.gl.stencilMask(0x0);\r\n    this.bgl.gl.depthMask(true);\r\n    this.bgl.gl.colorMask(true, true, true, true);\r\n  }\r\n\r\n  private writeDepthOnly() {\r\n    this.bgl.gl.colorMask(false, false, false, false);\r\n  }\r\n\r\n  private writeAll() {\r\n    this.bgl.gl.depthMask(true);\r\n    this.bgl.gl.colorMask(true, true, true, true);\r\n  }\r\n\r\n  private drawGeometry(view: View3d) {\r\n    PROFILE.startProfile('processing');\r\n    const board = this.board();\r\n    let result = view.sec == -1\r\n      ? all.visit(board)\r\n      : visible.visit(board, view, view.getForward());\r\n    PROFILE.endProfile();\r\n\r\n    this.bgl.setProjectionMatrix(view.getProjectionMatrix());\r\n    this.drawMirrors(result, view);\r\n    this.drawRor(result, view);\r\n\r\n    this.bgl.setViewMatrix(view.getTransformMatrix());\r\n    this.bgl.setPosition(view.getPosition());\r\n    this.drawRooms(result);\r\n  }\r\n\r\n\r\n  private getLinkVis(link: RorLink) {\r\n    let vis = rorViss.get(link);\r\n    if (vis == undefined) {\r\n      vis = new PvsBoardVisitorResult();\r\n      rorViss.set(link, vis);\r\n    }\r\n    return vis;\r\n  }\r\n\r\n  private drawStack(view: View3d, link: RorLink, surface: Renderable, stencilValue: number) {\r\n    if (!link) return;\r\n    this.bgl.setViewMatrix(view.getTransformMatrix());\r\n    this.bgl.setPosition(view.getPosition());\r\n    this.writeStencilOnly(stencilValue);\r\n    this.bgl.draw(surface);\r\n    this.bgl.flush();\r\n\r\n    const board = this.board();\r\n    const src = board.sprites[link.srcSpriteId];\r\n    const dst = board.sprites[link.dstSpriteId];\r\n    vec3.set(srcPos, src.x, src.z / ZSCALE, src.y);\r\n    vec3.set(dstPos, dst.x, dst.z / ZSCALE, dst.y);\r\n    vec3.sub(diff, srcPos, dstPos);\r\n    mat4.copy(stackTransform, view.getTransformMatrix());\r\n    mat4.translate(stackTransform, stackTransform, diff);\r\n    vec3.sub(npos, view.getPosition(), diff);\r\n\r\n    mstmp.sec = dst.sectnum; mstmp.x = npos[0]; mstmp.y = npos[2]; mstmp.z = npos[1] * ZSCALE;\r\n    this.bgl.setViewMatrix(stackTransform);\r\n    this.bgl.setPosition(npos);\r\n    this.writeStenciledOnly(stencilValue);\r\n    this.drawRooms(this.getLinkVis(link).visit(this.board(), mstmp, view.getForward()));\r\n\r\n    this.bgl.setViewMatrix(view.getTransformMatrix());\r\n    this.bgl.setPosition(view.getPosition());\r\n    this.writeDepthOnly();\r\n    this.bgl.draw(surface);\r\n    this.bgl.flush();\r\n  }\r\n\r\n  private rorSectorCollector = createSectorCollector((board: Board, sectorId: number) => this.impl.rorLinks().hasRor(sectorId));\r\n  private drawRor(result: VisResult, view: View3d) {\r\n    result.forSector(this.board(), this.rorSectorCollector.visit());\r\n    PROFILE.get(null).inc('rors', this.rorSectorCollector.sectors.length());\r\n\r\n    this.bgl.gl.enable(WebGLRenderingContext.STENCIL_TEST);\r\n    for (let i = 0; i < this.rorSectorCollector.sectors.length(); i++) {\r\n      const s = this.rorSectorCollector.sectors.get(i);\r\n      const r = this.renderables.sector(s);\r\n      this.drawStack(view, this.impl.rorLinks().ceilLinks[s], r.ceiling, i + 1);\r\n      this.drawStack(view, this.impl.rorLinks().floorLinks[s], r.floor, i + 1);\r\n    }\r\n    this.bgl.gl.disable(WebGLRenderingContext.STENCIL_TEST);\r\n    this.writeAll();\r\n  }\r\n\r\n  private mirrorWallsCollector = createWallCollector((board: Board, wallId: number, sectorId: number) => this.impl.isMirrorPic(board.walls[wallId].picnum));\r\n  private drawMirrors(result: VisResult, view: View3d) {\r\n    const board = this.board();\r\n    result.forWall(board, this.mirrorWallsCollector.visit());\r\n    PROFILE.get(null).inc('mirrors', this.mirrorWallsCollector.walls.length());\r\n    this.bgl.gl.enable(WebGLRenderingContext.STENCIL_TEST);\r\n    for (let i = 0; i < this.mirrorWallsCollector.walls.length(); i++) {\r\n      const w = unpackWallId(this.mirrorWallsCollector.walls.get(i));\r\n      if (!wallVisible(board, w, view)) continue;\r\n\r\n      // draw mirror surface into stencil\r\n      const r = this.renderables.wall(w);\r\n      this.bgl.setViewMatrix(view.getTransformMatrix());\r\n      this.bgl.setPosition(view.getPosition());\r\n      this.writeStencilOnly(i + 127);\r\n      this.bgl.draw(r);\r\n      this.bgl.flush();\r\n\r\n      // draw reflections in stenciled area\r\n      const w1 = board.walls[w]; const w2 = board.walls[w1.point2];\r\n      vec2.set(wallNormal, w2.x - w1.x, w2.y - w1.y);\r\n      normal2d(wallNormal, wallNormal);\r\n      vec3.set(mirrorNormal, wallNormal[0], 0, wallNormal[1]);\r\n      const mirrorrD = -dot2d(wallNormal[0], wallNormal[1], w1.x, w1.y);\r\n      mirrorBasis(mirroredTransform, view.getTransformMatrix(), view.getPosition(), mirrorNormal, mirrorrD);\r\n\r\n      this.bgl.setViewMatrix(mirroredTransform);\r\n      this.bgl.setClipPlane(mirrorNormal[0], mirrorNormal[1], mirrorNormal[2], mirrorrD);\r\n      this.bgl.gl.cullFace(WebGLRenderingContext.FRONT);\r\n      vec3.copy(mpos, view.getPosition());\r\n      reflectPoint3d(mpos, mirrorNormal, mirrorrD, mpos);\r\n      mstmp.sec = view.sec; mstmp.x = mpos[0]; mstmp.y = mpos[2]; mstmp.z = mpos[1];\r\n      this.writeStenciledOnly(i + 127);\r\n      this.drawRooms(mirrorVis.visit(board, mstmp, view.getForward()));\r\n      this.bgl.gl.cullFace(WebGLRenderingContext.BACK);\r\n\r\n      // seal reflections by writing depth of mirror surface\r\n      this.bgl.setViewMatrix(view.getTransformMatrix());\r\n      this.writeDepthOnly();\r\n      this.bgl.setClipPlane(0, 0, 0, 0);\r\n      this.bgl.draw(r);\r\n      this.bgl.flush();\r\n    }\r\n    this.bgl.gl.disable(WebGLRenderingContext.STENCIL_TEST);\r\n    this.writeAll();\r\n  }\r\n\r\n  private surfaces = list();\r\n  private surfacesTrans = list();\r\n  private sprites = list();\r\n  private spritesTrans = list();\r\n\r\n  private clearDrawLists() {\r\n    this.surfaces.clear();\r\n    this.surfacesTrans.clear();\r\n    this.sprites.clear();\r\n    this.spritesTrans.clear();\r\n  }\r\n\r\n  private _sectorVisitor = (board: Board, sectorId: number) => this.sectorVisitor(board, sectorId);\r\n  private sectorVisitor(board: Board, sectorId: number) {\r\n    const sector = this.renderables.sector(sectorId);\r\n    if (this.impl.rorLinks().floorLinks[sectorId] == undefined)\r\n      this.surfaces.add(sector.floor);\r\n    if (this.impl.rorLinks().ceilLinks[sectorId] == undefined)\r\n      this.surfaces.add(sector.ceiling);\r\n    PROFILE.incCount('sectors');\r\n  }\r\n\r\n  private _wallVisitor = (board: Board, wallId: number, sectorId: number) => this.wallVisitor(board, wallId, sectorId);\r\n  private wallVisitor(board: Board, wallId: number, sectorId: number) {\r\n    if (this.impl.isMirrorPic(board.walls[wallId].picnum)) return;\r\n    const wall = board.walls[wallId];\r\n    const wallr = this.renderables.wall(wallId);\r\n    if (wall.cstat.translucent == 1 || wall.cstat.translucentReversed == 1) {\r\n      this.surfacesTrans.add(wallr.mid);\r\n      this.surfaces.add(wallr.bot);\r\n      this.surfaces.add(wallr.top);\r\n    } else if (wall.nextwall == -1) {\r\n      this.surfaces.add(wallr.mid);\r\n    } else {\r\n      this.surfaces.add(wallr);\r\n    }\r\n    PROFILE.incCount('walls');\r\n  }\r\n\r\n  private _spriteVisitor = (board: Board, spriteId: number) => this.spriteVisitor(board, spriteId);\r\n  private spriteVisitor(board: Board, spriteId: number) {\r\n    const spriter = this.renderables.sprite(spriteId);\r\n    const sprite = board.sprites[spriteId];\r\n    const trans = sprite.cstat.translucent == 1 || sprite.cstat.tranclucentReversed == 1;\r\n    (trans ? this.spritesTrans : this.sprites).add(spriter);\r\n    PROFILE.incCount('sprites');\r\n  }\r\n\r\n  private drawRooms(result: VisResult) {\r\n    PROFILE.startProfile('processing');\r\n    this.clearDrawLists();\r\n    const board = this.board();\r\n    result.forSector(board, this._sectorVisitor);\r\n    result.forWall(board, this._wallVisitor);\r\n    result.forSprite(board, this._spriteVisitor);\r\n    PROFILE.endProfile();\r\n\r\n    PROFILE.startProfile('draw');\r\n    this.drawImpl();\r\n    PROFILE.endProfile();\r\n  }\r\n\r\n  private drawImpl() {\r\n    this.bgl.draw(this.surfaces);\r\n    this.bgl.flush();\r\n    polyOffsetOn(this.bgl);\r\n    this.bgl.draw(this.sprites);\r\n    this.bgl.flush();\r\n    polyOffsetOff(this.bgl);\r\n    blendOn(this.bgl);\r\n    this.bgl.draw(this.surfacesTrans);\r\n    this.bgl.flush();\r\n    polyOffsetOn(this.bgl);\r\n    this.bgl.draw(this.spritesTrans);\r\n    this.bgl.flush();\r\n    polyOffsetOff(this.bgl);\r\n    blendOff(this.bgl);\r\n  }\r\n}","import { Entity, Target } from \"../../../build/hitscan\";\r\nimport { Board } from \"../../../build/board/structs\";\r\nimport { create, Dependency, Injector, Module } from \"../../../utils/injector\";\r\nimport { int, len2d, tuple2 } from \"../../../utils/mathutils\";\r\nimport { STATE, State, View, GridController, GRID, VIEW } from \"../../apis/app\";\r\nimport { BUS, Message, MessageHandler } from \"../../apis/handler\";\r\nimport { Renderable } from \"../../apis/renderable\";\r\nimport { LoadBoard, NamedMessage } from \"../../edit/messages\";\r\nimport { View2d, View2dConstructor } from \"./view2d\";\r\nimport { View3d, View3dConstructor } from \"./view3d\";\r\nimport { nextwall } from \"../../../build/board/query\";\r\nimport { DEFAULT_REPEAT_RATE } from \"../../../build/board/mutations/internal\";\r\n\r\nexport class TargetImpl implements Target {\r\n  public coords_: [number, number, number] = [0, 0, 0];\r\n  public entity_: Entity = null;\r\n  get coords() { return this.coords_ }\r\n  get entity() { return this.entity_ }\r\n}\r\n\r\nexport interface ViewPosition {\r\n  x: number;\r\n  y: number;\r\n  z: number;\r\n  sec: number;\r\n}\r\n\r\nconst VIEW_2D = new Dependency<View2d>('View 2d');\r\nconst VIEW_3D = new Dependency<View3d>('View 3d');\r\n\r\nexport function SwappableViewModule(module: Module) {\r\n  module.bind(VIEW_2D, View2dConstructor);\r\n  module.bind(VIEW_3D, View3dConstructor);\r\n  module.bind(VIEW, SwappableViewConstructor);\r\n}\r\n\r\nexport async function SwappableViewConstructor(injector: Injector) {\r\n  const bus = await injector.getInstance(BUS);\r\n  const view = await create(injector, SwappableView, GRID, VIEW_2D, VIEW_3D, STATE);\r\n  bus.connect(view);\r\n  return view;\r\n}\r\n\r\nexport class SwappableView implements View, MessageHandler {\r\n  private view: View2d | View3d;\r\n  private view2d: View2d;\r\n  private view3d: View3d;\r\n  private gridController: GridController;\r\n  private lastGridScale: number;\r\n\r\n  constructor(gridController: GridController, view2d: View2d, view3d: View3d, state: State) {\r\n    this.gridController = gridController;\r\n    this.lastGridScale = gridController.getGridSize();\r\n    this.view2d = view2d;\r\n    this.view3d = view3d;\r\n    this.view = view2d;\r\n    state.register('lookaim', false);\r\n  }\r\n\r\n  get sec() { return this.view.sec }\r\n  get x() { return this.view.x }\r\n  get y() { return this.view.y }\r\n  get z() { return this.view.z }\r\n\r\n  target() { return this.view.target() }\r\n  snapTarget() { return this.view.snapTarget() }\r\n  dir() { return this.view.dir() }\r\n  drawTools(renderables: Iterable<Renderable>) { this.view.drawTools(renderables) }\r\n\r\n  handle(message: Message) {\r\n    if (message instanceof NamedMessage && message.name == 'view_mode') {\r\n      const viewPos = this.view.getViewPosition();\r\n      this.view = this.view == this.view3d ? this.view2d : this.view3d;\r\n      const gridScale = this.gridController.getGridSize();\r\n      this.gridController.setGridSize(this.lastGridScale);\r\n      this.lastGridScale = gridScale;\r\n      this.view.activate(viewPos);\r\n      return;\r\n    }\r\n    if (message instanceof LoadBoard) {\r\n      this.view2d.handle(message);\r\n      this.view3d.handle(message);\r\n      return;\r\n    }\r\n    this.view.handle(message)\r\n  }\r\n}","import { Board } from \"../../../build/board/structs\";\r\nimport { closestSpriteInSector, closestWallPoint, closestWallSegment } from \"../../../build/board/distances\";\r\nimport { Entity, EntityType, Hitscan, hitscan, Ray, Target } from \"../../../build/hitscan\";\r\nimport { getPlayerStart, ZSCALE } from \"../../../build/utils\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { CachedValue } from \"../../../utils/cachedvalue\";\r\nimport { Controller2D } from \"../../../utils/camera/controller2d\";\r\nimport { Injector } from \"../../../utils/injector\";\r\nimport { NumberInterpolator } from \"../../../utils/interpolator\";\r\nimport { int, len2d } from \"../../../utils/mathutils\";\r\nimport { DelayedValue } from \"../../../utils/timed\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, GRID, GridController, STATE, State, View } from \"../../apis/app\";\r\nimport { Message, MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { Renderable } from \"../../apis/renderable\";\r\nimport { BoardInvalidate, LoadBoard, Mouse } from \"../../edit/messages\";\r\nimport { BuildGl, BUILD_GL } from \"../gl/buildgl\";\r\nimport { BoardRenderer2D, Renderer2D } from \"./boardrenderer2d\";\r\nimport { TargetImpl, ViewPosition } from \"./view\";\r\nimport { inSector, findSector, snapWall } from \"../../../build/board/query\";\r\n\r\n\r\nexport async function View2dConstructor(injector: Injector) {\r\n  const [renderer, grid, bgl, board, art, state] = await Promise.all([\r\n    Renderer2D(injector),\r\n    injector.getInstance(GRID),\r\n    injector.getInstance(BUILD_GL),\r\n    injector.getInstance(BOARD),\r\n    injector.getInstance(ART),\r\n    injector.getInstance(STATE),\r\n  ]);\r\n  return new View2d(renderer, grid, bgl, board, art, state);\r\n}\r\n\r\nexport class View2d extends MessageHandlerReflective implements View {\r\n  private position: ViewPosition;\r\n  private control = new Controller2D();\r\n  private pointer = vec3.create();\r\n  private hit = new CachedValue((h: Hitscan) => this.updateHitscan(h), new Hitscan());\r\n  private snapTargetValue = new CachedValue((t: TargetImpl) => this.updateSnapTarget(t), new TargetImpl());\r\n  private direction = new CachedValue((r: Ray) => this.updateDir(r), new Ray());\r\n  private upp = new DelayedValue(100, 1, NumberInterpolator);\r\n\r\n  constructor(\r\n    private renderer: BoardRenderer2D,\r\n    private gridController: GridController,\r\n    private buildgl: BuildGl,\r\n    private board: BoardProvider,\r\n    private art: ArtProvider,\r\n    private state: State\r\n  ) {\r\n    super();\r\n\r\n    state.register('zoom+', false);\r\n    state.register('zoom-', false);\r\n\r\n    this.loadBoard(board());\r\n  }\r\n\r\n  get sec() { return this.position.sec }\r\n  get x() { return this.position.x }\r\n  get y() { return this.position.y }\r\n  get z() { return this.position.z }\r\n\r\n  getProjectionMatrix() { return this.control.getProjectionMatrix() }\r\n  getTransformMatrix() { return this.control.getTransformMatrix() }\r\n  getPosition() { return this.pointer }\r\n  drawTools(renderables: Iterable<Renderable>) { this.renderer.drawTools(renderables) }\r\n  target(): Target { return this.hit.get() }\r\n  snapTarget(): Target { return this.snapTargetValue.get() }\r\n  dir(): Ray { return this.direction.get() }\r\n  isWireframe() { return true }\r\n  getViewPosition() { return this.position }\r\n\r\n  activate(pos: ViewPosition) {\r\n    this.position = pos;\r\n    this.control.setPosition(this.position.x, this.position.y, this.position.z);\r\n  }\r\n\r\n  Mouse(msg: Mouse) {\r\n    this.control.track(msg.x, msg.y, 1024 * ZSCALE, this.state.get('lookaim'));\r\n    const x = (msg.x / this.buildgl.gl.drawingBufferWidth) * 2 - 1;\r\n    const y = (msg.y / this.buildgl.gl.drawingBufferHeight) * 2 - 1;\r\n    const p = this.control.getPointerPosition(this.pointer, x, y);\r\n\r\n    this.position.x = int(p[0]);\r\n    this.position.y = int(p[2]);\r\n    const board = this.board();\r\n    if (!inSector(board, this.position.x, this.position.y, this.position.sec))\r\n      this.position.sec = findSector(board, this.position.x, this.position.y, this.position.sec);\r\n  }\r\n\r\n  Frame(msg: Message) {\r\n    this.invalidateTarget();\r\n    this.control.setSize(this.buildgl.gl.drawingBufferWidth, this.buildgl.gl.drawingBufferHeight);\r\n    const max = this.control.getPointerPosition(this.pointer, 1, 1);\r\n    const campos = this.control.getPosition();\r\n    const dist = len2d(max[0] - campos[0], max[2] - campos[2]);\r\n    this.buildgl.newFrame();\r\n    this.renderer.draw(this, campos, dist, this.control);\r\n\r\n    const state = this.state;\r\n    if (state.get('zoom+')) { this.upp.set(this.upp.get() / 1.3); this.recalcGridSize(); }\r\n    if (state.get('zoom-')) { this.upp.set(this.upp.get() * 1.3); this.recalcGridSize(); }\r\n\r\n    this.control.setUnitsPerPixel(this.upp.get());\r\n  }\r\n\r\n  private recalcGridSize() {\r\n    this.gridController.setGridSize((this.control.getUnitsPerPixel() + 0.5) * 32);\r\n  }\r\n\r\n  private invalidateTarget() {\r\n    this.snapTargetValue.invalidate();\r\n    this.direction.invalidate();\r\n    this.hit.invalidate();\r\n  }\r\n\r\n  BoardInvalidate(msg: BoardInvalidate) {\r\n    this.invalidateTarget();\r\n  }\r\n\r\n  LoadBoard(msg: LoadBoard) {\r\n    this.loadBoard(msg.board);\r\n  }\r\n\r\n  private loadBoard(board: Board) {\r\n    const sprite = getPlayerStart(board);\r\n    this.position = { x: sprite.x, y: sprite.y, z: sprite.z, sec: sprite.sectnum };\r\n    this.control.setPosition(this.position.x, this.position.y, 1024 * ZSCALE);\r\n    this.invalidateTarget();\r\n  }\r\n\r\n  private updateHitscan(hit: Hitscan) {\r\n    hitscan(this.board(), this.art, this.x, this.y, this.z, this.sec, 0, 0, -1 * ZSCALE, hit, 0);\r\n    return hit;\r\n  }\r\n\r\n  private updateSnapTarget(target: TargetImpl) {\r\n    const board = this.board();\r\n    const d = this.gridController.getGridSize() / 2;\r\n    const s = closestSpriteInSector(board, this.sec, this.x, this.y, d);\r\n    if (s != -1) {\r\n      const sprite = board.sprites[s];\r\n      target.coords_[0] = sprite.x\r\n      target.coords_[1] = sprite.y;\r\n      target.coords_[2] = sprite.z;\r\n      target.entity_ = new Entity(s, EntityType.SPRITE);\r\n      return target;\r\n    }\r\n    const w = closestWallPoint(board, this.x, this.y, d);\r\n    if (w != -1) {\r\n      const wall = board.walls[w];\r\n      target.coords_[0] = wall.x\r\n      target.coords_[1] = wall.y;\r\n      target.entity_ = new Entity(w, EntityType.WALL_POINT);\r\n      return target;\r\n    }\r\n    const ws = closestWallSegment(board, this.x, this.y, d);\r\n    if (ws != -1) {\r\n      const [x, y] = snapWall(board, ws, this.x, this.y, this.gridController);\r\n      target.coords_[0] = x;\r\n      target.coords_[1] = y;\r\n      target.entity_ = new Entity(ws, EntityType.MID_WALL);\r\n      return target;\r\n    }\r\n    target.coords_[0] = this.gridController.snap(this.x);\r\n    target.coords_[1] = this.gridController.snap(this.y);\r\n    const sectorId = findSector(board, this.x, this.y, this.sec);\r\n    target.entity_ = sectorId == -1 ? null : new Entity(sectorId, EntityType.FLOOR);\r\n    return target;\r\n  }\r\n\r\n  private updateDir(ray: Ray): Ray {\r\n    vec3.set(ray.start, this.x, this.y, this.z);\r\n    vec3.set(ray.dir, 0, 0, -1 * ZSCALE);\r\n    return ray;\r\n  }\r\n}","import { closestWallInSector, closestWallSegmentInSector } from \"../../../build/board/distances\";\r\nimport { inSector, findSector, sectorOfWall, snapWall } from \"../../../build/board/query\";\r\nimport { Board } from \"../../../build/board/structs\";\r\nimport { Entity, EntityType, Hitscan, hitscan, Ray, Target } from \"../../../build/hitscan\";\r\nimport { build2gl, getPlayerStart, gl2build, ZSCALE } from \"../../../build/utils\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { CachedValue } from \"../../../utils/cachedvalue\";\r\nimport { Controller3D } from \"../../../utils/camera/controller3d\";\r\nimport { Injector } from \"../../../utils/injector\";\r\nimport { NumberInterpolator } from \"../../../utils/interpolator\";\r\nimport { int } from \"../../../utils/mathutils\";\r\nimport { DelayedValue } from \"../../../utils/timed\";\r\nimport { ART, ArtProvider, BOARD, BoardProvider, GRID, GridController, STATE, State, View } from \"../../apis/app\";\r\nimport { MessageHandlerReflective } from \"../../apis/handler\";\r\nimport { Renderable } from \"../../apis/renderable\";\r\nimport { BoardInvalidate, Frame, LoadBoard, Mouse, NamedMessage } from \"../../edit/messages\";\r\nimport { BuildGl, BUILD_GL } from \"../gl/buildgl\";\r\nimport { Boardrenderer3D, Renderer3D } from \"./boardrenderer3d\";\r\nimport { TargetImpl, ViewPosition } from \"./view\";\r\n\r\nexport async function View3dConstructor(injector: Injector) {\r\n  const [renderer, buildgl, board, state, grid, art] = await Promise.all([\r\n    Renderer3D(injector),\r\n    injector.getInstance(BUILD_GL),\r\n    injector.getInstance(BOARD),\r\n    injector.getInstance(STATE),\r\n    injector.getInstance(GRID),\r\n    injector.getInstance(ART),\r\n  ]);\r\n  return new View3d(renderer, buildgl, board, state, grid, art);\r\n}\r\n\r\nexport class View3d extends MessageHandlerReflective implements View {\r\n  private position: ViewPosition;\r\n  private aspect: number;\r\n  private control = new Controller3D();\r\n  private mouseX = 0;\r\n  private mouseY = 0;\r\n  private hit = new CachedValue((h: Hitscan) => this.updateHitscan(h), new Hitscan());\r\n  private snapTargetValue = new CachedValue((t: TargetImpl) => this.updateSnapTarget(t), new TargetImpl());\r\n  private direction = new CachedValue((r: Ray) => this.updateDir(r), new Ray());\r\n  private cursor = vec3.create();\r\n  private forwardDamper = new DelayedValue(100, 0, NumberInterpolator);\r\n  private sideDamper = new DelayedValue(100, 0, NumberInterpolator);\r\n\r\n  constructor(\r\n    private renderer: Boardrenderer3D,\r\n    private buildgl: BuildGl,\r\n    private board: BoardProvider,\r\n    private state: State,\r\n    private gridController: GridController,\r\n    private art: ArtProvider\r\n  ) {\r\n    super();\r\n\r\n    this.aspect = this.buildgl.gl.drawingBufferWidth / this.buildgl.gl.drawingBufferHeight;\r\n    this.control.setFov(90);\r\n\r\n    state.register('forward', false);\r\n    state.register('backward', false);\r\n    state.register('strafe_left', false);\r\n    state.register('strafe_right', false);\r\n    state.register('camera_speed', 8000);\r\n\r\n    this.loadBoard(board());\r\n  }\r\n\r\n  get sec() { return this.position.sec }\r\n  get x() { return this.position.x }\r\n  get y() { return this.position.y }\r\n  get z() { return this.position.z }\r\n\r\n  getProjectionMatrix() { return this.control.getProjectionMatrix(this.aspect) }\r\n  getTransformMatrix() { return this.control.getTransformMatrix() }\r\n  getPosition() { return this.control.getPosition() }\r\n  getForward() { return this.control.getForward() }\r\n  drawTools(renderables: Iterable<Renderable>) { this.renderer.drawTools(renderables) }\r\n  target(): Target { return this.hit.get() }\r\n  snapTarget(): Target { return this.snapTargetValue.get() }\r\n  dir(): Ray { return this.direction.get() }\r\n  getViewPosition() { return this.position }\r\n\r\n  activate(pos: ViewPosition) {\r\n    this.position = pos;\r\n    this.control.setPosition(this.position.x, this.position.z / ZSCALE + 1024, this.position.y);\r\n  }\r\n\r\n  Mouse(msg: Mouse) {\r\n    this.mouseX = msg.x;\r\n    this.mouseY = msg.y;\r\n    this.control.track(msg.x, msg.y, this.state.get('lookaim'));\r\n  }\r\n\r\n  Frame(msg: Frame) {\r\n    this.invalidateTarget();\r\n    build2gl(this.cursor, this.snapTarget().coords);\r\n    this.aspect = this.buildgl.gl.drawingBufferWidth / this.buildgl.gl.drawingBufferHeight;\r\n    this.buildgl.setCursorPosiotion(this.cursor[0], this.cursor[1], this.cursor[2]);\r\n    this.buildgl.newFrame();\r\n    this.renderer.draw(this);\r\n    this.move(msg.dt);\r\n  }\r\n\r\n  private move(dt: number) {\r\n    const state = this.state;\r\n    const cameraSpeed = state.get<number>('camera_speed');\r\n\r\n    this.forwardDamper.set(0);\r\n    this.sideDamper.set(0);\r\n    if (state.get('forward')) this.forwardDamper.set(1);\r\n    if (state.get('backward')) this.forwardDamper.set(-1);\r\n    if (state.get('strafe_left')) this.sideDamper.set(-1);\r\n    if (state.get('strafe_right')) this.sideDamper.set(1);\r\n    this.control.moveForward(dt * cameraSpeed * this.forwardDamper.get());\r\n    this.control.moveSideway(dt * cameraSpeed * this.sideDamper.get());\r\n\r\n    const board = this.board();\r\n    const p = this.control.getPosition();\r\n    this.position.x = int(p[0]);\r\n    this.position.y = int(p[2]);\r\n    this.position.z = int(p[1] * ZSCALE);\r\n    if (!inSector(board, this.position.x, this.position.y, this.position.sec))\r\n      this.position.sec = findSector(board, this.position.x, this.position.y, this.position.sec);\r\n  }\r\n\r\n  NamedMessage(msg: NamedMessage) {\r\n    if (msg.name == 'print_info') this.buildgl.printInfo();\r\n  }\r\n\r\n  BoardInvalidate(msg: BoardInvalidate) {\r\n    this.invalidateTarget();\r\n  }\r\n\r\n  LoadBoard(msg: LoadBoard) {\r\n    this.loadBoard(msg.board);\r\n  }\r\n\r\n  private loadBoard(board: Board) {\r\n    const sprite = getPlayerStart(board);\r\n    this.position = { x: sprite.x, y: sprite.y, z: sprite.z, sec: sprite.sectnum };\r\n    this.control.setPosition(this.position.x, this.position.z / ZSCALE + 1024, this.position.y);\r\n    this.invalidateTarget();\r\n  }\r\n\r\n  private invalidateTarget() {\r\n    this.snapTargetValue.invalidate();\r\n    this.direction.invalidate();\r\n    this.hit.invalidate();\r\n  }\r\n\r\n  private updateHitscan(hit: Hitscan): Target {\r\n    const { start, dir } = this.dir();\r\n    hitscan(this.board(), this.art, start[0], start[1], start[2], this.sec, dir[0], dir[1], dir[2], hit, 0);\r\n    return hit;\r\n  }\r\n\r\n  private getClosestWall(target: Target, d: number): number {\r\n    const [x, y] = target.coords;\r\n    const board = this.board();\r\n    if (target.entity.isWall())\r\n      return closestWallInSector(board, sectorOfWall(board, target.entity.id), x, y, d);\r\n    else if (target.entity.isSector())\r\n      return closestWallInSector(board, target.entity.id, x, y, d);\r\n    return -1;\r\n  }\r\n\r\n  private snapGrid(target: Target, t: TargetImpl) {\r\n    t.coords_[0] = this.gridController.snap(target.coords[0]);\r\n    t.coords_[1] = this.gridController.snap(target.coords[1]);\r\n    t.coords_[2] = this.gridController.snap(target.coords[2]);\r\n    t.entity_ = target.entity.clone();\r\n    return t;\r\n  }\r\n\r\n  private snapWall(target: Target, wallId: number, t: TargetImpl) {\r\n    const [x, y] = snapWall(this.board(), wallId, target.coords[0], target.coords[1], this.gridController);\r\n    t.coords_[0] = x;\r\n    t.coords_[1] = y;\r\n    t.coords_[2] = this.gridController.snap(target.coords[2] / ZSCALE) * ZSCALE;\r\n    t.entity_ = new Entity(wallId, EntityType.MID_WALL);\r\n    return t;\r\n  }\r\n\r\n  private snapWallPoint(target: Target, wallId: number, t: TargetImpl) {\r\n    const wall = this.board().walls[wallId];\r\n    t.coords_[0] = wall.x;\r\n    t.coords_[1] = wall.y;\r\n    t.coords_[2] = target.coords[2];\r\n    t.entity_ = new Entity(wallId, EntityType.WALL_POINT);\r\n    return t;\r\n  }\r\n\r\n  private snapSprite(target: Target, t: TargetImpl) {\r\n    const sprite = this.board().sprites[target.entity.id];\r\n    t.coords_[0] = sprite.x;\r\n    t.coords_[1] = sprite.y;\r\n    t.coords_[2] = sprite.z;\r\n    t.entity_ = target.entity.clone();\r\n    return t;\r\n  }\r\n\r\n  private copyTarget(target: Target, t: TargetImpl) {\r\n    t.coords_[0] = target.coords[0];\r\n    t.coords_[1] = target.coords[1];\r\n    t.coords_[2] = target.coords[2];\r\n    t.entity_ = null;\r\n    return t;\r\n  }\r\n\r\n  private minScale(x: number) {\r\n    let scale = 1;\r\n    x = int(x);\r\n    while ((x & 1) == 0 && scale <= 1024) {\r\n      x >>= 1;\r\n      scale <<= 1;\r\n    }\r\n    return scale;\r\n  }\r\n\r\n  private updateGridSize() {\r\n    if (this.state.get('move')) return;\r\n    const target = this.target();\r\n    if (target.entity == null) return;\r\n    const board = this.board();\r\n    const d = 64;\r\n    const w = this.getClosestWall(target, d);\r\n    if (w != -1) {\r\n      const wall = board.walls[w];\r\n      const scale = Math.min(this.minScale(wall.x), this.minScale(wall.y), this.gridController.getGridSize());\r\n      this.gridController.setGridSize(scale);\r\n    } else if (target.entity.isSprite()) {\r\n      const sprite = board.sprites[target.entity.id];\r\n      const scale = Math.min(this.minScale(sprite.x), this.minScale(sprite.y), this.gridController.getGridSize());\r\n      this.gridController.setGridSize(scale);\r\n      // } else if (target.entity.isWall()) {\r\n      //   const [x, y] = snapWall(target.entity.id, target.coords[0], target.coords[1], board, this.gridController);\r\n      //   const scale = Math.min(this.minScale(x), this.minScale(y), this.gridController.getGridSize());\r\n      //   this.gridController.setGridSize(scale);\r\n    } /*else if (target.entity.isSector()) {\r\n      this.gridController.setGridSize(512)\r\n    }*/\r\n  }\r\n\r\n  private updateSnapTarget(t: TargetImpl): Target {\r\n    const target = this.target();\r\n    if (target.entity == null) return this.copyTarget(target, t);\r\n    // this.updateGridSize();\r\n    const d = 32;//this.gridController.getGridSize() / 2;\r\n    const w = this.getClosestWall(target, d);\r\n    if (w != -1) {\r\n      return this.snapWallPoint(target, w, t);\r\n    } else if (target.entity.isSector()) {\r\n      const w = closestWallSegmentInSector(this.board(), target.entity.id, target.coords[0], target.coords[1], d);\r\n      return w == -1 ? this.snapGrid(target, t) : this.snapWall(target, w, t);\r\n    } else if (target.entity.isSprite()) {\r\n      return this.snapSprite(target, t);\r\n    } else if (target.entity.isWall()) {\r\n      return this.snapWall(target, target.entity.id, t);\r\n    }\r\n  }\r\n\r\n  private updateDir(r: Ray): Ray {\r\n    vec3.set(r.start, this.x, this.y, this.z);\r\n    const x = (this.mouseX / this.buildgl.gl.drawingBufferWidth) * 2 - 1;\r\n    const y = (this.mouseY / this.buildgl.gl.drawingBufferHeight) * 2 - 1;\r\n    gl2build(r.dir, this.control.getForwardUnprojected(this.aspect, x, y));\r\n    return r;\r\n  }\r\n}","import { AbstractPixelProvider, BlendFunc } from '../utils/pixelprovider';\r\nimport { ArtInfo } from './formats/art';\r\n\r\nexport class ArtPixelProvider extends AbstractPixelProvider {\r\n  private palTmp = new Uint8Array([0, 0, 0, 255]);\r\n  private trans = new Uint8Array([0, 0, 0, 255]);\r\n\r\n  constructor(\r\n    private info: ArtInfo,\r\n    private pal: Uint8Array,\r\n    private plu: (idx: number) => number = x => x\r\n  ) {\r\n    super(info.w, info.h);\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    const img = this.info.img;\r\n    const idx = this.plu(img[y + x * this.info.h]);\r\n    if (idx == 255) {\r\n      blend(dst, dstoff, this.trans, 0);\r\n      return;\r\n    }\r\n    const paloff = idx * 3;\r\n    this.palTmp[0] = this.pal[paloff];\r\n    this.palTmp[1] = this.pal[paloff + 1];\r\n    this.palTmp[2] = this.pal[paloff + 2];\r\n    blend(dst, dstoff, this.palTmp, 0);\r\n  }\r\n}","import { range } from \"../../utils/collections\";\r\nimport { iter } from \"../../utils/iter\";\r\nimport { len2d, lenPointToLine, lse } from \"../../utils/mathutils\";\r\nimport { sectorWalls } from \"./loops\";\r\nimport { findSector } from \"./query\";\r\nimport { Board } from \"./structs\";\r\n\r\nexport function distanceToWallSegment(board: Board, wallId: number, x: number, y: number): number {\r\n  const wall = board.walls[wallId];\r\n  const wall2 = board.walls[wall.point2];\r\n  return lenPointToLine(x, y, wall.x, wall.y, wall2.x, wall2.y);\r\n}\r\n\r\nexport function distanceToWallPoint(board: Board, wallId: number, x: number, y: number): number {\r\n  const wall = board.walls[wallId];\r\n  return len2d(x - wall.x, y - wall.y);\r\n}\r\n\r\nfunction distance(ids: Iterable<number>, distf: (ent: number) => number): [number, number] {\r\n  let id = -1;\r\n  let mindist = Number.MAX_VALUE;\r\n  for (const i of ids) {\r\n    const dist = distf(i);\r\n    if (dist < mindist) {\r\n      id = i;\r\n      mindist = dist;\r\n    }\r\n  }\r\n  return [id, mindist];\r\n}\r\n\r\nexport function closestWallPointDist(board: Board, x: number, y: number): [number, number] {\r\n  return distance(range(0, board.numwalls), w => distanceToWallPoint(board, w, x, y));\r\n}\r\n\r\nexport function closestWallInSectorDist(board: Board, sectorId: number, x: number, y: number): [number, number] {\r\n  return distance(sectorWalls(board, sectorId), w => distanceToWallPoint(board, w, x, y));\r\n}\r\n\r\nexport function closestWallSegmentInSectorDist(board: Board, sectorId: number, x: number, y: number): [number, number] {\r\n  return distance(sectorWalls(board, sectorId), w => distanceToWallSegment(board, w, x, y));\r\n}\r\n\r\nexport function closestSpriteInSectorDist(board: Board, secId: number, x: number, y: number): [number, number] {\r\n  const sprites = board.sprites;\r\n  return distance(iter(range(0, board.numsprites)).filter(s => sprites[s].sectnum == secId), s => len2d(sprites[s].x - x, sprites[s].y - y));\r\n}\r\n\r\nexport function closestWallSegmentDist(board: Board, x: number, y: number): [number, number] {\r\n  const sectorId = findSector(board, x, y);\r\n  return sectorId == -1\r\n    ? distance(range(0, board.numwalls), w => distanceToWallSegment(board, w, x, y))\r\n    : closestWallSegmentInSectorDist(board, sectorId, x, y);\r\n}\r\n\r\nexport function closestWallPoint(board: Board, x: number, y: number, d: number): number {\r\n  const [w, dist] = closestWallPointDist(board, x, y);\r\n  return lse(dist, d) ? w : -1;\r\n}\r\n\r\nexport function closestWallInSector(board: Board, sectorId: number, x: number, y: number, d: number): number {\r\n  const [w, dist] = closestWallInSectorDist(board, sectorId, x, y);\r\n  return lse(dist, d) ? w : -1;\r\n}\r\n\r\nexport function closestWallSegmentInSector(board: Board, sectorId: number, x: number, y: number, d: number): number {\r\n  const [w, dist] = closestWallSegmentInSectorDist(board, sectorId, x, y);\r\n  return lse(dist, d) ? w : -1;\r\n}\r\n\r\nexport function closestSpriteInSector(board: Board, secId: number, x: number, y: number, d: number): number {\r\n  const [s, dist] = closestSpriteInSectorDist(board, secId, x, y);\r\n  return lse(dist, d) ? s : -1;\r\n}\r\n\r\nexport function closestWallSegment(board: Board, x: number, y: number, d: number): number {\r\n  const [w, dist] = closestWallSegmentDist(board, x, y);\r\n  return lse(dist, d) ? w : -1;\r\n}","import { map } from \"../../utils/collections\";\r\nimport { minValue } from \"../../utils/mathutils\";\r\nimport { clockwise } from \"../utils\";\r\nimport { isValidSectorId, lastwall, nextwall } from \"./query\";\r\nimport { Board } from \"./structs\";\r\n\r\nexport function* sectorWalls(board: Board, sectorId: number): Generator<number> {\r\n  if (!isValidSectorId(board, sectorId)) throw new Error(`Invalid sectorId: ${sectorId}`);\r\n  const sector = board.sectors[sectorId];\r\n  const end = sector.wallnum + sector.wallptr;\r\n  for (let w = sector.wallptr; w < end; w++) yield w;\r\n}\r\n\r\nexport function* loopPoints(board: Board, sectorId: number): Generator<number> {\r\n  for (const w of sectorWalls(board, sectorId)) {\r\n    const wall = board.walls[w];\r\n    if (w > wall.point2) yield w;\r\n  }\r\n}\r\n\r\nexport function* loopWalls(board: Board, wallId: number): Generator<number> {\r\n  const start = loopStart(board, wallId);\r\n  yield start;\r\n  for (let w = board.walls[start].point2; w != start; w = board.walls[w].point2) yield w;\r\n}\r\n\r\nexport function loopStart(board: Board, wallId: number): number {\r\n  if (wallId < 0 || wallId >= board.numwalls) throw new Error(`Invalid wallId: ${wallId}`);\r\n  if (wallId > board.walls[wallId].point2) return board.walls[wallId].point2;\r\n  for (let w = board.walls[wallId].point2; w != wallId; w = board.walls[w].point2) {\r\n    const wall = board.walls[w];\r\n    if (w > wall.point2) return wall.point2;\r\n  }\r\n  throw new Error(`Corrupted Board`);\r\n}\r\n\r\nexport function* wallsBetween(board: Board, from: number, to: number): Generator<number> {\r\n  if (loopStart(board, from) != loopStart(board, to)) throw new Error(`Walls ${from} and ${to} not from one loop`);\r\n  for (let w = from; w != to; w = board.walls[w].point2) yield w;\r\n}\r\n\r\nexport function innerSectorsOfLoop(board: Board, wallId: number, sectors: Set<number> = new Set<number>()): Set<number> {\r\n  if (isOuterLoop(board, wallId)) return sectors;\r\n  for (const w of loopWalls(board, wallId)) {\r\n    const wall = board.walls[w];\r\n    const nextsector = wall.nextsector;\r\n    if (nextsector == -1 || sectors.has(nextsector)) continue;\r\n    sectors.add(nextsector);\r\n    innerSectors(board, nextsector, sectors);\r\n  }\r\n  return sectors;\r\n}\r\n\r\nexport function innerSectors(board: Board, sectorId: number, sectors: Set<number> = new Set<number>()): Set<number> {\r\n  for (const loopoint of loopPoints(board, sectorId)) innerSectorsOfLoop(board, loopoint, sectors);\r\n  return sectors;\r\n}\r\n\r\nexport function innerWalls(board: Board, wallId: number): Iterable<number> {\r\n  const loop = new Set<number>(loopWalls(board, wallId));\r\n  for (const isec of innerSectorsOfLoop(board, wallId)) {\r\n    for (const w of sectorWalls(board, isec)) {\r\n      loop.add(w);\r\n    }\r\n  }\r\n  return loop;\r\n}\r\n\r\nexport function isOuterLoop(board: Board, wallId: number) {\r\n  const WALL_MAPPER = (w: number) => <[number, number]>[board.walls[w].x, board.walls[w].y];\r\n  return clockwise(map(loopWalls(board, wallId), WALL_MAPPER));\r\n}\r\n\r\nexport function canonicalWall(board: Board, wallId: number): number {\r\n  const canonical = minValue(wallId);\r\n  let w = wallId;\r\n  do {\r\n    const wall = board.walls[w];\r\n    if (wall.nextwall != -1) {\r\n      w = nextwall(board, wall.nextwall);\r\n      canonical.set(w);\r\n    } else {\r\n      w = wallId;\r\n      do {\r\n        const wall = board.walls[lastwall(board, w)];\r\n        if (wall.nextwall != -1) {\r\n          w = wall.nextwall;\r\n          canonical.set(w);\r\n        } else break;\r\n      } while (w != wallId)\r\n    }\r\n  } while (w != wallId)\r\n  return canonical.get();\r\n}\r\n\r\nexport function connectedWalls(board: Board, wallId: number, result = new Set<number>()): Iterable<number> {\r\n  const walls = board.walls;\r\n  let counter = 0;\r\n  let w = wallId;\r\n  result.add(w);\r\n  do {\r\n    const wall = walls[w];\r\n    if (wall.nextwall != -1) {\r\n      w = nextwall(board, wall.nextwall);\r\n      result.add(w);\r\n    } else {\r\n      w = wallId;\r\n      do {\r\n        const last = lastwall(board, w);\r\n        const wall = walls[last];\r\n        if (wall.nextwall != -1) {\r\n          w = wall.nextwall;\r\n          result.add(w);\r\n        } else break;\r\n      } while (w != wallId)\r\n    }\r\n    counter++;\r\n    if (counter > board.numwalls) throw new Error('Cycled connected walls');\r\n  } while (w != wallId)\r\n  return result;\r\n}","import { BuildReferenceTracker } from \"../../../app/apis/app\";\r\nimport { Collection, enumerate, loopPairs, wrap } from \"../../../utils/collections\";\r\nimport { iter } from \"../../../utils/iter\";\r\nimport { order } from \"../../utils\";\r\nimport { Board, Sector, Wall } from \"../structs\";\r\nimport { EngineApi } from \"./api\";\r\nimport { addSector } from \"./internal\";\r\nimport { SectorBuilder } from \"./sectorbuilder\";\r\nimport { fixxrepeat } from \"./walls\";\r\n\r\nfunction searchMatchWall(board: Board, p1: [number, number], p2: [number, number]): [number, number] {\r\n  for (let s = 0; s < board.numsectors; s++) {\r\n    const sec = board.sectors[s];\r\n    const end = sec.wallptr + sec.wallnum;\r\n    for (let w = sec.wallptr; w < end; w++) {\r\n      const wall1 = board.walls[w];\r\n      if (wall1 == null || wall1.nextwall != -1) continue;\r\n      const wall2 = board.walls[wall1.point2];\r\n      if (wall1.x == p2[0] && wall1.y == p2[1] && wall2.x == p1[0] && wall2.y == p1[1]) {\r\n        return [s, w];\r\n      }\r\n    }\r\n  }\r\n  return null;\r\n}\r\n\r\nfunction matchWalls(board: Board, points: Iterable<[number, number]>): [number, number][] {\r\n  return iter(loopPairs(points)).map(([p1, p2]) => searchMatchWall(board, p1, p2)).collect();\r\n}\r\n\r\nfunction commonSectorWall(board: Board, matched: [number, number][], api: EngineApi): [Sector, Wall] {\r\n  for (let m of matched) if (m != null) return [board.sectors[m[0]], board.walls[m[1]]];\r\n  return [api.newSector(), api.newWall()];\r\n}\r\n\r\nfunction* createNewWalls(points: Iterable<[number, number]>, matchedWalls: [number, number][], commonWall: Wall, board: Board, cloneWall: (w: Wall) => Wall): Generator<Wall> {\r\n  for (const [[x, y], i] of enumerate(points)) {\r\n    const matchedWall = matchedWalls[i];\r\n    const baseWall = matchedWall == null ? commonWall : board.walls[matchedWall[1]];\r\n    const wall = cloneWall(baseWall);\r\n    wall.x = x;\r\n    wall.y = y;\r\n    if (matchedWall != null) {\r\n      wall.nextwall = matchedWall[1];\r\n      wall.nextsector = matchedWall[0];\r\n    } else {\r\n      wall.nextwall = -1;\r\n      wall.nextsector = -1;\r\n    }\r\n    yield wall;\r\n  }\r\n}\r\n\r\nexport function createNewSector(board: Board, points: Collection<[number, number]>, refs: BuildReferenceTracker, api: EngineApi) {\r\n  points = wrap([...order(points)]);\r\n  const mwalls = matchWalls(board, points);\r\n  const [commonSector, commonWall] = commonSectorWall(board, mwalls, api);\r\n  const sector = api.cloneSector(commonSector);\r\n  const sectorId = addSector(board, sector);\r\n  const walls = createNewWalls(points, mwalls, commonWall, board, api.cloneWall);\r\n  new SectorBuilder().addLoop(walls).build(board, sectorId, refs);\r\n  for (let w = sector.wallptr; w < sector.wallptr + sector.wallnum; w++) fixxrepeat(board, w);\r\n  return sectorId;\r\n}\r\n","import { Board } from \"../structs\";\r\nimport { ArtProvider, BuildReferenceTracker } from \"../../../app/apis/app\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { Deck } from \"../../../utils/collections\";\r\nimport { wallNormal, ZSCALE, ANGSCALE } from \"../../utils\";\r\nimport { sectorWalls } from \"../loops\";\r\nimport { sectorOfWall, lastwall, wallInSector, isValidWallId } from \"../query\";\r\nimport { EngineApi } from \"./api\";\r\nimport { cyclic, int } from \"../../../utils/mathutils\";\r\nimport { setFirstWall } from \"../mutations/sectors\"\r\nimport { createNewSector } from \"./ceatesector\";\r\nimport { splitWall } from \"./walls\";\r\nimport { splitSector } from \"../mutations/splitsector\";\r\nimport { closestWallSegmentInSector } from \"../distances\";\r\n\r\nexport class Point {\r\n  constructor(\r\n    readonly off: number,\r\n    readonly x: number,\r\n    readonly y: number,\r\n    readonly zup: number,\r\n    readonly zdown: number,\r\n    readonly zupoff = 0,\r\n    readonly zdownoff = 0,\r\n  ) { }\r\n}\r\n\r\nexport enum PortalType { UP, DOWN, MID };\r\nexport type point_3d = [number, number, number];\r\nexport type projector = (x: number, y: number) => [number, number, number];\r\n\r\nfunction findIndex(points: { off: number }[], off: number) {\r\n  for (let i = 0; i < points.length; i++) if (points[i].off >= off) return i;\r\n  return points.length;\r\n}\r\n\r\nfunction convert(hull: HullPoint[]) {\r\n  const newHull: Point[] = [];\r\n  let lastUp = 0, lastDown = 0;\r\n  for (let i = 0; i < hull.length; i++) {\r\n    const p = hull[i];\r\n    if (i == 0) {\r\n      newHull.push(new Point(p.off, int(p.x), int(p.y), p.upline[0], p.downline[0]));\r\n    } else if (i == hull.length - 1) {\r\n      newHull.push(new Point(p.off, int(p.x), int(p.y), lastUp, lastDown));\r\n    } else {\r\n      const upoff = p.upline[0] - lastUp;\r\n      const downoff = p.downline[0] - lastDown;\r\n      newHull.push(new Point(p.off, int(p.x), int(p.y), lastUp, lastDown, upoff, downoff));\r\n    }\r\n    lastUp = p.upline[1];\r\n    lastDown = p.downline[1];\r\n  }\r\n  return newHull;\r\n}\r\n\r\nexport function buildHull(points: point_3d[], proj: projector) {\r\n  const hull: HullPoint[] = [];\r\n  for (const [x, y, _] of points) {\r\n    const [xp, yp, off] = proj(x, y);\r\n    const idx = findIndex(hull, off);\r\n    if (idx == hull.length || hull[idx].off != off) hull.splice(idx, 0, new HullPoint(off, xp, yp));\r\n  }\r\n\r\n  for (let i = 0; i < points.length; i++) {\r\n    const p1 = points[i];\r\n    const p2 = points[cyclic(i + 1, points.length)];\r\n    const vertical = p1[0] == p2[0] && p1[1] == p2[1];\r\n    if (!vertical) {\r\n      const pp1 = proj(p1[0], p1[1]);\r\n      const pp2 = proj(p2[0], p2[1]);\r\n      const [start, end, dz, startz] = pp1[2] > pp2[2]\r\n        ? [pp2[2], pp1[2], p1[2] - p2[2], p2[2]]\r\n        : [pp1[2], pp2[2], p2[2] - p1[2], p1[2]];\r\n      let idx = findIndex(hull, start);\r\n      while (hull[idx].off != end) {\r\n        const doff1 = (hull[idx].off - start) / (end - start);\r\n        const doff2 = (hull[idx + 1].off - start) / (end - start);\r\n        hull[idx].addLine(startz + doff1 * dz, startz + doff2 * dz)\r\n        idx++;\r\n      }\r\n    }\r\n  }\r\n  return convert(hull);\r\n}\r\n\r\nclass HullPoint {\r\n  readonly upline: [number, number] = [-Number.MAX_VALUE, -Number.MAX_VALUE];\r\n  readonly downline: [number, number] = [Number.MAX_VALUE, Number.MAX_VALUE];\r\n  constructor(readonly off: number, readonly x: number, readonly y: number) { }\r\n\r\n  addLine(z1: number, z2: number) {\r\n    if (z1 == Number.MAX_VALUE || z1 == -Number.MAX_VALUE) return;\r\n    if (z1 > this.upline[0] || (z1 == this.upline[0] && z2 > this.upline[1])) {\r\n      const [lastup0, lastup1] = this.upline;\r\n      this.upline[0] = z1;\r\n      this.upline[1] = z2;\r\n      this.addLine(lastup0, lastup1);\r\n    } else if (z1 < this.downline[0] || (z1 == this.downline[0] && z2 < this.downline[1])) {\r\n      const [lastdown0, lastdown1] = this.downline;\r\n      this.downline[0] = z1;\r\n      this.downline[1] = z2;\r\n      this.addLine(lastdown0, lastdown1);\r\n    }\r\n  }\r\n}\r\n\r\nexport function drawWall(board: Board, wallId: number, type: PortalType, hull: Point[], art: ArtProvider, refs: BuildReferenceTracker, api: EngineApi, dist: number) {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  const wall = board.walls[wallId];\r\n  if (wall.nextsector == -1 && dist > 0) throw new Error();\r\n  const [nx, , ny] = wallNormal(vec3.create(), board, wallId);\r\n  const sectorId = sectorOfWall(board, wallId);\r\n  for (const p of hull) splitWall(board, closestWallSegmentInSector(board, sectorId, p.x, p.y, 0), p.x, p.y, art, refs, api.cloneWall);\r\n  if (type == PortalType.MID) mid(dist, hull, nx, ny, sectorId, board, refs, api);\r\n  else if (type == PortalType.DOWN) nonMid(dist, hull, nx, ny, sectorId, board, refs, api, true);\r\n  else if (type == PortalType.UP) nonMid(dist, hull, nx, ny, sectorId, board, refs, api, false);\r\n}\r\n\r\nfunction nonMid(dist: number, hull: Point[], nx: number, ny: number, sectorId: number, board: Board, refs: BuildReferenceTracker, api: EngineApi, down: boolean) {\r\n  for (let i = 0; i < hull.length - 1; i++) {\r\n    const p1 = hull[i];\r\n    const p2 = hull[i + 1];\r\n    const points = new Deck<[number, number]>();\r\n    if (i == 0) points.push([p1.x, p1.y]);\r\n    points\r\n      .push([int(p1.x + nx * dist), int(p1.y + ny * dist)])\r\n      .push([int(p2.x + nx * dist), int(p2.y + ny * dist)])\r\n      .push([p2.x, p2.y])\r\n    const sec = splitSector(board, sectorId, points, refs, api);\r\n    const sector = board.sectors[sec];\r\n    const firsWall = lastwall(board, wallInSector(board, sec, p1.x, p1.y));\r\n    setFirstWall(board, sec, firsWall, refs);\r\n    const doff = p2.off - p1.off;\r\n    const z = down ? p1.zup + p1.zupoff : p1.zdown + p1.zdownoff;\r\n    const k = (down ? (p2.zup - z) : (p2.zdown - z)) / doff;\r\n    if (down) {\r\n      sector.floorz = int(z * ZSCALE);\r\n      sector.floorheinum = -int(k / ANGSCALE);\r\n    } else {\r\n      sector.ceilingz = int(z * ZSCALE);\r\n      sector.ceilingheinum = -int(k / ANGSCALE);\r\n    }\r\n  }\r\n}\r\n\r\nfunction findPortalWall(board: Board, fromSectorId: number, toSectorId: number): number {\r\n  for (const w of sectorWalls(board, fromSectorId)) if (board.walls[w].nextsector == toSectorId) return board.walls[w].nextwall;\r\n  return -1;\r\n}\r\n\r\nfunction mid(dist: number, hull: Point[], nx: number, ny: number, sectorId: number, board: Board, refs: BuildReferenceTracker, api: EngineApi) {\r\n  for (let i = 0; i < hull.length - 1; i++) {\r\n    const p1 = hull[i];\r\n    const p2 = hull[i + 1];\r\n    const points = new Deck<[number, number]>()\r\n      .push([p1.x, p1.y])\r\n      .push([p2.x, p2.y])\r\n      .push([int(p2.x + nx * dist), int(p2.y + ny * dist)])\r\n      .push([int(p1.x + nx * dist), int(p1.y + ny * dist)]);\r\n    const newSectorId = createNewSector(board, points, refs, api);\r\n    const sector = board.sectors[newSectorId];\r\n    const firsWall = wallInSector(board, newSectorId, p1.x, p1.y);\r\n    setFirstWall(board, newSectorId, firsWall, refs);\r\n    const doff = p2.off - p1.off;\r\n    const floorz = p1.zdown + p1.zdownoff;\r\n    const ceilingz = p1.zup + p1.zupoff;\r\n    const floork = (p2.zdown - floorz) / doff;\r\n    const ceilingk = (p2.zup - ceilingz) / doff;\r\n    sector.floorz = int(floorz * ZSCALE);\r\n    sector.ceilingz = int(ceilingz * ZSCALE);\r\n    sector.floorheinum = -int(floork / ANGSCALE);\r\n    sector.ceilingheinum = -int(ceilingk / ANGSCALE);\r\n    const pwall = findPortalWall(board, newSectorId, sectorId);\r\n    board.walls[pwall].cstat.alignBottom = 1;\r\n  }\r\n}","import { BuildReferenceTracker } from \"../../../app/apis/app\";\r\nimport { Collection, forEach, range, reverse } from \"../../../utils/collections\";\r\nimport { iter } from \"../../../utils/iter\";\r\nimport { clockwise } from \"../../utils\";\r\nimport { isValidSectorId, isValidSpriteId } from \"../query\";\r\nimport { Board, Sector, Sprite } from \"../structs\";\r\n\r\nexport const DEFAULT_REPEAT_RATE = 128;\r\n\r\nexport function addSprite(board: Board, sprite: Sprite) {\r\n  const newSpriteId = board.numsprites;\r\n  board.sprites[newSpriteId] = sprite;\r\n  board.numsprites++;\r\n  return newSpriteId;\r\n}\r\n\r\nexport function deleteSprite(board: Board, spriteId: number) {\r\n  if (!isValidSpriteId(board, spriteId)) throw new Error(`Invalid spriteId: ${spriteId}`);\r\n  for (let i = spriteId; i < board.numsprites; i++) board.sprites[i] = board.sprites[i + 1];\r\n  board.sprites[board.numsprites - 1] = null;\r\n  board.numsprites--;\r\n}\r\n\r\nexport function addSector(board: Board, sector: Sector) {\r\n  const newSectorIdx = board.numsectors;\r\n  board.sectors[newSectorIdx] = sector;\r\n  sector.wallptr = board.numwalls;\r\n  sector.wallnum = 0;\r\n  board.numsectors++;\r\n  return newSectorIdx;\r\n}\r\n\r\nexport function deleteSector(board: Board, sectorId: number, refs: BuildReferenceTracker) {\r\n  if (!isValidSectorId(board, sectorId)) throw new Error(`Invalid sectorId: ${sectorId}`);\r\n  const sector = board.sectors[sectorId];\r\n  const wallsend = sector.wallptr + sector.wallnum;\r\n  for (let w = sector.wallptr; w < wallsend; w++) {\r\n    const wall = board.walls[w];\r\n    if (wall.nextwall != -1) {\r\n      const nextwall = board.walls[wall.nextwall];\r\n      nextwall.nextsector = -1;\r\n      nextwall.nextwall = -1;\r\n    }\r\n  }\r\n  updateSpriteSector(board, sectorId);\r\n  resizeWalls(board, sectorId, 0, refs);\r\n  deleteSectorImpl(board, sectorId, refs);\r\n}\r\n\r\nfunction updateSpriteSector(board: Board, fromSector: number) {\r\n  iter(range(0, board.numsprites))\r\n    .map(s => board.sprites[s])\r\n    .filter(s => s.sectnum == fromSector)\r\n    .forEach(s => s.sectnum = -1);\r\n}\r\n\r\nfunction deleteSectorImpl(board: Board, sectorId: number, refs: BuildReferenceTracker) {\r\n  if (board.sectors[sectorId].wallnum != 0) throw new Error(`Error while deleting sector #${sectorId}. wallnum != 0`);\r\n\r\n  for (let w = 0; w < board.numwalls; w++) {\r\n    const wall = board.walls[w];\r\n    if (wall.nextsector == sectorId) throw new Error(`Error while deleting sector #${sectorId}. Wall #${w} referencing sector`);\r\n    if (wall.nextsector > sectorId) wall.nextsector--;\r\n  }\r\n  for (let s = 0; s < board.numsprites; s++) {\r\n    const spr = board.sprites[s];\r\n    if (spr.sectnum == sectorId) throw new Error(`Error while deleting sector #${sectorId}. Sprite #${s} referencing sector`);\r\n    if (spr.sectnum > sectorId) spr.sectnum--;\r\n  }\r\n  for (let s = sectorId; s < board.numsectors - 1; s++) {\r\n    board.sectors[s] = board.sectors[s + 1];\r\n  }\r\n  refs.sectors.update((s) => s == sectorId ? -1 : s > sectorId ? s - 1 : s);\r\n  board.sectors[board.numsectors - 1] = null;\r\n  board.numsectors--;\r\n}\r\n\r\nfunction updateWallIds(afterWallId: number, size: number) {\r\n  return (w: number) => {\r\n    if (size < 0 && w >= afterWallId && w < afterWallId - size) return -1;\r\n    else if (w > afterWallId) return w + size;\r\n    return w;\r\n  }\r\n}\r\n\r\nexport function moveWalls(board: Board, secId: number, afterWallId: number, size: number, refs: BuildReferenceTracker) {\r\n  if (size == 0) return;\r\n  if (size < 0) forEach(range(afterWallId, afterWallId - size), w => board.walls[w] = null);\r\n\r\n  for (let w = 0; w < board.numwalls; w++) {\r\n    const wall = board.walls[w];\r\n    if (wall == null) continue;\r\n    if (wall.point2 > afterWallId) wall.point2 += size;\r\n    if (wall.nextwall > afterWallId) wall.nextwall += size;\r\n  }\r\n\r\n  refs.walls.update(updateWallIds(afterWallId, size));\r\n\r\n  if (size > 0) {\r\n    const end = board.numwalls - 1;\r\n    for (let i = end; i > afterWallId; i--) board.walls[i + size] = board.walls[i];\r\n    for (let i = 0; i < size; i++) board.walls[i + afterWallId + 1] = null;\r\n  } else {\r\n    const end = board.numwalls + size;\r\n    for (let i = afterWallId; i < end; i++) board.walls[i] = board.walls[i - size];\r\n    for (let i = 0; i < -size; i++) board.walls[end + i] = null;\r\n  }\r\n\r\n  board.numwalls += size;\r\n  board.sectors[secId].wallnum += size;\r\n  for (let i = 0; i < board.numsectors; i++) {\r\n    const sec = board.sectors[i];\r\n    if (sec.wallptr >= afterWallId + 1 && i != secId) sec.wallptr += size;\r\n  }\r\n}\r\n\r\nexport function resizeWalls(board: Board, sectorId: number, newSize: number, refs: BuildReferenceTracker) {\r\n  const sec = board.sectors[sectorId];\r\n  const dw = newSize - sec.wallnum;\r\n  if (dw == 0) return;\r\n  if (dw > 0) {\r\n    moveWalls(board, sectorId, sec.wallptr + sec.wallnum - 1, dw, refs);\r\n  } else {\r\n    moveWalls(board, sectorId, sec.wallptr + newSize, dw, refs)\r\n  }\r\n}\r\n","import { BuildReferenceTracker } from '../../../app/apis/app';\r\nimport { sectorWalls } from '../loops';\r\nimport { SectorBuilder } from '../mutations/sectorbuilder';\r\nimport { isJoinedSectors } from '../query';\r\nimport { Board } from '../structs';\r\nimport { deleteSector } from './internal';\r\n\r\nfunction fillSectorWalls(board: Board, s: number, set: Set<number>) { for (const w of sectorWalls(board, s)) set.add(w) }\r\n\r\nconst _wallset = new Set<number>();\r\nfunction fillWallSet(board: Board, s1: number, s2: number) {\r\n  _wallset.clear();\r\n  fillSectorWalls(board, s1, _wallset);\r\n  fillSectorWalls(board, s2, _wallset);\r\n  return _wallset;\r\n}\r\n\r\nfunction getJoinedWallsLoops(board: Board, s1: number, s2: number): SectorBuilder {\r\n  const builder = new SectorBuilder();\r\n  const wallset = fillWallSet(board, s1, s2);\r\n  const values = wallset.values();\r\n  for (let it = values.next(); !it.done; it = values.next()) {\r\n    let w = it.value;\r\n    const loopstart = w;\r\n    for (; ;) {\r\n      wallset.delete(w);\r\n      const wall = board.walls[w];\r\n      if (wall.nextsector == s1 || wall.nextsector == s2) {\r\n        wallset.delete(wall.nextwall);\r\n        w = board.walls[wall.nextwall].point2;\r\n      } else {\r\n        builder.addWall(wall);\r\n        w = wall.point2;\r\n      }\r\n      if (w == loopstart) {\r\n        builder.loop();\r\n        break;\r\n      }\r\n    }\r\n  }\r\n  return builder;\r\n}\r\n\r\nexport function joinSectors(board: Board, s1: number, s2: number, refs: BuildReferenceTracker) {\r\n  if (!isJoinedSectors(board, s1, s2)) return -1;\r\n  getJoinedWallsLoops(board, s1, s2).build(board, s1, refs);\r\n  deleteSector(board, s2, refs);\r\n  return 0;\r\n}","import { BuildReferenceTracker } from \"../../../app/apis/app\";\r\nimport { track } from \"../../../app/apis/referencetracker\";\r\nimport { Deck, map, forEach, enumerate } from \"../../../utils/collections\";\r\nimport { Wall, Board } from \"../structs\";\r\nimport { resizeWalls } from \"./internal\";\r\n\r\nexport class SectorBuilder {\r\n  private walls = new Deck<Wall>();\r\n  private looppoints = new Deck<number>();\r\n\r\n  addWall(wall: Wall): SectorBuilder { this.walls.push(wall); return this }\r\n  addWalls(walls: Iterable<Wall>): SectorBuilder { this.walls.pushAll(walls); return this }\r\n  addLoop(walls: Iterable<Wall>): SectorBuilder { return this.addWalls(walls).loop() }\r\n  getWalls() { return this.walls }\r\n\r\n  loop(): SectorBuilder {\r\n    if (this.walls.length() == 0 || this.looppoints.top() == this.walls.length()) return this;\r\n    this.looppoints.push(this.walls.length());\r\n    return this;\r\n  }\r\n\r\n  build(board: Board, sectorId: number, refs: BuildReferenceTracker) {\r\n    track(refs.walls, wallRefs => {\r\n      const nextWallPtrs = [...map(this.walls, w => wallRefs.ref(w.nextwall))];\r\n      resizeWalls(board, sectorId, this.walls.length(), refs);\r\n      forEach(enumerate(this.walls), ([w, i]) => w.nextwall = wallRefs.val(nextWallPtrs[i]));\r\n    });\r\n    const sec = board.sectors[sectorId];\r\n    const loopIter = this.looppoints[Symbol.iterator]();\r\n    let loopStart = sec.wallptr;\r\n    let loopEnd = loopIter.next().value;\r\n    for (let [wall, i] of enumerate(this.walls)) {\r\n      const w = i + sec.wallptr;\r\n      board.walls[w] = wall;\r\n      if (loopEnd == i + 1) {\r\n        wall.point2 = loopStart;\r\n        loopStart = w + 1;\r\n        loopEnd = loopIter.next().value;\r\n      } else {\r\n        wall.point2 = w + 1;\r\n      }\r\n      if (wall.nextwall != -1) {\r\n        const nextwall = board.walls[wall.nextwall];\r\n        nextwall.nextsector = sectorId;\r\n        nextwall.nextwall = w;\r\n      }\r\n    }\r\n  }\r\n}","import { BuildReferenceTracker } from \"../../../app/apis/app\";\r\nimport { track } from \"../../../app/apis/referencetracker\";\r\nimport { any, chain, cyclicRange, Deck, enumerate, length, map, wrap } from \"../../../utils/collections\";\r\nimport { order } from \"../../utils\";\r\nimport { innerSectors, innerSectorsOfLoop, isOuterLoop, loopWalls } from \"../loops\";\r\nimport { sectorOfWall } from \"../query\";\r\nimport { Board, Wall } from \"../structs\";\r\nimport { EngineApi } from \"./api\";\r\nimport { createNewSector } from \"./ceatesector\";\r\nimport { deleteSector, moveWalls, resizeWalls } from \"./internal\";\r\nimport { SectorBuilder } from \"./sectorbuilder\";\r\nimport { fixxrepeat } from \"./walls\";\r\n\r\nexport function fillInnerLoop(board: Board, wallId: number, refs: BuildReferenceTracker, api: EngineApi) {\r\n  if (isOuterLoop(board, wallId)) throw new Error('Only inner loops can be filled');\r\n  if (any(loopWalls(board, wallId), w => board.walls[w].nextsector != -1)) throw new Error(`Already filled`);\r\n  const WALL_MAPPER = (w: number) => <[number, number]>[board.walls[w].x, board.walls[w].y];\r\n  const points = wrap([...map(loopWalls(board, wallId), WALL_MAPPER)]);\r\n  createNewSector(board, points, refs, api);\r\n}\r\n\r\nexport function createInnerLoop(board: Board, sectorId: number, points: Iterable<[number, number]>, refs: BuildReferenceTracker, api: EngineApi) {\r\n  const sector = board.sectors[sectorId];\r\n  const pointsLength = length(points);\r\n  resizeWalls(board, sectorId, sector.wallnum + pointsLength, refs);\r\n  const wallPtr = sector.wallptr + sector.wallnum - pointsLength;\r\n  const firstWall = board.walls[sector.wallptr];\r\n  points = order(points, false);\r\n  for (const [[x, y], i] of enumerate(points)) {\r\n    const wall = api.cloneWall(firstWall);\r\n    wall.x = x;\r\n    wall.y = y;\r\n    wall.point2 = i == pointsLength - 1 ? wallPtr : wallPtr + i + 1;\r\n    wall.nextsector = wall.nextwall = -1;\r\n    board.walls[wallPtr + i] = wall;\r\n  }\r\n  for (let w = wallPtr; w < sector.wallptr + sector.wallnum; w++) fixxrepeat(board, w);\r\n}\r\n\r\nexport function setFirstWall(board: Board, sectorId: number, newFirstWall: number, refs: BuildReferenceTracker) {\r\n  const sector = board.sectors[sectorId];\r\n  if (sector.wallptr == newFirstWall) return;\r\n  const end = sector.wallptr + sector.wallnum;\r\n  if (newFirstWall < sector.wallptr || newFirstWall >= end) throw new Error(`Wall ${newFirstWall} not in sector ${sectorId}`);\r\n  const loops = new Deck<Deck<Wall>>();\r\n  const newFirstWallLoop = new Deck<Wall>();\r\n  let currentLoop = new Deck<Wall>();\r\n  let firstWallLoopPos = -1;\r\n  for (let w = sector.wallptr; w < end; w++) {\r\n    if (w == newFirstWall) firstWallLoopPos = currentLoop.length();\r\n    const wall = board.walls[w];\r\n    currentLoop.push(wall);\r\n    if (wall.point2 < w) {\r\n      if (firstWallLoopPos != -1) {\r\n        for (let i of cyclicRange(firstWallLoopPos, currentLoop.length()))\r\n          newFirstWallLoop.push(currentLoop.get(i));\r\n        firstWallLoopPos = -1;\r\n      } else {\r\n        loops.push(currentLoop);\r\n      }\r\n      currentLoop = new Deck<Wall>();\r\n    }\r\n  }\r\n  const builder = new SectorBuilder().addLoop(newFirstWallLoop);\r\n  for (let loop of loops) builder.addLoop(loop);\r\n  builder.build(board, sectorId, refs);\r\n}\r\n\r\nexport function deleteLoop(board: Board, wallId: number, refs: BuildReferenceTracker) {\r\n  if (isOuterLoop(board, wallId)) throw new Error('Cannot delete outer loops');\r\n  const loop = [...loopWalls(board, wallId)];\r\n  if (any(loop, w => board.walls[w].nextsector != -1)) throw new Error('Cannot delete filled loop');\r\n  const sectorId = sectorOfWall(board, wallId);\r\n  moveWalls(board, sectorId, loop[0], -loop.length, refs);\r\n}\r\n\r\nfunction deleteSectors(board: Board, sectors: Iterable<number>, refs: BuildReferenceTracker) {\r\n  track(refs.sectors, sectorRefs => {\r\n    const secs = [...map(sectors, s => sectorRefs.ref(s))];\r\n    for (const s of secs) deleteSector(board, sectorRefs.val(s), refs);\r\n  });\r\n}\r\n\r\nexport function deleteSectorFull(board: Board, sectorId: number, refs: BuildReferenceTracker) {\r\n  deleteSectors(board, chain(innerSectors(board, sectorId), [sectorId]), refs);\r\n}\r\n\r\nexport function deleteLoopFull(board: Board, wallId: number, refs: BuildReferenceTracker) {\r\n  deleteSectors(board, innerSectorsOfLoop(board, wallId), refs);\r\n}\r\n\r\n","import { BuildReferenceTracker } from '../../../app/apis/app';\r\nimport { all, Collection, enumerate, first, last, map, range, reversed, wrap } from '../../../utils/collections';\r\nimport { iter } from '../../../utils/iter';\r\nimport { Board, Wall } from '../structs';\r\nimport { clockwise, inPolygon } from '../../utils';\r\nimport { loopPoints, loopStart, loopWalls, wallsBetween } from '../loops';\r\nimport { SectorBuilder } from './sectorbuilder';\r\nimport { wallInSector } from '../query';\r\nimport { EngineApi, WallCloner } from './api';\r\nimport { addSector } from './internal';\r\n\r\ntype point2d = [number, number];\r\n\r\nfunction* createNewWalls(points: Iterable<[number, number]>, matchWalls: [number, number][], commonWall: Wall, board: Board, cloneWall: WallCloner): Generator<Wall> {\r\n  for (const [p, i] of enumerate(points)) {\r\n    const matchWall = matchWalls[i];\r\n    const baseWall = matchWall == null ? commonWall : board.walls[matchWall[1]];\r\n    const wall = cloneWall(baseWall)\r\n    wall.x = p[0];\r\n    wall.y = p[1];\r\n    if (matchWall != null) {\r\n      wall.nextwall = matchWall[1];\r\n      wall.nextsector = matchWall[0];\r\n    } else {\r\n      wall.nextwall = -1;\r\n      wall.nextsector = -1;\r\n    }\r\n    yield wall;\r\n  }\r\n}\r\n\r\nfunction loopInPolygon(board: Board, loopId: number, polygon: Iterable<point2d>) {\r\n  return all(loopWalls(board, loopId), w => inPolygon(board.walls[w].x, board.walls[w].y, polygon));\r\n}\r\n\r\nfunction checkSplitSector(board: Board, sectorId: number, points: Collection<point2d>): [number, number, number] {\r\n  const [fx, fy] = first(points);\r\n  const [lx, ly] = last(points);\r\n  const firstWall = wallInSector(board, sectorId, fx, fy);\r\n  const lastWall = wallInSector(board, sectorId, lx, ly);\r\n  if (firstWall == -1 || lastWall == -1) throw new Error(`Terminal points [${fx}, ${fy}], [${lx}, ${ly}] dont touch sector ${sectorId} walls`);\r\n  const start = loopStart(board, firstWall);\r\n  if (start != loopStart(board, lastWall)) throw new Error(`Start ${firstWall} and end ${lastWall} walls in different loops`);\r\n  return [firstWall, lastWall, start];\r\n}\r\n\r\nfunction splitSectorImpl(board: Board, sectorId: number, firstWall: number, lastWall: number, start: number, points: Collection<point2d>, refs: BuildReferenceTracker, api: EngineApi) {\r\n  const WALL_MAPPER = (w: number) => board.walls[w];\r\n  const refWall = board.walls[firstWall];\r\n  const lengthWoLast = points.length() - 1;\r\n  const [newWalls, existedWalls, loopPoly] = getSplitLoop(board, firstWall, lastWall, points, api.cloneWall);\r\n  const oldSectorBuilder = new SectorBuilder();\r\n  const newSectorBuilder = new SectorBuilder()\r\n    .addWalls(existedWalls)\r\n    .addWalls(createNewWalls(newWalls, [], refWall, board, api.cloneWall))\r\n    .loop();\r\n  const firstLoopLength = newSectorBuilder.getWalls().length();\r\n\r\n  for (const lid of loopPoints(board, sectorId)) {\r\n    if (loopStart(board, lid) == start) continue;\r\n    else (loopInPolygon(board, lid, loopPoly) ? newSectorBuilder : oldSectorBuilder).addLoop(map(loopWalls(board, lid), WALL_MAPPER));\r\n  }\r\n  const newSectorId = addSector(board, api.cloneSector(board.sectors[sectorId]));\r\n  newSectorBuilder.build(board, newSectorId, refs);\r\n  const newSector = board.sectors[newSectorId];\r\n  const wallEnd = newSector.wallptr + firstLoopLength - 1;\r\n  const mwalls = iter(range(wallEnd, wallEnd - lengthWoLast)).map(w => <point2d>[newSectorId, w]).collect();\r\n  const reversedWoLast = iter(reversed(points)).take(lengthWoLast);\r\n  oldSectorBuilder\r\n    .addWalls(createNewWalls(reversedWoLast, mwalls, refWall, board, api.cloneWall))\r\n    .addWalls(iter(wallsBetween(board, firstWall, lastWall)).map(w => board.walls[w]))\r\n    .loop();\r\n  // const usedWalls = iter(sectorWalls(board, newSectorId)).map(WALL_MAPPER).collect();\r\n  // iter(sectorWalls(board, sectorId))\r\n  //   .filter(w => usedWalls.includes(board.walls[w]))\r\n  //   .forEach(w => board.walls[w] = null);\r\n  oldSectorBuilder.build(board, sectorId, refs);\r\n  return newSectorId;\r\n}\r\n\r\nconst POINT_MAPPER = (w: Wall) => <point2d>[w.x, w.y];\r\nfunction getSplitLoop(board: Board, firstWall: number, lastWall: number, points: Iterable<point2d>, cloneWall: WallCloner): [Iterable<point2d>, Iterable<Wall>, Iterable<point2d>] {\r\n  const newWalls = iter(points).butLast().collect();\r\n  const existedWalls = [...iter(wallsBetween(board, lastWall, firstWall)).map(w => cloneWall(board.walls[w]))];\r\n  const loopPoly = iter(map(existedWalls, POINT_MAPPER)).chain(newWalls).collect();\r\n  return [newWalls, existedWalls, loopPoly];\r\n}\r\n\r\nfunction checkPointsOrder(board: Board, firstWall: number, lastWall: number, points: Collection<point2d>, cloneWall: WallCloner): boolean {\r\n  const [, , loop] = getSplitLoop(board, firstWall, lastWall, points, cloneWall);\r\n  return clockwise(loop);\r\n}\r\n\r\nexport function splitSector(board: Board, sectorId: number, points: Collection<point2d>, refs: BuildReferenceTracker, api: EngineApi) {\r\n  const [firstWall, lastWall, loop] = checkSplitSector(board, sectorId, points);\r\n  if (checkPointsOrder(board, firstWall, lastWall, points, api.cloneWall))\r\n    return splitSectorImpl(board, sectorId, firstWall, lastWall, loop, points, refs, api);\r\n  else\r\n    return splitSectorImpl(board, sectorId, lastWall, firstWall, loop, wrap([...reversed(points)]), refs, api);\r\n}","import { GridController } from \"../../../app/apis/app\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { findFirst } from \"../../../utils/collections\";\r\nimport { int } from \"../../../utils/mathutils\";\r\nimport { slope, wallNormal } from \"../../utils\";\r\nimport { distanceToWallSegment } from \"../distances\";\r\nimport { sectorWalls } from \"../loops\";\r\nimport { findSector, snapWall } from \"../query\";\r\nimport { Board, Sprite } from \"../structs\";\r\n\r\nexport function moveSprite(board: Board, sprId: number, x: number, y: number, z: number): boolean {\r\n  var spr = board.sprites[sprId];\r\n  if (spr.x == x && spr.y == y && spr.z == z) return false;\r\n  spr.x = x; spr.y = y; spr.z = z;\r\n  spr.sectnum = findSector(board, x, y, spr.sectnum);\r\n  return true;\r\n}\r\n\r\nfunction ornamentWall(board: Board, wallId: number, x: number, y: number, grid: GridController): [number, number] {\r\n  const n = wallNormal(vec3.create(), board, wallId);\r\n  const [nx, ny] = snapWall(board, wallId, x, y, grid)\r\n  return [int(nx + n[0] * 4), int(ny + n[2] * 4)];\r\n}\r\n\r\nfunction selectOrnamentWall(board: Board, sectorId: number, wallId: number, x: number, y: number, z: number): [number, number] {\r\n  const sector = board.sectors[sectorId];\r\n  const wall = board.walls[wallId];\r\n  if (wall.nextwall != -1) {\r\n    const nextSectorId = wall.nextsector;\r\n    const nextSector = board.sectors[nextSectorId];\r\n    const f1z = slope(board, sectorId, x, y, sector.floorheinum) + sector.floorz;\r\n    const c1z = slope(board, sectorId, x, y, sector.ceilingheinum) + sector.ceilingz;\r\n    const f2z = slope(board, nextSectorId, x, y, nextSector.floorheinum) + nextSector.floorz;\r\n    const c2z = slope(board, nextSectorId, x, y, nextSector.ceilingheinum) + nextSector.ceilingz;\r\n    if ((z > f1z || z < c1z) && z <= f2z && z >= c2z) return [wall.nextwall, wall.nextsector];\r\n    if ((z > f2z || z < c2z) && z <= f1z && z >= c1z) return [wallId, sectorId];\r\n    return [-1, -1];\r\n  }\r\n  return [wallId, sectorId];\r\n}\r\n\r\nfunction tryMoveSprite(sprite: Sprite, x: number, y: number, z: number, sectorId: number): boolean {\r\n  if (sprite.x == x && sprite.y == y && sprite.z == z && sprite.sectnum == sectorId) return false;\r\n  sprite.x = x;\r\n  sprite.y = y;\r\n  sprite.z = z;\r\n  sprite.sectnum = sectorId;\r\n  return true;\r\n}\r\n\r\nexport function moveSpriteX(board: Board, spriteId: number, x: number, y: number, z: number, grid: GridController): boolean {\r\n  const sprite = board.sprites[spriteId];\r\n  if (sprite.x == x && sprite.y == y && sprite.z == z) return false;\r\n  const tsectorId = findSector(board, x, y, sprite.sectnum);\r\n  const newSectorId = tsectorId == -1 ? sprite.sectnum : tsectorId;\r\n  const d = grid.getGridSize();\r\n  const w = findFirst(sectorWalls(board, newSectorId), w => distanceToWallSegment(board, w, x, y) <= d, -1);\r\n  if (w != -1) {\r\n    const ow = selectOrnamentWall(board, newSectorId, w, x, y, sprite.z);\r\n    if (ow[0] == -1) {\r\n      return tryMoveSprite(sprite, x, y, z, newSectorId);\r\n    } else {\r\n      const [nx, ny] = ornamentWall(board, ow[0], x, y, grid);\r\n      return tryMoveSprite(sprite, nx, ny, z, ow[1]);\r\n    }\r\n  } else {\r\n    if (tsectorId == -1) return false;\r\n    return tryMoveSprite(sprite, x, y, z, newSectorId);\r\n  }\r\n}","import { BuildReferenceTracker } from \"../../../app/apis/app\";\r\nimport { vec3 } from \"../../../libs_js/glmatrix\";\r\nimport { forEach, length } from \"../../../utils/collections\";\r\nimport { cross2d, int } from \"../../../utils/mathutils\";\r\nimport { ArtInfoProvider } from \"../../formats/art\";\r\nimport { wallNormal } from \"../../utils\";\r\nimport { connectedWalls, loopWalls } from \"../loops\";\r\nimport { walllen, sectorOfWall, lastwall, isValidWallId, nextwall, isTJunction } from \"../query\";\r\nimport { Board, Wall } from \"../structs\";\r\nimport { DEFAULT_REPEAT_RATE, moveWalls } from \"./internal\";\r\nimport { EngineApi } from \"./api\";\r\n\r\nexport function fixxrepeat(board: Board, wallId: number, reprate: number = DEFAULT_REPEAT_RATE) {\r\n  const wall = board.walls[wallId];\r\n  wall.xrepeat = Math.min(255, Math.max(1, Math.round((walllen(board, wallId) + 0.5) / reprate)))\r\n}\r\n\r\nfunction fixpoint2xpan(board: Board, wallId: number, art: ArtInfoProvider) {\r\n  const wall = board.walls[wallId];\r\n  const wall2 = board.walls[wall.point2];\r\n  wall2.xpanning = ((wall.xpanning + (wall.xrepeat << 3)) % art.getInfo(wall.picnum).w) & 0xff;\r\n}\r\n\r\nfunction insertWall(board: Board, wallId: number, x: number, y: number, art: ArtInfoProvider, refs: BuildReferenceTracker, cloneWall: (w: Wall) => Wall) {\r\n  const secId = sectorOfWall(board, wallId);\r\n  const wall = board.walls[wallId];\r\n  const lenperrep = walllen(board, wallId) / Math.max(wall.xrepeat, 1);\r\n  moveWalls(board, secId, wallId, 1, refs);\r\n  const nwall = cloneWall(wall);\r\n  nwall.x = x;\r\n  nwall.y = y;\r\n  board.walls[wallId + 1] = nwall;\r\n  wall.point2 = wallId + 1;\r\n  fixxrepeat(board, wallId, lenperrep);\r\n  fixpoint2xpan(board, wallId, art);\r\n  fixxrepeat(board, wallId + 1, lenperrep);\r\n}\r\n\r\nexport function splitWall(board: Board, wallId: number, x: number, y: number, art: ArtInfoProvider, refs: BuildReferenceTracker, cloneWall: (w: Wall) => Wall): number {\r\n  if (!isValidWallId(board, wallId)) throw new Error('Invalid wall: ' + wallId);\r\n  const wall = board.walls[wallId];\r\n  insertWall(board, wallId, x, y, art, refs, cloneWall);\r\n  if (wall.nextwall != -1) {\r\n    const nextwallId = wall.nextwall;\r\n    insertWall(board, nextwallId, x, y, art, refs, cloneWall);\r\n    const wallId = board.walls[nextwallId].nextwall;\r\n    board.walls[wallId].nextwall = nextwallId + 1;\r\n    board.walls[wallId + 1].nextwall = nextwallId;\r\n    board.walls[nextwallId].nextwall = wallId + 1;\r\n    board.walls[nextwallId + 1].nextwall = wallId;\r\n    return wallId;\r\n  }\r\n  return wallId;\r\n}\r\n\r\nfunction doMoveWall(board: Board, w: number, x: number, y: number) {\r\n  board.walls[w].x = x;\r\n  board.walls[w].y = y;\r\n  fixxrepeat(board, w);\r\n  fixxrepeat(board, lastwall(board, w));\r\n}\r\n\r\nexport function moveWall(board: Board, wallId: number, x: number, y: number): boolean {\r\n  const wall = board.walls[wallId];\r\n  if (wall.x == x && wall.y == y) return false;\r\n  forEach(connectedWalls(board, wallId), w => doMoveWall(board, w, x, y));\r\n  return true;\r\n}\r\n\r\n\r\nconst _wallNormal = vec3.create();\r\nexport function pushWall(board: Board, wallId: number, len: number, art: ArtInfoProvider, alwaysNewPoints = false, refs: BuildReferenceTracker, api: EngineApi) {\r\n  if (len == 0) return wallId;\r\n  let w1 = wallId;\r\n  const wall1 = board.walls[w1];\r\n  let w2 = wall1.point2;\r\n  const wall2 = board.walls[w2];\r\n  const p1 = lastwall(board, w1);\r\n  const prev1 = board.walls[p1];\r\n  const n2 = wall2.point2;\r\n  const next2 = board.walls[n2];\r\n  const normal = wallNormal(_wallNormal, board, wallId);\r\n  const [nx, _, ny] = vec3.scale(normal, normal, len);\r\n  const x1 = int(wall1.x + nx);\r\n  const y1 = int(wall1.y + ny);\r\n  const x2 = int(wall2.x + nx);\r\n  const y2 = int(wall2.y + ny);\r\n\r\n  if (alwaysNewPoints) {\r\n    w1 = splitWall(board, w1, x1, y1, art, refs, api.cloneWall);\r\n    w2 = nextwall(board, w1);\r\n    splitWall(board, w2, x2, y2, art, refs, api.cloneWall);\r\n  }\r\n\r\n  const extent1 = cross2d(x1 - prev1.x, y1 - prev1.y, wall1.x - prev1.x, wall1.y - prev1.y) == 0;\r\n  const extent2 = cross2d(x2 - next2.x, y2 - next2.y, wall2.x - next2.x, wall2.y - next2.y) == 0;\r\n\r\n  if (extent1 && extent2) {\r\n    moveWall(board, w1, x1, y1);\r\n    moveWall(board, w2, x2, y2);\r\n  } else if (extent1 && !extent2) {\r\n    moveWall(board, w1, x1, y1);\r\n    splitWall(board, w1, x2, y2, art, refs, api.cloneWall);\r\n  } else if (!extent1 && extent2) {\r\n    w1 = splitWall(board, w1, x1, y1, art, refs, api.cloneWall);\r\n    w2 = nextwall(board, nextwall(board, w1));\r\n    moveWall(board, w2, x2, y2);\r\n  } else if (!extent1 && !extent2) {\r\n    w1 = splitWall(board, w1, x1, y1, art, refs, api.cloneWall);\r\n    w2 = nextwall(board, w1);\r\n    splitWall(board, w2, x2, y2, art, refs, api.cloneWall);\r\n  }\r\n}\r\n\r\nexport function deleteWall(board: Board, wallId: number, refs: BuildReferenceTracker) {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  if (isTJunction(board, wallId)) throw new Error(`Wall ${wallId} is sector T junction`);\r\n  if (length(loopWalls(board, wallId)) < 4) throw new Error(`Loop of Wall ${wallId} need to have 3 walls at minimum`);\r\n  const sectorId = sectorOfWall(board, wallId);\r\n  const wall = board.walls[wallId];\r\n  if (wall.nextsector != -1) {\r\n    if (length(loopWalls(board, wall.nextwall)) < 4) throw new Error(`Loop of Wall ${wall.nextwall} need to have 3 walls minimum`);\r\n    const wall2Id = board.walls[wall.nextwall].point2;\r\n    const lastWallId = lastwall(board, wallId);\r\n    board.walls[lastWallId].nextwall = wall.nextwall;\r\n    board.walls[wall.nextwall].nextwall = lastWallId;\r\n    wall.nextwall = -1;\r\n    wall.nextsector = -1;\r\n    moveWalls(board, wall.nextsector, wall2Id, -1, refs);\r\n    wallId += wallId > wall2Id ? -1 : 0;\r\n  }\r\n  moveWalls(board, sectorId, wallId, -1, refs);\r\n}\r\n\r\nexport function mergePoints(board: Board, wallId: number, refs: BuildReferenceTracker) {\r\n  const wall = board.walls[wallId];\r\n  const wall2 = board.walls[wall.point2];\r\n  if (wall.x == wall2.x && wall.y == wall2.y) deleteWall(board, wallId, refs);\r\n}\r\n","import { GridController } from \"../../app/apis/app\";\r\nimport { any, findFirst, interpolate, intersect, range } from \"../../utils/collections\";\r\nimport { NumberInterpolator } from \"../../utils/interpolator\";\r\nimport { iter } from \"../../utils/iter\";\r\nimport { cross2d, int, len2d, tuple2 } from \"../../utils/mathutils\";\r\nimport { connectedWalls, sectorWalls } from \"./loops\";\r\nimport { DEFAULT_REPEAT_RATE } from \"./mutations/internal\";\r\nimport { Board } from \"./structs\";\r\n\r\nexport function isValidWallId(board: Board, wallId: number): boolean {\r\n  return wallId >= 0 && wallId < board.numwalls;\r\n}\r\n\r\nexport function isValidSectorId(board: Board, sectorId: number): boolean {\r\n  return sectorId >= 0 && sectorId < board.numsectors;\r\n}\r\n\r\nexport function isValidSpriteId(board: Board, spriteId: number): boolean {\r\n  return spriteId >= 0 && spriteId < board.numsprites;\r\n}\r\n\r\nexport function wallInSector(board: Board, sectorId: number, x: number, y: number) {\r\n  return findFirst(sectorWalls(board, sectorId), w => board.walls[w].x == x && board.walls[w].y == y, -1);\r\n}\r\n\r\nexport function walllen(board: Board, wallId: number) {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  const wall = board.walls[wallId];\r\n  const wall2 = board.walls[wall.point2];\r\n  const dx = wall2.x - wall.x;\r\n  const dy = wall2.y - wall.y;\r\n  return len2d(dx, dy);\r\n}\r\n\r\nexport function lastwall(board: Board, wallId: number): number {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  if (wallId > 0 && board.walls[wallId - 1].point2 == wallId) return wallId - 1;\r\n  for (let w = wallId; ; w = board.walls[w].point2) {\r\n    if (board.walls[w].point2 == wallId) return w;\r\n  }\r\n}\r\n\r\nexport function nextwall(board: Board, wallId: number): number {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  return board.walls[wallId].point2;\r\n}\r\n\r\nexport function isJoinedSectors(board: Board, sectorId1: number, sectorId2: number) {\r\n  return any(sectorWalls(board, sectorId1), w => board.walls[w].nextsector == sectorId2);\r\n}\r\n\r\nexport function isTJunction(board: Board, wallId: number) {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  const wall = board.walls[wallId];\r\n  const lwall = board.walls[lastwall(board, wallId)];\r\n  return wall.nextsector != lwall.nextsector;\r\n}\r\n\r\nconst NULL_SECTOR_SET = new Set([-1]);\r\nexport function findSectorsAtPoint(board: Board, x: number, y: number): Set<number> {\r\n  const sectorId = findSector(board, x, y);\r\n  if (sectorId == -1) return NULL_SECTOR_SET;\r\n  const wallId = wallInSector(board, sectorId, x, y);\r\n  if (wallId == -1) return new Set([sectorId]);\r\n  return new Set(iter(connectedWalls(board, wallId))\r\n    .map(w => sectorOfWall(board, w)));\r\n}\r\n\r\nexport function findContainingSector(board: Board, points: Iterable<[number, number]>) {\r\n  return iter(points)\r\n    .map(p => findSectorsAtPoint(board, p[0], p[1]))\r\n    .reduce((lh, rh) => { return lh == null ? rh : intersect(lh, rh) }, null)\r\n}\r\n\r\nfunction pointInterpolator(lh: [number, number], rh: [number, number], t: number) {\r\n  return <[number, number]>[NumberInterpolator(lh[0], rh[0], t), NumberInterpolator(lh[1], rh[1], t)]\r\n}\r\n\r\nexport function findContainingSectorMidPoints(board: Board, points: Iterable<[number, number]>): Set<number> {\r\n  const interpolated = interpolate(points, pointInterpolator);\r\n  return findContainingSector(board, interpolated);\r\n}\r\n\r\nexport function inSector(board: Board, x: number, y: number, sectorId: number): boolean {\r\n  if (sectorId < 0 || sectorId >= board.numsectors) return false;\r\n  x = int(x);\r\n  y = int(y);\r\n  let inter = 0;\r\n  for (const w of sectorWalls(board, sectorId)) {\r\n    const wall = board.walls[w];\r\n    const wall2 = board.walls[wall.point2];\r\n    const dy1 = wall.y - y;\r\n    const dy2 = wall2.y - y;\r\n    const dx1 = wall.x - x;\r\n    const dx2 = wall2.x - x;\r\n    if (dx1 == 0 && dx2 == 0 && (dy1 == 0 || dy2 == 0 || (dy1 ^ dy2) < 0)) return true;\r\n    if (dy1 == 0 && dy2 == 0 && (dx1 == 0 || dx2 == 0 || (dx1 ^ dx2) < 0)) return true;\r\n\r\n    if ((dy1 ^ dy2) < 0) {\r\n      if ((dx1 ^ dx2) >= 0) inter ^= dx1;\r\n      else inter ^= cross2d(dx1, dy1, dx2, dy2) ^ dy2;\r\n    }\r\n  }\r\n  return (inter >>> 31) == 1;\r\n}\r\n\r\nexport function sectorOfWall(board: Board, wallId: number): number {\r\n  if (wallId < 0 || wallId >= board.numwalls) return -1;\r\n  const wall = board.walls[wallId];\r\n  if (wall.nextwall != -1) return board.walls[wall.nextwall].nextsector;\r\n  let start = 0;\r\n  let end = board.numsectors - 1;\r\n  while (end - start >= 0) {\r\n    const pivot = int(start + (end - start) / 2);\r\n    const sec = board.sectors[pivot];\r\n    if (sec.wallptr <= wallId && sec.wallptr + sec.wallnum - 1 >= wallId) return pivot;\r\n    if (sec.wallptr > wallId) end = pivot - 1;\r\n    else start = pivot + 1;\r\n  }\r\n}\r\n\r\nexport function findSector(board: Board, x: number, y: number, sectorId: number = -1): number {\r\n  if (!isValidSectorId(board, sectorId)) return findSectorAll(board, x, y);\r\n  const secs = [sectorId];\r\n  for (let i = 0; i < secs.length; i++) {\r\n    sectorId = secs[i];\r\n    const sec = board.sectors[sectorId];\r\n    if (inSector(board, x, y, sectorId)) return sectorId;\r\n    for (let w = 0; w < sec.wallnum; w++) {\r\n      const wallidx = w + sec.wallptr;\r\n      const wall = board.walls[wallidx];\r\n      if (wall.nextsector != -1) {\r\n        const nextsector = wall.nextsector;\r\n        if (secs.indexOf(nextsector) == -1)\r\n          secs.push(nextsector);\r\n      }\r\n    }\r\n  }\r\n  return -1;\r\n}\r\n\r\nfunction findSectorAll(board: Board, x: number, y: number) {\r\n  return findFirst(range(0, board.numsectors), s => inSector(board, x, y, s), -1);\r\n}\r\n\r\nexport function snapWall(board: Board, wallId: number, x: number, y: number, grid: GridController) {\r\n  if (!isValidWallId(board, wallId)) throw new Error(`Invalid wallId: ${wallId}`);\r\n  const wall = board.walls[wallId];\r\n  const w1 = nextwall(board, wallId);\r\n  const wall1 = board.walls[w1];\r\n  const dx = wall1.x - wall.x;\r\n  const dy = wall1.y - wall.y;\r\n  const repeat = DEFAULT_REPEAT_RATE * wall.xrepeat;\r\n  const dxt = x - wall.x;\r\n  const dyt = y - wall.y;\r\n  const dt = len2d(dxt, dyt) / len2d(dx, dy);\r\n  const t = grid.snap(dt * repeat) / repeat;\r\n  const xs = int(wall.x + (t * dx));\r\n  const ys = int(wall.y + (t * dy));\r\n  return [xs, ys];\r\n}","\r\n//  wallptr - index to first wall of sector\r\n//  wallnum - number of walls in sector\r\n//  z's - z coordinate (height) of ceiling / floor at first point of sector\r\n//  stat's\r\n//  bit 0: 1 = parallaxing, 0 = not                                 \"P\"\r\n//  bit 1: 1 = sloped, 0 = not\r\n//  bit 2: 1 = swap x&y, 0 = not                                    \"F\"\r\n//  bit 3: 1 = double smooshiness                                   \"E\"\r\n//  bit 4: 1 = x-flip                                               \"F\"\r\n//  bit 5: 1 = y-flip                                               \"F\"\r\n//  bit 6: 1 = Align texture to first wall of sector                \"R\"\r\n//  bits 7-15: reserved\r\n//  picnum's - texture index into art file\r\n//  heinum's - slope value (rise/run) (0-parallel to floor, 4096-45 degrees)\r\n//  shade's - shade offset of ceiling/floor\r\n//  pal's - palette lookup table number (0 - use standard colors)\r\n//  panning's - used to align textures or to do texture panning\r\n//  visibility - determines how fast an area changes shade relative to distance\r\n//  filler - useless byte to make structure aligned\r\n//  lotag, hitag, extra - These variables used by the game programmer only\r\n\r\nexport class SectorStats {\r\n  public parallaxing: number;\r\n  public slopped: number;\r\n  public swapXY: number;\r\n  public doubleSmooshiness: number;\r\n  public xflip: number;\r\n  public yflip: number;\r\n  public alignToFirstWall: number;\r\n  public unk: number;\r\n}\r\n\r\nexport class Sector {\r\n  public wallptr: number;\r\n  public wallnum: number;\r\n  public ceilingz: number;\r\n  public floorz: number;\r\n  public ceilingstat: SectorStats;\r\n  public floorstat: SectorStats;\r\n  public ceilingpicnum: number;\r\n  public ceilingheinum: number;\r\n  public ceilingshade: number;\r\n  public ceilingpal: number;\r\n  public ceilingxpanning: number;\r\n  public ceilingypanning: number;\r\n  public floorpicnum: number;\r\n  public floorheinum: number;\r\n  public floorshade: number;\r\n  public floorpal: number;\r\n  public floorxpanning: number;\r\n  public floorypanning: number;\r\n  public visibility: number;\r\n  public filler: number;\r\n  public lotag: number;\r\n  public hitag: number;\r\n  public extra: number;\r\n}\r\n\r\n//  x, y: Coordinate of left side of wall, get right side from next wall's left side\r\n//  point2: Index to next wall on the right (always in the same sector)\r\n//  nextwall: Index to wall on other side of wall (-1 if there is no sector)\r\n//  nextsector: Index to sector on other side of wall (-1 if there is no sector)\r\n//  cstat:\r\n//    bit 0: 1 = Blocking wall (use with clipmove, getzrange)         \"B\"\r\n//  bit 1: 1 = bottoms of invisible walls swapped, 0 = not          \"2\"\r\n//  bit 2: 1 = align picture on bottom (for doors), 0 = top         \"O\"\r\n//  bit 3: 1 = x-flipped, 0 = normal                                \"F\"\r\n//  bit 4: 1 = masking wall, 0 = not                                \"M\"\r\n//  bit 5: 1 = 1-way wall, 0 = not                                  \"1\"\r\n//  bit 6: 1 = Blocking wall (use with hitscan / cliptype 1)        \"H\"\r\n//  bit 7: 1 = Transluscence, 0 = not                               \"T\"\r\n//  bit 8: 1 = y-flipped, 0 = normal                                \"F\"\r\n//  bit 9: 1 = Transluscence reversing, 0 = normal                  \"T\"\r\n//  bits 10-15: reserved\r\n//  picnum - texture index into art file\r\n//  overpicnum - texture index into art file for masked walls / 1-way walls\r\n//  shade - shade offset of wall\r\n//  pal - palette lookup table number (0 - use standard colors)\r\n//  repeat's - used to change the size of pixels (stretch textures)\r\n//  pannings - used to align textures or to do texture panning\r\n//  lotag, hitag, extra - These variables used by the game programmer only\r\n\r\nexport class WallStats {\r\n  public blocking: number;\r\n  public swapBottoms: number;\r\n  public alignBottom: number;\r\n  public xflip: number;\r\n  public masking: number;\r\n  public oneWay: number;\r\n  public blocking2: number;\r\n  public translucent: number;\r\n  public yflip: number;\r\n  public translucentReversed: number;\r\n  public unk: number;\r\n}\r\n\r\nexport class Wall {\r\n  public x: number;\r\n  public y: number;\r\n  public point2: number;\r\n  public nextwall: number;\r\n  public nextsector: number;\r\n  public cstat: WallStats;\r\n  public picnum: number;\r\n  public overpicnum: number;\r\n  public shade: number;\r\n  public pal: number;\r\n  public xrepeat: number;\r\n  public yrepeat: number;\r\n  public xpanning: number;\r\n  public ypanning: number;\r\n  public lotag: number;\r\n  public hitag: number;\r\n  public extra: number;\r\n}\r\n\r\n//  x, y, z - position of sprite - can be defined at center bottom or center\r\n//  cstat:\r\n//    bit 0: 1 = Blocking sprite (use with clipmove, getzrange)       \"B\"\r\n//  bit 1: 1 = transluscence, 0 = normal                            \"T\"\r\n//  bit 2: 1 = x-flipped, 0 = normal                                \"F\"\r\n//  bit 3: 1 = y-flipped, 0 = normal                                \"F\"\r\n//  bits 5-4: 00 = FACE sprite (default)                            \"R\"\r\n//  01 = WALL sprite (like masked walls)\r\n//  10 = FLOOR sprite (parallel to ceilings&floors)\r\n//  bit 6: 1 = 1-sided sprite, 0 = normal                           \"1\"\r\n//  bit 7: 1 = Real centered centering, 0 = foot center             \"C\"\r\n//  bit 8: 1 = Blocking sprite (use with hitscan / cliptype 1)      \"H\"\r\n//  bit 9: 1 = Transluscence reversing, 0 = normal                  \"T\"\r\n//  bits 10-14: reserved\r\n//  bit 15: 1 = Invisible sprite, 0 = not invisible\r\n//  picnum - texture index into art file\r\n//  shade - shade offset of sprite\r\n//  pal - palette lookup table number (0 - use standard colors)\r\n//  clipdist - the size of the movement clipping square (face sprites only)\r\n//  filler - useless byte to make structure aligned\r\n//  repeat's - used to change the size of pixels (stretch textures)\r\n//  offset's - used to center the animation of sprites\r\n//  sectnum - current sector of sprite\r\n//  statnum - current status of sprite (inactive/monster/bullet, etc.)\r\n//\r\n//  ang - angle the sprite is facing\r\n//  owner, xvel, yvel, zvel, lotag, hitag, extra - These variables used by the\r\n//  game programmer only\r\n\r\nexport const FACE_SPRITE = 0;\r\nexport const WALL_SPRITE = 1;\r\nexport const FLOOR_SPRITE = 2;\r\n\r\nexport class SpriteStats {\r\n  public blocking: number;\r\n  public translucent: number;\r\n  public xflip: number;\r\n  public yflip: number;\r\n  public type: number; // 0 - FACE, 1 - WALL, 2 - FLOOR\r\n  public onesided: number;\r\n  public realCenter: number;\r\n  public blocking2: number;\r\n  public tranclucentReversed: number;\r\n  public noautoshading: number;\r\n  public reserved: number;\r\n  public invisible: number;\r\n  public unk: number;\r\n}\r\n\r\nexport class Sprite {\r\n  public x: number;\r\n  public y: number;\r\n  public z: number;\r\n  public cstat: SpriteStats;\r\n  public picnum: number;\r\n  public shade: number;\r\n  public pal: number;\r\n  public clipdist: number;\r\n  public filler: number;\r\n  public xrepeat: number;\r\n  public yrepeat: number;\r\n  public xoffset: number;\r\n  public yoffset: number;\r\n  public sectnum: number;\r\n  public statnum: number;\r\n  public ang: number;\r\n  public owner: number;\r\n  public xvel: number;\r\n  public yvel: number;\r\n  public zvel: number;\r\n  public lotag: number;\r\n  public hitag: number;\r\n  public extra: number;\r\n}\r\n\r\nexport class Board {\r\n  public version: number;\r\n  public posx: number;\r\n  public posy: number;\r\n  public posz: number;\r\n  public ang: number;\r\n  public cursectnum: number;\r\n  public numsectors: number;\r\n  public sectors: Sector[];\r\n  public numwalls: number;\r\n  public walls: Wall[];\r\n  public numsprites: number;\r\n  public sprites: Sprite[];\r\n}\r\n\r\n\r\nexport class Header1 {\r\n  public startX: number;\r\n  public startY: number;\r\n  public startZ: number;\r\n  public startAng: number;\r\n  public startSec: number;\r\n  public unk: number;\r\n}\r\n\r\n","import { arcsIntersects, monoatan2, dot2d, len2d } from '../utils/mathutils';\r\nimport * as GLM from '../libs_js/glmatrix';\r\nimport { Deck, IndexedDeck } from '../utils/collections';\r\nimport * as PROFILE from '../utils/profiler';\r\nimport { Board } from './board/structs';\r\nimport * as U from './utils';\r\nimport { inSector, nextwall } from './board/query';\r\n\r\nexport function packWallSectorId(wallId: number, sectorId: number) {\r\n  return wallId | (sectorId << 16)\r\n}\r\n\r\nexport function unpackWallId(wallSectorId: number) {\r\n  return wallSectorId & 0xffff;\r\n}\r\n\r\nexport function unpackSectorId(wallSectorId: number) {\r\n  return (wallSectorId >> 16) & 0xffff;\r\n}\r\n\r\n\r\nexport interface VisResult {\r\n  forSector<T>(ctx: T, secv: SectorVisitor<T>): void;\r\n  forWall<T>(ctx: T, wallv: WallVisitor<T>): void;\r\n  forSprite<T>(ctx: T, sprv: SpriteVisitor<T>): void;\r\n}\r\n\r\nexport type SectorVisitor<T> = (ctx: T, sectorId: number) => void;\r\nexport type SectorPredicate<T> = (ctx: T, sectorId: number) => boolean;\r\nexport type WallVisitor<T> = (ctx: T, wallId: number, sectorId: number) => void;\r\nexport type WallPredicate<T> = (ctx: T, wallId: number, sectorId: number) => boolean;\r\nexport type SpriteVisitor<T> = (ctx: T, spriteId: number) => void;\r\nexport type SpritePredicate<T> = (ctx: T, spriteId: number) => boolean;\r\n\r\nexport class SectorCollector<T> {\r\n  private visitor: SectorVisitor<T>;\r\n  public sectors = new Deck<number>();\r\n\r\n  constructor(pred: SectorPredicate<T>) {\r\n    this.visitor = (ctx: T, sectorId: number) => {\r\n      if (pred(ctx, sectorId))\r\n        this.sectors.push(sectorId);\r\n    }\r\n  }\r\n\r\n  public visit(): SectorVisitor<T> {\r\n    this.sectors.clear();\r\n    return this.visitor;\r\n  }\r\n}\r\n\r\nexport function createSectorCollector<T>(pred: SectorPredicate<T>) {\r\n  return new SectorCollector(pred);\r\n}\r\n\r\nexport class WallCollector<T> {\r\n  private visitor: WallVisitor<T>;\r\n  public walls = new Deck<number>();\r\n\r\n  constructor(pred: WallPredicate<T>) {\r\n    this.visitor = (ctx: T, wallId: number, sectorId: number) => {\r\n      if (pred(ctx, wallId, sectorId))\r\n        this.walls.push(packWallSectorId(wallId, sectorId));\r\n    }\r\n  }\r\n\r\n  public visit(): WallVisitor<T> {\r\n    this.walls.clear();\r\n    return this.visitor;\r\n  }\r\n}\r\n\r\nexport function createWallCollector<T>(pred: WallPredicate<T>) {\r\n  return new WallCollector(pred);\r\n}\r\n\r\nexport class SpriteCollector<T> {\r\n  private visitor: SpriteVisitor<T>;\r\n  public sprites = new Deck<number>();\r\n\r\n  constructor(pred: SpritePredicate<T>) {\r\n    this.visitor = (ctx: T, spriteId: number) => {\r\n      if (pred(ctx, spriteId))\r\n        this.sprites.push(spriteId);\r\n    }\r\n  }\r\n\r\n  public visit(): SectorVisitor<T> {\r\n    this.sprites.clear();\r\n    return this.visitor;\r\n  }\r\n}\r\n\r\nexport function createSpriteCollector<T>(pred: SpritePredicate<T>) {\r\n  return new SpriteCollector(pred);\r\n}\r\n\r\n\r\nexport class AllBoardVisitorResult implements VisResult {\r\n  private board: Board;\r\n\r\n  visit(board: Board): VisResult {\r\n    this.board = board;\r\n    return this;\r\n  }\r\n\r\n  public forSector<T>(ctx: T, secv: SectorVisitor<T>) {\r\n    for (let s = 0; s < this.board.numsectors; s++)\r\n      secv(ctx, s);\r\n  }\r\n\r\n  public forWall<T>(ctx: T, wallv: WallVisitor<T>) {\r\n    for (let s = 0; s < this.board.numsectors; s++) {\r\n      let sec = this.board.sectors[s];\r\n      let endwall = sec.wallptr + sec.wallnum;\r\n      for (let w = sec.wallptr; w < endwall; w++)\r\n        wallv(ctx, w, s);\r\n    }\r\n  }\r\n\r\n  public forSprite<T>(ctx: T, sprv: SpriteVisitor<T>) {\r\n    for (let s = 0; s < this.board.numsprites; s++)\r\n      sprv(ctx, s);\r\n  }\r\n}\r\n\r\nexport class TopDownBoardVisitorResult implements VisResult {\r\n  private board: Board;\r\n  private cx: number;\r\n  private cy: number;\r\n  private dist: number;\r\n  private visibleSectors = new Set<number>();\r\n\r\n  visit(board: Board, campos: GLM.Vec3Array, dist: number): VisResult {\r\n    this.board = board;\r\n    this.cx = campos[0];\r\n    this.cy = campos[2];\r\n    this.dist = dist;\r\n    this.prescan();\r\n    return this;\r\n  }\r\n\r\n  private prescan() {\r\n    this.visibleSectors.clear();\r\n    for (let s = 0; s < this.board.numsectors; s++) {\r\n      if (inSector(this.board, this.cx, this.cy, s)) {\r\n        this.visibleSectors.add(s);\r\n        continue;\r\n      }\r\n      let sec = this.board.sectors[s];\r\n      let end = sec.wallptr + sec.wallnum;\r\n      for (let w = sec.wallptr; w < end; w++) {\r\n        let wall = this.board.walls[w];\r\n        if (len2d(this.cx - wall.x, this.cy - wall.y) < this.dist) {\r\n          this.visibleSectors.add(s);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  forSector<T>(ctx: T, secv: SectorVisitor<T>): void {\r\n    for (let s of this.visibleSectors.keys()) secv(ctx, s);\r\n  }\r\n\r\n  forWall<T>(ctx: T, wallv: WallVisitor<T>): void {\r\n    for (let s of this.visibleSectors.keys()) {\r\n      let sec = this.board.sectors[s];\r\n      let end = sec.wallptr + sec.wallnum;\r\n      for (let w = sec.wallptr; w < end; w++) {\r\n        let wall = this.board.walls[w];\r\n        if (len2d(this.cx - wall.x, this.cy - wall.y) < this.dist) {\r\n          wallv(ctx, w, s);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  forSprite<T>(ctx: T, sprv: SpriteVisitor<T>): void {\r\n    for (let s = 0; s < this.board.numsprites; s++) {\r\n      let spr = this.board.sprites[s];\r\n      if (len2d(this.cx - spr.x, this.cy - spr.y) < this.dist) sprv(ctx, s);\r\n    }\r\n  }\r\n}\r\n\r\nfunction wallBehind(board: Board, wallId: number, ms: U.MoveStruct, fwd: GLM.Mat3Array) {\r\n  // return false;\r\n  let wall1 = board.walls[wallId];\r\n  let wall2 = board.walls[wall1.point2];\r\n  let dx1 = wall1.x - ms.x; let dy1 = wall1.y - ms.y;\r\n  let dx2 = wall2.x - ms.x; let dy2 = wall2.y - ms.y;\r\n  return dot2d(dx1, dy1, fwd[0], fwd[2]) < 0 && dot2d(dx2, dy2, fwd[0], fwd[2]) < 0;\r\n}\r\n\r\nexport class PvsBoardVisitorResult implements VisResult {\r\n  private sectors = new Deck<number>();\r\n  private walls = new Deck<number>();\r\n  private sprites = new Deck<number>();\r\n\r\n  private prepvs = new IndexedDeck<number>();\r\n  private pvs = new IndexedDeck<number>();\r\n  private entryWalls = new Map<number, Deck<number>>();\r\n  private angCache = new Map<number, number>();\r\n  private board: Board;\r\n\r\n\r\n  private init(board: Board, sectorId: number) {\r\n    this.board = board;\r\n    this.sectors.clear();\r\n    this.walls.clear();\r\n    this.sprites.clear();\r\n    this.prepvs.clear();\r\n    this.prepvs.push(sectorId);\r\n    this.pvs.clear();\r\n    this.pvs.push(sectorId);\r\n    this.angCache.clear();\r\n    this.entryWalls.clear();\r\n  }\r\n\r\n  private ensureEntryWalls(sectorId: number) {\r\n    let ewalls = this.entryWalls.get(sectorId);\r\n    if (ewalls == undefined) {\r\n      ewalls = new Deck<number>();\r\n      this.entryWalls.set(sectorId, ewalls);\r\n    }\r\n    return ewalls;\r\n  }\r\n\r\n  private fillPVS(ms: U.MoveStruct, fwd: GLM.Mat3Array) {\r\n    for (let i = 0; i < this.prepvs.length(); i++) {\r\n      let s = this.prepvs.get(i);\r\n      let sec = this.board.sectors[s];\r\n      if (sec == undefined) continue;\r\n      let endwall = sec.wallptr + sec.wallnum;\r\n      for (let w = sec.wallptr; w < endwall; w++) {\r\n        if (!U.wallVisible(this.board, w, ms) || wallBehind(this.board, w, ms, fwd)) continue;\r\n\r\n        let wall = this.board.walls[w];\r\n        let nextsector = wall.nextsector;\r\n        if (nextsector == -1) continue;\r\n        let nextwall = wall.nextwall;\r\n        if (this.prepvs.indexOf(nextsector) == -1) {\r\n          this.prepvs.push(nextsector);\r\n          this.ensureEntryWalls(nextsector)\r\n            .clear()\r\n            .push(nextwall);\r\n        } else {\r\n          this.ensureEntryWalls(nextsector)\r\n            .push(nextwall);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  private getAngForWall(wallId: number, ms: U.MoveStruct) {\r\n    let ang = this.angCache.get(wallId);\r\n    if (ang == undefined) {\r\n      let wall = this.board.walls[wallId];\r\n      let dx = wall.x - ms.x;\r\n      let dy = wall.y - ms.y;\r\n      ang = monoatan2(dy, dx);\r\n      this.angCache.set(wallId, ang);\r\n    }\r\n    return ang;\r\n  }\r\n\r\n  private visibleFromEntryWalls(wallId: number, entryWalls: Deck<number>, ms: U.MoveStruct) {\r\n    return true;\r\n    if (entryWalls.length() == 0)\r\n      return true;\r\n    for (let i = 0; i < entryWalls.length(); i++) {\r\n      let ew = entryWalls.get(i);\r\n      let a1s = this.getAngForWall(nextwall(this.board, ew), ms);\r\n      let a1e = this.getAngForWall(ew, ms);\r\n      let a2s = this.getAngForWall(wallId, ms);\r\n      let a2e = this.getAngForWall(nextwall(this.board, wallId), ms);\r\n      if (arcsIntersects(a1s, a1e, a2s, a2e))\r\n        return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n\r\n  public visit(board: Board, ms: U.MoveStruct, fwd: GLM.Mat3Array): VisResult {\r\n    this.init(board, ms.sec);\r\n    // this.fillPVS(ms, fwd);\r\n    PROFILE.get(null).inc('pvs', this.prepvs.length());\r\n    let sectors = board.sectors;\r\n    let sec2spr = U.groupSprites(board);\r\n    for (let i = 0; i < this.pvs.length(); i++) {\r\n      let s = this.pvs.get(i);\r\n      let entryWalls = this.ensureEntryWalls(s);\r\n      let sec = sectors[s];\r\n      if (sec == undefined) continue;\r\n\r\n      this.sectors.push(s);\r\n      let endwall = sec.wallptr + sec.wallnum;\r\n      for (let w = sec.wallptr; w < endwall; w++) {\r\n        if (!U.wallVisible(board, w, ms)\r\n          || wallBehind(board, w, ms, fwd)\r\n          || !this.visibleFromEntryWalls(w, entryWalls, ms))\r\n          continue;\r\n\r\n        this.walls.push(packWallSectorId(w, s));\r\n\r\n        let wall = board.walls[w];\r\n        let nextsector = wall.nextsector;\r\n        if (nextsector == -1) continue;\r\n        if (this.pvs.indexOf(nextsector) == -1) {\r\n          this.pvs.push(nextsector);\r\n        }\r\n      }\r\n\r\n      let sprs = sec2spr[s];\r\n      if (sprs != undefined) {\r\n        for (let i = 0; i < sprs.length; i++)\r\n          this.sprites.push(sprs[i]);\r\n      }\r\n    }\r\n    PROFILE.get(null).inc('pvs', this.pvs.length());\r\n    return this;\r\n  }\r\n\r\n  public forSector<T>(ctx: T, secv: SectorVisitor<T>) {\r\n    for (let i = 0; i < this.sectors.length(); i++)\r\n      secv(ctx, this.sectors.get(i));\r\n  }\r\n\r\n  public forWall<T>(ctx: T, wallv: WallVisitor<T>) {\r\n    for (let i = 0; i < this.walls.length(); i++) {\r\n      let id = this.walls.get(i);\r\n      wallv(ctx, unpackWallId(id), unpackSectorId(id));\r\n    }\r\n  }\r\n\r\n  public forSprite<T>(ctx: T, sprv: SpriteVisitor<T>) {\r\n    for (let i = 0; i < this.sprites.length(); i++)\r\n      sprv(ctx, this.sprites.get(i));\r\n  }\r\n}","import { struct, bits, Stream, array, ushort, atomic_array, ubyte, byte } from \"../../utils/stream\";\r\n\r\nexport class ArtInfo {\r\n  constructor(public w: number, public h: number, public attrs: Attributes, public img: Uint8Array) { }\r\n}\r\n\r\nexport const NO_ANIMATION = 0;\r\nexport const ANIMATE_FORWARD = 2;\r\nexport const OSCILLATING_ANIMATION = 1;\r\nexport const ANIMATE_BACKWARD = 3;\r\n\r\nexport class Attributes {\r\n  public frames = 0;\r\n  public type = NO_ANIMATION;\r\n  public xoff = 0;\r\n  public yoff = 0;\r\n  public speed = 0;\r\n  public unk = 0;\r\n}\r\n\r\nexport function animate(frame: number, info: ArtInfo) {\r\n  const max = info.attrs.frames + 1;\r\n  if (info.attrs.type == NO_ANIMATION) return 0;\r\n  else if (info.attrs.type == OSCILLATING_ANIMATION) {\r\n    const x = frame % (max * 2 - 2);\r\n    return x >= max ? max * 2 - 2 - x : x;\r\n  } else if (info.attrs.type == ANIMATE_FORWARD) return frame % max;\r\n  else if (info.attrs.type == ANIMATE_BACKWARD) return max - frame % max;\r\n}\r\n\r\nvar anumStruct = struct(Attributes)\r\n  .field('frames', bits(6))\r\n  .field('type', bits(2))\r\n  .field('xoff', byte)\r\n  .field('yoff', byte)\r\n  .field('speed', bits(4))\r\n  .field('unk', bits(4));\r\n\r\nexport class ArtFile {\r\n\r\n  public offsets: number[];\r\n  public ws: number[];\r\n  public hs: number[];\r\n  public anums: Attributes[];\r\n  public start: number;\r\n  public end: number;\r\n  public size: number;\r\n\r\n\r\n  constructor(private stream: Stream) {\r\n    var version = stream.readUInt();\r\n    var numtiles = stream.readUInt();\r\n    var start = stream.readUInt();\r\n    var end = stream.readUInt();\r\n    var size = end - start + 1;\r\n    var hs = array(ushort, size).read(stream);\r\n    var ws = array(ushort, size).read(stream);\r\n    var anums = array(anumStruct, size).read(stream);\r\n    var offsets = new Array<number>(size);\r\n    var offset = stream.mark();\r\n    for (var i = 0; i < size; i++) {\r\n      offsets[i] = offset;\r\n      offset += ws[i] * hs[i];\r\n    }\r\n\r\n    this.offsets = offsets;\r\n    this.ws = ws;\r\n    this.hs = hs;\r\n    this.anums = anums;\r\n    this.start = start;\r\n    this.end = end;\r\n    this.size = size;\r\n  }\r\n\r\n  public getInfo(id: number): ArtInfo {\r\n    var offset = this.offsets[id];\r\n    this.stream.setOffset(offset);\r\n    var w = this.ws[id];\r\n    var h = this.hs[id];\r\n    var anum = this.anums[id];\r\n    var pixels = atomic_array(ubyte, w * h).read(this.stream);\r\n    return new ArtInfo(h, w, anum, pixels);\r\n  }\r\n\r\n  public getStart(): number {\r\n    return this.start;\r\n  }\r\n\r\n  public getEnd(): number {\r\n    return this.end;\r\n  }\r\n}\r\n\r\nexport interface ArtInfoProvider {\r\n  getInfo(picnum: number): ArtInfo;\r\n}\r\n\r\nexport class ArtFiles implements ArtInfoProvider {\r\n\r\n  constructor(private arts: ArtFile[]) { }\r\n\r\n  private getArt(id: number) {\r\n    for (var i in this.arts) {\r\n      var art = this.arts[i];\r\n      if (id >= art.getStart() && id <= art.getEnd())\r\n        return art;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  public getInfo(id: number): ArtInfo {\r\n    var art = this.getArt(id);\r\n    if (art == null) return null;\r\n    return art.getInfo(id - art.getStart());\r\n  }\r\n}","import { Stream, atomic_array, ubyte } from \"../../utils/stream\";\r\n\r\nexport class GrpFile {\r\n  private data: Stream;\r\n  private count: number;\r\n  readonly files: { [index: string]: number } = {};\r\n  readonly sizes: { [index: string]: number } = {};\r\n\r\n  constructor(buf: ArrayBuffer) {\r\n    this.data = new Stream(buf, true);\r\n    this.loadFiles();\r\n  }\r\n\r\n  private loadFiles() {\r\n    const d = this.data;\r\n    d.setOffset(12);\r\n    this.count = d.readUInt();\r\n    let offset = this.count * 16 + 16;\r\n    for (let i = 0; i < this.count; i++) {\r\n      const fname = d.readByteString(12);\r\n      const size = d.readUInt();\r\n      this.files[fname.toLowerCase()] = offset;\r\n      this.sizes[fname.toLowerCase()] = size;\r\n      offset += size;\r\n    }\r\n  }\r\n\r\n  public get(fname: string): Stream {\r\n    const off = this.files[fname.toLowerCase()];\r\n    if (off == undefined) return null;\r\n    this.data.setOffset(off);\r\n    return this.data.subView();\r\n  }\r\n\r\n  public getArrayBuffer(fname: string) {\r\n    const stream = this.get(fname);\r\n    if (stream == null) return null;\r\n    return stream.readArrayBuffer(this.sizes[fname.toLowerCase()]);\r\n  }\r\n}\r\n\r\nexport function create(buf: ArrayBuffer): GrpFile {\r\n  return new GrpFile(buf);\r\n}\r\n\r\nexport function createPalette(stream: Stream): Uint8Array {\r\n  const pal = new Uint8Array(768);\r\n  for (let i = 0; i < 256; i++) {\r\n    pal[i * 3 + 0] = stream.readUByte() * 4;\r\n    pal[i * 3 + 1] = stream.readUByte() * 4;\r\n    pal[i * 3 + 2] = stream.readUByte() * 4;\r\n  }\r\n  return pal;\r\n}\r\n\r\nexport function loadShadeTables(stream: Stream): Uint8Array[] {\r\n  stream.skip(0x300);\r\n  const size = stream.readUShort();\r\n  const table = atomic_array(ubyte, 256);\r\n  const result = [];\r\n  for (let i = 0; i < size; i++) result.push(table.read(stream));\r\n  return result;\r\n}\r\n\r\nexport function loadPlus(stream: Stream): Uint8Array[] {\r\n  const size = stream.readUByte();\r\n  const table = atomic_array(ubyte, 256);\r\n  const plus = [];\r\n  const refPlu = new Uint8Array(256);\r\n  for (let i = 0; i < 256; i++) refPlu[i] = i;\r\n  plus[0] = refPlu;\r\n  for (let i = 0; i < size; i++) {\r\n    const idx = stream.readUByte();\r\n    const plu = table.read(stream);\r\n    plus[idx] = plu;\r\n  }\r\n  return plus;\r\n}","import { cross2d, dot2d, int, len2d, sign, sqrLen2d } from \"../utils/mathutils\";\r\nimport { Deck, IndexedDeck, range, wrap } from \"../utils/collections\";\r\nimport { ArtInfo, ArtInfoProvider } from \"./formats/art\";\r\nimport { Board, FACE_SPRITE, FLOOR_SPRITE, Sector, WALL_SPRITE } from \"./board/structs\";\r\nimport { ANGSCALE, groupSprites, inPolygon, rayIntersect, slope, spriteAngle, ZSCALE } from \"./utils\";\r\nimport { vec3, Vec3Array } from \"../libs_js/glmatrix\";\r\nimport { inSector } from \"./board/query\";\r\n\r\nexport enum EntityType {\r\n  FLOOR, CEILING, UPPER_WALL, MID_WALL, LOWER_WALL, SPRITE, WALL_POINT\r\n}\r\n\r\nexport class Entity {\r\n  constructor(\r\n    readonly id: number,\r\n    readonly type: EntityType\r\n  ) { }\r\n\r\n  isWall() { return isWall(this.type) }\r\n  isSector() { return isSector(this.type) }\r\n  isSprite() { return isSprite(this.type) }\r\n  clone() { return new Entity(this.id, this.type) }\r\n}\r\n\r\nexport interface Target {\r\n  readonly coords: [number, number, number];\r\n  readonly entity: Entity;\r\n}\r\n\r\nexport function isSector(type: EntityType) {\r\n  switch (type) {\r\n    case EntityType.FLOOR:\r\n    case EntityType.CEILING:\r\n      return true;\r\n    default: return false;\r\n  }\r\n}\r\n\r\nexport function isWall(type: EntityType) {\r\n  switch (type) {\r\n    case EntityType.LOWER_WALL:\r\n    case EntityType.MID_WALL:\r\n    case EntityType.UPPER_WALL:\r\n    case EntityType.WALL_POINT:\r\n      return true;\r\n    default: return false;\r\n  }\r\n}\r\n\r\nexport function isSprite(type: EntityType) {\r\n  return type == EntityType.SPRITE;\r\n}\r\n\r\nexport class Ray {\r\n  public start = vec3.create();\r\n  public dir = vec3.create();\r\n}\r\n\r\nconst SPRITE_OFF = 0.1;\r\n\r\nexport function pointOnRay(out: Vec3Array, ray: Ray, t: number) {\r\n  vec3.copy(out, ray.dir);\r\n  vec3.scale(out, out, t);\r\n  vec3.add(out, out, ray.start);\r\n  return out;\r\n}\r\n\r\nexport class Hitscan implements Target {\r\n  constructor(\r\n    public t: number = -1,\r\n    public ent: Entity = null,\r\n    public ray = new Ray(),\r\n    private targetPoint = vec3.create()) { }\r\n\r\n  public reset(xs: number, ys: number, zs: number, vx: number, vy: number, vz: number) {\r\n    this.ent = null;\r\n    this.t = -1;\r\n    vec3.set(this.ray.start, xs, ys, zs);\r\n    vec3.set(this.ray.dir, vx, vy, vz);\r\n  }\r\n\r\n  private testHit(t: number): boolean {\r\n    if (this.t == -1 || this.t >= t) {\r\n      this.t = t;\r\n      return true;\r\n    }\r\n    return false;\r\n  }\r\n\r\n  public hit(t: number, id: number, type: EntityType) {\r\n    if (this.testHit(t)) {\r\n      this.ent = new Entity(id, type)\r\n    }\r\n  }\r\n\r\n  private target(): Vec3Array {\r\n    return this.t == -1\r\n      ? vec3.copy(this.targetPoint, this.ray.start)\r\n      : pointOnRay(this.targetPoint, this.ray, this.t);\r\n  }\r\n\r\n  get coords() { return <[number, number, number]>this.target() }\r\n  get entity() { return this.ent }\r\n}\r\n\r\nlet hitPoint = vec3.create();\r\nfunction hitSector(board: Board, secId: number, t: number, hit: Hitscan, type: EntityType) {\r\n  pointOnRay(hitPoint, hit.ray, t);\r\n  let x = int(hitPoint[0]);\r\n  let y = int(hitPoint[1]);\r\n  if (inSector(board, x, y, secId))\r\n    hit.hit(t, secId, type);\r\n}\r\n\r\nfunction intersectSectorPlanes(board: Board, sec: Sector, secId: number, hit: Hitscan) {\r\n  let wall1 = board.walls[sec.wallptr]\r\n  let wall2 = board.walls[wall1.point2];\r\n  let dx = wall2.x - wall1.x;\r\n  let dy = wall2.y - wall1.y;\r\n  let dl = len2d(dx, dy);\r\n  if (dl == 0) return;\r\n  let ndx = dx / dl;\r\n  let ndy = dy / dl;\r\n  let angk = -cross2d(ndx, ndy, hit.ray.dir[0], hit.ray.dir[1]);\r\n\r\n  let ceilk = sec.ceilingheinum * ANGSCALE * angk;\r\n  let dk = hit.ray.dir[2] / ZSCALE - ceilk;\r\n  if (dk > 0) {\r\n    let ceilz = slope(board, secId, hit.ray.start[0], hit.ray.start[1], sec.ceilingheinum) + sec.ceilingz;\r\n    let ceildz = (ceilz - hit.ray.start[2]) / ZSCALE;\r\n    let t = ceildz / dk;\r\n    hitSector(board, secId, t, hit, EntityType.CEILING);\r\n  }\r\n\r\n  let floork = sec.floorheinum * ANGSCALE * angk;\r\n  let dk1 = floork - hit.ray.dir[2] / ZSCALE;\r\n  if (dk1 > 0) {\r\n    let floorz = slope(board, secId, hit.ray.start[0], hit.ray.start[1], sec.floorheinum) + sec.floorz;\r\n    let floordz = (hit.ray.start[2] - floorz) / ZSCALE;\r\n    let t = floordz / dk1;\r\n    hitSector(board, secId, t, hit, EntityType.FLOOR);\r\n  }\r\n}\r\n\r\nfunction intersectWall(board: Board, wallId: number, hit: Hitscan): number {\r\n  let wall = board.walls[wallId];\r\n  let wall2 = board.walls[wall.point2];\r\n  let x1 = wall.x, y1 = wall.y;\r\n  let x2 = wall2.x, y2 = wall2.y;\r\n  let [xs, ys, zs] = hit.ray.start;\r\n  let [vx, vy, vz] = hit.ray.dir;\r\n\r\n  if (cross2d(x1 - xs, y1 - ys, x2 - xs, y2 - ys) <= 0) return -1;\r\n\r\n  let intersect = rayIntersect(xs, ys, zs, vx, vy, vz, x1, y1, x2, y2);\r\n  if (intersect == null) return -1;\r\n  let [ix, iy, iz, it] = intersect;\r\n\r\n  let nextsecId = wall.nextsector;\r\n  if (nextsecId == -1) {\r\n    hit.hit(it, wallId, EntityType.MID_WALL);\r\n    return -1;\r\n  }\r\n\r\n  let nextsec = board.sectors[nextsecId];\r\n  let floorz = slope(board, nextsecId, ix, iy, nextsec.floorheinum) + nextsec.floorz;\r\n  let ceilz = slope(board, nextsecId, ix, iy, nextsec.ceilingheinum) + nextsec.ceilingz;\r\n  if (iz <= ceilz) {\r\n    hit.hit(it, wallId, EntityType.UPPER_WALL);\r\n    return -1;\r\n  } else if (iz >= floorz) {\r\n    hit.hit(it, wallId, EntityType.LOWER_WALL);\r\n    return -1;\r\n  } else if (wall.cstat.masking) {\r\n    hit.hit(it, wallId, EntityType.MID_WALL);\r\n    return -1;\r\n  }\r\n\r\n  return nextsecId;\r\n}\r\n\r\nfunction intersectFaceSprite(board: Board, info: ArtInfo, sprId: number, hit: Hitscan) {\r\n  let [xs, ys, zs] = hit.ray.start;\r\n  let [vx, vy, vz] = hit.ray.dir;\r\n  if (vx == 0 && vy == 0) return;\r\n  let spr = board.sprites[sprId];\r\n  let x = spr.x, y = spr.y, z = spr.z;\r\n  let dx = x - xs; let dy = y - ys;\r\n  let vl = sqrLen2d(vx, vy);\r\n  let t = dot2d(vx, vy, dx, dy) / vl;\r\n  if (t <= 0) return;\r\n  let intz = zs + int(vz * t);\r\n  let h = info.h * (spr.yrepeat << 2);\r\n  z += spr.cstat.realCenter ? h >> 1 : 0;\r\n  z -= info.attrs.yoff * (spr.yrepeat << 2);\r\n  if ((intz > z) || (intz < z - h)) return;\r\n  let intx = xs + int(vx * t);\r\n  let inty = ys + int(vy * t);\r\n  let w = info.w * (spr.xrepeat >> 2);\r\n  if (len2d(x - intx, y - inty) > (w >> 1)) return;\r\n  hit.hit(t, sprId, EntityType.SPRITE);\r\n}\r\n\r\nfunction intersectWallSprite(board: Board, info: ArtInfo, sprId: number, hit: Hitscan) {\r\n  let [xs, ys, zs] = hit.ray.start;\r\n  let [vx, vy, vz] = hit.ray.dir;\r\n  if (vx == 0 && vy == 0) return;\r\n  let spr = board.sprites[sprId];\r\n  let x = spr.x, y = spr.y, z = spr.z;\r\n  let ang = spriteAngle(spr.ang);\r\n  let dx = Math.sin(ang) * (spr.xrepeat >> 2);\r\n  let dy = Math.cos(ang) * (spr.xrepeat >> 2);\r\n  let w = info.w;\r\n  let xoff = info.attrs.xoff + spr.xoffset;\r\n  if (spr.cstat.xflip) xoff = -xoff;\r\n  let hw = (w >> 1) + xoff;\r\n  let x1 = x - dx * hw; let y1 = y - dy * hw;\r\n  let x2 = x1 + dx * w; let y2 = y1 + dy * w;\r\n  if (spr.cstat.onesided && cross2d(x1 - xs, y1 - ys, x2 - xs, y2 - ys) > 0) return;\r\n  let intersect = rayIntersect(xs, ys, zs, vx, vy, vz, x1, y1, x2, y2);\r\n  if (intersect == null) return;\r\n  let [, , iz, it] = intersect;\r\n  let h = info.h * (spr.yrepeat << 2);\r\n  z += spr.cstat.realCenter ? h >> 1 : 0;\r\n  z -= info.attrs.yoff * (spr.yrepeat << 2);\r\n  if ((iz > z) || (iz < z - h)) return;\r\n  hit.hit(it - SPRITE_OFF, sprId, EntityType.SPRITE);\r\n}\r\n\r\nlet points_ = wrap(<[number, number][]>[[0, 0], [0, 0], [0, 0], [0, 0]]);\r\nfunction points(x1: number, y1: number, x2: number, y2: number, x3: number, y3: number, x4: number, y4: number) {\r\n  points_.get(0)[0] = x1;\r\n  points_.get(0)[1] = y1;\r\n  points_.get(1)[0] = x2;\r\n  points_.get(1)[1] = y2;\r\n  points_.get(2)[0] = x3;\r\n  points_.get(2)[1] = y3;\r\n  points_.get(3)[0] = x4;\r\n  points_.get(3)[1] = y4;\r\n  return points_;\r\n}\r\n\r\nfunction intersectFloorSprite(board: Board, info: ArtInfo, sprId: number, hit: Hitscan) {\r\n  let [xs, ys, zs] = hit.ray.start;\r\n  let [vx, vy, vz] = hit.ray.dir;\r\n  if (vz == 0) return;\r\n  let spr = board.sprites[sprId];\r\n  let x = spr.x, y = spr.y, z = spr.z;\r\n  let dz = z - zs;\r\n  if (sign(dz) != sign(vz)) return;\r\n  if (spr.cstat.onesided && (spr.cstat.yflip == 1) == zs < z) return;\r\n\r\n  let xoff = 0;//(info.attrs.xoff + spr.xoffset) * (spr.cstat.xflip ? -1 : 1);\r\n  let yoff = 0;//(info.attrs.yoff + spr.yoffset) * (spr.cstat.yflip ? -1 : 1);\r\n  let ang = spriteAngle(spr.ang);\r\n  let cosang = Math.cos(ang);\r\n  let sinang = Math.sin(ang);\r\n  let dx = ((info.w >> 1) + xoff) * (spr.xrepeat >> 2);\r\n  let dy = ((info.h >> 1) + yoff) * (spr.yrepeat >> 2);\r\n  let dw = info.w * (spr.xrepeat >> 2);\r\n  let dh = info.h * (spr.yrepeat >> 2);\r\n\r\n  let x1 = int(x + sinang * dx + cosang * dy);\r\n  let y1 = int(y + sinang * dy - cosang * dx);\r\n  let x2 = int(x1 - sinang * dw);\r\n  let y2 = int(y1 + cosang * dw);\r\n  let x3 = int(x2 - cosang * dh);\r\n  let y3 = int(y2 - sinang * dh);\r\n  let x4 = int(x1 - cosang * dh);\r\n  let y4 = int(y1 - sinang * dh);\r\n\r\n  let t = dz / vz;\r\n  let ix = xs + int(vx * t);\r\n  let iy = ys + int(vy * t);\r\n  if (!inPolygon(ix, iy, points(x1, y1, x2, y2, x3, y3, x4, y4))) return;\r\n  hit.hit(t - SPRITE_OFF, sprId, EntityType.SPRITE);\r\n}\r\n\r\n\r\nfunction intersectSprite(board: Board, artInfo: ArtInfoProvider, sprId: number, hit: Hitscan) {\r\n  let spr = board.sprites[sprId];\r\n  if (spr.picnum == 0 || spr.cstat.invisible) return;\r\n  let info = artInfo.getInfo(spr.picnum);\r\n  if (spr.cstat.type == FACE_SPRITE) {\r\n    intersectFaceSprite(board, info, sprId, hit);\r\n  } else if (spr.cstat.type == WALL_SPRITE) {\r\n    intersectWallSprite(board, info, sprId, hit);\r\n  } else if (spr.cstat.type == FLOOR_SPRITE) {\r\n    intersectFloorSprite(board, info, sprId, hit);\r\n  }\r\n}\r\n\r\nfunction resetStack(board: Board, sectorId: number, stack: IndexedDeck<number>): void {\r\n  stack.clear();\r\n  if (sectorId == -1 || !board.sectors[sectorId]) for (let i of range(0, board.numsectors)) stack.push(i);\r\n  else stack.push(sectorId);\r\n}\r\n\r\nlet stack = new IndexedDeck<number>();\r\nexport function hitscan(board: Board, artInfo: ArtInfoProvider, xs: number, ys: number, zs: number, secId: number, vx: number, vy: number, vz: number, hit: Hitscan, cliptype: number) {\r\n  hit.reset(xs, ys, zs, vx, vy, vz);\r\n\r\n  resetStack(board, secId, stack);\r\n  let sprites = groupSprites(board);\r\n  for (let i = 0; i < stack.length(); i++) {\r\n    let s = stack.get(i);\r\n    let sec = board.sectors[s];\r\n    intersectSectorPlanes(board, sec, s, hit);\r\n\r\n    let endwall = sec.wallptr + sec.wallnum;\r\n    for (let w = sec.wallptr; w < endwall; w++) {\r\n      let nextsec = intersectWall(board, w, hit);\r\n      if (nextsec != -1 && stack.indexOf(nextsec) == -1) {\r\n        stack.push(nextsec);\r\n      }\r\n    }\r\n\r\n    if (cliptype == 1) continue;\r\n    let sprs = sprites[s];\r\n    if (sprs == undefined) continue;\r\n    for (let j = 0; j < sprs.length; j++) {\r\n      intersectSprite(board, artInfo, sprs[j], hit);\r\n    }\r\n  }\r\n}\r\n","import { struct, bits, ushort, int, short, byte, ubyte, uint, Stream, array } from '../utils/stream';\r\nimport { SectorStats, Sector, WallStats, Wall, SpriteStats, Sprite, Board, FACE_SPRITE } from './board/structs';\r\nimport { ZSCALE } from './utils';\r\n\r\nlet sectorStats = struct(SectorStats)\r\n  .field('parallaxing', bits(1))\r\n  .field('slopped', bits(1))\r\n  .field('swapXY', bits(1))\r\n  .field('doubleSmooshiness', bits(1))\r\n  .field('xflip', bits(1))\r\n  .field('yflip', bits(1))\r\n  .field('alignToFirstWall', bits(1))\r\n  .field('unk', bits(9));\r\n\r\nexport let sectorStruct = struct(Sector)\r\n  .field('wallptr', ushort)\r\n  .field('wallnum', ushort)\r\n  .field('ceilingz', int)\r\n  .field('floorz', int)\r\n  .field('ceilingstat', sectorStats)\r\n  .field('floorstat', sectorStats)\r\n  .field('ceilingpicnum', ushort)\r\n  .field('ceilingheinum', short)\r\n  .field('ceilingshade', byte)\r\n  .field('ceilingpal', ubyte)\r\n  .field('ceilingxpanning', ubyte)\r\n  .field('ceilingypanning', ubyte)\r\n  .field('floorpicnum', ushort)\r\n  .field('floorheinum', short)\r\n  .field('floorshade', byte)\r\n  .field('floorpal', ubyte)\r\n  .field('floorxpanning', ubyte)\r\n  .field('floorypanning', ubyte)\r\n  .field('visibility', byte)\r\n  .field('filler', byte)\r\n  .field('lotag', ushort)\r\n  .field('hitag', ushort)\r\n  .field('extra', ushort);\r\n\r\nlet wallStats = struct(WallStats)\r\n  .field('blocking', bits(1))\r\n  .field('swapBottoms', bits(1))\r\n  .field('alignBottom', bits(1))\r\n  .field('xflip', bits(1))\r\n  .field('masking', bits(1))\r\n  .field('oneWay', bits(1))\r\n  .field('blocking2', bits(1))\r\n  .field('translucent', bits(1))\r\n  .field('yflip', bits(1))\r\n  .field('translucentReversed', bits(1))\r\n  .field('unk', bits(6));\r\n\r\nexport let wallStruct = struct(Wall)\r\n  .field('x', int)\r\n  .field('y', int)\r\n  .field('point2', ushort)\r\n  .field('nextwall', short)\r\n  .field('nextsector', short)\r\n  .field('cstat', wallStats)\r\n  .field('picnum', ushort)\r\n  .field('overpicnum', ushort)\r\n  .field('shade', byte)\r\n  .field('pal', ubyte)\r\n  .field('xrepeat', ubyte)\r\n  .field('yrepeat', ubyte)\r\n  .field('xpanning', ubyte)\r\n  .field('ypanning', ubyte)\r\n  .field('lotag', ushort)\r\n  .field('hitag', ushort)\r\n  .field('extra', ushort);\r\n\r\nlet spriteStats = struct(SpriteStats)\r\n  .field('blocking', bits(1))\r\n  .field('translucent', bits(1))\r\n  .field('xflip', bits(1))\r\n  .field('yflip', bits(1))\r\n  .field('type', bits(2))\r\n  .field('onesided', bits(1))\r\n  .field('realCenter', bits(1))\r\n  .field('blocking2', bits(1))\r\n  .field('tranclucentReversed', bits(1))\r\n  .field('noautoshading', bits(1))\r\n  .field('unk', bits(4))\r\n  .field('invisible', bits(1));\r\n\r\nexport let spriteStruct = struct(Sprite)\r\n  .field('x', int)\r\n  .field('y', int)\r\n  .field('z', int)\r\n  .field('cstat', spriteStats)\r\n  .field('picnum', ushort)\r\n  .field('shade', byte)\r\n  .field('pal', ubyte)\r\n  .field('clipdist', ubyte)\r\n  .field('filler', ubyte)\r\n  .field('xrepeat', ubyte)\r\n  .field('yrepeat', ubyte)\r\n  .field('xoffset', ubyte)\r\n  .field('yoffset', ubyte)\r\n  .field('sectnum', ushort)\r\n  .field('statnum', ushort)\r\n  .field('ang', ushort)\r\n  .field('owner', ushort)\r\n  .field('xvel', short)\r\n  .field('yvel', short)\r\n  .field('zvel', short)\r\n  .field('lotag', ushort)\r\n  .field('hitag', ushort)\r\n  .field('extra', ushort);\r\n\r\nexport let boardStruct = struct(Board)\r\n  .field('version', uint)\r\n  .field('posx', int)\r\n  .field('posy', int)\r\n  .field('posz', int)\r\n  .field('ang', ushort)\r\n  .field('cursectnum', ushort);\r\n\r\nexport function loadBuildMap(stream: Stream): Board {\r\n  let brd = boardStruct.read(stream);\r\n  brd.numsectors = ushort.read(stream);\r\n  brd.sectors = array(sectorStruct, brd.numsectors).read(stream);\r\n  brd.numwalls = ushort.read(stream);\r\n  brd.walls = array(wallStruct, brd.numwalls).read(stream);\r\n  brd.numsprites = ushort.read(stream);\r\n  brd.sprites = array(spriteStruct, brd.numsprites).read(stream);\r\n  return brd;\r\n}\r\n\r\nexport function saveBuildMap(board: Board): ArrayBuffer {\r\n  const size = boardStruct.size\r\n    + 2 + sectorStruct.size * board.numsectors\r\n    + 2 + wallStruct.size * board.numwalls +\r\n    + 2 + spriteStruct.size * board.numsprites;\r\n  const buffer = new ArrayBuffer(size);\r\n  const stream = new Stream(buffer, true);\r\n  boardStruct.write(stream, board);\r\n  ushort.write(stream, board.numsectors);\r\n  array(sectorStruct, board.numsectors).write(stream, fixSectorSlopes(board.sectors));\r\n  ushort.write(stream, board.numwalls);\r\n  array(wallStruct, board.numwalls).write(stream, board.walls);\r\n  ushort.write(stream, board.numsprites);\r\n  array(spriteStruct, board.numsprites).write(stream, board.sprites);\r\n  return buffer;\r\n}\r\n\r\nfunction fixSectorSlopes(sectors: Sector[]) {\r\n  for (const sec of sectors) {\r\n    sec.ceilingstat.slopped = 1;\r\n    sec.floorstat.slopped = 1;\r\n  }\r\n  return sectors;\r\n}\r\n\r\nexport function initWallStats(stat: WallStats) {\r\n  stat.alignBottom = 0;\r\n  stat.blocking = 0;\r\n  stat.blocking2 = 0;\r\n  stat.masking = 0;\r\n  stat.oneWay = 0;\r\n  stat.swapBottoms = 0;\r\n  stat.translucent = 0;\r\n  stat.translucentReversed = 0;\r\n  stat.xflip = 0;\r\n  stat.yflip = 0;\r\n  stat.unk = 0;\r\n  return stat;\r\n}\r\n\r\nexport function initWall(wall: Wall) {\r\n  wall.x = 0;\r\n  wall.y = 0;\r\n  wall.point2 = -1;\r\n  wall.nextwall = -1;\r\n  wall.nextsector = -1;\r\n  wall.cstat = initWallStats(new WallStats());\r\n  wall.picnum = 0;\r\n  wall.overpicnum = 0;\r\n  wall.shade = 0;\r\n  wall.pal = 0;\r\n  wall.xrepeat = 8;\r\n  wall.yrepeat = 8;\r\n  wall.xpanning = 0;\r\n  wall.ypanning = 0;\r\n  wall.lotag = 0;\r\n  wall.hitag = 0\r\n  wall.extra = 65535;\r\n  return wall;\r\n}\r\n\r\nexport function newWall() {\r\n  return initWall(new Wall())\r\n}\r\n\r\nexport function initSectorStats(stat: SectorStats) {\r\n  stat.alignToFirstWall = 0;\r\n  stat.doubleSmooshiness = 0;\r\n  stat.parallaxing = 0;\r\n  stat.slopped = 0;\r\n  stat.swapXY = 0;\r\n  stat.xflip = 0;\r\n  stat.yflip = 0;\r\n  stat.unk = 0;\r\n  return stat;\r\n}\r\n\r\nexport function initSector(sector: Sector) {\r\n  sector.ceilingheinum = 0;\r\n  sector.ceilingpal = 0;\r\n  sector.ceilingpicnum = 0;\r\n  sector.ceilingshade = 0;\r\n  sector.ceilingstat = initSectorStats(new SectorStats());\r\n  sector.ceilingxpanning = 0;\r\n  sector.ceilingypanning = 0;\r\n  sector.ceilingz = 2048 * ZSCALE;\r\n  sector.extra = 65535;\r\n  sector.floorheinum = 0;\r\n  sector.floorpal = 0;\r\n  sector.floorpicnum = 0;\r\n  sector.floorshade = 0;\r\n  sector.floorstat = initSectorStats(new SectorStats())\r\n  sector.floorxpanning = 0;\r\n  sector.floorypanning = 0;\r\n  sector.floorz = 0;\r\n  sector.hitag = 0;\r\n  sector.lotag = 0;\r\n  sector.visibility = 0;\r\n  sector.wallnum = 0;\r\n  sector.wallptr = 0;\r\n  sector.filler = 0;\r\n  return sector;\r\n}\r\n\r\nexport function newSector() {\r\n  return initSector(new Sector())\r\n}\r\n\r\nexport function initSpriteStats(stats: SpriteStats) {\r\n  stats.blocking = 0;\r\n  stats.blocking2 = 0;\r\n  stats.invisible = 0;\r\n  stats.noautoshading = 0;\r\n  stats.onesided = 0;\r\n  stats.realCenter = 0;\r\n  stats.tranclucentReversed = 0;\r\n  stats.translucent = 0;\r\n  stats.type = FACE_SPRITE;\r\n  stats.xflip = 0;\r\n  stats.yflip = 0;\r\n  stats.unk = 0;\r\n  return stats;\r\n}\r\n\r\nexport function initSprite(sprite: Sprite) {\r\n  sprite.ang = 0;\r\n  sprite.clipdist = 0;\r\n  sprite.cstat = initSpriteStats(new SpriteStats());\r\n  sprite.extra = 65535;\r\n  sprite.hitag = 0;\r\n  sprite.lotag = 0;\r\n  sprite.owner = -1;\r\n  sprite.pal = 0;\r\n  sprite.picnum = 1;\r\n  sprite.sectnum = -1;\r\n  sprite.shade = 0;\r\n  sprite.statnum = 0;\r\n  sprite.x = 0;\r\n  sprite.y = 0;\r\n  sprite.z = 0;\r\n  sprite.xoffset = 0;\r\n  sprite.yoffset = 0;\r\n  sprite.xvel = 0;\r\n  sprite.yvel = 0;\r\n  sprite.xrepeat = 64;\r\n  sprite.yrepeat = 64;\r\n  sprite.filler = 0;\r\n  return sprite;\r\n}\r\n\r\nexport function newSprite() {\r\n  return initSprite(new Sprite())\r\n}\r\n\r\nexport function newBoard() {\r\n  const board = new Board();\r\n  board.walls = [];\r\n  board.sectors = [];\r\n  board.sprites = [];\r\n  board.numwalls = 0;\r\n  board.numsectors = 0;\r\n  board.numsprites = 0;\r\n  board.version = 0x0007;\r\n  board.posx = board.posy = board.posz = board.cursectnum = board.ang = 0;\r\n  return board;\r\n}\r\n\r\nexport function cloneSector(sector: Sector): Sector {\r\n  let sectorCopy = new Sector();\r\n  Object.assign(sectorCopy, sector);\r\n  Object.assign(sectorCopy.floorstat, sector.floorstat);\r\n  Object.assign(sectorCopy.ceilingstat, sector.ceilingstat);\r\n  return sectorCopy;\r\n}\r\n\r\nexport function cloneWall(wall: Wall): Wall {\r\n  let wallCopy = new Wall();\r\n  Object.assign(wallCopy, wall);\r\n  Object.assign(wallCopy.cstat, wall.cstat);\r\n  return wallCopy;\r\n}\r\n\r\nexport function cloneSprite(sprite: Sprite): Sprite {\r\n  let spriteCopy = new Sprite();\r\n  Object.assign(spriteCopy, sprite);\r\n  Object.assign(spriteCopy.cstat, sprite.cstat);\r\n  return spriteCopy;\r\n}\r\n\r\nexport function cloneBoard(board: Board): Board {\r\n  let copy = new Board();\r\n  Object.assign(copy, board);\r\n  copy.sectors = [];\r\n  copy.walls = [];\r\n  copy.sprites = [];\r\n  for (let i = 0; i < board.numsectors; i++)    copy.sectors[i] = cloneSector(board.sectors[i]);\r\n  for (let i = 0; i < board.numwalls; i++)    copy.walls[i] = cloneWall(board.walls[i]);\r\n  for (let i = 0; i < board.numsprites; i++)    copy.sprites[i] = cloneSprite(board.sprites[i]);\r\n  return copy;\r\n}\r\n","import { vec2, vec3, Vec3Array } from '../libs_js/glmatrix';\r\nimport { cyclicPairs, loopPairs, reverse } from '../utils/collections';\r\nimport { cross2d, cyclic, int, len2d, monoatan2, PI2 } from '../utils/mathutils';\r\nimport { normal2d } from '../utils/vecmath';\r\nimport { Board, Sprite } from './board/structs';\r\nimport { Entity, EntityType } from './hitscan';\r\n\r\nexport const ZSCALE = -16;\r\n\r\nexport function build2gl(out: Vec3Array, vec: Vec3Array): Vec3Array {\r\n  return vec3.set(out, vec[0], vec[2] / ZSCALE, vec[1]);\r\n}\r\n\r\nexport function gl2build(out: Vec3Array, vec: Vec3Array): Vec3Array {\r\n  return vec3.set(out, vec[0], vec[2], vec[1] * ZSCALE);\r\n}\r\n\r\nlet fakePlayerStart_: Sprite;\r\nfunction fakePlayerStart() {\r\n  if (fakePlayerStart_ == null) {\r\n    fakePlayerStart_ = new Sprite();\r\n    fakePlayerStart_.x = 0\r\n    fakePlayerStart_.y = 0\r\n    fakePlayerStart_.z = 0\r\n    fakePlayerStart_.sectnum = -1;\r\n  }\r\n  return fakePlayerStart_;\r\n}\r\n\r\nexport function getPlayerStart(board: Board): Sprite {\r\n  for (let i = 0; i < board.numsprites; i++) {\r\n    const sprite = board.sprites[i];\r\n    if (sprite.lotag == 1)\r\n      return sprite;\r\n  }\r\n  return fakePlayerStart();\r\n}\r\n\r\nexport interface MoveStruct {\r\n  readonly x: number;\r\n  readonly y: number;\r\n  readonly z: number;\r\n  readonly sec: number;\r\n}\r\n\r\nexport function inPolygon(x: number, y: number, points: Iterable<[number, number]>) {\r\n  let inter = 0;\r\n  for (const [p1, p2] of loopPairs(points)) {\r\n    const [x1, y1] = p1;\r\n    const [x2, y2] = p2;\r\n    const dx1 = x1 - x;\r\n    const dx2 = x2 - x;\r\n    const dy1 = y1 - y;\r\n    const dy2 = y2 - y;\r\n    if (dx1 == 0 && dx2 == 0 && (dy1 == 0 || dy2 == 0 || (dy1 ^ dy2) < 0)) return true;\r\n    if (dy1 == 0 && dy2 == 0 && (dx1 == 0 || dx2 == 0 || (dx1 ^ dx2) < 0)) return true;\r\n\r\n    if ((dy1 ^ dy2) < 0) {\r\n      if ((dx1 ^ dx2) >= 0)\r\n        inter ^= dx1;\r\n      else\r\n        inter ^= cross2d(dx1, dy1, dx2, dy2) ^ dy2;\r\n    }\r\n  }\r\n  return (inter >>> 31) == 1;\r\n}\r\n\r\nexport function sectorZ(board: Board, sectorEnt: Entity) {\r\n  const sec = board.sectors[sectorEnt.id];\r\n  return (sectorEnt.type == EntityType.CEILING ? sec.ceilingz : sec.floorz);\r\n}\r\n\r\nexport function sectorHeinum(board: Board, sectorEnt: Entity) {\r\n  const sec = board.sectors[sectorEnt.id];\r\n  return (sectorEnt.type == EntityType.CEILING ? sec.ceilingheinum : sec.floorheinum);\r\n}\r\n\r\nexport function setSectorZ(board: Board, sectorEnt: Entity, z: number): boolean {\r\n  const pz = sectorZ(board, sectorEnt);\r\n  if (pz == z) return false;\r\n  const sec = board.sectors[sectorEnt.id];\r\n  if (sectorEnt.type == EntityType.CEILING) sec.ceilingz = z; else sec.floorz = z;\r\n  return true;\r\n}\r\n\r\nexport function setSectorHeinum(board: Board, sectorEnt: Entity, h: number): boolean {\r\n  const ph = sectorHeinum(board, sectorEnt);\r\n  if (ph == h) return false;\r\n  const sec = board.sectors[sectorEnt.id];\r\n  if (sectorEnt.type == EntityType.CEILING) sec.ceilingheinum = h; else sec.floorheinum = h;\r\n  return true;\r\n}\r\n\r\nexport function sectorPicnum(board: Board, sectorEnt: Entity) {\r\n  const sec = board.sectors[sectorEnt.id];\r\n  return sectorEnt.type == EntityType.CEILING ? sec.ceilingpicnum : sec.floorpicnum;\r\n}\r\n\r\nexport function setSectorPicnum(board: Board, sectorEnt: Entity, picnum: number): boolean {\r\n  if (picnum == -1 || sectorPicnum(board, sectorEnt) == picnum) return false;\r\n  const sec = board.sectors[sectorEnt.id];\r\n  if (sectorEnt.type == EntityType.CEILING) sec.ceilingpicnum = picnum; else sec.floorpicnum = picnum;\r\n  return true;\r\n}\r\n\r\nexport function groupSprites(board: Board): { [index: number]: number[] } {\r\n  const sec2spr: { [index: number]: number[] } = {};\r\n  for (let s = 0; s < board.numsprites; s++) {\r\n    const spr = board.sprites[s];\r\n    let sprs = sec2spr[spr.sectnum];\r\n    if (sprs == undefined) {\r\n      sprs = [];\r\n      sec2spr[spr.sectnum] = sprs;\r\n    }\r\n    sprs.push(s);\r\n  }\r\n  return sec2spr;\r\n}\r\n\r\nexport const ANGSCALE = (1 / 4096);\r\n\r\nexport function slope(board: Board, sectorId: number, x: number, y: number, heinum: number) {\r\n  const sec = board.sectors[sectorId];\r\n  const wall1 = board.walls[sec.wallptr];\r\n  const wall2 = board.walls[wall1.point2];\r\n  let dx = wall2.x - wall1.x;\r\n  let dy = wall2.y - wall1.y;\r\n  const ln = len2d(dx, dy);\r\n  dx /= ln; dy /= ln;\r\n  const dx1 = x - wall1.x;\r\n  const dy1 = y - wall1.y;\r\n  const k = -cross2d(dx, dy, dx1, dy1);\r\n  return int(heinum * ANGSCALE * k * ZSCALE);\r\n}\r\n\r\nexport function createSlopeCalculator(board: Board, sectorId: number) {\r\n  const sector = board.sectors[sectorId];\r\n  const wall1 = board.walls[sector.wallptr];\r\n  const wall2 = board.walls[wall1.point2];\r\n  let dx = wall2.x - wall1.x;\r\n  let dy = wall2.y - wall1.y;\r\n  const ln = len2d(dx, dy);\r\n  dx /= ln; dy /= ln;\r\n\r\n  return function (x: number, y: number, heinum: number): number {\r\n    const dx1 = x - wall1.x;\r\n    const dy1 = y - wall1.y;\r\n    const k = -cross2d(dx, dy, dx1, dy1);\r\n    return int(heinum * ANGSCALE * k * ZSCALE);\r\n  };\r\n}\r\n\r\nexport function lineIntersect(\r\n  sx: number, sy: number, sz: number,\r\n  x2: number, y2: number, z2: number,\r\n  x3: number, y3: number, x4: number, y4: number): [number, number, number, number] {\r\n\r\n  const x21 = x2 - sx, x34 = x3 - x4;\r\n  const y21 = y2 - sy, y34 = y3 - y4;\r\n  const bot = cross2d(x21, y21, x34, y34);\r\n\r\n  if (bot == 0) return null;\r\n\r\n  const x31 = x3 - sx, y31 = y3 - sy;\r\n  const topt = cross2d(x31, y31, x34, y34);\r\n\r\n  if (bot > 0) {\r\n    if ((topt < 0) || (topt >= bot))\r\n      return null;\r\n    const topu = cross2d(x21, y31, x31, y31);\r\n    if ((topu < 0) || (topu >= bot))\r\n      return null;\r\n  } else {\r\n    if ((topt > 0) || (topt <= bot))\r\n      return null;\r\n    const topu = cross2d(x21, y21, x31, y31);\r\n    if ((topu > 0) || (topu <= bot))\r\n      return null;\r\n  }\r\n\r\n  const t = topt / bot;\r\n  const x = sx + int(x21 * t);\r\n  const y = sy + int(y21 * t);\r\n  const z = sz + int((z2 - sz) * t) * ZSCALE;\r\n\r\n  return [x, y, z, t];\r\n}\r\n\r\nexport function rayIntersect(\r\n  xs: number, ys: number, zs: number,\r\n  vx: number, vy: number, vz: number,\r\n  x3: number, y3: number, x4: number, y4: number): [number, number, number, number] {\r\n\r\n  const x34 = x3 - x4;\r\n  const y34 = y3 - y4;\r\n  const bot = cross2d(vx, vy, x34, y34);\r\n  if (bot == 0) return null;\r\n  const x31 = x3 - xs;\r\n  const y31 = y3 - ys;\r\n  const topt = cross2d(x31, y31, x34, y34);\r\n\r\n  if (bot > 0) {\r\n    if (topt < 0) return null;\r\n    const topu = cross2d(vx, vy, x31, y31);\r\n    if ((topu < 0) || (topu >= bot))\r\n      return null;\r\n  } else {\r\n    if (topt > 0) return null;\r\n    const topu = cross2d(vx, vy, x31, y31);\r\n    if ((topu > 0) || (topu <= bot))\r\n      return null;\r\n  }\r\n\r\n  const t = topt / bot;\r\n  const x = xs + int(vx * t);\r\n  const y = ys + int(vy * t);\r\n  const z = zs + int(vz * t);\r\n\r\n  return [x, y, z, t];\r\n}\r\n\r\nexport function getFirstWallAngle(board: Board, sectorId: number): number {\r\n  const sector = board.sectors[sectorId];\r\n  const w1 = board.walls[sector.wallptr];\r\n  const w2 = board.walls[w1.point2];\r\n  const dx = w2.x - w1.x;\r\n  const dy = w2.y - w1.y;\r\n  return Math.atan2(-dy, dx);\r\n}\r\n\r\nexport function wallVisible(board: Board, wallId: number, ms: MoveStruct) {\r\n  const wall1 = board.walls[wallId];\r\n  const wall2 = board.walls[wall1.point2];\r\n  const dx1 = wall2.x - wall1.x;\r\n  const dy1 = wall2.y - wall1.y;\r\n  const dx2 = ms.x - wall1.x;\r\n  const dy2 = ms.y - wall1.y;\r\n  return cross2d(dx1, dy1, dx2, dy2) >= 0;\r\n}\r\n\r\nconst _normal = vec2.create();\r\nexport function wallNormal(out: Vec3Array, board: Board, wallId: number): Vec3Array {\r\n  const w1 = board.walls[wallId];\r\n  const w2 = board.walls[w1.point2];\r\n  vec2.set(_normal, w1.x - w2.x, w1.y - w2.y);\r\n  normal2d(_normal, _normal);\r\n  vec3.set(out, _normal[0], 0, _normal[1]);\r\n  return out;\r\n}\r\n\r\nconst _wn = vec3.create();\r\nconst _up = vec3.fromValues(0, 1, 0);\r\nconst _down = vec3.fromValues(0, -1, 0);\r\nexport function sectorNormal(out: Vec3Array, board: Board, sectorId: number, ceiling: boolean): Vec3Array {\r\n  const sector = board.sectors[sectorId];\r\n  wallNormal(_wn, board, sector.wallptr);\r\n  vec3.negate(_wn, _wn);\r\n  const h = ceiling ? sector.ceilingheinum : sector.floorheinum;\r\n  const normal = ceiling ? _down : _up;\r\n  vec3.lerp(out, normal, _wn, Math.atan(h * ANGSCALE) / (Math.PI / 2));\r\n  return out;\r\n}\r\n\r\nexport function ang2vec(ang: number): Vec3Array {\r\n  ang += Math.PI / 2;\r\n  return vec3.fromValues(Math.sin(ang), 0, Math.cos(ang))\r\n}\r\n\r\nexport function spriteAngle(ang: number): number {\r\n  return PI2 - (ang * ANGSCALE * 2) * PI2;\r\n}\r\n\r\nexport function vec2ang(x: number, y: number) {\r\n  return int((monoatan2(y, x) / PI2) / ANGSCALE / 2);\r\n}\r\n\r\nexport function clockwise(polygon: Iterable<[number, number]>): boolean {\r\n  let minx = Number.MAX_VALUE;\r\n  let minwall = -1;\r\n  const points = [...polygon];\r\n  const len = points.length;\r\n  for (const [w1, w2] of cyclicPairs(len)) {\r\n    const wall2 = points[w2];\r\n    if (wall2[0] < minx) {\r\n      minx = wall2[0];\r\n      minwall = w1;\r\n    }\r\n  }\r\n  const wall0 = points[minwall];\r\n  const wall1 = points[cyclic(minwall + 1, len)];\r\n  const wall2 = points[cyclic(minwall + 2, len)];\r\n\r\n  if (wall2[1] <= wall1[1] && wall1[1] <= wall0[1]) return true;\r\n  if (wall0[1] <= wall1[1] && wall1[1] <= wall2[1]) return false;\r\n\r\n  return cross2d(wall0[0] - wall1[0], wall0[1] - wall1[1], wall2[0] - wall1[0], wall2[1] - wall1[1]) < 0;\r\n}\r\n\r\nexport function order(points: Iterable<[number, number]>, cw = true): Iterable<[number, number]> {\r\n  const actual = clockwise(points);\r\n  if (actual == cw) return points;\r\n  else {\r\n    const reversed = [...points];\r\n    reversed.reverse();\r\n    return reversed;\r\n  }\r\n}\r\n","import { BloodModule } from './app/modules/blood/module';\r\nimport { DukeModule } from './app/modules/duke/module';\r\nimport { GL } from './app/modules/buildartprovider';\r\nimport { DefaultSetupModule, MainLoopConstructor } from './app/modules/context';\r\nimport { DbFsModule } from './app/modules/fs/db';\r\nimport { FileBrowserModule } from './app/modules/fs/manager';\r\nimport { ArtEditorModule } from './app/modules/arteditor';\r\nimport { PhotonUiModule } from './app/modules/photonui';\r\nimport { animate, createContextFromCanvas } from './utils/gl/gl';\r\nimport { RootModule } from './utils/injector';\r\nimport { addLogAppender, CONSOLE } from './utils/logger';\r\nimport { InputModule } from './app/modules/input';\r\n\r\naddLogAppender(CONSOLE);\r\nconst gl = createContextFromCanvas(\"display\", { alpha: false, antialias: true, stencil: true });\r\n\r\nconst module = new RootModule();\r\nmodule.bindInstance(GL, gl);\r\nmodule.install(InputModule);\r\nmodule.install(DbFsModule('resources/engines/blood/'));\r\nmodule.install(DefaultSetupModule);\r\n// module.install(BloodModule);\r\nmodule.install(DukeModule);\r\nmodule.install(PhotonUiModule);\r\nmodule.install(FileBrowserModule);\r\nmodule.install(ArtEditorModule);\r\nmodule.execute(async injector => {\r\n  MainLoopConstructor(injector).then(mainLoop => {\r\n    animate(gl, (gl: WebGLRenderingContext, time: number) => {\r\n      mainLoop.frame(time);\r\n    });\r\n  });\r\n});\r\nmodule.start();\r\n\r\n\r\n","import * as glMatrix from \"./glmatrix/common.js\";\r\nimport * as mat2 from \"./glmatrix/mat2.js\";\r\nimport * as mat2d from \"./glmatrix/mat2d.js\";\r\nimport * as mat3 from \"./glmatrix/mat3.js\";\r\nimport * as mat4 from \"./glmatrix/mat4.js\";\r\nimport * as quat from \"./glmatrix/quat.js\";\r\nimport * as quat2 from \"./glmatrix/quat2.js\";\r\nimport * as vec2 from \"./glmatrix/vec2.js\";\r\nimport * as vec3 from \"./glmatrix/vec3.js\";\r\nimport * as vec4 from \"./glmatrix/vec4.js\";\r\n\r\nexport {\r\n  glMatrix,\r\n  mat2, mat2d, mat3, mat4,\r\n  quat, quat2,\r\n  vec2, vec3, vec4,\r\n};\r\n","/**\r\n * Common utilities\r\n * @module glMatrix\r\n */\r\n\r\n// Configuration Constants\r\nexport const EPSILON = 0.000001;\r\nexport let ARRAY_TYPE = (typeof Float32Array !== 'undefined') ? Float32Array : Array;\r\nexport const RANDOM = Math.random;\r\n\r\n/**\r\n * Sets the type of array used when creating new vectors and matrices\r\n *\r\n * @param {Type} type Array type, such as Float32Array or Array\r\n */\r\nexport function setMatrixArrayType(type) {\r\n  ARRAY_TYPE = type;\r\n}\r\n\r\nconst degree = Math.PI / 180;\r\n\r\n/**\r\n * Convert Degree To Radian\r\n *\r\n * @param {Number} a Angle in Degrees\r\n */\r\nexport function toRadian(a) {\r\n  return a * degree;\r\n}\r\n\r\n/**\r\n * Tests whether or not the arguments have approximately the same value, within an absolute\r\n * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less\r\n * than or equal to 1.0, and a relative tolerance is used for larger values)\r\n *\r\n * @param {Number} a The first number to test.\r\n * @param {Number} b The second number to test.\r\n * @returns {Boolean} True if the numbers are approximately equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  return Math.abs(a - b) <= EPSILON*Math.max(1.0, Math.abs(a), Math.abs(b));\r\n}\r\n\r\nif (!Math.hypot) Math.hypot = function() {\r\n  var y = 0, i = arguments.length;\r\n  while (i--) y += arguments[i] * arguments[i];\r\n  return Math.sqrt(y);\r\n};\r\n","import * as glMatrix from \"./common.js\"\r\n\r\n/**\r\n * 2x2 Matrix\r\n * @module mat2\r\n */\r\n\r\n/**\r\n * Creates a new identity mat2\r\n *\r\n * @returns {mat2} a new 2x2 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat2 initialized with values from an existing matrix\r\n *\r\n * @param {mat2} a matrix to clone\r\n * @returns {mat2} a new 2x2 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat2 to another\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat2 to the identity matrix\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @returns {mat2} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat2 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out A new 2x2 matrix\r\n */\r\nexport function fromValues(m00, m01, m10, m11) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m10;\r\n  out[3] = m11;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat2 to the given values\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 2)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 3)\r\n * @returns {mat2} out\r\n */\r\nexport function set(out, m00, m01, m10, m11) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m10;\r\n  out[3] = m11;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache\r\n  // some values\r\n  if (out === a) {\r\n    let a1 = a[1];\r\n    out[1] = a[2];\r\n    out[2] = a1;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[2];\r\n    out[2] = a[1];\r\n    out[3] = a[3];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nexport function invert(out, a) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n\r\n  // Calculate the determinant\r\n  let det = a0 * a3 - a2 * a1;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] =  a3 * det;\r\n  out[1] = -a1 * det;\r\n  out[2] = -a2 * det;\r\n  out[3] =  a0 * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the source matrix\r\n * @returns {mat2} out\r\n */\r\nexport function adjoint(out, a) {\r\n  // Caching this value is nessecary if out == a\r\n  let a0 = a[0];\r\n  out[0] =  a[3];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] =  a0;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat2\r\n *\r\n * @param {mat2} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  return a[0] * a[3] - a[2] * a[1];\r\n}\r\n\r\n/**\r\n * Multiplies two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\r\n  out[0] = a0 * b0 + a2 * b1;\r\n  out[1] = a1 * b0 + a3 * b1;\r\n  out[2] = a0 * b2 + a2 * b3;\r\n  out[3] = a1 * b2 + a3 * b3;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat2 by the given angle\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\r\nexport function rotate(out, a, rad) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  out[0] = a0 *  c + a2 * s;\r\n  out[1] = a1 *  c + a3 * s;\r\n  out[2] = a0 * -s + a2 * c;\r\n  out[3] = a1 * -s + a3 * c;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat2 by the dimensions in the given vec2\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat2} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n  let v0 = v[0], v1 = v[1];\r\n  out[0] = a0 * v0;\r\n  out[1] = a1 * v0;\r\n  out[2] = a2 * v1;\r\n  out[3] = a3 * v1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2} out\r\n */\r\nexport function fromRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = -s;\r\n  out[3] = c;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2.identity(dest);\r\n *     mat2.scale(dest, dest, vec);\r\n *\r\n * @param {mat2} out mat2 receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat2} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = v[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat2\r\n *\r\n * @param {mat2} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return 'mat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat2\r\n *\r\n * @param {mat2} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return(Math.hypot(a[0],a[1],a[2],a[3]))\r\n}\r\n\r\n/**\r\n * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix\r\n * @param {mat2} L the lower triangular matrix\r\n * @param {mat2} D the diagonal matrix\r\n * @param {mat2} U the upper triangular matrix\r\n * @param {mat2} a the input matrix to factorize\r\n */\r\n\r\nexport function LDU(L, D, U, a) {\r\n  L[2] = a[2]/a[0];\r\n  U[0] = a[0];\r\n  U[1] = a[1];\r\n  U[3] = a[3] - L[2] * U[1];\r\n  return [L, D, U];\r\n}\r\n\r\n/**\r\n * Adds two mat2's\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @returns {mat2} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat2} a The first matrix.\r\n * @param {mat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat2} a The first matrix.\r\n * @param {mat2} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n          Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n          Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)));\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2} out the receiving matrix\r\n * @param {mat2} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat2's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2} out the receiving vector\r\n * @param {mat2} a the first operand\r\n * @param {mat2} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  out[2] = a[2] + (b[2] * scale);\r\n  out[3] = a[3] + (b[3] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Alias for {@link mat2.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat2.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","import * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 2x3 Matrix\r\n * @module mat2d\r\n *\r\n * @description\r\n * A mat2d contains six elements defined as:\r\n * <pre>\r\n * [a, b, c,\r\n *  d, tx, ty]\r\n * </pre>\r\n * This is a short form for the 3x3 matrix:\r\n * <pre>\r\n * [a, b, 0,\r\n *  c, d, 0,\r\n *  tx, ty, 1]\r\n * </pre>\r\n * The last column is ignored so the array is shorter and operations are faster.\r\n */\r\n\r\n/**\r\n * Creates a new identity mat2d\r\n *\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(6);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[4] = 0;\r\n    out[5] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat2d initialized with values from an existing matrix\r\n *\r\n * @param {mat2d} a matrix to clone\r\n * @returns {mat2d} a new 2x3 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(6);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat2d to another\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat2d to the identity matrix\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @returns {mat2d} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  out[4] = 0;\r\n  out[5] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat2d with the given values\r\n *\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} A new mat2d\r\n */\r\nexport function fromValues(a, b, c, d, tx, ty) {\r\n  let out = new glMatrix.ARRAY_TYPE(6);\r\n  out[0] = a;\r\n  out[1] = b;\r\n  out[2] = c;\r\n  out[3] = d;\r\n  out[4] = tx;\r\n  out[5] = ty;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat2d to the given values\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {Number} a Component A (index 0)\r\n * @param {Number} b Component B (index 1)\r\n * @param {Number} c Component C (index 2)\r\n * @param {Number} d Component D (index 3)\r\n * @param {Number} tx Component TX (index 4)\r\n * @param {Number} ty Component TY (index 5)\r\n * @returns {mat2d} out\r\n */\r\nexport function set(out, a, b, c, d, tx, ty) {\r\n  out[0] = a;\r\n  out[1] = b;\r\n  out[2] = c;\r\n  out[3] = d;\r\n  out[4] = tx;\r\n  out[5] = ty;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat2d\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the source matrix\r\n * @returns {mat2d} out\r\n */\r\nexport function invert(out, a) {\r\n  let aa = a[0], ab = a[1], ac = a[2], ad = a[3];\r\n  let atx = a[4], aty = a[5];\r\n\r\n  let det = aa * ad - ab * ac;\r\n  if(!det){\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = ad * det;\r\n  out[1] = -ab * det;\r\n  out[2] = -ac * det;\r\n  out[3] = aa * det;\r\n  out[4] = (ac * aty - ad * atx) * det;\r\n  out[5] = (ab * atx - aa * aty) * det;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat2d\r\n *\r\n * @param {mat2d} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  return a[0] * a[3] - a[1] * a[2];\r\n}\r\n\r\n/**\r\n * Multiplies two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5];\r\n  out[0] = a0 * b0 + a2 * b1;\r\n  out[1] = a1 * b0 + a3 * b1;\r\n  out[2] = a0 * b2 + a2 * b3;\r\n  out[3] = a1 * b2 + a3 * b3;\r\n  out[4] = a0 * b4 + a2 * b5 + a4;\r\n  out[5] = a1 * b4 + a3 * b5 + a5;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat2d by the given angle\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\r\nexport function rotate(out, a, rad) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5];\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  out[0] = a0 *  c + a2 * s;\r\n  out[1] = a1 *  c + a3 * s;\r\n  out[2] = a0 * -s + a2 * c;\r\n  out[3] = a1 * -s + a3 * c;\r\n  out[4] = a4;\r\n  out[5] = a5;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to translate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat2d} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5];\r\n  let v0 = v[0], v1 = v[1];\r\n  out[0] = a0 * v0;\r\n  out[1] = a1 * v0;\r\n  out[2] = a2 * v1;\r\n  out[3] = a3 * v1;\r\n  out[4] = a4;\r\n  out[5] = a5;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translates the mat2d by the dimensions in the given vec2\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to translate\r\n * @param {vec2} v the vec2 to translate the matrix by\r\n * @returns {mat2d} out\r\n **/\r\nexport function translate(out, a, v) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5];\r\n  let v0 = v[0], v1 = v[1];\r\n  out[0] = a0;\r\n  out[1] = a1;\r\n  out[2] = a2;\r\n  out[3] = a3;\r\n  out[4] = a0 * v0 + a2 * v1 + a4;\r\n  out[5] = a1 * v0 + a3 * v1 + a5;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.rotate(dest, dest, rad);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat2d} out\r\n */\r\nexport function fromRotation(out, rad) {\r\n  let s = Math.sin(rad), c = Math.cos(rad);\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = -s;\r\n  out[3] = c;\r\n  out[4] = 0;\r\n  out[5] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.scale(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat2d} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = v[1];\r\n  out[4] = 0;\r\n  out[5] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat2d.identity(dest);\r\n *     mat2d.translate(dest, dest, vec);\r\n *\r\n * @param {mat2d} out mat2d receiving operation result\r\n * @param {vec2} v Translation vector\r\n * @returns {mat2d} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  out[4] = v[0];\r\n  out[5] = v[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat2d\r\n *\r\n * @param {mat2d} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return 'mat2d(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' +\r\n          a[3] + ', ' + a[4] + ', ' + a[5] + ')';\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat2d\r\n *\r\n * @param {mat2d} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return(Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],1))\r\n}\r\n\r\n/**\r\n * Adds two mat2d's\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @returns {mat2d} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat2d} out the receiving matrix\r\n * @param {mat2d} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat2d} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat2d's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat2d} out the receiving vector\r\n * @param {mat2d} a the first operand\r\n * @param {mat2d} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat2d} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  out[2] = a[2] + (b[2] * scale);\r\n  out[3] = a[3] + (b[3] * scale);\r\n  out[4] = a[4] + (b[4] * scale);\r\n  out[5] = a[5] + (b[5] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat2d} a The first matrix.\r\n * @param {mat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat2d} a The first matrix.\r\n * @param {mat2d} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n          Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n          Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n          Math.abs(a4 - b4) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n          Math.abs(a5 - b5) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a5), Math.abs(b5)));\r\n}\r\n\r\n/**\r\n * Alias for {@link mat2d.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat2d.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","import * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 3x3 Matrix\r\n * @module mat3\r\n */\r\n\r\n/**\r\n * Creates a new identity mat3\r\n *\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[5] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[4] = 1;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copies the upper-left 3x3 values into the given mat3.\r\n *\r\n * @param {mat3} out the receiving 3x3 matrix\r\n * @param {mat4} a   the source 4x4 matrix\r\n * @returns {mat3} out\r\n */\r\nexport function fromMat4(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[4];\r\n  out[4] = a[5];\r\n  out[5] = a[6];\r\n  out[6] = a[8];\r\n  out[7] = a[9];\r\n  out[8] = a[10];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat3 initialized with values from an existing matrix\r\n *\r\n * @param {mat3} a matrix to clone\r\n * @returns {mat3} a new 3x3 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat3 to another\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat3 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} A new mat3\r\n */\r\nexport function fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n  let out = new glMatrix.ARRAY_TYPE(9);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m10;\r\n  out[4] = m11;\r\n  out[5] = m12;\r\n  out[6] = m20;\r\n  out[7] = m21;\r\n  out[8] = m22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat3 to the given values\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 3)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 4)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 5)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 6)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 7)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 8)\r\n * @returns {mat3} out\r\n */\r\nexport function set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m10;\r\n  out[4] = m11;\r\n  out[5] = m12;\r\n  out[6] = m20;\r\n  out[7] = m21;\r\n  out[8] = m22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a mat3 to the identity matrix\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @returns {mat3} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 1;\r\n  out[5] = 0;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n  if (out === a) {\r\n    let a01 = a[1], a02 = a[2], a12 = a[5];\r\n    out[1] = a[3];\r\n    out[2] = a[6];\r\n    out[3] = a01;\r\n    out[5] = a[7];\r\n    out[6] = a02;\r\n    out[7] = a12;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[3];\r\n    out[2] = a[6];\r\n    out[3] = a[1];\r\n    out[4] = a[4];\r\n    out[5] = a[7];\r\n    out[6] = a[2];\r\n    out[7] = a[5];\r\n    out[8] = a[8];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function invert(out, a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2];\r\n  let a10 = a[3], a11 = a[4], a12 = a[5];\r\n  let a20 = a[6], a21 = a[7], a22 = a[8];\r\n\r\n  let b01 = a22 * a11 - a12 * a21;\r\n  let b11 = -a22 * a10 + a12 * a20;\r\n  let b21 = a21 * a10 - a11 * a20;\r\n\r\n  // Calculate the determinant\r\n  let det = a00 * b01 + a01 * b11 + a02 * b21;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = b01 * det;\r\n  out[1] = (-a22 * a01 + a02 * a21) * det;\r\n  out[2] = (a12 * a01 - a02 * a11) * det;\r\n  out[3] = b11 * det;\r\n  out[4] = (a22 * a00 - a02 * a20) * det;\r\n  out[5] = (-a12 * a00 + a02 * a10) * det;\r\n  out[6] = b21 * det;\r\n  out[7] = (-a21 * a00 + a01 * a20) * det;\r\n  out[8] = (a11 * a00 - a01 * a10) * det;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the source matrix\r\n * @returns {mat3} out\r\n */\r\nexport function adjoint(out, a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2];\r\n  let a10 = a[3], a11 = a[4], a12 = a[5];\r\n  let a20 = a[6], a21 = a[7], a22 = a[8];\r\n\r\n  out[0] = (a11 * a22 - a12 * a21);\r\n  out[1] = (a02 * a21 - a01 * a22);\r\n  out[2] = (a01 * a12 - a02 * a11);\r\n  out[3] = (a12 * a20 - a10 * a22);\r\n  out[4] = (a00 * a22 - a02 * a20);\r\n  out[5] = (a02 * a10 - a00 * a12);\r\n  out[6] = (a10 * a21 - a11 * a20);\r\n  out[7] = (a01 * a20 - a00 * a21);\r\n  out[8] = (a00 * a11 - a01 * a10);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat3\r\n *\r\n * @param {mat3} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2];\r\n  let a10 = a[3], a11 = a[4], a12 = a[5];\r\n  let a20 = a[6], a21 = a[7], a22 = a[8];\r\n\r\n  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);\r\n}\r\n\r\n/**\r\n * Multiplies two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2];\r\n  let a10 = a[3], a11 = a[4], a12 = a[5];\r\n  let a20 = a[6], a21 = a[7], a22 = a[8];\r\n\r\n  let b00 = b[0], b01 = b[1], b02 = b[2];\r\n  let b10 = b[3], b11 = b[4], b12 = b[5];\r\n  let b20 = b[6], b21 = b[7], b22 = b[8];\r\n\r\n  out[0] = b00 * a00 + b01 * a10 + b02 * a20;\r\n  out[1] = b00 * a01 + b01 * a11 + b02 * a21;\r\n  out[2] = b00 * a02 + b01 * a12 + b02 * a22;\r\n\r\n  out[3] = b10 * a00 + b11 * a10 + b12 * a20;\r\n  out[4] = b10 * a01 + b11 * a11 + b12 * a21;\r\n  out[5] = b10 * a02 + b11 * a12 + b12 * a22;\r\n\r\n  out[6] = b20 * a00 + b21 * a10 + b22 * a20;\r\n  out[7] = b20 * a01 + b21 * a11 + b22 * a21;\r\n  out[8] = b20 * a02 + b21 * a12 + b22 * a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translate a mat3 by the given vector\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to translate\r\n * @param {vec2} v vector to translate by\r\n * @returns {mat3} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2],\r\n    a10 = a[3], a11 = a[4], a12 = a[5],\r\n    a20 = a[6], a21 = a[7], a22 = a[8],\r\n    x = v[0], y = v[1];\r\n\r\n  out[0] = a00;\r\n  out[1] = a01;\r\n  out[2] = a02;\r\n\r\n  out[3] = a10;\r\n  out[4] = a11;\r\n  out[5] = a12;\r\n\r\n  out[6] = x * a00 + y * a10 + a20;\r\n  out[7] = x * a01 + y * a11 + a21;\r\n  out[8] = x * a02 + y * a12 + a22;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat3 by the given angle\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nexport function rotate(out, a, rad) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2],\r\n    a10 = a[3], a11 = a[4], a12 = a[5],\r\n    a20 = a[6], a21 = a[7], a22 = a[8],\r\n\r\n    s = Math.sin(rad),\r\n    c = Math.cos(rad);\r\n\r\n  out[0] = c * a00 + s * a10;\r\n  out[1] = c * a01 + s * a11;\r\n  out[2] = c * a02 + s * a12;\r\n\r\n  out[3] = c * a10 - s * a00;\r\n  out[4] = c * a11 - s * a01;\r\n  out[5] = c * a12 - s * a02;\r\n\r\n  out[6] = a20;\r\n  out[7] = a21;\r\n  out[8] = a22;\r\n  return out;\r\n};\r\n\r\n/**\r\n * Scales the mat3 by the dimensions in the given vec2\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to rotate\r\n * @param {vec2} v the vec2 to scale the matrix by\r\n * @returns {mat3} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let x = v[0], y = v[1];\r\n\r\n  out[0] = x * a[0];\r\n  out[1] = x * a[1];\r\n  out[2] = x * a[2];\r\n\r\n  out[3] = y * a[3];\r\n  out[4] = y * a[4];\r\n  out[5] = y * a[5];\r\n\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.translate(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Translation vector\r\n * @returns {mat3} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 1;\r\n  out[5] = 0;\r\n  out[6] = v[0];\r\n  out[7] = v[1];\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.rotate(dest, dest, rad);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat3} out\r\n */\r\nexport function fromRotation(out, rad) {\r\n  let s = Math.sin(rad), c = Math.cos(rad);\r\n\r\n  out[0] = c;\r\n  out[1] = s;\r\n  out[2] = 0;\r\n\r\n  out[3] = -s;\r\n  out[4] = c;\r\n  out[5] = 0;\r\n\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat3.identity(dest);\r\n *     mat3.scale(dest, dest, vec);\r\n *\r\n * @param {mat3} out mat3 receiving operation result\r\n * @param {vec2} v Scaling vector\r\n * @returns {mat3} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n\r\n  out[3] = 0;\r\n  out[4] = v[1];\r\n  out[5] = 0;\r\n\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copies the values from a mat2d into a mat3\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat2d} a the matrix to copy\r\n * @returns {mat3} out\r\n **/\r\nexport function fromMat2d(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = 0;\r\n\r\n  out[3] = a[2];\r\n  out[4] = a[3];\r\n  out[5] = 0;\r\n\r\n  out[6] = a[4];\r\n  out[7] = a[5];\r\n  out[8] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n* Calculates a 3x3 matrix from the given quaternion\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {quat} q Quaternion to create matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\r\nexport function fromQuat(out, q) {\r\n  let x = q[0], y = q[1], z = q[2], w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let yx = y * x2;\r\n  let yy = y * y2;\r\n  let zx = z * x2;\r\n  let zy = z * y2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - yy - zz;\r\n  out[3] = yx - wz;\r\n  out[6] = zx + wy;\r\n\r\n  out[1] = yx + wz;\r\n  out[4] = 1 - xx - zz;\r\n  out[7] = zy - wx;\r\n\r\n  out[2] = zx - wy;\r\n  out[5] = zy + wx;\r\n  out[8] = 1 - xx - yy;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\r\n*\r\n* @param {mat3} out mat3 receiving operation result\r\n* @param {mat4} a Mat4 to derive the normal matrix from\r\n*\r\n* @returns {mat3} out\r\n*/\r\nexport function normalFromMat4(out, a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\r\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\r\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\r\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n\r\n  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n\r\n  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a 2D projection matrix with the given bounds\r\n *\r\n * @param {mat3} out mat3 frustum matrix will be written into\r\n * @param {number} width Width of your gl context\r\n * @param {number} height Height of gl context\r\n * @returns {mat3} out\r\n */\r\nexport function projection(out, width, height) {\r\n    out[0] = 2 / width;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = -2 / height;\r\n    out[5] = 0;\r\n    out[6] = -1;\r\n    out[7] = 1;\r\n    out[8] = 1;\r\n    return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a mat3\r\n *\r\n * @param {mat3} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' +\r\n          a[3] + ', ' + a[4] + ', ' + a[5] + ', ' +\r\n          a[6] + ', ' + a[7] + ', ' + a[8] + ')';\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat3\r\n *\r\n * @param {mat3} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return(Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8]))\r\n}\r\n\r\n/**\r\n * Adds two mat3's\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  out[8] = a[8] + b[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @returns {mat3} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  out[6] = a[6] - b[6];\r\n  out[7] = a[7] - b[7];\r\n  out[8] = a[8] - b[8];\r\n  return out;\r\n}\r\n\r\n\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat3} out the receiving matrix\r\n * @param {mat3} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat3} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  out[8] = a[8] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat3's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat3} out the receiving vector\r\n * @param {mat3} a the first operand\r\n * @param {mat3} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat3} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  out[2] = a[2] + (b[2] * scale);\r\n  out[3] = a[3] + (b[3] * scale);\r\n  out[4] = a[4] + (b[4] * scale);\r\n  out[5] = a[5] + (b[5] * scale);\r\n  out[6] = a[6] + (b[6] * scale);\r\n  out[7] = a[7] + (b[7] * scale);\r\n  out[8] = a[8] + (b[8] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] &&\r\n         a[3] === b[3] && a[4] === b[4] && a[5] === b[5] &&\r\n         a[6] === b[6] && a[7] === b[7] && a[8] === b[8];\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat3} a The first matrix.\r\n * @param {mat3} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3], a4 = a[4], a5 = a[5], a6 = a[6], a7 = a[7], a8 = a[8];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3], b4 = b[4], b5 = b[5], b6 = b[6], b7 = b[7], b8 = b[8];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n          Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n          Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n          Math.abs(a4 - b4) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n          Math.abs(a5 - b5) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n          Math.abs(a6 - b6) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n          Math.abs(a7 - b7) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\r\n          Math.abs(a8 - b8) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a8), Math.abs(b8)));\r\n}\r\n\r\n/**\r\n * Alias for {@link mat3.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat3.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","import * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.\r\n * @module mat4\r\n */\r\n\r\n/**\r\n * Creates a new identity mat4\r\n *\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n    out[4] = 0;\r\n    out[6] = 0;\r\n    out[7] = 0;\r\n    out[8] = 0;\r\n    out[9] = 0;\r\n    out[11] = 0;\r\n    out[12] = 0;\r\n    out[13] = 0;\r\n    out[14] = 0;\r\n  }\r\n  out[0] = 1;\r\n  out[5] = 1;\r\n  out[10] = 1;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat4 initialized with values from an existing matrix\r\n *\r\n * @param {mat4} a matrix to clone\r\n * @returns {mat4} a new 4x4 matrix\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  out[9] = a[9];\r\n  out[10] = a[10];\r\n  out[11] = a[11];\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one mat4 to another\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  out[8] = a[8];\r\n  out[9] = a[9];\r\n  out[10] = a[10];\r\n  out[11] = a[11];\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Create a new mat4 with the given values\r\n *\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} A new mat4\r\n */\r\nexport function fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\r\n  let out = new glMatrix.ARRAY_TYPE(16);\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m03;\r\n  out[4] = m10;\r\n  out[5] = m11;\r\n  out[6] = m12;\r\n  out[7] = m13;\r\n  out[8] = m20;\r\n  out[9] = m21;\r\n  out[10] = m22;\r\n  out[11] = m23;\r\n  out[12] = m30;\r\n  out[13] = m31;\r\n  out[14] = m32;\r\n  out[15] = m33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a mat4 to the given values\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {Number} m00 Component in column 0, row 0 position (index 0)\r\n * @param {Number} m01 Component in column 0, row 1 position (index 1)\r\n * @param {Number} m02 Component in column 0, row 2 position (index 2)\r\n * @param {Number} m03 Component in column 0, row 3 position (index 3)\r\n * @param {Number} m10 Component in column 1, row 0 position (index 4)\r\n * @param {Number} m11 Component in column 1, row 1 position (index 5)\r\n * @param {Number} m12 Component in column 1, row 2 position (index 6)\r\n * @param {Number} m13 Component in column 1, row 3 position (index 7)\r\n * @param {Number} m20 Component in column 2, row 0 position (index 8)\r\n * @param {Number} m21 Component in column 2, row 1 position (index 9)\r\n * @param {Number} m22 Component in column 2, row 2 position (index 10)\r\n * @param {Number} m23 Component in column 2, row 3 position (index 11)\r\n * @param {Number} m30 Component in column 3, row 0 position (index 12)\r\n * @param {Number} m31 Component in column 3, row 1 position (index 13)\r\n * @param {Number} m32 Component in column 3, row 2 position (index 14)\r\n * @param {Number} m33 Component in column 3, row 3 position (index 15)\r\n * @returns {mat4} out\r\n */\r\nexport function set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\r\n  out[0] = m00;\r\n  out[1] = m01;\r\n  out[2] = m02;\r\n  out[3] = m03;\r\n  out[4] = m10;\r\n  out[5] = m11;\r\n  out[6] = m12;\r\n  out[7] = m13;\r\n  out[8] = m20;\r\n  out[9] = m21;\r\n  out[10] = m22;\r\n  out[11] = m23;\r\n  out[12] = m30;\r\n  out[13] = m31;\r\n  out[14] = m32;\r\n  out[15] = m33;\r\n  return out;\r\n}\r\n\r\n\r\n/**\r\n * Set a mat4 to the identity matrix\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @returns {mat4} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transpose the values of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function transpose(out, a) {\r\n  // If we are transposing ourselves we can skip a few steps but have to cache some values\r\n  if (out === a) {\r\n    let a01 = a[1], a02 = a[2], a03 = a[3];\r\n    let a12 = a[6], a13 = a[7];\r\n    let a23 = a[11];\r\n\r\n    out[1] = a[4];\r\n    out[2] = a[8];\r\n    out[3] = a[12];\r\n    out[4] = a01;\r\n    out[6] = a[9];\r\n    out[7] = a[13];\r\n    out[8] = a02;\r\n    out[9] = a12;\r\n    out[11] = a[14];\r\n    out[12] = a03;\r\n    out[13] = a13;\r\n    out[14] = a23;\r\n  } else {\r\n    out[0] = a[0];\r\n    out[1] = a[4];\r\n    out[2] = a[8];\r\n    out[3] = a[12];\r\n    out[4] = a[1];\r\n    out[5] = a[5];\r\n    out[6] = a[9];\r\n    out[7] = a[13];\r\n    out[8] = a[2];\r\n    out[9] = a[6];\r\n    out[10] = a[10];\r\n    out[11] = a[14];\r\n    out[12] = a[3];\r\n    out[13] = a[7];\r\n    out[14] = a[11];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Inverts a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function invert(out, a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\r\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\r\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\r\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  let det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n\r\n  if (!det) {\r\n    return null;\r\n  }\r\n  det = 1.0 / det;\r\n\r\n  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;\r\n  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;\r\n  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;\r\n  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;\r\n  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;\r\n  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;\r\n  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;\r\n  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;\r\n  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;\r\n  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;\r\n  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;\r\n  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;\r\n  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;\r\n  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;\r\n  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;\r\n  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the adjugate of a mat4\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the source matrix\r\n * @returns {mat4} out\r\n */\r\nexport function adjoint(out, a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\r\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\r\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\r\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n  out[0]  =  (a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22));\r\n  out[1]  = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));\r\n  out[2]  =  (a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12));\r\n  out[3]  = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));\r\n  out[4]  = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));\r\n  out[5]  =  (a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22));\r\n  out[6]  = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));\r\n  out[7]  =  (a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12));\r\n  out[8]  =  (a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21));\r\n  out[9]  = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));\r\n  out[10] =  (a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11));\r\n  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));\r\n  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));\r\n  out[13] =  (a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21));\r\n  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));\r\n  out[15] =  (a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11));\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the determinant of a mat4\r\n *\r\n * @param {mat4} a the source matrix\r\n * @returns {Number} determinant of a\r\n */\r\nexport function determinant(a) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\r\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\r\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\r\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n  let b00 = a00 * a11 - a01 * a10;\r\n  let b01 = a00 * a12 - a02 * a10;\r\n  let b02 = a00 * a13 - a03 * a10;\r\n  let b03 = a01 * a12 - a02 * a11;\r\n  let b04 = a01 * a13 - a03 * a11;\r\n  let b05 = a02 * a13 - a03 * a12;\r\n  let b06 = a20 * a31 - a21 * a30;\r\n  let b07 = a20 * a32 - a22 * a30;\r\n  let b08 = a20 * a33 - a23 * a30;\r\n  let b09 = a21 * a32 - a22 * a31;\r\n  let b10 = a21 * a33 - a23 * a31;\r\n  let b11 = a22 * a33 - a23 * a32;\r\n\r\n  // Calculate the determinant\r\n  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;\r\n}\r\n\r\n/**\r\n * Multiplies two mat4s\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let a00 = a[0], a01 = a[1], a02 = a[2], a03 = a[3];\r\n  let a10 = a[4], a11 = a[5], a12 = a[6], a13 = a[7];\r\n  let a20 = a[8], a21 = a[9], a22 = a[10], a23 = a[11];\r\n  let a30 = a[12], a31 = a[13], a32 = a[14], a33 = a[15];\r\n\r\n  // Cache only the current line of the second matrix\r\n  let b0  = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\r\n  out[0] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n  out[1] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n  out[2] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n  out[3] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\r\n  b0 = b[4]; b1 = b[5]; b2 = b[6]; b3 = b[7];\r\n  out[4] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n  out[5] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n  out[6] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n  out[7] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\r\n  b0 = b[8]; b1 = b[9]; b2 = b[10]; b3 = b[11];\r\n  out[8] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n  out[9] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n  out[10] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n  out[11] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n\r\n  b0 = b[12]; b1 = b[13]; b2 = b[14]; b3 = b[15];\r\n  out[12] = b0*a00 + b1*a10 + b2*a20 + b3*a30;\r\n  out[13] = b0*a01 + b1*a11 + b2*a21 + b3*a31;\r\n  out[14] = b0*a02 + b1*a12 + b2*a22 + b3*a32;\r\n  out[15] = b0*a03 + b1*a13 + b2*a23 + b3*a33;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translate a mat4 by the given vector\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {mat4} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let x = v[0], y = v[1], z = v[2];\r\n  let a00, a01, a02, a03;\r\n  let a10, a11, a12, a13;\r\n  let a20, a21, a22, a23;\r\n\r\n  if (a === out) {\r\n    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];\r\n    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];\r\n    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];\r\n    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];\r\n  } else {\r\n    a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\r\n    a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\r\n    a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\r\n\r\n    out[0] = a00; out[1] = a01; out[2] = a02; out[3] = a03;\r\n    out[4] = a10; out[5] = a11; out[6] = a12; out[7] = a13;\r\n    out[8] = a20; out[9] = a21; out[10] = a22; out[11] = a23;\r\n\r\n    out[12] = a00 * x + a10 * y + a20 * z + a[12];\r\n    out[13] = a01 * x + a11 * y + a21 * z + a[13];\r\n    out[14] = a02 * x + a12 * y + a22 * z + a[14];\r\n    out[15] = a03 * x + a13 * y + a23 * z + a[15];\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales the mat4 by the dimensions in the given vec3 not using vectorization\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {vec3} v the vec3 to scale the matrix by\r\n * @returns {mat4} out\r\n **/\r\nexport function scale(out, a, v) {\r\n  let x = v[0], y = v[1], z = v[2];\r\n\r\n  out[0] = a[0] * x;\r\n  out[1] = a[1] * x;\r\n  out[2] = a[2] * x;\r\n  out[3] = a[3] * x;\r\n  out[4] = a[4] * y;\r\n  out[5] = a[5] * y;\r\n  out[6] = a[6] * y;\r\n  out[7] = a[7] * y;\r\n  out[8] = a[8] * z;\r\n  out[9] = a[9] * z;\r\n  out[10] = a[10] * z;\r\n  out[11] = a[11] * z;\r\n  out[12] = a[12];\r\n  out[13] = a[13];\r\n  out[14] = a[14];\r\n  out[15] = a[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a mat4 by the given angle around the given axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nexport function rotate(out, a, rad, axis) {\r\n  let x = axis[0], y = axis[1], z = axis[2];\r\n  let len = Math.hypot(x,y,z);\r\n  let s, c, t;\r\n  let a00, a01, a02, a03;\r\n  let a10, a11, a12, a13;\r\n  let a20, a21, a22, a23;\r\n  let b00, b01, b02;\r\n  let b10, b11, b12;\r\n  let b20, b21, b22;\r\n\r\n  if (len < glMatrix.EPSILON) { return null; }\r\n\r\n  len = 1 / len;\r\n  x *= len;\r\n  y *= len;\r\n  z *= len;\r\n\r\n  s = Math.sin(rad);\r\n  c = Math.cos(rad);\r\n  t = 1 - c;\r\n\r\n  a00 = a[0]; a01 = a[1]; a02 = a[2]; a03 = a[3];\r\n  a10 = a[4]; a11 = a[5]; a12 = a[6]; a13 = a[7];\r\n  a20 = a[8]; a21 = a[9]; a22 = a[10]; a23 = a[11];\r\n\r\n  // Construct the elements of the rotation matrix\r\n  b00 = x * x * t + c; b01 = y * x * t + z * s; b02 = z * x * t - y * s;\r\n  b10 = x * y * t - z * s; b11 = y * y * t + c; b12 = z * y * t + x * s;\r\n  b20 = x * z * t + y * s; b21 = y * z * t - x * s; b22 = z * z * t + c;\r\n\r\n  // Perform rotation-specific matrix multiplication\r\n  out[0] = a00 * b00 + a10 * b01 + a20 * b02;\r\n  out[1] = a01 * b00 + a11 * b01 + a21 * b02;\r\n  out[2] = a02 * b00 + a12 * b01 + a22 * b02;\r\n  out[3] = a03 * b00 + a13 * b01 + a23 * b02;\r\n  out[4] = a00 * b10 + a10 * b11 + a20 * b12;\r\n  out[5] = a01 * b10 + a11 * b11 + a21 * b12;\r\n  out[6] = a02 * b10 + a12 * b11 + a22 * b12;\r\n  out[7] = a03 * b10 + a13 * b11 + a23 * b12;\r\n  out[8] = a00 * b20 + a10 * b21 + a20 * b22;\r\n  out[9] = a01 * b20 + a11 * b21 + a21 * b22;\r\n  out[10] = a02 * b20 + a12 * b21 + a22 * b22;\r\n  out[11] = a03 * b20 + a13 * b21 + a23 * b22;\r\n\r\n  if (a !== out) { // If the source and destination differ, copy the unchanged last row\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the X axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a10 = a[4];\r\n  let a11 = a[5];\r\n  let a12 = a[6];\r\n  let a13 = a[7];\r\n  let a20 = a[8];\r\n  let a21 = a[9];\r\n  let a22 = a[10];\r\n  let a23 = a[11];\r\n\r\n  if (a !== out) { // If the source and destination differ, copy the unchanged rows\r\n    out[0]  = a[0];\r\n    out[1]  = a[1];\r\n    out[2]  = a[2];\r\n    out[3]  = a[3];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[4] = a10 * c + a20 * s;\r\n  out[5] = a11 * c + a21 * s;\r\n  out[6] = a12 * c + a22 * s;\r\n  out[7] = a13 * c + a23 * s;\r\n  out[8] = a20 * c - a10 * s;\r\n  out[9] = a21 * c - a11 * s;\r\n  out[10] = a22 * c - a12 * s;\r\n  out[11] = a23 * c - a13 * s;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Y axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a00 = a[0];\r\n  let a01 = a[1];\r\n  let a02 = a[2];\r\n  let a03 = a[3];\r\n  let a20 = a[8];\r\n  let a21 = a[9];\r\n  let a22 = a[10];\r\n  let a23 = a[11];\r\n\r\n  if (a !== out) { // If the source and destination differ, copy the unchanged rows\r\n    out[4]  = a[4];\r\n    out[5]  = a[5];\r\n    out[6]  = a[6];\r\n    out[7]  = a[7];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = a00 * c - a20 * s;\r\n  out[1] = a01 * c - a21 * s;\r\n  out[2] = a02 * c - a22 * s;\r\n  out[3] = a03 * c - a23 * s;\r\n  out[8] = a00 * s + a20 * c;\r\n  out[9] = a01 * s + a21 * c;\r\n  out[10] = a02 * s + a22 * c;\r\n  out[11] = a03 * s + a23 * c;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a matrix by the given angle around the Z axis\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to rotate\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n  let a00 = a[0];\r\n  let a01 = a[1];\r\n  let a02 = a[2];\r\n  let a03 = a[3];\r\n  let a10 = a[4];\r\n  let a11 = a[5];\r\n  let a12 = a[6];\r\n  let a13 = a[7];\r\n\r\n  if (a !== out) { // If the source and destination differ, copy the unchanged last row\r\n    out[8]  = a[8];\r\n    out[9]  = a[9];\r\n    out[10] = a[10];\r\n    out[11] = a[11];\r\n    out[12] = a[12];\r\n    out[13] = a[13];\r\n    out[14] = a[14];\r\n    out[15] = a[15];\r\n  }\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0] = a00 * c + a10 * s;\r\n  out[1] = a01 * c + a11 * s;\r\n  out[2] = a02 * c + a12 * s;\r\n  out[3] = a03 * c + a13 * s;\r\n  out[4] = a10 * c - a00 * s;\r\n  out[5] = a11 * c - a01 * s;\r\n  out[6] = a12 * c - a02 * s;\r\n  out[7] = a13 * c - a03 * s;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromTranslation(out, v) {\r\n  out[0] = 1;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a vector scaling\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.scale(dest, dest, vec);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {vec3} v Scaling vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromScaling(out, v) {\r\n  out[0] = v[0];\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = v[1];\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = v[2];\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a given angle around a given axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotate(dest, dest, rad, axis);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @param {vec3} axis the axis to rotate around\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotation(out, rad, axis) {\r\n  let x = axis[0], y = axis[1], z = axis[2];\r\n  let len = Math.hypot(x, y, z);\r\n  let s, c, t;\r\n\r\n  if (len < glMatrix.EPSILON) { return null; }\r\n\r\n  len = 1 / len;\r\n  x *= len;\r\n  y *= len;\r\n  z *= len;\r\n\r\n  s = Math.sin(rad);\r\n  c = Math.cos(rad);\r\n  t = 1 - c;\r\n\r\n  // Perform rotation-specific matrix multiplication\r\n  out[0] = x * x * t + c;\r\n  out[1] = y * x * t + z * s;\r\n  out[2] = z * x * t - y * s;\r\n  out[3] = 0;\r\n  out[4] = x * y * t - z * s;\r\n  out[5] = y * y * t + c;\r\n  out[6] = z * y * t + x * s;\r\n  out[7] = 0;\r\n  out[8] = x * z * t + y * s;\r\n  out[9] = y * z * t - x * s;\r\n  out[10] = z * z * t + c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the X axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateX(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromXRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0]  = 1;\r\n  out[1]  = 0;\r\n  out[2]  = 0;\r\n  out[3]  = 0;\r\n  out[4] = 0;\r\n  out[5] = c;\r\n  out[6] = s;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = -s;\r\n  out[10] = c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the Y axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateY(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromYRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0]  = c;\r\n  out[1]  = 0;\r\n  out[2]  = -s;\r\n  out[3]  = 0;\r\n  out[4] = 0;\r\n  out[5] = 1;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = s;\r\n  out[9] = 0;\r\n  out[10] = c;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from the given angle around the Z axis\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.rotateZ(dest, dest, rad);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {Number} rad the angle to rotate the matrix by\r\n * @returns {mat4} out\r\n */\r\nexport function fromZRotation(out, rad) {\r\n  let s = Math.sin(rad);\r\n  let c = Math.cos(rad);\r\n\r\n  // Perform axis-specific matrix multiplication\r\n  out[0]  = c;\r\n  out[1]  = s;\r\n  out[2]  = 0;\r\n  out[3]  = 0;\r\n  out[4] = -s;\r\n  out[5] = c;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 1;\r\n  out[11] = 0;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation and vector translation\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslation(out, q, v) {\r\n  // Quaternion math\r\n  let x = q[0], y = q[1], z = q[2], w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - (yy + zz);\r\n  out[1] = xy + wz;\r\n  out[2] = xz - wy;\r\n  out[3] = 0;\r\n  out[4] = xy - wz;\r\n  out[5] = 1 - (xx + zz);\r\n  out[6] = yz + wx;\r\n  out[7] = 0;\r\n  out[8] = xz + wy;\r\n  out[9] = yz - wx;\r\n  out[10] = 1 - (xx + yy);\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new mat4 from a dual quat.\r\n *\r\n * @param {mat4} out Matrix\r\n * @param {quat2} a Dual Quaternion\r\n * @returns {mat4} mat4 receiving operation result\r\n */\r\nexport function fromQuat2(out, a) {\r\n  let translation = new glMatrix.ARRAY_TYPE(3);\r\n  let bx = -a[0], by = -a[1], bz = -a[2], bw = a[3],\r\n  ax = a[4], ay = a[5], az = a[6], aw = a[7];\r\n\r\n  let magnitude = bx * bx + by * by + bz * bz + bw * bw;\r\n  //Only scale if it makes sense\r\n  if (magnitude > 0) {\r\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;\r\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;\r\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;\r\n  } else {\r\n    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\r\n    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\r\n    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\r\n  }\r\n  fromRotationTranslation(out, a, translation);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the translation vector component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslation,\r\n *  the returned vector will be the same as the translation vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive translation component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\r\nexport function getTranslation(out, mat) {\r\n  out[0] = mat[12];\r\n  out[1] = mat[13];\r\n  out[2] = mat[14];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the scaling factor component of a transformation\r\n *  matrix. If a matrix is built with fromRotationTranslationScale\r\n *  with a normalized Quaternion paramter, the returned vector will be\r\n *  the same as the scaling vector\r\n *  originally supplied.\r\n * @param  {vec3} out Vector to receive scaling factor component\r\n * @param  {mat4} mat Matrix to be decomposed (input)\r\n * @return {vec3} out\r\n */\r\nexport function getScaling(out, mat) {\r\n  let m11 = mat[0];\r\n  let m12 = mat[1];\r\n  let m13 = mat[2];\r\n  let m21 = mat[4];\r\n  let m22 = mat[5];\r\n  let m23 = mat[6];\r\n  let m31 = mat[8];\r\n  let m32 = mat[9];\r\n  let m33 = mat[10];\r\n\r\n  out[0] = Math.hypot(m11, m12, m13);\r\n  out[1] = Math.hypot(m21, m22, m23);\r\n  out[2] = Math.hypot(m31, m32, m33);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a quaternion representing the rotational component\r\n *  of a transformation matrix. If a matrix is built with\r\n *  fromRotationTranslation, the returned quaternion will be the\r\n *  same as the quaternion originally supplied.\r\n * @param {quat} out Quaternion to receive the rotation component\r\n * @param {mat4} mat Matrix to be decomposed (input)\r\n * @return {quat} out\r\n */\r\nexport function getRotation(out, mat) {\r\n  let scaling = new glMatrix.ARRAY_TYPE(3);\r\n  getScaling(scaling, mat);\r\n\r\n  let is1 = 1 / scaling[0];\r\n  let is2 = 1 / scaling[1];\r\n  let is3 = 1 / scaling[2];\r\n\r\n  let sm11 = mat[0] * is1;\r\n  let sm12 = mat[1] * is2;\r\n  let sm13 = mat[2] * is3;\r\n  let sm21 = mat[4] * is1;\r\n  let sm22 = mat[5] * is2;\r\n  let sm23 = mat[6] * is3;\r\n  let sm31 = mat[8] * is1;\r\n  let sm32 = mat[9] * is2;\r\n  let sm33 = mat[10] * is3;\r\n\r\n  let trace = sm11 + sm22 + sm33;\r\n  let S = 0;\r\n\r\n  if (trace > 0) {\r\n    S = Math.sqrt(trace + 1.0) * 2;\r\n    out[3] = 0.25 * S;\r\n    out[0] = (sm23 - sm32) / S;\r\n    out[1] = (sm31 - sm13) / S;\r\n    out[2] = (sm12 - sm21) / S;\r\n  } else if ((sm11 > sm22) && (sm11 > sm33)) {\r\n    S = Math.sqrt(1.0 + sm11 - sm22- sm33) * 2;\r\n    out[3] = (sm23 - sm32) / S;\r\n    out[0] = 0.25 * S;\r\n    out[1] = (sm12 + sm21) / S;\r\n    out[2] = (sm31 + sm13) / S;\r\n  } else if (sm22 > sm33) {\r\n    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;\r\n    out[3] = (sm31 - sm13) / S;\r\n    out[0] = (sm12 + sm21) / S;\r\n    out[1] = 0.25 * S;\r\n    out[2] = (sm23 + sm32) / S;\r\n  } else {\r\n    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;\r\n    out[3] = (sm12 - sm21) / S;\r\n    out[0] = (sm31 + sm13) / S;\r\n    out[1] = (sm23 + sm32) / S;\r\n    out[2] = 0.25 * S;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslationScale(out, q, v, s) {\r\n  // Quaternion math\r\n  let x = q[0], y = q[1], z = q[2], w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n  let sx = s[0];\r\n  let sy = s[1];\r\n  let sz = s[2];\r\n\r\n  out[0] = (1 - (yy + zz)) * sx;\r\n  out[1] = (xy + wz) * sx;\r\n  out[2] = (xz - wy) * sx;\r\n  out[3] = 0;\r\n  out[4] = (xy - wz) * sy;\r\n  out[5] = (1 - (xx + zz)) * sy;\r\n  out[6] = (yz + wx) * sy;\r\n  out[7] = 0;\r\n  out[8] = (xz + wy) * sz;\r\n  out[9] = (yz - wx) * sz;\r\n  out[10] = (1 - (xx + yy)) * sz;\r\n  out[11] = 0;\r\n  out[12] = v[0];\r\n  out[13] = v[1];\r\n  out[14] = v[2];\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\r\n * This is equivalent to (but much faster than):\r\n *\r\n *     mat4.identity(dest);\r\n *     mat4.translate(dest, vec);\r\n *     mat4.translate(dest, origin);\r\n *     let quatMat = mat4.create();\r\n *     quat4.toMat4(quat, quatMat);\r\n *     mat4.multiply(dest, quatMat);\r\n *     mat4.scale(dest, scale)\r\n *     mat4.translate(dest, negativeOrigin);\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat4} q Rotation quaternion\r\n * @param {vec3} v Translation vector\r\n * @param {vec3} s Scaling vector\r\n * @param {vec3} o The origin vector around which to scale and rotate\r\n * @returns {mat4} out\r\n */\r\nexport function fromRotationTranslationScaleOrigin(out, q, v, s, o) {\r\n  // Quaternion math\r\n  let x = q[0], y = q[1], z = q[2], w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let xy = x * y2;\r\n  let xz = x * z2;\r\n  let yy = y * y2;\r\n  let yz = y * z2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  let sx = s[0];\r\n  let sy = s[1];\r\n  let sz = s[2];\r\n\r\n  let ox = o[0];\r\n  let oy = o[1];\r\n  let oz = o[2];\r\n\r\n  let out0 = (1 - (yy + zz)) * sx;\r\n  let out1 = (xy + wz) * sx;\r\n  let out2 = (xz - wy) * sx;\r\n  let out4 = (xy - wz) * sy;\r\n  let out5 = (1 - (xx + zz)) * sy;\r\n  let out6 = (yz + wx) * sy;\r\n  let out8 = (xz + wy) * sz;\r\n  let out9 = (yz - wx) * sz;\r\n  let out10 = (1 - (xx + yy)) * sz;\r\n\r\n  out[0] = out0;\r\n  out[1] = out1;\r\n  out[2] = out2;\r\n  out[3] = 0;\r\n  out[4] = out4;\r\n  out[5] = out5;\r\n  out[6] = out6;\r\n  out[7] = 0;\r\n  out[8] = out8;\r\n  out[9] = out9;\r\n  out[10] = out10;\r\n  out[11] = 0;\r\n  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);\r\n  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);\r\n  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates a 4x4 matrix from the given quaternion\r\n *\r\n * @param {mat4} out mat4 receiving operation result\r\n * @param {quat} q Quaternion to create matrix from\r\n *\r\n * @returns {mat4} out\r\n */\r\nexport function fromQuat(out, q) {\r\n  let x = q[0], y = q[1], z = q[2], w = q[3];\r\n  let x2 = x + x;\r\n  let y2 = y + y;\r\n  let z2 = z + z;\r\n\r\n  let xx = x * x2;\r\n  let yx = y * x2;\r\n  let yy = y * y2;\r\n  let zx = z * x2;\r\n  let zy = z * y2;\r\n  let zz = z * z2;\r\n  let wx = w * x2;\r\n  let wy = w * y2;\r\n  let wz = w * z2;\r\n\r\n  out[0] = 1 - yy - zz;\r\n  out[1] = yx + wz;\r\n  out[2] = zx - wy;\r\n  out[3] = 0;\r\n\r\n  out[4] = yx - wz;\r\n  out[5] = 1 - xx - zz;\r\n  out[6] = zy + wx;\r\n  out[7] = 0;\r\n\r\n  out[8] = zx + wy;\r\n  out[9] = zy - wx;\r\n  out[10] = 1 - xx - yy;\r\n  out[11] = 0;\r\n\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = 0;\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a frustum matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Number} left Left bound of the frustum\r\n * @param {Number} right Right bound of the frustum\r\n * @param {Number} bottom Bottom bound of the frustum\r\n * @param {Number} top Top bound of the frustum\r\n * @param {Number} near Near bound of the frustum\r\n * @param {Number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function frustum(out, left, right, bottom, top, near, far) {\r\n  let rl = 1 / (right - left);\r\n  let tb = 1 / (top - bottom);\r\n  let nf = 1 / (near - far);\r\n  out[0] = (near * 2) * rl;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = (near * 2) * tb;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = (right + left) * rl;\r\n  out[9] = (top + bottom) * tb;\r\n  out[10] = (far + near) * nf;\r\n  out[11] = -1;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[14] = (far * near * 2) * nf;\r\n  out[15] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given bounds.\r\n * Passing null/undefined/no value for far will generate infinite projection matrix.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} fovy Vertical field of view in radians\r\n * @param {number} aspect Aspect ratio. typically viewport width/height\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum, can be null or Infinity\r\n * @returns {mat4} out\r\n */\r\nexport function perspective(out, fovy, aspect, near, far) {\r\n  let f = 1.0 / Math.tan(fovy / 2), nf;\r\n  out[0] = f / aspect;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = f;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[11] = -1;\r\n  out[12] = 0;\r\n  out[13] = 0;\r\n  out[15] = 0;\r\n  if (far != null && far !== Infinity) {\r\n    nf = 1 / (near - far);\r\n    out[10] = (far + near) * nf;\r\n    out[14] = (2 * far * near) * nf;\r\n  } else {\r\n    out[10] = -1;\r\n    out[14] = -2 * near;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a perspective projection matrix with the given field of view.\r\n * This is primarily useful for generating projection matrices to be used\r\n * with the still experiemental WebVR API.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function perspectiveFromFieldOfView(out, fov, near, far) {\r\n  let upTan = Math.tan(fov.upDegrees * Math.PI/180.0);\r\n  let downTan = Math.tan(fov.downDegrees * Math.PI/180.0);\r\n  let leftTan = Math.tan(fov.leftDegrees * Math.PI/180.0);\r\n  let rightTan = Math.tan(fov.rightDegrees * Math.PI/180.0);\r\n  let xScale = 2.0 / (leftTan + rightTan);\r\n  let yScale = 2.0 / (upTan + downTan);\r\n\r\n  out[0] = xScale;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  out[3] = 0.0;\r\n  out[4] = 0.0;\r\n  out[5] = yScale;\r\n  out[6] = 0.0;\r\n  out[7] = 0.0;\r\n  out[8] = -((leftTan - rightTan) * xScale * 0.5);\r\n  out[9] = ((upTan - downTan) * yScale * 0.5);\r\n  out[10] = far / (near - far);\r\n  out[11] = -1.0;\r\n  out[12] = 0.0;\r\n  out[13] = 0.0;\r\n  out[14] = (far * near) / (near - far);\r\n  out[15] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a orthogonal projection matrix with the given bounds\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {number} left Left bound of the frustum\r\n * @param {number} right Right bound of the frustum\r\n * @param {number} bottom Bottom bound of the frustum\r\n * @param {number} top Top bound of the frustum\r\n * @param {number} near Near bound of the frustum\r\n * @param {number} far Far bound of the frustum\r\n * @returns {mat4} out\r\n */\r\nexport function ortho(out, left, right, bottom, top, near, far) {\r\n  let lr = 1 / (left - right);\r\n  let bt = 1 / (bottom - top);\r\n  let nf = 1 / (near - far);\r\n  out[0] = -2 * lr;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 0;\r\n  out[4] = 0;\r\n  out[5] = -2 * bt;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  out[8] = 0;\r\n  out[9] = 0;\r\n  out[10] = 2 * nf;\r\n  out[11] = 0;\r\n  out[12] = (left + right) * lr;\r\n  out[13] = (top + bottom) * bt;\r\n  out[14] = (far + near) * nf;\r\n  out[15] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a look-at matrix with the given eye position, focal point, and up axis.\r\n * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nexport function lookAt(out, eye, center, up) {\r\n  let x0, x1, x2, y0, y1, y2, z0, z1, z2, len;\r\n  let eyex = eye[0];\r\n  let eyey = eye[1];\r\n  let eyez = eye[2];\r\n  let upx = up[0];\r\n  let upy = up[1];\r\n  let upz = up[2];\r\n  let centerx = center[0];\r\n  let centery = center[1];\r\n  let centerz = center[2];\r\n\r\n  if (Math.abs(eyex - centerx) < glMatrix.EPSILON &&\r\n      Math.abs(eyey - centery) < glMatrix.EPSILON &&\r\n      Math.abs(eyez - centerz) < glMatrix.EPSILON) {\r\n    return identity(out);\r\n  }\r\n\r\n  z0 = eyex - centerx;\r\n  z1 = eyey - centery;\r\n  z2 = eyez - centerz;\r\n\r\n  len = 1 / Math.hypot(z0, z1, z2);\r\n  z0 *= len;\r\n  z1 *= len;\r\n  z2 *= len;\r\n\r\n  x0 = upy * z2 - upz * z1;\r\n  x1 = upz * z0 - upx * z2;\r\n  x2 = upx * z1 - upy * z0;\r\n  len = Math.hypot(x0, x1, x2);\r\n  if (!len) {\r\n    x0 = 0;\r\n    x1 = 0;\r\n    x2 = 0;\r\n  } else {\r\n    len = 1 / len;\r\n    x0 *= len;\r\n    x1 *= len;\r\n    x2 *= len;\r\n  }\r\n\r\n  y0 = z1 * x2 - z2 * x1;\r\n  y1 = z2 * x0 - z0 * x2;\r\n  y2 = z0 * x1 - z1 * x0;\r\n\r\n  len = Math.hypot(y0, y1, y2);\r\n  if (!len) {\r\n    y0 = 0;\r\n    y1 = 0;\r\n    y2 = 0;\r\n  } else {\r\n    len = 1 / len;\r\n    y0 *= len;\r\n    y1 *= len;\r\n    y2 *= len;\r\n  }\r\n\r\n  out[0] = x0;\r\n  out[1] = y0;\r\n  out[2] = z0;\r\n  out[3] = 0;\r\n  out[4] = x1;\r\n  out[5] = y1;\r\n  out[6] = z1;\r\n  out[7] = 0;\r\n  out[8] = x2;\r\n  out[9] = y2;\r\n  out[10] = z2;\r\n  out[11] = 0;\r\n  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);\r\n  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);\r\n  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);\r\n  out[15] = 1;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a matrix that makes something look at something else.\r\n *\r\n * @param {mat4} out mat4 frustum matrix will be written into\r\n * @param {vec3} eye Position of the viewer\r\n * @param {vec3} center Point the viewer is looking at\r\n * @param {vec3} up vec3 pointing up\r\n * @returns {mat4} out\r\n */\r\nexport function targetTo(out, eye, target, up) {\r\n  let eyex = eye[0],\r\n      eyey = eye[1],\r\n      eyez = eye[2],\r\n      upx = up[0],\r\n      upy = up[1],\r\n      upz = up[2];\r\n\r\n  let z0 = eyex - target[0],\r\n      z1 = eyey - target[1],\r\n      z2 = eyez - target[2];\r\n\r\n  let len = z0*z0 + z1*z1 + z2*z2;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n    z0 *= len;\r\n    z1 *= len;\r\n    z2 *= len;\r\n  }\r\n\r\n  let x0 = upy * z2 - upz * z1,\r\n      x1 = upz * z0 - upx * z2,\r\n      x2 = upx * z1 - upy * z0;\r\n\r\n  len = x0*x0 + x1*x1 + x2*x2;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n    x0 *= len;\r\n    x1 *= len;\r\n    x2 *= len;\r\n  }\r\n\r\n  out[0] = x0;\r\n  out[1] = x1;\r\n  out[2] = x2;\r\n  out[3] = 0;\r\n  out[4] = z1 * x2 - z2 * x1;\r\n  out[5] = z2 * x0 - z0 * x2;\r\n  out[6] = z0 * x1 - z1 * x0;\r\n  out[7] = 0;\r\n  out[8] = z0;\r\n  out[9] = z1;\r\n  out[10] = z2;\r\n  out[11] = 0;\r\n  out[12] = eyex;\r\n  out[13] = eyey;\r\n  out[14] = eyez;\r\n  out[15] = 1;\r\n  return out;\r\n};\r\n\r\n/**\r\n * Returns a string representation of a mat4\r\n *\r\n * @param {mat4} a matrix to represent as a string\r\n * @returns {String} string representation of the matrix\r\n */\r\nexport function str(a) {\r\n  return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' +\r\n          a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' +\r\n          a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' +\r\n          a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';\r\n}\r\n\r\n/**\r\n * Returns Frobenius norm of a mat4\r\n *\r\n * @param {mat4} a the matrix to calculate Frobenius norm of\r\n * @returns {Number} Frobenius norm\r\n */\r\nexport function frob(a) {\r\n  return(Math.hypot(a[0],a[1],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15]))\r\n}\r\n\r\n/**\r\n * Adds two mat4's\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  out[8] = a[8] + b[8];\r\n  out[9] = a[9] + b[9];\r\n  out[10] = a[10] + b[10];\r\n  out[11] = a[11] + b[11];\r\n  out[12] = a[12] + b[12];\r\n  out[13] = a[13] + b[13];\r\n  out[14] = a[14] + b[14];\r\n  out[15] = a[15] + b[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts matrix b from matrix a\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @returns {mat4} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  out[4] = a[4] - b[4];\r\n  out[5] = a[5] - b[5];\r\n  out[6] = a[6] - b[6];\r\n  out[7] = a[7] - b[7];\r\n  out[8] = a[8] - b[8];\r\n  out[9] = a[9] - b[9];\r\n  out[10] = a[10] - b[10];\r\n  out[11] = a[11] - b[11];\r\n  out[12] = a[12] - b[12];\r\n  out[13] = a[13] - b[13];\r\n  out[14] = a[14] - b[14];\r\n  out[15] = a[15] - b[15];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiply each element of the matrix by a scalar.\r\n *\r\n * @param {mat4} out the receiving matrix\r\n * @param {mat4} a the matrix to scale\r\n * @param {Number} b amount to scale the matrix's elements by\r\n * @returns {mat4} out\r\n */\r\nexport function multiplyScalar(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  out[8] = a[8] * b;\r\n  out[9] = a[9] * b;\r\n  out[10] = a[10] * b;\r\n  out[11] = a[11] * b;\r\n  out[12] = a[12] * b;\r\n  out[13] = a[13] * b;\r\n  out[14] = a[14] * b;\r\n  out[15] = a[15] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two mat4's after multiplying each element of the second operand by a scalar value.\r\n *\r\n * @param {mat4} out the receiving vector\r\n * @param {mat4} a the first operand\r\n * @param {mat4} b the second operand\r\n * @param {Number} scale the amount to scale b's elements by before adding\r\n * @returns {mat4} out\r\n */\r\nexport function multiplyScalarAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  out[2] = a[2] + (b[2] * scale);\r\n  out[3] = a[3] + (b[3] * scale);\r\n  out[4] = a[4] + (b[4] * scale);\r\n  out[5] = a[5] + (b[5] * scale);\r\n  out[6] = a[6] + (b[6] * scale);\r\n  out[7] = a[7] + (b[7] * scale);\r\n  out[8] = a[8] + (b[8] * scale);\r\n  out[9] = a[9] + (b[9] * scale);\r\n  out[10] = a[10] + (b[10] * scale);\r\n  out[11] = a[11] + (b[11] * scale);\r\n  out[12] = a[12] + (b[12] * scale);\r\n  out[13] = a[13] + (b[13] * scale);\r\n  out[14] = a[14] + (b[14] * scale);\r\n  out[15] = a[15] + (b[15] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] &&\r\n         a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] &&\r\n         a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] &&\r\n         a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];\r\n}\r\n\r\n/**\r\n * Returns whether or not the matrices have approximately the same elements in the same position.\r\n *\r\n * @param {mat4} a The first matrix.\r\n * @param {mat4} b The second matrix.\r\n * @returns {Boolean} True if the matrices are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0  = a[0],  a1  = a[1],  a2  = a[2],  a3  = a[3];\r\n  let a4  = a[4],  a5  = a[5],  a6  = a[6],  a7  = a[7];\r\n  let a8  = a[8],  a9  = a[9],  a10 = a[10], a11 = a[11];\r\n  let a12 = a[12], a13 = a[13], a14 = a[14], a15 = a[15];\r\n\r\n  let b0  = b[0],  b1  = b[1],  b2  = b[2],  b3  = b[3];\r\n  let b4  = b[4],  b5  = b[5],  b6  = b[6],  b7  = b[7];\r\n  let b8  = b[8],  b9  = b[9],  b10 = b[10], b11 = b[11];\r\n  let b12 = b[12], b13 = b[13], b14 = b[14], b15 = b[15];\r\n\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n          Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n          Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n          Math.abs(a4 - b4) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n          Math.abs(a5 - b5) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n          Math.abs(a6 - b6) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n          Math.abs(a7 - b7) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a7), Math.abs(b7)) &&\r\n          Math.abs(a8 - b8) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a8), Math.abs(b8)) &&\r\n          Math.abs(a9 - b9) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a9), Math.abs(b9)) &&\r\n          Math.abs(a10 - b10) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a10), Math.abs(b10)) &&\r\n          Math.abs(a11 - b11) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a11), Math.abs(b11)) &&\r\n          Math.abs(a12 - b12) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a12), Math.abs(b12)) &&\r\n          Math.abs(a13 - b13) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a13), Math.abs(b13)) &&\r\n          Math.abs(a14 - b14) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a14), Math.abs(b14)) &&\r\n          Math.abs(a15 - b15) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a15), Math.abs(b15)));\r\n}\r\n\r\n/**\r\n * Alias for {@link mat4.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link mat4.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n","import * as glMatrix from \"./common.js\"\r\nimport * as mat3 from \"./mat3.js\"\r\nimport * as vec3 from \"./vec3.js\"\r\nimport * as vec4 from \"./vec4.js\"\r\n\r\n/**\r\n * Quaternion\r\n * @module quat\r\n */\r\n\r\n/**\r\n * Creates a new identity quat\r\n *\r\n * @returns {quat} a new quaternion\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a quat to the identity quaternion\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 0;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Sets a quat from the given angle and rotation axis,\r\n * then returns it.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {vec3} axis the axis around which to rotate\r\n * @param {Number} rad the angle in radians\r\n * @returns {quat} out\r\n **/\r\nexport function setAxisAngle(out, axis, rad) {\r\n  rad = rad * 0.5;\r\n  let s = Math.sin(rad);\r\n  out[0] = s * axis[0];\r\n  out[1] = s * axis[1];\r\n  out[2] = s * axis[2];\r\n  out[3] = Math.cos(rad);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Gets the rotation axis and angle for a given\r\n *  quaternion. If a quaternion is created with\r\n *  setAxisAngle, this method will return the same\r\n *  values as providied in the original parameter list\r\n *  OR functionally equivalent values.\r\n * Example: The quaternion formed by axis [0, 0, 1] and\r\n *  angle -90 is the same as the quaternion formed by\r\n *  [0, 0, 1] and 270. This method favors the latter.\r\n * @param  {vec3} out_axis  Vector receiving the axis of rotation\r\n * @param  {quat} q     Quaternion to be decomposed\r\n * @return {Number}     Angle, in radians, of the rotation\r\n */\r\nexport function getAxisAngle(out_axis, q) {\r\n  let rad = Math.acos(q[3]) * 2.0;\r\n  let s = Math.sin(rad / 2.0);\r\n  if (s > glMatrix.EPSILON) {\r\n    out_axis[0] = q[0] / s;\r\n    out_axis[1] = q[1] / s;\r\n    out_axis[2] = q[2] / s;\r\n  } else {\r\n    // If s is zero, return any axis (no rotation - axis does not matter)\r\n    out_axis[0] = 1;\r\n    out_axis[1] = 0;\r\n    out_axis[2] = 0;\r\n  }\r\n  return rad;\r\n}\r\n\r\n/**\r\n * Gets the angular distance between two unit quaternions\r\n *\r\n * @param  {quat} a     Origin unit quaternion \r\n * @param  {quat} b     Destination unit quaternion\r\n * @return {Number}     Angle, in radians, between the two quaternions\r\n */\r\nexport function getAngle(a, b) {\r\n  let dotproduct = dot(a, b);\r\n  \r\n  return Math.acos(2 * dotproduct*dotproduct - 1);\r\n}\r\n\r\n/**\r\n * Multiplies two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\r\n  let bx = b[0], by = b[1], bz = b[2], bw = b[3];\r\n\r\n  out[0] = ax * bw + aw * bx + ay * bz - az * by;\r\n  out[1] = ay * bw + aw * by + az * bx - ax * bz;\r\n  out[2] = az * bw + aw * bz + ax * by - ay * bx;\r\n  out[3] = aw * bw - ax * bx - ay * by - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the X axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\r\n  let bx = Math.sin(rad), bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw + aw * bx;\r\n  out[1] = ay * bw + az * bx;\r\n  out[2] = az * bw - ay * bx;\r\n  out[3] = aw * bw - ax * bx;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Y axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\r\n  let by = Math.sin(rad), bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw - az * by;\r\n  out[1] = ay * bw + aw * by;\r\n  out[2] = az * bw + ax * by;\r\n  out[3] = aw * bw - ay * by;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a quaternion by the given angle about the Z axis\r\n *\r\n * @param {quat} out quat receiving operation result\r\n * @param {quat} a quat to rotate\r\n * @param {number} rad angle (in radians) to rotate\r\n * @returns {quat} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  rad *= 0.5;\r\n\r\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\r\n  let bz = Math.sin(rad), bw = Math.cos(rad);\r\n\r\n  out[0] = ax * bw + ay * bz;\r\n  out[1] = ay * bw - ax * bz;\r\n  out[2] = az * bw + aw * bz;\r\n  out[3] = aw * bw - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the W component of a quat from the X, Y, and Z components.\r\n * Assumes that quaternion is 1 unit in length.\r\n * Any existing W component will be ignored.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate W component of\r\n * @returns {quat} out\r\n */\r\nexport function calculateW(out, a) {\r\n  let x = a[0], y = a[1], z = a[2];\r\n\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the exponential of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\r\nexport function exp(out, a) {\r\n  let x = a[0], y = a[1], z = a[2], w = a[3];\r\n\r\n  let r = Math.sqrt(x*x + y*y + z*z);\r\n  let et = Math.exp(w);\r\n  let s = r > 0 ? et * Math.sin(r) / r : 0;\r\n\r\n  out[0] = x * s;\r\n  out[1] = y * s;\r\n  out[2] = z * s;\r\n  out[3] = et * Math.cos(r);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the natural logarithm of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate the exponential of\r\n * @returns {quat} out\r\n */\r\nexport function ln(out, a) {\r\n  let x = a[0], y = a[1], z = a[2], w = a[3];\r\n\r\n  let r = Math.sqrt(x*x + y*y + z*z);\r\n  let t = r > 0 ? Math.atan2(r, w) / r : 0;\r\n\r\n  out[0] = x * t;\r\n  out[1] = y * t;\r\n  out[2] = z * t;\r\n  out[3] = 0.5 * Math.log(x*x + y*y + z*z + w*w);\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculate the scalar power of a unit quaternion.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate the exponential of\r\n * @param {Number} b amount to scale the quaternion by\r\n * @returns {quat} out\r\n */\r\nexport function pow(out, a, b) {\r\n  ln(out, a);\r\n  scale(out, out, b);\r\n  exp(out, out);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a spherical linear interpolation between two quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\r\nexport function slerp(out, a, b, t) {\r\n  // benchmarks:\r\n  //    http://jsperf.com/quaternion-slerp-implementations\r\n  let ax = a[0], ay = a[1], az = a[2], aw = a[3];\r\n  let bx = b[0], by = b[1], bz = b[2], bw = b[3];\r\n\r\n  let omega, cosom, sinom, scale0, scale1;\r\n\r\n  // calc cosine\r\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\r\n  // adjust signs (if necessary)\r\n  if ( cosom < 0.0 ) {\r\n    cosom = -cosom;\r\n    bx = - bx;\r\n    by = - by;\r\n    bz = - bz;\r\n    bw = - bw;\r\n  }\r\n  // calculate coefficients\r\n  if ( (1.0 - cosom) > glMatrix.EPSILON ) {\r\n    // standard case (slerp)\r\n    omega  = Math.acos(cosom);\r\n    sinom  = Math.sin(omega);\r\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\r\n    scale1 = Math.sin(t * omega) / sinom;\r\n  } else {\r\n    // \"from\" and \"to\" quaternions are very close\r\n    //  ... so we can do a linear interpolation\r\n    scale0 = 1.0 - t;\r\n    scale1 = t;\r\n  }\r\n  // calculate final values\r\n  out[0] = scale0 * ax + scale1 * bx;\r\n  out[1] = scale0 * ay + scale1 * by;\r\n  out[2] = scale0 * az + scale1 * bz;\r\n  out[3] = scale0 * aw + scale1 * bw;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random unit quaternion\r\n * \r\n * @param {quat} out the receiving quaternion\r\n * @returns {quat} out\r\n */\r\nexport function random(out) {\r\n  // Implementation of http://planning.cs.uiuc.edu/node198.html\r\n  // TODO: Calling random 3 times is probably not the fastest solution\r\n  let u1 = glMatrix.RANDOM();\r\n  let u2 = glMatrix.RANDOM();\r\n  let u3 = glMatrix.RANDOM();\r\n\r\n  let sqrt1MinusU1 = Math.sqrt(1 - u1);\r\n  let sqrtU1 = Math.sqrt(u1);\r\n\r\n  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);\r\n  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);\r\n  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);\r\n  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the inverse of a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate inverse of\r\n * @returns {quat} out\r\n */\r\nexport function invert(out, a) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n  let dot = a0*a0 + a1*a1 + a2*a2 + a3*a3;\r\n  let invDot = dot ? 1.0/dot : 0;\r\n\r\n  // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0\r\n\r\n  out[0] = -a0*invDot;\r\n  out[1] = -a1*invDot;\r\n  out[2] = -a2*invDot;\r\n  out[3] = a3*invDot;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the conjugate of a quat\r\n * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quat to calculate conjugate of\r\n * @returns {quat} out\r\n */\r\nexport function conjugate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a quaternion from the given 3x3 rotation matrix.\r\n *\r\n * NOTE: The resultant quaternion is not normalized, so you should be sure\r\n * to renormalize the quaternion yourself where necessary.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {mat3} m rotation matrix\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport function fromMat3(out, m) {\r\n  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes\r\n  // article \"Quaternion Calculus and Fast Animation\".\r\n  let fTrace = m[0] + m[4] + m[8];\r\n  let fRoot;\r\n\r\n  if ( fTrace > 0.0 ) {\r\n    // |w| > 1/2, may as well choose w > 1/2\r\n    fRoot = Math.sqrt(fTrace + 1.0);  // 2w\r\n    out[3] = 0.5 * fRoot;\r\n    fRoot = 0.5/fRoot;  // 1/(4w)\r\n    out[0] = (m[5]-m[7])*fRoot;\r\n    out[1] = (m[6]-m[2])*fRoot;\r\n    out[2] = (m[1]-m[3])*fRoot;\r\n  } else {\r\n    // |w| <= 1/2\r\n    let i = 0;\r\n    if ( m[4] > m[0] )\r\n      i = 1;\r\n    if ( m[8] > m[i*3+i] )\r\n      i = 2;\r\n    let j = (i+1)%3;\r\n    let k = (i+2)%3;\r\n\r\n    fRoot = Math.sqrt(m[i*3+i]-m[j*3+j]-m[k*3+k] + 1.0);\r\n    out[i] = 0.5 * fRoot;\r\n    fRoot = 0.5 / fRoot;\r\n    out[3] = (m[j*3+k] - m[k*3+j]) * fRoot;\r\n    out[j] = (m[j*3+i] + m[i*3+j]) * fRoot;\r\n    out[k] = (m[k*3+i] + m[i*3+k]) * fRoot;\r\n  }\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a quaternion from the given euler angle x, y, z.\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {x} Angle to rotate around X axis in degrees.\r\n * @param {y} Angle to rotate around Y axis in degrees.\r\n * @param {z} Angle to rotate around Z axis in degrees.\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport function fromEuler(out, x, y, z) {\r\n    let halfToRad = 0.5 * Math.PI / 180.0;\r\n    x *= halfToRad;\r\n    y *= halfToRad;\r\n    z *= halfToRad;\r\n\r\n    let sx = Math.sin(x);\r\n    let cx = Math.cos(x);\r\n    let sy = Math.sin(y);\r\n    let cy = Math.cos(y);\r\n    let sz = Math.sin(z);\r\n    let cz = Math.cos(z);\r\n\r\n    out[0] = sx * cy * cz - cx * sy * sz;\r\n    out[1] = cx * sy * cz + sx * cy * sz;\r\n    out[2] = cx * cy * sz - sx * sy * cz;\r\n    out[3] = cx * cy * cz + sx * sy * sz;\r\n\r\n    return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a quatenion\r\n *\r\n * @param {quat} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n}\r\n\r\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat} a quaternion to clone\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nexport const clone = vec4.clone;\r\n\r\n/**\r\n * Creates a new quat initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} a new quaternion\r\n * @function\r\n */\r\nexport const fromValues = vec4.fromValues;\r\n\r\n/**\r\n * Copy the values from one quat to another\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the source quaternion\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const copy = vec4.copy;\r\n\r\n/**\r\n * Set the components of a quat to the given values\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const set = vec4.set;\r\n\r\n/**\r\n * Adds two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const add = vec4.add;\r\n\r\n/**\r\n * Alias for {@link quat.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Scales a quat by a scalar number\r\n *\r\n * @param {quat} out the receiving vector\r\n * @param {quat} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const scale = vec4.scale;\r\n\r\n/**\r\n * Calculates the dot product of two quat's\r\n *\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\r\nexport const dot = vec4.dot;\r\n\r\n/**\r\n * Performs a linear interpolation between two quat's\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const lerp = vec4.lerp;\r\n\r\n/**\r\n * Calculates the length of a quat\r\n *\r\n * @param {quat} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport const length = vec4.length;\r\n\r\n/**\r\n * Alias for {@link quat.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Calculates the squared length of a quat\r\n *\r\n * @param {quat} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\r\nexport const squaredLength = vec4.squaredLength;\r\n\r\n/**\r\n * Alias for {@link quat.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Normalize a quat\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a quaternion to normalize\r\n * @returns {quat} out\r\n * @function\r\n */\r\nexport const normalize = vec4.normalize;\r\n\r\n/**\r\n * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {quat} a The first quaternion.\r\n * @param {quat} b The second quaternion.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport const exactEquals = vec4.exactEquals;\r\n\r\n/**\r\n * Returns whether or not the quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {quat} a The first vector.\r\n * @param {quat} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport const equals = vec4.equals;\r\n\r\n/**\r\n * Sets a quaternion to represent the shortest rotation from one\r\n * vector to another.\r\n *\r\n * Both vectors are assumed to be unit length.\r\n *\r\n * @param {quat} out the receiving quaternion.\r\n * @param {vec3} a the initial vector\r\n * @param {vec3} b the destination vector\r\n * @returns {quat} out\r\n */\r\nexport const rotationTo = (function() {\r\n  let tmpvec3 = vec3.create();\r\n  let xUnitVec3 = vec3.fromValues(1,0,0);\r\n  let yUnitVec3 = vec3.fromValues(0,1,0);\r\n\r\n  return function(out, a, b) {\r\n    let dot = vec3.dot(a, b);\r\n    if (dot < -0.999999) {\r\n      vec3.cross(tmpvec3, xUnitVec3, a);\r\n      if (vec3.len(tmpvec3) < 0.000001)\r\n        vec3.cross(tmpvec3, yUnitVec3, a);\r\n      vec3.normalize(tmpvec3, tmpvec3);\r\n      setAxisAngle(out, tmpvec3, Math.PI);\r\n      return out;\r\n    } else if (dot > 0.999999) {\r\n      out[0] = 0;\r\n      out[1] = 0;\r\n      out[2] = 0;\r\n      out[3] = 1;\r\n      return out;\r\n    } else {\r\n      vec3.cross(tmpvec3, a, b);\r\n      out[0] = tmpvec3[0];\r\n      out[1] = tmpvec3[1];\r\n      out[2] = tmpvec3[2];\r\n      out[3] = 1 + dot;\r\n      return normalize(out, out);\r\n    }\r\n  };\r\n})();\r\n\r\n/**\r\n * Performs a spherical linear interpolation with two control points\r\n *\r\n * @param {quat} out the receiving quaternion\r\n * @param {quat} a the first operand\r\n * @param {quat} b the second operand\r\n * @param {quat} c the third operand\r\n * @param {quat} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat} out\r\n */\r\nexport const sqlerp = (function () {\r\n  let temp1 = create();\r\n  let temp2 = create();\r\n\r\n  return function (out, a, b, c, d, t) {\r\n    slerp(temp1, a, d, t);\r\n    slerp(temp2, b, c, t);\r\n    slerp(out, temp1, temp2, 2 * t * (1 - t));\r\n\r\n    return out;\r\n  };\r\n}());\r\n\r\n/**\r\n * Sets the specified quaternion with values corresponding to the given\r\n * axes. Each axis is a vec3 and is expected to be unit length and\r\n * perpendicular to all other specified axes.\r\n *\r\n * @param {vec3} view  the vector representing the viewing direction\r\n * @param {vec3} right the vector representing the local \"right\" direction\r\n * @param {vec3} up    the vector representing the local \"up\" direction\r\n * @returns {quat} out\r\n */\r\nexport const setAxes = (function() {\r\n  let matr = mat3.create();\r\n\r\n  return function(out, view, right, up) {\r\n    matr[0] = right[0];\r\n    matr[3] = right[1];\r\n    matr[6] = right[2];\r\n\r\n    matr[1] = up[0];\r\n    matr[4] = up[1];\r\n    matr[7] = up[2];\r\n\r\n    matr[2] = -view[0];\r\n    matr[5] = -view[1];\r\n    matr[8] = -view[2];\r\n\r\n    return normalize(out, fromMat3(out, matr));\r\n  };\r\n})();\r\n","import * as glMatrix from \"./common.js\";\r\nimport * as quat from \"./quat.js\";\r\nimport * as mat4 from \"./mat4.js\";\r\n\r\n/**\r\n * Dual Quaternion<br>\r\n * Format: [real, dual]<br>\r\n * Quaternion format: XYZW<br>\r\n * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>\r\n * @module quat2\r\n */\r\n\r\n\r\n/**\r\n * Creates a new identity dual quat\r\n *\r\n * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]\r\n */\r\nexport function create() {\r\n  let dq = new glMatrix.ARRAY_TYPE(8);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    dq[0] = 0;\r\n    dq[1] = 0;\r\n    dq[2] = 0;\r\n    dq[4] = 0;\r\n    dq[5] = 0;\r\n    dq[6] = 0;\r\n    dq[7] = 0;\r\n  }\r\n  dq[3] = 1;\r\n  return dq;\r\n}\r\n\r\n/**\r\n * Creates a new quat initialized with values from an existing quaternion\r\n *\r\n * @param {quat2} a dual quaternion to clone\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\r\nexport function clone(a) {\r\n  let dq = new glMatrix.ARRAY_TYPE(8);\r\n  dq[0] = a[0];\r\n  dq[1] = a[1];\r\n  dq[2] = a[2];\r\n  dq[3] = a[3];\r\n  dq[4] = a[4];\r\n  dq[5] = a[5];\r\n  dq[6] = a[6];\r\n  dq[7] = a[7];\r\n  return dq;\r\n}\r\n\r\n/**\r\n * Creates a new dual quat initialized with the given values\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\r\nexport function fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {\r\n  let dq = new glMatrix.ARRAY_TYPE(8);\r\n  dq[0] = x1;\r\n  dq[1] = y1;\r\n  dq[2] = z1;\r\n  dq[3] = w1;\r\n  dq[4] = x2;\r\n  dq[5] = y2;\r\n  dq[6] = z2;\r\n  dq[7] = w2;\r\n  return dq;\r\n}\r\n\r\n/**\r\n * Creates a new dual quat from the given values (quat and translation)\r\n *\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component (translation)\r\n * @param {Number} y2 Y component (translation)\r\n * @param {Number} z2 Z component (translation)\r\n * @returns {quat2} new dual quaternion\r\n * @function\r\n */\r\nexport function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {\r\n  let dq = new glMatrix.ARRAY_TYPE(8);\r\n  dq[0] = x1;\r\n  dq[1] = y1;\r\n  dq[2] = z1;\r\n  dq[3] = w1;\r\n  let ax = x2 * 0.5,\r\n    ay = y2 * 0.5,\r\n    az = z2 * 0.5;\r\n  dq[4] = ax * w1 + ay * z1 - az * y1;\r\n  dq[5] = ay * w1 + az * x1 - ax * z1;\r\n  dq[6] = az * w1 + ax * y1 - ay * x1;\r\n  dq[7] = -ax * x1 - ay * y1 - az * z1;\r\n  return dq;\r\n}\r\n\r\n/**\r\n * Creates a dual quat from a quaternion and a translation\r\n *\r\n * @param {quat2} dual quaternion receiving operation result\r\n * @param {quat} q a normalized quaternion\r\n * @param {vec3} t tranlation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\r\nexport function fromRotationTranslation(out, q, t) {\r\n  let ax = t[0] * 0.5,\r\n    ay = t[1] * 0.5,\r\n    az = t[2] * 0.5,\r\n    bx = q[0],\r\n    by = q[1],\r\n    bz = q[2],\r\n    bw = q[3];\r\n  out[0] = bx;\r\n  out[1] = by;\r\n  out[2] = bz;\r\n  out[3] = bw;\r\n  out[4] = ax * bw + ay * bz - az * by;\r\n  out[5] = ay * bw + az * bx - ax * bz;\r\n  out[6] = az * bw + ax * by - ay * bx;\r\n  out[7] = -ax * bx - ay * by - az * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a dual quat from a translation\r\n *\r\n * @param {quat2} dual quaternion receiving operation result\r\n * @param {vec3} t translation vector\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\r\nexport function fromTranslation(out, t) {\r\n  out[0] = 0;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  out[4] = t[0] * 0.5;\r\n  out[5] = t[1] * 0.5;\r\n  out[6] = t[2] * 0.5;\r\n  out[7] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a dual quat from a quaternion\r\n *\r\n * @param {quat2} dual quaternion receiving operation result\r\n * @param {quat} q the quaternion\r\n * @returns {quat2} dual quaternion receiving operation result\r\n * @function\r\n */\r\nexport function fromRotation(out, q) {\r\n  out[0] = q[0];\r\n  out[1] = q[1];\r\n  out[2] = q[2];\r\n  out[3] = q[3];\r\n  out[4] = 0;\r\n  out[5] = 0;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new dual quat from a matrix (4x4)\r\n *\r\n * @param {quat2} out the dual quaternion\r\n * @param {mat4} a the matrix\r\n * @returns {quat2} dual quat receiving operation result\r\n * @function\r\n */\r\nexport function fromMat4(out, a) {\r\n  //TODO Optimize this\r\n  let outer = quat.create();\r\n  mat4.getRotation(outer, a);\r\n  let t = new glMatrix.ARRAY_TYPE(3);\r\n  mat4.getTranslation(t, a);\r\n  fromRotationTranslation(out, outer, t);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one dual quat to another\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the source dual quaternion\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  out[4] = a[4];\r\n  out[5] = a[5];\r\n  out[6] = a[6];\r\n  out[7] = a[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set a dual quat to the identity dual quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @returns {quat2} out\r\n */\r\nexport function identity(out) {\r\n  out[0] = 0;\r\n  out[1] = 0;\r\n  out[2] = 0;\r\n  out[3] = 1;\r\n  out[4] = 0;\r\n  out[5] = 0;\r\n  out[6] = 0;\r\n  out[7] = 0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a dual quat to the given values\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {Number} x1 X component\r\n * @param {Number} y1 Y component\r\n * @param {Number} z1 Z component\r\n * @param {Number} w1 W component\r\n * @param {Number} x2 X component\r\n * @param {Number} y2 Y component\r\n * @param {Number} z2 Z component\r\n * @param {Number} w2 W component\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport function set(out, x1, y1, z1, w1, x2, y2, z2, w2) {\r\n  out[0] = x1;\r\n  out[1] = y1;\r\n  out[2] = z1;\r\n  out[3] = w1;\r\n\r\n  out[4] = x2;\r\n  out[5] = y2;\r\n  out[6] = z2;\r\n  out[7] = w2;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Gets the real part of a dual quat\r\n * @param  {quat} out real part\r\n * @param  {quat2} a Dual Quaternion\r\n * @return {quat} real part\r\n */\r\nexport const getReal = quat.copy;\r\n\r\n/**\r\n * Gets the dual part of a dual quat\r\n * @param  {quat} out dual part\r\n * @param  {quat2} a Dual Quaternion\r\n * @return {quat} dual part\r\n */\r\nexport function getDual(out, a) {\r\n  out[0] = a[4];\r\n  out[1] = a[5];\r\n  out[2] = a[6];\r\n  out[3] = a[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the real component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {quat} q a quaternion representing the real part\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport const setReal = quat.copy;\r\n\r\n/**\r\n * Set the dual component of a dual quat to the given quaternion\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {quat} q a quaternion representing the dual part\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport function setDual(out, q) {\r\n  out[4] = q[0];\r\n  out[5] = q[1];\r\n  out[6] = q[2];\r\n  out[7] = q[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Gets the translation of a normalized dual quat\r\n * @param  {vec3} out translation\r\n * @param  {quat2} a Dual Quaternion to be decomposed\r\n * @return {vec3} translation\r\n */\r\nexport function getTranslation(out, a) {\r\n  let ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7],\r\n    bx = -a[0],\r\n    by = -a[1],\r\n    bz = -a[2],\r\n    bw = a[3];\r\n  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;\r\n  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;\r\n  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Translates a dual quat by the given vector\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to translate\r\n * @param {vec3} v vector to translate by\r\n * @returns {quat2} out\r\n */\r\nexport function translate(out, a, v) {\r\n  let ax1 = a[0],\r\n    ay1 = a[1],\r\n    az1 = a[2],\r\n    aw1 = a[3],\r\n    bx1 = v[0] * 0.5,\r\n    by1 = v[1] * 0.5,\r\n    bz1 = v[2] * 0.5,\r\n    ax2 = a[4],\r\n    ay2 = a[5],\r\n    az2 = a[6],\r\n    aw2 = a[7];\r\n  out[0] = ax1;\r\n  out[1] = ay1;\r\n  out[2] = az1;\r\n  out[3] = aw1;\r\n  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;\r\n  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;\r\n  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;\r\n  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a dual quat around the X axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\r\nexport function rotateX(out, a, rad) {\r\n  let bx = -a[0],\r\n    by = -a[1],\r\n    bz = -a[2],\r\n    bw = a[3],\r\n    ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7],\r\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\r\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\r\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\r\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\r\n  quat.rotateX(out, a, rad);\r\n  bx = out[0];\r\n  by = out[1];\r\n  bz = out[2];\r\n  bw = out[3];\r\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\r\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\r\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\r\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a dual quat around the Y axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\r\nexport function rotateY(out, a, rad) {\r\n  let bx = -a[0],\r\n    by = -a[1],\r\n    bz = -a[2],\r\n    bw = a[3],\r\n    ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7],\r\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\r\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\r\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\r\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\r\n  quat.rotateY(out, a, rad);\r\n  bx = out[0];\r\n  by = out[1];\r\n  bz = out[2];\r\n  bw = out[3];\r\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\r\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\r\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\r\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a dual quat around the Z axis\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {number} rad how far should the rotation be\r\n * @returns {quat2} out\r\n */\r\nexport function rotateZ(out, a, rad) {\r\n  let bx = -a[0],\r\n    by = -a[1],\r\n    bz = -a[2],\r\n    bw = a[3],\r\n    ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7],\r\n    ax1 = ax * bw + aw * bx + ay * bz - az * by,\r\n    ay1 = ay * bw + aw * by + az * bx - ax * bz,\r\n    az1 = az * bw + aw * bz + ax * by - ay * bx,\r\n    aw1 = aw * bw - ax * bx - ay * by - az * bz;\r\n  quat.rotateZ(out, a, rad);\r\n  bx = out[0];\r\n  by = out[1];\r\n  bz = out[2];\r\n  bw = out[3];\r\n  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\r\n  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\r\n  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\r\n  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a dual quat by a given quaternion (a * q)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {quat} q quaternion to rotate by\r\n * @returns {quat2} out\r\n */\r\nexport function rotateByQuatAppend(out, a, q) {\r\n  let qx = q[0],\r\n    qy = q[1],\r\n    qz = q[2],\r\n    qw = q[3],\r\n    ax = a[0],\r\n    ay = a[1],\r\n    az = a[2],\r\n    aw = a[3];\r\n\r\n  out[0] = ax * qw + aw * qx + ay * qz - az * qy;\r\n  out[1] = ay * qw + aw * qy + az * qx - ax * qz;\r\n  out[2] = az * qw + aw * qz + ax * qy - ay * qx;\r\n  out[3] = aw * qw - ax * qx - ay * qy - az * qz;\r\n  ax = a[4];\r\n  ay = a[5];\r\n  az = a[6];\r\n  aw = a[7];\r\n  out[4] = ax * qw + aw * qx + ay * qz - az * qy;\r\n  out[5] = ay * qw + aw * qy + az * qx - ax * qz;\r\n  out[6] = az * qw + aw * qz + ax * qy - ay * qx;\r\n  out[7] = aw * qw - ax * qx - ay * qy - az * qz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a dual quat by a given quaternion (q * a)\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat} q quaternion to rotate by\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @returns {quat2} out\r\n */\r\nexport function rotateByQuatPrepend(out, q, a) {\r\n  let qx = q[0],\r\n    qy = q[1],\r\n    qz = q[2],\r\n    qw = q[3],\r\n    bx = a[0],\r\n    by = a[1],\r\n    bz = a[2],\r\n    bw = a[3];\r\n\r\n  out[0] = qx * bw + qw * bx + qy * bz - qz * by;\r\n  out[1] = qy * bw + qw * by + qz * bx - qx * bz;\r\n  out[2] = qz * bw + qw * bz + qx * by - qy * bx;\r\n  out[3] = qw * bw - qx * bx - qy * by - qz * bz;\r\n  bx = a[4];\r\n  by = a[5];\r\n  bz = a[6];\r\n  bw = a[7];\r\n  out[4] = qx * bw + qw * bx + qy * bz - qz * by;\r\n  out[5] = qy * bw + qw * by + qz * bx - qx * bz;\r\n  out[6] = qz * bw + qw * bz + qx * by - qy * bx;\r\n  out[7] = qw * bw - qx * bx - qy * by - qz * bz;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotates a dual quat around a given axis. Does the normalisation automatically\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the dual quaternion to rotate\r\n * @param {vec3} axis the axis to rotate around\r\n * @param {Number} rad how far the rotation should be\r\n * @returns {quat2} out\r\n */\r\nexport function rotateAroundAxis(out, a, axis, rad) {\r\n  //Special case for rad = 0\r\n  if (Math.abs(rad) < glMatrix.EPSILON) {\r\n    return copy(out, a);\r\n  }\r\n  let axisLength = Math.hypot(axis[0],axis[1],axis[2]);\r\n\r\n  rad = rad * 0.5;\r\n  let s = Math.sin(rad);\r\n  let bx = s * axis[0] / axisLength;\r\n  let by = s * axis[1] / axisLength;\r\n  let bz = s * axis[2] / axisLength;\r\n  let bw = Math.cos(rad);\r\n\r\n  let ax1 = a[0],\r\n    ay1 = a[1],\r\n    az1 = a[2],\r\n    aw1 = a[3];\r\n  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;\r\n  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;\r\n  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;\r\n  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;\r\n\r\n  let ax = a[4],\r\n    ay = a[5],\r\n    az = a[6],\r\n    aw = a[7];\r\n  out[4] = ax * bw + aw * bx + ay * bz - az * by;\r\n  out[5] = ay * bw + aw * by + az * bx - ax * bz;\r\n  out[6] = az * bw + aw * bz + ax * by - ay * bx;\r\n  out[7] = aw * bw - ax * bx - ay * by - az * bz;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  out[4] = a[4] + b[4];\r\n  out[5] = a[5] + b[5];\r\n  out[6] = a[6] + b[6];\r\n  out[7] = a[7] + b[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two dual quat's\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @returns {quat2} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  let ax0 = a[0],\r\n    ay0 = a[1],\r\n    az0 = a[2],\r\n    aw0 = a[3],\r\n    bx1 = b[4],\r\n    by1 = b[5],\r\n    bz1 = b[6],\r\n    bw1 = b[7],\r\n    ax1 = a[4],\r\n    ay1 = a[5],\r\n    az1 = a[6],\r\n    aw1 = a[7],\r\n    bx0 = b[0],\r\n    by0 = b[1],\r\n    bz0 = b[2],\r\n    bw0 = b[3];\r\n  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;\r\n  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;\r\n  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;\r\n  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;\r\n  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;\r\n  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;\r\n  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;\r\n  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Alias for {@link quat2.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Scales a dual quat by a scalar number\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {quat2} a the dual quat to scale\r\n * @param {Number} b amount to scale the dual quat by\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  out[4] = a[4] * b;\r\n  out[5] = a[5] * b;\r\n  out[6] = a[6] * b;\r\n  out[7] = a[7] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two dual quat's (The dot product of the real parts)\r\n *\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n * @function\r\n */\r\nexport const dot = quat.dot;\r\n\r\n/**\r\n * Performs a linear interpolation between two dual quats's\r\n * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)\r\n *\r\n * @param {quat2} out the receiving dual quat\r\n * @param {quat2} a the first operand\r\n * @param {quat2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {quat2} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let mt = 1 - t;\r\n  if (dot(a, b) < 0) t = -t;\r\n\r\n  out[0] = a[0] * mt + b[0] * t;\r\n  out[1] = a[1] * mt + b[1] * t;\r\n  out[2] = a[2] * mt + b[2] * t;\r\n  out[3] = a[3] * mt + b[3] * t;\r\n  out[4] = a[4] * mt + b[4] * t;\r\n  out[5] = a[5] * mt + b[5] * t;\r\n  out[6] = a[6] * mt + b[6] * t;\r\n  out[7] = a[7] * mt + b[7] * t;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a dual quat to calculate inverse of\r\n * @returns {quat2} out\r\n */\r\nexport function invert(out, a) {\r\n  let sqlen = squaredLength(a);\r\n  out[0] = -a[0] / sqlen;\r\n  out[1] = -a[1] / sqlen;\r\n  out[2] = -a[2] / sqlen;\r\n  out[3] = a[3] / sqlen;\r\n  out[4] = -a[4] / sqlen;\r\n  out[5] = -a[5] / sqlen;\r\n  out[6] = -a[6] / sqlen;\r\n  out[7] = a[7] / sqlen;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the conjugate of a dual quat\r\n * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.\r\n *\r\n * @param {quat2} out the receiving quaternion\r\n * @param {quat2} a quat to calculate conjugate of\r\n * @returns {quat2} out\r\n */\r\nexport function conjugate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = a[3];\r\n  out[4] = -a[4];\r\n  out[5] = -a[5];\r\n  out[6] = -a[6];\r\n  out[7] = a[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the length of a dual quat\r\n *\r\n * @param {quat2} a dual quat to calculate length of\r\n * @returns {Number} length of a\r\n * @function\r\n */\r\nexport const length = quat.length;\r\n\r\n/**\r\n * Alias for {@link quat2.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Calculates the squared length of a dual quat\r\n *\r\n * @param {quat2} a dual quat to calculate squared length of\r\n * @returns {Number} squared length of a\r\n * @function\r\n */\r\nexport const squaredLength = quat.squaredLength;\r\n\r\n/**\r\n * Alias for {@link quat2.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Normalize a dual quat\r\n *\r\n * @param {quat2} out the receiving dual quaternion\r\n * @param {quat2} a dual quaternion to normalize\r\n * @returns {quat2} out\r\n * @function\r\n */\r\nexport function normalize(out, a) {\r\n  let magnitude = squaredLength(a);\r\n  if (magnitude > 0) {\r\n    magnitude = Math.sqrt(magnitude);\r\n\r\n    let a0 = a[0] / magnitude;\r\n    let a1 = a[1] / magnitude;\r\n    let a2 = a[2] / magnitude;\r\n    let a3 = a[3] / magnitude;\r\n\r\n    let b0 = a[4];\r\n    let b1 = a[5];\r\n    let b2 = a[6];\r\n    let b3 = a[7];\r\n\r\n    let a_dot_b = (a0 * b0) + (a1 * b1) + (a2 * b2) + (a3 * b3);\r\n\r\n    out[0] = a0;\r\n    out[1] = a1;\r\n    out[2] = a2;\r\n    out[3] = a3;\r\n\r\n    out[4] = (b0 - (a0 * a_dot_b)) / magnitude;\r\n    out[5] = (b1 - (a1 * a_dot_b)) / magnitude;\r\n    out[6] = (b2 - (a2 * a_dot_b)) / magnitude;\r\n    out[7] = (b3 - (a3 * a_dot_b)) / magnitude;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a dual quatenion\r\n *\r\n * @param {quat2} a dual quaternion to represent as a string\r\n * @returns {String} string representation of the dual quat\r\n */\r\nexport function str(a) {\r\n  return 'quat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' +\r\n    a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ')';\r\n}\r\n\r\n/**\r\n * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {quat2} a the first dual quaternion.\r\n * @param {quat2} b the second dual quaternion.\r\n * @returns {Boolean} true if the dual quaternions are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] &&\r\n    a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];\r\n}\r\n\r\n/**\r\n * Returns whether or not the dual quaternions have approximately the same elements in the same position.\r\n *\r\n * @param {quat2} a the first dual quat.\r\n * @param {quat2} b the second dual quat.\r\n * @returns {Boolean} true if the dual quats are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0],\r\n    a1 = a[1],\r\n    a2 = a[2],\r\n    a3 = a[3],\r\n    a4 = a[4],\r\n    a5 = a[5],\r\n    a6 = a[6],\r\n    a7 = a[7];\r\n  let b0 = b[0],\r\n    b1 = b[1],\r\n    b2 = b[2],\r\n    b3 = b[3],\r\n    b4 = b[4],\r\n    b5 = b[5],\r\n    b6 = b[6],\r\n    b7 = b[7];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n    Math.abs(a1 - b1) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n    Math.abs(a2 - b2) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n    Math.abs(a3 - b3) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) &&\r\n    Math.abs(a4 - b4) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) &&\r\n    Math.abs(a5 - b5) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) &&\r\n    Math.abs(a6 - b6) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) &&\r\n    Math.abs(a7 - b7) <= glMatrix.EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)));\r\n}\r\n","import * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 2 Dimensional Vector\r\n * @module vec2\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec2\r\n *\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec2 initialized with values from an existing vector\r\n *\r\n * @param {vec2} a vector to clone\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec2 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} a new 2D vector\r\n */\r\nexport function fromValues(x, y) {\r\n  let out = new glMatrix.ARRAY_TYPE(2);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec2 to another\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the source vector\r\n * @returns {vec2} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec2 to the given values\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @returns {vec2} out\r\n */\r\nexport function set(out, x, y) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to ceil\r\n * @returns {vec2} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to floor\r\n * @returns {vec2} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec2} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to round\r\n * @returns {vec2} out\r\n */\r\nexport function round (out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec2 by a scalar number\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec2} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec2's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec2} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  var x = b[0] - a[0],\r\n    y = b[1] - a[1];\r\n  return Math.hypot(x, y);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  var x = b[0] - a[0],\r\n    y = b[1] - a[1];\r\n  return x*x + y*y;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  return Math.hypot(x, y);\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec2\r\n *\r\n * @param {vec2} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength (a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  return x*x + y*y;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to negate\r\n * @returns {vec2} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to invert\r\n * @returns {vec2} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a vector to normalize\r\n * @returns {vec2} out\r\n */\r\nexport function normalize(out, a) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  var len = x*x + y*y;\r\n  if (len > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = a[0] * len;\r\n  out[1] = a[1] * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec2's\r\n *\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1];\r\n}\r\n\r\n/**\r\n * Computes the cross product of two vec2's\r\n * Note that the cross product must by definition produce a 3D vector\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function cross(out, a, b) {\r\n  var z = a[0] * b[1] - a[1] * b[0];\r\n  out[0] = out[1] = 0;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec2's\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the first operand\r\n * @param {vec2} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec2} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  var ax = a[0],\r\n    ay = a[1];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec2} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n  var r = glMatrix.RANDOM() * 2.0 * Math.PI;\r\n  out[0] = Math.cos(r) * scale;\r\n  out[1] = Math.sin(r) * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat2\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat2(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[2] * y;\r\n  out[1] = m[1] * x + m[3] * y;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat2d\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat2d} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat2d(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[2] * y + m[4];\r\n  out[1] = m[1] * x + m[3] * y + m[5];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat3\r\n * 3rd vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat3} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat3(out, a, m) {\r\n  var x = a[0],\r\n    y = a[1];\r\n  out[0] = m[0] * x + m[3] * y + m[6];\r\n  out[1] = m[1] * x + m[4] * y + m[7];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec2 with a mat4\r\n * 3rd vector component is implicitly '0'\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @param {vec2} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec2} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  out[0] = m[0] * x + m[4] * y + m[12];\r\n  out[1] = m[1] * x + m[5] * y + m[13];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 2D vector\r\n * @param {vec2} out The receiving vec2\r\n * @param {vec2} a The vec2 point to rotate\r\n * @param {vec2} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec2} out\r\n */\r\nexport function rotate(out, a, b, rad) {\r\n  //Translate point to the origin\r\n  let p0 = a[0] - b[0],\r\n  p1 = a[1] - b[1],\r\n  sinC = Math.sin(rad),\r\n  cosC = Math.cos(rad);\r\n\r\n  //perform rotation and translate to correct position\r\n  out[0] = p0*cosC - p1*sinC + b[0];\r\n  out[1] = p0*sinC + p1*cosC + b[1];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Get the angle between two 2D vectors\r\n * @param {vec2} a The first operand\r\n * @param {vec2} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\r\nexport function angle(a, b) {\r\n  let x1 = a[0],\r\n    y1 = a[1],\r\n    x2 = b[0],\r\n    y2 = b[1];\r\n\r\n  let len1 = x1*x1 + y1*y1;\r\n  if (len1 > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len1 = 1 / Math.sqrt(len1);\r\n  }\r\n\r\n  let len2 = x2*x2 + y2*y2;\r\n  if (len2 > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len2 = 1 / Math.sqrt(len2);\r\n  }\r\n\r\n  let cosine = (x1 * x2 + y1 * y2) * len1 * len2;\r\n\r\n  if(cosine > 1.0) {\r\n    return 0;\r\n  }\r\n  else if(cosine < -1.0) {\r\n    return Math.PI;\r\n  } else {\r\n    return Math.acos(cosine);\r\n  }\r\n}\r\n\r\n/**\r\n * Set the components of a vec2 to zero\r\n *\r\n * @param {vec2} out the receiving vector\r\n * @returns {vec2} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec2} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return 'vec2(' + a[0] + ', ' + a[1] + ')';\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec2} a The first vector.\r\n * @param {vec2} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0], a1 = a[1];\r\n  let b0 = b[0], b1 = b[1];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)));\r\n}\r\n\r\n/**\r\n * Alias for {@link vec2.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec2.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec2.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec2.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec2.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec2.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec2.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec2s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if(!stride) {\r\n      stride = 2;\r\n    }\r\n\r\n    if(!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if(count) {\r\n      l = Math.min((count * stride) + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for(i = offset; i < l; i += stride) {\r\n      vec[0] = a[i]; vec[1] = a[i+1];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0]; a[i+1] = vec[1];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","import * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 3 Dimensional Vector\r\n * @module vec3\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec3\r\n *\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(3);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec3 initialized with values from an existing vector\r\n *\r\n * @param {vec3} a vector to clone\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function clone(a) {\r\n  var out = new glMatrix.ARRAY_TYPE(3);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  return Math.hypot(x, y, z);\r\n}\r\n\r\n/**\r\n * Creates a new vec3 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} a new 3D vector\r\n */\r\nexport function fromValues(x, y, z) {\r\n  let out = new glMatrix.ARRAY_TYPE(3);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec3 to another\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the source vector\r\n * @returns {vec3} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec3 to the given values\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @returns {vec3} out\r\n */\r\nexport function set(out, x, y, z) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  out[2] = a[2] * b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  out[2] = a[2] / b[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to ceil\r\n * @returns {vec3} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  out[2] = Math.ceil(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to floor\r\n * @returns {vec3} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  out[2] = Math.floor(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  out[2] = Math.min(a[2], b[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  out[2] = Math.max(a[2], b[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to round\r\n * @returns {vec3} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  out[2] = Math.round(a[2]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec3 by a scalar number\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec3} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec3's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec3} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  out[2] = a[2] + (b[2] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  return Math.hypot(x, y, z);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  return x*x + y*y + z*z;\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec3\r\n *\r\n * @param {vec3} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  return x*x + y*y + z*z;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to negate\r\n * @returns {vec3} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to invert\r\n * @returns {vec3} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec3\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a vector to normalize\r\n * @returns {vec3} out\r\n */\r\nexport function normalize(out, a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let len = x*x + y*y + z*z;\r\n  if (len > 0) {\r\n    //TODO: evaluate use of glm_invsqrt here?\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = a[0] * len;\r\n  out[1] = a[1] * len;\r\n  out[2] = a[2] * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec3's\r\n *\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\r\n}\r\n\r\n/**\r\n * Computes the cross product of two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @returns {vec3} out\r\n */\r\nexport function cross(out, a, b) {\r\n  let ax = a[0], ay = a[1], az = a[2];\r\n  let bx = b[0], by = b[1], bz = b[2];\r\n\r\n  out[0] = ay * bz - az * by;\r\n  out[1] = az * bx - ax * bz;\r\n  out[2] = ax * by - ay * bx;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a linear interpolation between two vec3's\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let ax = a[0];\r\n  let ay = a[1];\r\n  let az = a[2];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  out[2] = az + t * (b[2] - az);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a hermite interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function hermite(out, a, b, c, d, t) {\r\n  let factorTimes2 = t * t;\r\n  let factor1 = factorTimes2 * (2 * t - 3) + 1;\r\n  let factor2 = factorTimes2 * (t - 2) + t;\r\n  let factor3 = factorTimes2 * (t - 1);\r\n  let factor4 = factorTimes2 * (3 - 2 * t);\r\n\r\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\r\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\r\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Performs a bezier interpolation with two control points\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the first operand\r\n * @param {vec3} b the second operand\r\n * @param {vec3} c the third operand\r\n * @param {vec3} d the fourth operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec3} out\r\n */\r\nexport function bezier(out, a, b, c, d, t) {\r\n  let inverseFactor = 1 - t;\r\n  let inverseFactorTimesTwo = inverseFactor * inverseFactor;\r\n  let factorTimes2 = t * t;\r\n  let factor1 = inverseFactorTimesTwo * inverseFactor;\r\n  let factor2 = 3 * t * inverseFactorTimesTwo;\r\n  let factor3 = 3 * factorTimes2 * inverseFactor;\r\n  let factor4 = factorTimes2 * t;\r\n\r\n  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;\r\n  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;\r\n  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec3} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n\r\n  let r = glMatrix.RANDOM() * 2.0 * Math.PI;\r\n  let z = (glMatrix.RANDOM() * 2.0) - 1.0;\r\n  let zScale = Math.sqrt(1.0-z*z) * scale;\r\n\r\n  out[0] = Math.cos(r) * zScale;\r\n  out[1] = Math.sin(r) * zScale;\r\n  out[2] = z * scale;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a mat4.\r\n * 4th vector component is implicitly '1'\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0], y = a[1], z = a[2];\r\n  let w = m[3] * x + m[7] * y + m[11] * z + m[15];\r\n  w = w || 1.0;\r\n  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;\r\n  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;\r\n  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a mat3.\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {mat3} m the 3x3 matrix to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformMat3(out, a, m) {\r\n  let x = a[0], y = a[1], z = a[2];\r\n  out[0] = x * m[0] + y * m[3] + z * m[6];\r\n  out[1] = x * m[1] + y * m[4] + z * m[7];\r\n  out[2] = x * m[2] + y * m[5] + z * m[8];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec3 with a quat\r\n * Can also be used for dual quaternions. (Multiply it with the real part)\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @param {vec3} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec3} out\r\n */\r\nexport function transformQuat(out, a, q) {\r\n    // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed\r\n    let qx = q[0], qy = q[1], qz = q[2], qw = q[3];\r\n    let x = a[0], y = a[1], z = a[2];\r\n    // var qvec = [qx, qy, qz];\r\n    // var uv = vec3.cross([], qvec, a);\r\n    let uvx = qy * z - qz * y,\r\n        uvy = qz * x - qx * z,\r\n        uvz = qx * y - qy * x;\r\n    // var uuv = vec3.cross([], qvec, uv);\r\n    let uuvx = qy * uvz - qz * uvy,\r\n        uuvy = qz * uvx - qx * uvz,\r\n        uuvz = qx * uvy - qy * uvx;\r\n    // vec3.scale(uv, uv, 2 * w);\r\n    let w2 = qw * 2;\r\n    uvx *= w2;\r\n    uvy *= w2;\r\n    uvz *= w2;\r\n    // vec3.scale(uuv, uuv, 2);\r\n    uuvx *= 2;\r\n    uuvy *= 2;\r\n    uuvz *= 2;\r\n    // return vec3.add(out, a, vec3.add(out, uv, uuv));\r\n    out[0] = x + uvx + uuvx;\r\n    out[1] = y + uvy + uuvy;\r\n    out[2] = z + uvz + uuvz;\r\n    return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the x-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateX(out, a, b, rad){\r\n  let p = [], r=[];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[0];\r\n  r[1] = p[1]*Math.cos(rad) - p[2]*Math.sin(rad);\r\n  r[2] = p[1]*Math.sin(rad) + p[2]*Math.cos(rad);\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the y-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateY(out, a, b, rad){\r\n  let p = [], r=[];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[2]*Math.sin(rad) + p[0]*Math.cos(rad);\r\n  r[1] = p[1];\r\n  r[2] = p[2]*Math.cos(rad) - p[0]*Math.sin(rad);\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Rotate a 3D vector around the z-axis\r\n * @param {vec3} out The receiving vec3\r\n * @param {vec3} a The vec3 point to rotate\r\n * @param {vec3} b The origin of the rotation\r\n * @param {Number} rad The angle of rotation in radians\r\n * @returns {vec3} out\r\n */\r\nexport function rotateZ(out, a, b, rad){\r\n  let p = [], r=[];\r\n  //Translate point to the origin\r\n  p[0] = a[0] - b[0];\r\n  p[1] = a[1] - b[1];\r\n  p[2] = a[2] - b[2];\r\n\r\n  //perform rotation\r\n  r[0] = p[0]*Math.cos(rad) - p[1]*Math.sin(rad);\r\n  r[1] = p[0]*Math.sin(rad) + p[1]*Math.cos(rad);\r\n  r[2] = p[2];\r\n\r\n  //translate to correct position\r\n  out[0] = r[0] + b[0];\r\n  out[1] = r[1] + b[1];\r\n  out[2] = r[2] + b[2];\r\n\r\n  return out;\r\n}\r\n\r\n/**\r\n * Get the angle between two 3D vectors\r\n * @param {vec3} a The first operand\r\n * @param {vec3} b The second operand\r\n * @returns {Number} The angle in radians\r\n */\r\nexport function angle(a, b) {\r\n  let tempA = fromValues(a[0], a[1], a[2]);\r\n  let tempB = fromValues(b[0], b[1], b[2]);\r\n\r\n  normalize(tempA, tempA);\r\n  normalize(tempB, tempB);\r\n\r\n  let cosine = dot(tempA, tempB);\r\n\r\n  if(cosine > 1.0) {\r\n    return 0;\r\n  }\r\n  else if(cosine < -1.0) {\r\n    return Math.PI;\r\n  } else {\r\n    return Math.acos(cosine);\r\n  }\r\n}\r\n\r\n/**\r\n * Set the components of a vec3 to zero\r\n *\r\n * @param {vec3} out the receiving vector\r\n * @returns {vec3} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec3} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec3} a The first vector.\r\n * @param {vec3} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n          Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)));\r\n}\r\n\r\n/**\r\n * Alias for {@link vec3.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec3.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec3.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec3.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec3.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec3.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec3.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec3s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if(!stride) {\r\n      stride = 3;\r\n    }\r\n\r\n    if(!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if(count) {\r\n      l = Math.min((count * stride) + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for(i = offset; i < l; i += stride) {\r\n      vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","import * as glMatrix from \"./common.js\";\r\n\r\n/**\r\n * 4 Dimensional Vector\r\n * @module vec4\r\n */\r\n\r\n/**\r\n * Creates a new, empty vec4\r\n *\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function create() {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  if(glMatrix.ARRAY_TYPE != Float32Array) {\r\n    out[0] = 0;\r\n    out[1] = 0;\r\n    out[2] = 0;\r\n    out[3] = 0;\r\n  }\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec4 initialized with values from an existing vector\r\n *\r\n * @param {vec4} a vector to clone\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function clone(a) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Creates a new vec4 initialized with the given values\r\n *\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} a new 4D vector\r\n */\r\nexport function fromValues(x, y, z, w) {\r\n  let out = new glMatrix.ARRAY_TYPE(4);\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Copy the values from one vec4 to another\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the source vector\r\n * @returns {vec4} out\r\n */\r\nexport function copy(out, a) {\r\n  out[0] = a[0];\r\n  out[1] = a[1];\r\n  out[2] = a[2];\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec4 to the given values\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} x X component\r\n * @param {Number} y Y component\r\n * @param {Number} z Z component\r\n * @param {Number} w W component\r\n * @returns {vec4} out\r\n */\r\nexport function set(out, x, y, z, w) {\r\n  out[0] = x;\r\n  out[1] = y;\r\n  out[2] = z;\r\n  out[3] = w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function add(out, a, b) {\r\n  out[0] = a[0] + b[0];\r\n  out[1] = a[1] + b[1];\r\n  out[2] = a[2] + b[2];\r\n  out[3] = a[3] + b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Subtracts vector b from vector a\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function subtract(out, a, b) {\r\n  out[0] = a[0] - b[0];\r\n  out[1] = a[1] - b[1];\r\n  out[2] = a[2] - b[2];\r\n  out[3] = a[3] - b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Multiplies two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function multiply(out, a, b) {\r\n  out[0] = a[0] * b[0];\r\n  out[1] = a[1] * b[1];\r\n  out[2] = a[2] * b[2];\r\n  out[3] = a[3] * b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Divides two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function divide(out, a, b) {\r\n  out[0] = a[0] / b[0];\r\n  out[1] = a[1] / b[1];\r\n  out[2] = a[2] / b[2];\r\n  out[3] = a[3] / b[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.ceil the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to ceil\r\n * @returns {vec4} out\r\n */\r\nexport function ceil(out, a) {\r\n  out[0] = Math.ceil(a[0]);\r\n  out[1] = Math.ceil(a[1]);\r\n  out[2] = Math.ceil(a[2]);\r\n  out[3] = Math.ceil(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.floor the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to floor\r\n * @returns {vec4} out\r\n */\r\nexport function floor(out, a) {\r\n  out[0] = Math.floor(a[0]);\r\n  out[1] = Math.floor(a[1]);\r\n  out[2] = Math.floor(a[2]);\r\n  out[3] = Math.floor(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the minimum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function min(out, a, b) {\r\n  out[0] = Math.min(a[0], b[0]);\r\n  out[1] = Math.min(a[1], b[1]);\r\n  out[2] = Math.min(a[2], b[2]);\r\n  out[3] = Math.min(a[3], b[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the maximum of two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {vec4} out\r\n */\r\nexport function max(out, a, b) {\r\n  out[0] = Math.max(a[0], b[0]);\r\n  out[1] = Math.max(a[1], b[1]);\r\n  out[2] = Math.max(a[2], b[2]);\r\n  out[3] = Math.max(a[3], b[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Math.round the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to round\r\n * @returns {vec4} out\r\n */\r\nexport function round(out, a) {\r\n  out[0] = Math.round(a[0]);\r\n  out[1] = Math.round(a[1]);\r\n  out[2] = Math.round(a[2]);\r\n  out[3] = Math.round(a[3]);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Scales a vec4 by a scalar number\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to scale\r\n * @param {Number} b amount to scale the vector by\r\n * @returns {vec4} out\r\n */\r\nexport function scale(out, a, b) {\r\n  out[0] = a[0] * b;\r\n  out[1] = a[1] * b;\r\n  out[2] = a[2] * b;\r\n  out[3] = a[3] * b;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Adds two vec4's after scaling the second operand by a scalar value\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} scale the amount to scale b by before adding\r\n * @returns {vec4} out\r\n */\r\nexport function scaleAndAdd(out, a, b, scale) {\r\n  out[0] = a[0] + (b[0] * scale);\r\n  out[1] = a[1] + (b[1] * scale);\r\n  out[2] = a[2] + (b[2] * scale);\r\n  out[3] = a[3] + (b[3] * scale);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} distance between a and b\r\n */\r\nexport function distance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  let w = b[3] - a[3];\r\n  return Math.hypot(x, y, z, w);\r\n}\r\n\r\n/**\r\n * Calculates the squared euclidian distance between two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} squared distance between a and b\r\n */\r\nexport function squaredDistance(a, b) {\r\n  let x = b[0] - a[0];\r\n  let y = b[1] - a[1];\r\n  let z = b[2] - a[2];\r\n  let w = b[3] - a[3];\r\n  return x*x + y*y + z*z + w*w;\r\n}\r\n\r\n/**\r\n * Calculates the length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate length of\r\n * @returns {Number} length of a\r\n */\r\nexport function length(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  return Math.hypot(x, y, z, w);\r\n}\r\n\r\n/**\r\n * Calculates the squared length of a vec4\r\n *\r\n * @param {vec4} a vector to calculate squared length of\r\n * @returns {Number} squared length of a\r\n */\r\nexport function squaredLength(a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  return x*x + y*y + z*z + w*w;\r\n}\r\n\r\n/**\r\n * Negates the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to negate\r\n * @returns {vec4} out\r\n */\r\nexport function negate(out, a) {\r\n  out[0] = -a[0];\r\n  out[1] = -a[1];\r\n  out[2] = -a[2];\r\n  out[3] = -a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns the inverse of the components of a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to invert\r\n * @returns {vec4} out\r\n */\r\nexport function inverse(out, a) {\r\n  out[0] = 1.0 / a[0];\r\n  out[1] = 1.0 / a[1];\r\n  out[2] = 1.0 / a[2];\r\n  out[3] = 1.0 / a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Normalize a vec4\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a vector to normalize\r\n * @returns {vec4} out\r\n */\r\nexport function normalize(out, a) {\r\n  let x = a[0];\r\n  let y = a[1];\r\n  let z = a[2];\r\n  let w = a[3];\r\n  let len = x*x + y*y + z*z + w*w;\r\n  if (len > 0) {\r\n    len = 1 / Math.sqrt(len);\r\n  }\r\n  out[0] = x * len;\r\n  out[1] = y * len;\r\n  out[2] = z * len;\r\n  out[3] = w * len;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Calculates the dot product of two vec4's\r\n *\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @returns {Number} dot product of a and b\r\n */\r\nexport function dot(a, b) {\r\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\r\n}\r\n\r\n/**\r\n * Returns the cross-product of three vectors in a 4-dimensional space\r\n *\r\n * @param {vec4} result the receiving vector\r\n * @param {vec4} U the first vector\r\n * @param {vec4} V the second vector\r\n * @param {vec4} W the third vector\r\n * @returns {vec4} result\r\n */\r\nexport function cross (out, u, v, w) {\r\n    let A = (v[0] * w[1]) - (v[1] * w[0]),\r\n        B = (v[0] * w[2]) - (v[2] * w[0]),\r\n        C = (v[0] * w[3]) - (v[3] * w[0]),\r\n        D = (v[1] * w[2]) - (v[2] * w[1]),\r\n        E = (v[1] * w[3]) - (v[3] * w[1]),\r\n        F = (v[2] * w[3]) - (v[3] * w[2]);\r\n    let G = u[0];\r\n    let H = u[1];\r\n    let I = u[2];\r\n    let J = u[3];\r\n\r\n    out[0] = (H * F) - (I * E) + (J * D);\r\n    out[1] = -(G * F) + (I * C) - (J * B);\r\n    out[2] = (G * E) - (H * C) + (J * A);\r\n    out[3] = -(G * D) + (H * B) - (I * A);\r\n\r\n    return out;\r\n};\r\n\r\n/**\r\n * Performs a linear interpolation between two vec4's\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the first operand\r\n * @param {vec4} b the second operand\r\n * @param {Number} t interpolation amount, in the range [0-1], between the two inputs\r\n * @returns {vec4} out\r\n */\r\nexport function lerp(out, a, b, t) {\r\n  let ax = a[0];\r\n  let ay = a[1];\r\n  let az = a[2];\r\n  let aw = a[3];\r\n  out[0] = ax + t * (b[0] - ax);\r\n  out[1] = ay + t * (b[1] - ay);\r\n  out[2] = az + t * (b[2] - az);\r\n  out[3] = aw + t * (b[3] - aw);\r\n  return out;\r\n}\r\n\r\n/**\r\n * Generates a random vector with the given scale\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned\r\n * @returns {vec4} out\r\n */\r\nexport function random(out, scale) {\r\n  scale = scale || 1.0;\r\n\r\n  // Marsaglia, George. Choosing a Point from the Surface of a\r\n  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.\r\n  // http://projecteuclid.org/euclid.aoms/1177692644;\r\n  var v1, v2, v3, v4;\r\n  var s1, s2;\r\n  do {\r\n    v1 = glMatrix.RANDOM() * 2 - 1;\r\n    v2 = glMatrix.RANDOM() * 2 - 1;\r\n    s1 = v1 * v1 + v2 * v2;\r\n  } while (s1 >= 1);\r\n  do {\r\n    v3 = glMatrix.RANDOM() * 2 - 1;\r\n    v4 = glMatrix.RANDOM() * 2 - 1;\r\n    s2 = v3 * v3 + v4 * v4;\r\n  } while (s2 >= 1);\r\n\r\n  var d = Math.sqrt((1 - s1) / s2);\r\n  out[0] = scale * v1;\r\n  out[1] = scale * v2;\r\n  out[2] = scale * v3 * d;\r\n  out[3] = scale * v4 * d;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec4 with a mat4.\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {mat4} m matrix to transform with\r\n * @returns {vec4} out\r\n */\r\nexport function transformMat4(out, a, m) {\r\n  let x = a[0], y = a[1], z = a[2], w = a[3];\r\n  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;\r\n  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;\r\n  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;\r\n  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Transforms the vec4 with a quat\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @param {vec4} a the vector to transform\r\n * @param {quat} q quaternion to transform with\r\n * @returns {vec4} out\r\n */\r\nexport function transformQuat(out, a, q) {\r\n  let x = a[0], y = a[1], z = a[2];\r\n  let qx = q[0], qy = q[1], qz = q[2], qw = q[3];\r\n\r\n  // calculate quat * vec\r\n  let ix = qw * x + qy * z - qz * y;\r\n  let iy = qw * y + qz * x - qx * z;\r\n  let iz = qw * z + qx * y - qy * x;\r\n  let iw = -qx * x - qy * y - qz * z;\r\n\r\n  // calculate result * inverse quat\r\n  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;\r\n  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;\r\n  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;\r\n  out[3] = a[3];\r\n  return out;\r\n}\r\n\r\n/**\r\n * Set the components of a vec4 to zero\r\n *\r\n * @param {vec4} out the receiving vector\r\n * @returns {vec4} out\r\n */\r\nexport function zero(out) {\r\n  out[0] = 0.0;\r\n  out[1] = 0.0;\r\n  out[2] = 0.0;\r\n  out[3] = 0.0;\r\n  return out;\r\n}\r\n\r\n/**\r\n * Returns a string representation of a vector\r\n *\r\n * @param {vec4} a vector to represent as a string\r\n * @returns {String} string representation of the vector\r\n */\r\nexport function str(a) {\r\n  return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function exactEquals(a, b) {\r\n  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];\r\n}\r\n\r\n/**\r\n * Returns whether or not the vectors have approximately the same elements in the same position.\r\n *\r\n * @param {vec4} a The first vector.\r\n * @param {vec4} b The second vector.\r\n * @returns {Boolean} True if the vectors are equal, false otherwise.\r\n */\r\nexport function equals(a, b) {\r\n  let a0 = a[0], a1 = a[1], a2 = a[2], a3 = a[3];\r\n  let b0 = b[0], b1 = b[1], b2 = b[2], b3 = b[3];\r\n  return (Math.abs(a0 - b0) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a0), Math.abs(b0)) &&\r\n          Math.abs(a1 - b1) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a1), Math.abs(b1)) &&\r\n          Math.abs(a2 - b2) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a2), Math.abs(b2)) &&\r\n          Math.abs(a3 - b3) <= glMatrix.EPSILON*Math.max(1.0, Math.abs(a3), Math.abs(b3)));\r\n}\r\n\r\n/**\r\n * Alias for {@link vec4.subtract}\r\n * @function\r\n */\r\nexport const sub = subtract;\r\n\r\n/**\r\n * Alias for {@link vec4.multiply}\r\n * @function\r\n */\r\nexport const mul = multiply;\r\n\r\n/**\r\n * Alias for {@link vec4.divide}\r\n * @function\r\n */\r\nexport const div = divide;\r\n\r\n/**\r\n * Alias for {@link vec4.distance}\r\n * @function\r\n */\r\nexport const dist = distance;\r\n\r\n/**\r\n * Alias for {@link vec4.squaredDistance}\r\n * @function\r\n */\r\nexport const sqrDist = squaredDistance;\r\n\r\n/**\r\n * Alias for {@link vec4.length}\r\n * @function\r\n */\r\nexport const len = length;\r\n\r\n/**\r\n * Alias for {@link vec4.squaredLength}\r\n * @function\r\n */\r\nexport const sqrLen = squaredLength;\r\n\r\n/**\r\n * Perform some operation over an array of vec4s.\r\n *\r\n * @param {Array} a the array of vectors to iterate over\r\n * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed\r\n * @param {Number} offset Number of elements to skip at the beginning of the array\r\n * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array\r\n * @param {Function} fn Function to call for each vector in the array\r\n * @param {Object} [arg] additional argument to pass to fn\r\n * @returns {Array} a\r\n * @function\r\n */\r\nexport const forEach = (function() {\r\n  let vec = create();\r\n\r\n  return function(a, stride, offset, count, fn, arg) {\r\n    let i, l;\r\n    if(!stride) {\r\n      stride = 4;\r\n    }\r\n\r\n    if(!offset) {\r\n      offset = 0;\r\n    }\r\n\r\n    if(count) {\r\n      l = Math.min((count * stride) + offset, a.length);\r\n    } else {\r\n      l = a.length;\r\n    }\r\n\r\n    for(i = offset; i < l; i += stride) {\r\n      vec[0] = a[i]; vec[1] = a[i+1]; vec[2] = a[i+2]; vec[3] = a[i+3];\r\n      fn(vec, vec, arg);\r\n      a[i] = vec[0]; a[i+1] = vec[1]; a[i+2] = vec[2]; a[i+3] = vec[3];\r\n    }\r\n\r\n    return a;\r\n  };\r\n})();\r\n","import { List, Node } from \"./list\";\r\n\r\nexport class Place {\r\n  constructor(public offset: number, public size: number, public data: any = null) { }\r\n}\r\n\r\nexport class Bag {\r\n  private holes: List<Place>;\r\n\r\n  constructor(readonly size: number) {\r\n    this.reset();\r\n  }\r\n\r\n  private getSuitablePlace(size: number): Node<Place> {\r\n    for (let hole = this.holes.first(); hole != this.holes.terminator(); hole = hole.next)\r\n      if (hole.obj.size >= size) return hole;\r\n    return null;\r\n  }\r\n\r\n  private tryMerge(node: Node<Place>): void {\r\n    if (node != this.holes.terminator() && node.next != this.holes.terminator()) {\r\n      if (node.obj.offset + node.obj.size == node.next.obj.offset) {\r\n        node.obj.size += node.next.obj.size;\r\n        this.holes.remove(node.next);\r\n        this.tryMerge(node);\r\n      }\r\n    }\r\n  }\r\n\r\n  public put(offset: number, size: number): void {\r\n    let hole = this.holes.first();\r\n    if (hole == this.holes.terminator()) {\r\n      this.holes.insertAfter(new Place(offset, size));\r\n      return;\r\n    }\r\n    while (hole.next != this.holes.terminator()) {\r\n      const next = hole.next;\r\n      if (next.obj.offset >= size + offset) break;\r\n      hole = next;\r\n    }\r\n    const end = hole.obj.offset + hole.obj.size;\r\n    if (hole.obj.offset > offset) {\r\n      const newHole = this.holes.insertBefore(new Place(offset, size), hole);\r\n      this.tryMerge(newHole);\r\n    } else if (end == offset) {\r\n      hole.obj.size += size;\r\n      this.tryMerge(hole);\r\n    } else {\r\n      const newHole = this.holes.insertAfter(new Place(offset, size), hole);\r\n      this.tryMerge(newHole);\r\n    }\r\n  }\r\n\r\n  public get(size: number): number {\r\n    const hole = this.getSuitablePlace(size);\r\n    if (hole == null) return null;\r\n    if (hole.obj.size == size) {\r\n      const prev = hole.prev;\r\n      this.holes.remove(hole);\r\n      this.tryMerge(prev);\r\n      return hole.obj.offset;\r\n    } else {\r\n      const off = hole.obj.offset;\r\n      hole.obj.offset += size;\r\n      hole.obj.size -= size;\r\n      return off;\r\n    }\r\n  }\r\n\r\n  public reset() {\r\n    this.holes = new List<Place>();\r\n    this.holes.insertAfter(new Place(0, this.size));\r\n  }\r\n\r\n  public freeSpace(segments: number) {\r\n    const results = new Array<number>(segments).fill(1);\r\n    const ds = this.size / segments;\r\n    for (const hole of this.holes) {\r\n      const hstart = hole.offset;\r\n      const hend = hstart + hole.size;\r\n      for (let i = (hstart / ds | 0); i <= (hend / ds | 0) && i < segments; i++) {\r\n        const start = i * ds;\r\n        const end = start + ds;\r\n        const dl = Math.max(0, hstart - start);\r\n        const dr = Math.max(0, end - hend);\r\n        results[i] -= 1 - (dl + dr) / ds;\r\n      }\r\n    }\r\n    return results;\r\n  }\r\n}\r\n\r\nexport class BagController {\r\n  private bag: Bag;\r\n  private places = {};\r\n  private updater: (place: Place, noffset: number) => void;\r\n\r\n  constructor(size: number, updater: (place: Place, noffset: number) => void) {\r\n    this.bag = new Bag(size);\r\n    this.updater = updater;\r\n  }\r\n\r\n  public get(size: number): Place {\r\n    let offset = this.bag.get(size);\r\n    // if (offset == null) {\r\n    //   this.optimize();\r\n    //   offset = this.bag.get(size);\r\n    // }\r\n    if (offset == null) return null;\r\n    let result = new Place(offset, size);\r\n    this.places[offset] = result;\r\n    return result;\r\n  }\r\n\r\n  public put(place: Place): void {\r\n    this.bag.put(place.offset, place.size);\r\n    delete this.places[place.offset];\r\n  }\r\n\r\n  public optimize() {\r\n    let places = this.places;\r\n    let keys = Object.keys(places);\r\n    this.places = {};\r\n    this.bag.reset();\r\n    let offset = 0;\r\n    for (let i = 0; i < keys.length; i++) {\r\n      let key = keys[i];\r\n      let place = places[key];\r\n      this.places[offset] = place;\r\n      if (place.offset == offset)\r\n        continue;\r\n      this.updater(place, offset);\r\n      place.offset = offset;\r\n      offset += place.size;\r\n    }\r\n    this.bag.get(offset);\r\n  }\r\n\r\n  public freeSpace(segments: number) {\r\n    return this.bag.freeSpace(segments);\r\n  }\r\n}\r\n\r\nexport function create(size: number): Bag {\r\n  return new Bag(size);\r\n}\r\n\r\nexport function createController(size: number, updater: (place: Place, noffset: number) => void): BagController {\r\n  return new BagController(size, updater);\r\n}","\r\nexport class CachedValue<T> {\r\n  private valid = false;\r\n  constructor(\r\n    private supplier: (value: T) => T,\r\n    private cached: T = null\r\n  ) { }\r\n\r\n  public get() {\r\n    if (!this.valid) {\r\n      this.cached = this.supplier(this.cached);\r\n      this.valid = true;\r\n    }\r\n    return this.cached;\r\n  }\r\n\r\n  public invalidate() { this.valid = false }\r\n}","import { mat4, Mat4Array, vec3, Vec3Array } from '../../libs_js/glmatrix';\r\nimport { deg2rad } from '../mathutils';\r\n\r\nexport class Camera {\r\n  private transform: Mat4Array;\r\n  private position: Vec3Array;\r\n  private angleX: number;\r\n  private angleY: number;\r\n  private needUpdate: boolean = true;\r\n\r\n  constructor(x: number, y: number, z: number, ax: number, ay: number) {\r\n    this.transform = mat4.create();\r\n    this.position = vec3.fromValues(x, y, z);\r\n    this.angleX = ax;\r\n    this.angleY = ay;\r\n  }\r\n\r\n  public setPosition(x: number, y: number, z: number): void {\r\n    this.position[0] = x;\r\n    this.position[1] = y;\r\n    this.position[2] = z;\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  public setPositionXYZ(x: number, y: number, z: number): void {\r\n    vec3.set(this.position, x, y, z);\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  public getPosition(): Vec3Array {\r\n    return this.position;\r\n  }\r\n\r\n  public forward(): Vec3Array {\r\n    var mat4 = this.getTransformMatrix()\r\n    return vec3.fromValues(-mat4[2], -mat4[6], -mat4[10]);\r\n  }\r\n\r\n  public side(): Vec3Array {\r\n    var mat4 = this.getTransformMatrix()\r\n    return vec3.fromValues(mat4[0], mat4[4], mat4[8]);\r\n  }\r\n\r\n  public updateAngles(dx: number, dy: number): void {\r\n    this.angleY -= dx;\r\n    this.angleX -= dy;\r\n    this.angleX = Math.max(-90, Math.min(90, this.angleX));\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  public setAngles(ax: number, ay: number): void {\r\n    this.angleX = Math.max(-90, Math.min(90, ax));\r\n    this.angleY = ay;\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  public getTransformMatrix(): Mat4Array {\r\n    var mat = this.transform;\r\n    if (this.needUpdate) {\r\n      var pos = this.position;\r\n      mat4.identity(mat);\r\n      mat4.rotateX(mat, mat, deg2rad(-this.angleX));\r\n      mat4.rotateY(mat, mat, deg2rad(-this.angleY));\r\n      vec3.negate(pos, pos);\r\n      mat4.translate(mat, mat, pos);\r\n      vec3.negate(pos, pos);\r\n      this.needUpdate = false;\r\n    }\r\n    return mat;\r\n  }\r\n}","import { Camera } from \"./camera\";\r\nimport { mat4, Vec3Array, vec3 } from \"../../libs_js/glmatrix\";\r\n\r\nexport class Controller2D {\r\n  private camera = new Camera(0, 0, 0, 0, 0);\r\n  private width = 800;\r\n  private height = 600;\r\n  private oldX = 0;\r\n  private oldY = 0;\r\n  private scale = 1;\r\n  private projection = mat4.create();\r\n\r\n  public track(x: number, y: number, z: number, move: boolean) {\r\n    if (move) {\r\n      var dx = (x - this.oldX) * this.scale;\r\n      var dy = (y - this.oldY) * this.scale;\r\n      let pos = this.camera.getPosition();\r\n      this.camera.setPositionXYZ(pos[0] - dx, z, pos[2] - dy);\r\n    }\r\n    this.oldX = x;\r\n    this.oldY = y;\r\n  }\r\n\r\n  public setSize(w: number, h: number) {\r\n    this.width = w;\r\n    this.height = h;\r\n  }\r\n\r\n  public getWidth() { return this.width }\r\n  public getHeight() { return this.height }\r\n  public setUnitsPerPixel(scale: number) { this.scale = scale }\r\n  public getUnitsPerPixel() { return this.scale }\r\n  public setPosition(x: number, y: number, z: number): void { this.camera.setPositionXYZ(x, z, y) }\r\n  public getPosition() { return this.camera.getPosition() }\r\n  public getTransformMatrix() { return this.camera.getTransformMatrix() }\r\n\r\n  public getPointerPosition(pointer: Vec3Array, x: number, y: number) {\r\n    let pos = this.camera.getPosition();\r\n    return vec3.set(pointer, pos[0] + (this.width / 2) * x * this.scale, 0, pos[2] + (this.height / 2) * y * this.scale);\r\n  }\r\n\r\n  public getProjectionMatrix() {\r\n    const projection = this.projection;\r\n    const wscale = this.width / 2 * this.scale;\r\n    const hscale = this.height / 2 * this.scale;\r\n    mat4.identity(projection);\r\n    mat4.ortho(projection, -wscale, wscale, hscale, -hscale, 1, 0xFFFF);\r\n    mat4.rotateX(projection, projection, -Math.PI / 2);\r\n    return projection;\r\n  }\r\n\r\n}\r\n","import * as MU from '../../utils/mathutils';\r\nimport * as camera from './camera';\r\nimport { mat4, vec3, Mat4Array, Vec3Array } from '../../libs_js/glmatrix';\r\n\r\nlet invertTrans = mat4.create();\r\nlet invTP = mat4.create();\r\nlet forward = vec3.create();\r\n\r\nexport class Controller3D {\r\n  private camera = new camera.Camera(0, 0, 0, 0, 0);\r\n  private projection = mat4.create();\r\n  private fov = 90;\r\n  private oldX = 0;\r\n  private oldY = 0;\r\n\r\n  public setFov(fov: number) {\r\n    this.fov = fov;\r\n  }\r\n\r\n  public getFov(): number {\r\n    return this.fov;\r\n  }\r\n\r\n  public getMatrix(aspect: number): Mat4Array {\r\n    let projection = this.getProjectionMatrix(aspect);\r\n    mat4.mul(projection, projection, this.camera.getTransformMatrix());\r\n    return projection;\r\n  }\r\n\r\n  public getProjectionMatrix(aspect: number): Mat4Array {\r\n    return mat4.perspective(this.projection, MU.deg2rad(this.fov), aspect, 1, 0xFFFF);\r\n  }\r\n\r\n  public getTransformMatrix() {\r\n    return this.camera.getTransformMatrix();\r\n  }\r\n\r\n  public getPosition() {\r\n    return this.camera.getPosition();\r\n  }\r\n\r\n  public setPosition(x: number, y: number, z: number) {\r\n    this.camera.setPosition(x, y, z);\r\n  }\r\n\r\n  public getForward() {\r\n    return this.camera.forward();\r\n  }\r\n\r\n  public getForwardUnprojected(aspect: number, x: number, y: number): Vec3Array {\r\n    mat4.invert(invertTrans, this.getTransformMatrix());\r\n    mat4.invert(invTP, this.getProjectionMatrix(aspect));\r\n    mat4.mul(invTP, invertTrans, invTP);\r\n\r\n    vec3.set(forward, x, -y, -1);\r\n    vec3.transformMat4(forward, forward, invTP);\r\n    vec3.sub(forward, forward, this.getPosition());\r\n    return vec3.normalize(forward, forward);\r\n  }\r\n\r\n  public moveForward(dist: number) {\r\n    let forward = this.camera.forward();\r\n    let campos = this.camera.getPosition();\r\n    vec3.scale(forward, forward, dist);\r\n    vec3.add(campos, campos, forward);\r\n    this.camera.setPosition(campos[0], campos[1], campos[2]);\r\n  }\r\n\r\n  public moveSideway(dist: number) {\r\n    let sideways = this.camera.side();\r\n    let campos = this.camera.getPosition();\r\n    vec3.scale(sideways, sideways, dist);\r\n    vec3.add(campos, campos, sideways);\r\n    this.camera.setPosition(campos[0], campos[1], campos[2]);\r\n  }\r\n\r\n  public track(x: number, y: number, move: boolean) {\r\n    if (move) this.camera.updateAngles((x - this.oldX) / 2, (y - this.oldY) / 2);\r\n    this.oldX = x;\r\n    this.oldY = y;\r\n  }\r\n}","import { cyclic } from \"./mathutils\";\r\nimport { Iter } from \"./iter\";\r\n\r\nexport interface Collection<T> extends Iterable<T> {\r\n  get(i: number): T;\r\n  length(): number;\r\n}\r\n\r\nexport function last<T>(c: Collection<T>): T { return c.get(c.length() - 1) }\r\nexport function first<T>(c: Collection<T>): T { return c.get(0) }\r\nexport function isEmpty<T>(c: Collection<T>): boolean { return c.length() == 0 }\r\n\r\nexport interface MutableCollection<T> extends Collection<T> {\r\n  set(idx: number, value: T): void;\r\n}\r\n\r\nexport const TERMINAL_ITERATOR_RESULT: IteratorResult<any> = { value: null, done: true };\r\nexport const EMPTY_ITERATOR = { next: () => TERMINAL_ITERATOR_RESULT };\r\nexport const EMPTY_COLLECTION: MutableCollection<any> = {\r\n  get: (i: number) => undefined,\r\n  length: () => 0,\r\n  [Symbol.iterator]: () => EMPTY_ITERATOR,\r\n  set: (i: number, v: any) => { }\r\n}\r\n\r\nexport function iteratorResult<T>(isDone: boolean, val: T): IteratorResult<T> {\r\n  return isDone ? TERMINAL_ITERATOR_RESULT : { done: false, value: val };\r\n}\r\n\r\nexport class ArrayWrapper<T> implements MutableCollection<T> {\r\n  constructor(readonly array: T[], readonly size: number = array.length) { };\r\n  get(i: number) { return this.array[i] }\r\n  length() { return this.size }\r\n  [Symbol.iterator]() { return this.array.values(); }\r\n  set(i: number, value: T) { this.array[i] = value }\r\n}\r\nexport function wrap<T>(array: T[], len: number = array.length) { return new ArrayWrapper(array, len) }\r\n\r\nexport class Deck<T> implements MutableCollection<T>{\r\n  public array: T[] = [];\r\n  public size = 0;\r\n\r\n  public get(i: number) { return this.array[i] }\r\n\r\n  public set(i: number, value: T) {\r\n    if (i < 0 || i >= this.size) throw new Error(`Invalid set position: ${i}, size:${this.size}`);\r\n    this.array[i] = value;\r\n  }\r\n\r\n  public push(value: T): Deck<T> {\r\n    this.array[this.size++] = value;\r\n    return this;\r\n  }\r\n\r\n  public pushAll(values: Iterable<T>): Deck<T> {\r\n    for (let val of values) this.push(val);\r\n    return this;\r\n  }\r\n\r\n  public pop(): Deck<T> {\r\n    this.size--;\r\n    return this;\r\n  }\r\n\r\n  public top(): T {\r\n    return this.array[this.size - 1];\r\n  }\r\n\r\n  public clear(): Deck<T> {\r\n    this.size = 0;\r\n    return this;\r\n  }\r\n\r\n  public length() {\r\n    return this.size;\r\n  }\r\n\r\n  public clone() {\r\n    let copy = new Deck<T>();\r\n    copy.array = [...take(this.array, this.size)];\r\n    copy.size = this.size;\r\n    return copy;\r\n  }\r\n\r\n  public [Symbol.iterator]() {\r\n    let i = 0;\r\n    return this.size == 0\r\n      ? EMPTY_ITERATOR\r\n      : { next: () => { return iteratorResult(i == this.size, this.array[i++]) } }\r\n  }\r\n}\r\n\r\nexport class IndexedDeck<T> extends Deck<T>{\r\n  private index = new Map<T, number>();\r\n\r\n  public push(value: T): IndexedDeck<T> {\r\n    if (this.index.has(value)) return this;\r\n    super.push(value);\r\n    this.index.set(value, this.size - 1);\r\n    return this;\r\n  }\r\n\r\n  public set(i: number, value: T) {\r\n    const last = this.get(i);\r\n    super.set(i, value);\r\n    this.index.delete(last);\r\n    this.index.set(value, i);\r\n  }\r\n\r\n  public clear(): IndexedDeck<T> {\r\n    super.clear();\r\n    this.index.clear();\r\n    return this;\r\n  }\r\n\r\n  public indexOf(value: T) {\r\n    let idx = this.index.get(value);\r\n    return idx == undefined ? -1 : idx;\r\n  }\r\n\r\n  public hasAny(i: Iterable<T>): boolean {\r\n    for (const v of i) if (this.indexOf(v) != -1) return true;\r\n    return false;\r\n  }\r\n}\r\n\r\nexport function reverse<T>(c: Collection<T>): Collection<T> {\r\n  return isEmpty(c)\r\n    ? EMPTY_COLLECTION\r\n    : {\r\n      get: (i: number) => c.get(c.length() - 1 - i),\r\n      length: () => c.length(),\r\n      [Symbol.iterator]: () => reversed(c)\r\n    }\r\n}\r\n\r\nexport function length<T>(it: Iterable<T>): number {\r\n  let length = 0;\r\n  for (const _ of it) length++;\r\n  return length;\r\n}\r\n\r\nexport function* filter<T>(i: Iterable<T>, f: (t: T) => boolean): Generator<T> {\r\n  for (const v of i) if (f(v)) yield v;\r\n}\r\n\r\nexport function* map<T, V>(i: Iterable<T>, f: (t: T) => V): Generator<V> {\r\n  for (const v of i) yield f(v);\r\n}\r\n\r\nexport function forEach<T>(i: Iterable<T>, f: (t: T) => void): void {\r\n  for (const v of i) f(v);\r\n}\r\n\r\nexport function reduce<T>(i: Iterable<T>, f: (lh: T, rh: T) => T, start: T): T {\r\n  for (const v of i) start = f(start, v);\r\n  return start;\r\n}\r\n\r\nexport function* sub<T>(c: Collection<T>, start: number, length: number): Generator<T> {\r\n  for (let i = 0; i < length; i++) yield c.get(start + i);\r\n}\r\n\r\nexport function all<T>(i: Iterable<T>, f: (t: T) => boolean): boolean {\r\n  for (const t of i) if (!f(t)) return false;\r\n  return true;\r\n}\r\n\r\nexport function any<T>(i: Iterable<T>, f: (t: T) => boolean): boolean {\r\n  for (const t of i) if (f(t)) return true;\r\n  return false;\r\n}\r\n\r\nexport function iterIsEmpty<T>(i: Iterable<T>): boolean {\r\n  const ii = i[Symbol.iterator]();\r\n  return ii.next().done;\r\n}\r\n\r\nexport function findFirst<T>(i: Iterable<T>, f: (t: T) => boolean, def: T): T {\r\n  for (const t of i) if (f(t)) return t;\r\n  return def;\r\n}\r\n\r\nexport function* chain<T>(i1: Iterable<T>, i2: Iterable<T>): Generator<T> {\r\n  const iter1 = i1[Symbol.iterator]();\r\n  let v = iter1.next();\r\n  while (!v.done) {\r\n    yield v.value;\r\n    v = iter1.next();\r\n  }\r\n  const iter2 = i2[Symbol.iterator]();\r\n  v = iter2.next();\r\n  while (!v.done) {\r\n    yield v.value;\r\n    v = iter2.next();\r\n  }\r\n}\r\n\r\nexport function* butLast<T>(i: Iterable<T>): Generator<T> {\r\n  const iter = i[Symbol.iterator]();\r\n  let v1 = iter.next();\r\n  if (v1.done) return;\r\n  let v2 = iter.next();\r\n  while (!v2.done) {\r\n    yield v1.value;\r\n    v1 = v2;\r\n    v2 = iter.next();\r\n  }\r\n}\r\n\r\nexport function* reversed<T>(c: Collection<T>): Generator<T> {\r\n  for (let i = c.length() - 1; i >= 0; i--) yield c.get(i);\r\n}\r\n\r\nexport function* enumerate<T>(c: Iterable<T>): Generator<[T, number]> {\r\n  let i = 0;\r\n  for (const t of c) yield [t, i++];\r\n}\r\n\r\nexport function* range(start: number, end: number): Generator<number> {\r\n  const di = start > end ? -1 : 1;\r\n  for (let i = start; i != end; i += di) yield i;\r\n}\r\nexport function rangeIter(start: number, end: number): Iter<number> {\r\n  return Iter.of(range(start, end));\r\n}\r\n\r\nexport function* cyclicRange(start: number, length: number) {\r\n  if (start >= length) throw new Error(`${start} >= ${length}`);\r\n  for (let i = 0; i < length; i++) yield cyclic(start + i, length);\r\n}\r\n\r\nexport function* cyclicPairs(length: number): Generator<[number, number]> {\r\n  if (length < 0) throw new Error(`${length} < 0`)\r\n  for (let i = 0; i < length; i++) yield [i, cyclic(i + 1, length)];\r\n}\r\n\r\nexport function* loopPairs<T>(i: Iterable<T>): Generator<[T, T]> {\r\n  const iter = i[Symbol.iterator]();\r\n  const first = iter.next();\r\n  if (first.done) return;\r\n  let lh = first;\r\n  let rh = iter.next();\r\n  while (!rh.done) {\r\n    yield [lh.value, rh.value];\r\n    lh = rh;\r\n    rh = iter.next();\r\n  }\r\n  yield [lh.value, first.value];\r\n}\r\n\r\nexport function* pairs<T>(i: Iterable<T>): Generator<[T, T]> {\r\n  const iter = i[Symbol.iterator]();\r\n  const first = iter.next();\r\n  if (first.done) return;\r\n  let lh = first;\r\n  let rh = iter.next();\r\n  while (!rh.done) {\r\n    yield [lh.value, rh.value];\r\n    lh = rh;\r\n    rh = iter.next();\r\n  }\r\n}\r\n\r\nexport function* take<T>(c: Iterable<T>, count: number): Generator<T> {\r\n  if (count < 0) return;\r\n  const iter = c[Symbol.iterator]();\r\n  while (count > 0) {\r\n    const next = iter.next();\r\n    if (next.done) return;\r\n    yield next.value;\r\n    count--;\r\n  }\r\n}\r\n\r\nexport function skip<T>(i: Iterable<T>, count: number): Iterable<T> {\r\n  const iter = i[Symbol.iterator]();\r\n  while (count > 0) {\r\n    const v = iter.next();\r\n    if (v.done) break;\r\n    count--;\r\n  }\r\n  return {\r\n    [Symbol.iterator]: () => {\r\n      return {\r\n        next: () => { return iter.next() }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function skipWhile<T>(i: Iterable<T>, f: (t: T) => boolean): Iterable<T> {\r\n  const iter = i[Symbol.iterator]();\r\n  for (; ;) {\r\n    const v = iter.next();\r\n    if (v.done || !f(v.value)) break;\r\n  }\r\n  return {\r\n    [Symbol.iterator]: () => {\r\n      return {\r\n        next: () => { return iter.next() }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function* rect(w: number, h: number): Generator<[number, number]> {\r\n  if (w < 0) throw new Error(`${w} < 0`)\r\n  if (h < 0) throw new Error(`${h} < 0`)\r\n  for (let y = 0; y < h; y++)\r\n    for (let x = 0; x < w; x++)\r\n      yield [x, y]\r\n}\r\n\r\nexport function intersect<T>(lh: Set<T>, rh: Set<T>): Set<T> {\r\n  return new Set([...lh].filter(t => rh.has(t)));\r\n}\r\n\r\nexport function* interpolate<T>(ii: Iterable<T>, f: (lh: T, rh: T, t: number) => T, points = [0.5]) {\r\n  const i = ii[Symbol.iterator]();\r\n  let lh = i.next();\r\n  if (lh.done) return;\r\n  yield lh.value;\r\n  let rh = i.next();\r\n  while (!rh.done) {\r\n    for (const p of points) yield f(lh.value, rh.value, p);\r\n    yield rh.value;\r\n    lh = rh;\r\n    rh = i.next();\r\n  }\r\n}","import { rect } from \"./collections\";\r\nimport { int } from \"./mathutils\";\r\n\r\nexport function rgb2hsl(r: number, g: number, b: number): [number, number, number] {\r\n  const rd = r / 255.0;\r\n  const gd = g / 255.0;\r\n  const bd = b / 255.0;\r\n\r\n  const max = Math.max(rd, gd, bd);\r\n  const min = Math.min(rd, gd, bd);\r\n  const l = (max + min) / 2.0;\r\n  const delta = max - min;\r\n  let s = 0;\r\n  let h = 0;\r\n  if (max != min) {\r\n    s = delta / (1 - Math.abs(2 * l - 1));\r\n    if (max == rd) h = 42.5 * (gd - bd) / (delta);\r\n    else if (max == gd) h = 42.5 * ((bd - rd) / (delta) + 2);\r\n    else h = 42.5 * ((rd - gd) / (delta) + 4);\r\n    if (h < 0) h += 255;\r\n  }\r\n  return [int(h), int(s * 255), int(l * 255)];\r\n}\r\n\r\nexport function hsl2rgb(h: number, s: number, l: number): [number, number, number] {\r\n  if (s == 0) return [l, l, l];\r\n\r\n  const lf = l / 255.0;\r\n  const sf = s / 255.0;\r\n\r\n  const c = (1 - Math.abs(2 * lf - 1)) * sf;\r\n  const x = c * (1 - Math.abs((h / 42.5) % 2 - 1));\r\n  const m = lf - c / 2;\r\n\r\n  let r = 0, g = 0, b = 0;\r\n  if (h >= 0 && h < 42.5) { r = c; g = x; b = 0; }\r\n  else if (h >= 42.5 && h <= 42.5 * 2) { r = x; g = c; b = 0; }\r\n  else if (h >= 42.5 * 2 && h <= 42.5 * 3) { r = 0; g = c; b = x; }\r\n  else if (h >= 42.5 * 3 && h <= 42.5 * 4) { r = 0; g = x; b = c; }\r\n  else if (h >= 42.5 * 4 && h <= 42.5 * 5) { r = x; g = 0; b = c; }\r\n  else if (h >= 42.5 * 5 && h <= 42.5 * 6) { r = c; g = 0; b = x; }\r\n\r\n  return [int((r + m) * 255), int((g + m) * 255), int((b + m) * 255)];\r\n}\r\n\r\nexport function rgb2xyz(r: number, g: number, b: number): [number, number, number] {\r\n  return [\r\n    (r * 0.49 + g * 0.31 + b * 0.2) / 0.17697,\r\n    (r * 0.17697 + g * 0.8124 + b * 0.01063) / 0.17697,\r\n    (r * 0 + g * 0.01 + b * 0.99) / 0.17697\r\n  ];\r\n}\r\n\r\nexport function xyz2rgb(x: number, y: number, z: number): [number, number, number] {\r\n  return [\r\n    x * 0.41847 + y * -0.15866 + z * -0.082835,\r\n    x * -0.091169 + y * 0.25243 + z * 0.015708,\r\n    x * 0.00092090 + y * -0.0025498 + z * 0.1786\r\n  ];\r\n}\r\n\r\nconst xn = 95.047;\r\nconst yn = 100;\r\nconst zn = 108.883;\r\nconst c = Math.pow(6 / 29, 3);\r\nfunction f(t: number): number {\r\n  if (t > c) return Math.pow(t, 1 / 3);\r\n  else return (1 / 3) * Math.pow(29 / 6, 2) * t + 4 / 29;\r\n}\r\n\r\nexport function xyz2lab(x: number, y: number, z: number): [number, number, number] {\r\n  return [\r\n    116 * f(y / yn) - 16,\r\n    500 * (f(x / xn) - f(y / yn)),\r\n    200 * (f(y / yn) - f(z / zn))\r\n  ]\r\n}\r\n\r\nexport function convertPal(srcPal: number[], conv: (a: number, b: number, c: number) => [number, number, number]): number[] {\r\n  const dst = new Array<number>(256 * 3);\r\n  for (let i = 0; i < 256; i++) {\r\n    const off = i * 3;\r\n    const r = conv(srcPal[off + 0], srcPal[off + 1], srcPal[off + 2]);\r\n    dst[off + 0] = r[0];\r\n    dst[off + 1] = r[1];\r\n    dst[off + 2] = r[2];\r\n  }\r\n  return dst;\r\n}\r\n\r\nexport function labDist(pal: number[], color: number, l: number, a: number, b: number) {\r\n  const off = color * 3;\r\n  const dh = l - pal[off + 0];\r\n  const ds = a - pal[off + 1];\r\n  const dl = b - pal[off + 2];\r\n  return Math.sqrt(dh * dh + ds * ds + dl * dl);\r\n}\r\n\r\nexport function findLab(pal: number[], l: number, a: number, b: number): [number, number, number] {\r\n  let mindist = Number.MAX_VALUE;\r\n  let mindist1 = Number.MAX_VALUE;\r\n  let idx = 0;\r\n  let idx1 = 0;\r\n  for (let i = 0; i < 256; i++) {\r\n    const off = i * 3;\r\n    const dh = l - pal[off + 0];\r\n    const ds = a - pal[off + 1];\r\n    const dl = b - pal[off + 2];\r\n    const dist = Math.sqrt(dh * dh + ds * ds + dl * dl);\r\n    if (dist < mindist) {\r\n      mindist1 = mindist;\r\n      idx1 = idx;\r\n      mindist = dist;\r\n      idx = i;\r\n    }\r\n  }\r\n  return [idx, idx1, mindist / mindist1];\r\n}\r\n\r\nexport function resizeIndexed(dstw: number, dsth: number, srcw: number, srch: number, src: Uint8Array, pal: number[], labpal: number[]): Uint8Array {\r\n  const dst = new Uint8Array(dstw * dsth);\r\n  const dx = srcw / dstw;\r\n  const dy = srch / dsth;\r\n  for (const [x, y] of rect(dstw, dsth))\r\n    dst[y * dstw + x] = convoluteIndexed(x * dx, y * dy, dx, dy, srcw, src, pal, labpal);\r\n  return dst;\r\n}\r\n\r\nexport function convoluteIndexed(x: number, y: number, w: number, h: number, imgw: number, img: Uint8Array, pal: number[], labpal: number[]): number {\r\n  if (w == int(w) && h == int(h) && x == int(x) && y == int(y)) {\r\n    const sum = [0, 0, 0];\r\n    let trans = 0;\r\n    const colors = new Set<number>();\r\n    for (const [xx, yy] of rect(w, h)) {\r\n      const off = (yy + y) * imgw + xx + x;\r\n      const color = img[off] * 3;\r\n      if (color == 255 * 3) {\r\n        trans++;\r\n        if (trans > (w * h) / 2) return 255;\r\n      } else {\r\n        sum[0] += pal[color + 0];\r\n        sum[1] += pal[color + 1];\r\n        sum[2] += pal[color + 2];\r\n        colors.add(color / 3);\r\n      }\r\n    }\r\n    const weight = 1 / (w * h - trans);\r\n    const xyz = rgb2xyz(sum[0] * weight, sum[1] * weight, sum[2] * weight);\r\n    const lab = xyz2lab(xyz[0], xyz[1], xyz[2]);\r\n    let mindist = Number.MAX_VALUE;\r\n    let mindist1 = Number.MAX_VALUE;\r\n    let idx = 0;\r\n    let idx1 = 0;\r\n    for (const color of colors) {\r\n      const dist = labDist(labpal, color, lab[0], lab[1], lab[2]);\r\n      if (mindist > dist) {\r\n        idx1 = idx;\r\n        mindist1 = mindist;\r\n        idx = color;\r\n        mindist = dist;\r\n      }\r\n    }\r\n\r\n    const [i, i1, t] = findLab(labpal, lab[0], lab[1], lab[2]);\r\n    const d = labDist(labpal, i, lab[0], lab[1], lab[2]);\r\n    // return dither(x, y, t, ditherMatrix) ? i : i1;\r\n    return d / mindist < 0.2 ? i : dither(x, y, mindist / mindist1, ditherMatrix) ? idx : idx1;\r\n  } else {\r\n    return img[int(y + h / 2) * imgw + int(x + w / 2)];\r\n  }\r\n}\r\n\r\nfunction scale3resample(x: number, y: number, w: number, h: number, src: Uint8Array): number {\r\n  const px = Math.min(x + 1, w - 1);\r\n  const mx = Math.max(x - 1, 0);\r\n  const py = Math.min(y + 1, h - 1);\r\n  const my = Math.max(y - 1, 0);\r\n\r\n  return 0;\r\n}\r\n\r\nexport const ditherMatrix = [\r\n  0, 32, 8, 40, 2, 34, 10, 42,\r\n  48, 16, 56, 24, 50, 18, 58, 26,\r\n  12, 44, 4, 36, 14, 46, 6, 38,\r\n  60, 28, 52, 20, 62, 30, 54, 22,\r\n  3, 35, 11, 43, 1, 33, 9, 41,\r\n  51, 19, 59, 27, 49, 17, 57, 25,\r\n  15, 47, 7, 39, 13, 45, 5, 37,\r\n  63, 31, 55, 23, 61, 29, 53, 21];\r\n\r\nexport function dither(x: number, y: number, t: number, matrix: number[]): boolean {\r\n  const size = matrix.length;\r\n  const rsize = 1 / size;\r\n  if (t < (0.0 + rsize / 2)) return true;\r\n  if (t > (1.0 - rsize / 2)) return false;\r\n  const sqrsize = Math.sqrt(size);\r\n  const idx = (y % sqrsize) * sqrsize + (x % sqrsize);\r\n  const d = matrix[idx] / (size - 1);\r\n  return t <= d;\r\n}\r\n\r\nexport function rgb2lum(r: number, g: number, b: number): number {\r\n  return r * 0.2126 + g * 0.7152 + b * 0.0722;\r\n}\r\n\r\nexport function scale2x(width: number, height: number, src: Uint8Array): Uint8Array {\r\n  const dst = new Uint8Array(4 * width * height);\r\n  for (const [x, y] of rect(width, height)) {\r\n    const px = Math.min(x + 1, width - 1);\r\n    const mx = Math.max(x - 1, 0);\r\n    const py = Math.min(y + 1, height - 1);\r\n    const my = Math.max(y - 1, 0);\r\n    const b = src[my * width + x];\r\n    const d = src[y * width + mx];\r\n    const e = src[y * width + x];\r\n    const f = src[y * width + px];\r\n    const h = src[py * width + x];\r\n    if (b != h && d != f) {\r\n      dst[y * width * 4 + x * 2] = d == b ? d : e;\r\n      dst[y * width * 4 + x * 2 + 1] = b == f ? f : e;\r\n      dst[(y * 2 + 1) * width * 2 + x * 2] = d == h ? d : e;\r\n      dst[(y * 2 + 1) * width * 2 + x * 2 + 1] = h == f ? f : e;\r\n    } else {\r\n      dst[y * width * 4 + x * 2] =\r\n        dst[y * width * 4 + x * 2 + 1] =\r\n        dst[(y * 2 + 1) * width * 2 + x * 2] =\r\n        dst[(y * 2 + 1) * width * 2 + x * 2 + 1] = e;\r\n    }\r\n  }\r\n  return dst;\r\n}\r\n","\r\nexport const save = (function () {\r\n  const a = document.createElement(\"a\");\r\n  document.body.appendChild(a);\r\n  a.style.display = 'none';\r\n  return function (buffer: ArrayBuffer, fileName: string) {\r\n    const url = window.URL.createObjectURL(new Blob([buffer], { type: \"octet/stream\" }));\r\n    a.href = url;\r\n    a.download = fileName;\r\n    a.click();\r\n    window.URL.revokeObjectURL(url);\r\n    document.body.removeChild(a);\r\n  };\r\n}());\r\n\r\nexport async function saveAs(buffer: ArrayBuffer, fileName: string) {\r\n  const opts = {\r\n    type: 'save-file',\r\n    accepts: [{\r\n      description: 'BUILD Map',\r\n      extensions: ['map'],\r\n    }],\r\n  };\r\n  const handle = await window['chooseFileSystemEntries'](opts);\r\n  const writable = await handle.createWritable();\r\n  await writable.write(buffer);\r\n  await writable.close();\r\n}","export async function loadBin(fname: string): Promise<ArrayBuffer> {\r\n  const r = await fetch(fname);\r\n  return r.ok ? r.arrayBuffer() : null;\r\n}\r\n\r\nexport async function loadString(fname: string): Promise<string> {\r\n  const r = await fetch(fname);\r\n  return r.ok ? r.text() : null;\r\n}\r\n","import * as PROFILE from '../profiler';\r\nimport { VertexBufferDynamic, createVertexBuffer, DynamicIndexBuffer, createIndexBuffer, Updatable } from './bufferimpl';\r\nimport { Place, BagController, createController } from '../bag';\r\n\r\nexport interface Pointer {\r\n  readonly buffer: Buffer,\r\n  readonly vtx: Place,\r\n  readonly idx: Place\r\n}\r\n\r\nclass Pointerimpl implements Pointer {\r\n  constructor(\r\n    readonly buffer: Buffer,\r\n    readonly vtx: Place,\r\n    readonly idx: Place\r\n  ) { }\r\n}\r\n\r\nexport class BufferBuilder {\r\n  public vtxBuffers: VertexBufferDynamic[] = [];\r\n\r\n  constructor(public size: number = 64 * 1024) { }\r\n\r\n  public addVertexBuffer(gl: WebGLRenderingContext, type: number, spacing: number): BufferBuilder {\r\n    this.vtxBuffers.push(createVertexBuffer(gl, type, this.size, spacing));\r\n    return this;\r\n  }\r\n}\r\n\r\ntype Region = [number, number];\r\n\r\nexport class Buffer {\r\n  private vtxBag: BagController;\r\n  private idxBag: BagController;\r\n  public vtxBuffers: VertexBufferDynamic[];\r\n  private idxBuffer: DynamicIndexBuffer;\r\n  private vtxRegions: Region[][] = [];\r\n  private idxRegions: Region[] = [];\r\n  private needUpdate = true;\r\n\r\n  constructor(gl: WebGLRenderingContext, builder: BufferBuilder, readonly blockSize = 1024) {\r\n    let vtxSize = builder.size;\r\n    let idxSize = vtxSize * 2;\r\n    this.vtxBuffers = builder.vtxBuffers;\r\n    this.idxBuffer = createIndexBuffer(gl, gl.UNSIGNED_SHORT, idxSize);\r\n\r\n    this.vtxBag = createController(vtxSize, (place: Place, noffset: number) => {\r\n      for (const v of this.vtxBuffers) {\r\n        let buff = <any>v.getData();\r\n        let spacing = v.getSpacing();\r\n        buff.set(buff.subarray(place.offset * spacing, (place.offset + place.size) * spacing), noffset * spacing);\r\n      }\r\n      let ptr = <Place>place.data;\r\n      let offdiff = noffset - place.offset;\r\n      let idxData = <Uint16Array>this.idxBuffer.getData();\r\n      for (let i = 0; i < ptr.size; i++) {\r\n        idxData[ptr.offset + i] += offdiff;\r\n      }\r\n    });\r\n\r\n    this.idxBag = createController(idxSize, (place: Place, noffset: number) => {\r\n      let idxData = <Uint16Array>this.idxBuffer.getData();\r\n      idxData.set(idxData.subarray(place.offset, place.offset + place.size), noffset);\r\n    });\r\n\r\n    for (let i = 0; i < this.vtxBuffers.length; i++) this.vtxRegions.push([]);\r\n  }\r\n\r\n  public getVertexBuffer(idx: number): VertexBufferDynamic {\r\n    return this.vtxBuffers[idx];\r\n  }\r\n\r\n  public getIndexBuffer(): DynamicIndexBuffer {\r\n    return this.idxBuffer;\r\n  }\r\n\r\n  public allocate(vtxs: number, idxs: number): Pointer {\r\n    let vtx = this.vtxBag.get(vtxs);\r\n    if (vtx == null) return null;\r\n    let idx = this.idxBag.get(idxs);\r\n    if (idx == null) {\r\n      this.vtxBag.put(vtx);\r\n      return null;\r\n    }\r\n    vtx.data = idx;\r\n    return new Pointerimpl(this, vtx, idx);\r\n  }\r\n\r\n  public deallocate(ptr: Pointer): void {\r\n    if (ptr.buffer != this)\r\n      throw new Error('Invalid Buffer for this Pointer');\r\n    this.vtxBag.put(ptr.vtx);\r\n    this.idxBag.put(ptr.idx);\r\n  }\r\n\r\n  public writeVertex(ptr: Pointer, idx: number, off: number, vdata: number[]) {\r\n    let buff = this.vtxBuffers[idx];\r\n    let offset = (ptr.vtx.offset + off) * buff.getSpacing();\r\n    let data = <any>buff.getData();\r\n    for (let i = 0; i < vdata.length; i++) {\r\n      data[offset + i] = vdata[i];\r\n    }\r\n    this.vtxRegions[idx].push([offset / buff.getSpacing(), Math.ceil(vdata.length / buff.getSpacing())]);\r\n    this.needUpdate = true;\r\n  }\r\n\r\n  public writeIndex(ptr: Pointer, off: number, idata: number[]) {\r\n    let buff = this.idxBuffer;\r\n    let offset = ptr.idx.offset + off;\r\n    let vtxoff = ptr.vtx.offset;\r\n    let data = <any>buff.getData();\r\n    for (let i = 0; i < idata.length; i++) {\r\n      data[offset + i] = idata[i] + vtxoff;\r\n    }\r\n    this.idxRegions.push([offset, idata.length]);\r\n    this.needUpdate = true;\r\n  }\r\n\r\n\r\n  private mergeRegions(regions: Region[], i: number): [number, Region] {\r\n    let region = regions[i];\r\n    for (; ;) {\r\n      if (i + 1 >= regions.length)\r\n        break;\r\n      let currentend = region[0] + region[1];\r\n      let nextstart = regions[i + 1][0];\r\n      let diff = nextstart - currentend;\r\n      if (diff < 0 || diff > this.blockSize)\r\n        break;\r\n      region[1] += regions[++i][1] + diff;\r\n    }\r\n    return [i, region];\r\n  }\r\n\r\n  private updateBuffer(gl: WebGLRenderingContext, buffer: Updatable, regions: Region[]): boolean {\r\n    for (let i = 0; i < regions.length; i++) {\r\n      let [ii, region] = this.mergeRegions(regions, i);\r\n      i = ii;\r\n      // PROFILE.get(null).inc('traffic', region[1]);\r\n      // PROFILE.get(null).inc('updates');\r\n      buffer.updateRegion(gl, region[0], region[1]);\r\n    }\r\n    return true;\r\n  }\r\n\r\n  public update(gl: WebGLRenderingContext) {\r\n    if (!this.needUpdate) return;\r\n    for (let v = 0; v < this.vtxBuffers.length; v++) {\r\n      if (this.vtxRegions[v].length == 0)\r\n        continue;\r\n      this.updateBuffer(gl, this.vtxBuffers[v], this.vtxRegions[v]);\r\n      this.vtxRegions[v] = [];\r\n    }\r\n    if (this.idxRegions.length != 0) {\r\n      this.updateBuffer(gl, this.idxBuffer, this.idxRegions);\r\n      this.idxRegions = [];\r\n    }\r\n    this.needUpdate = false;\r\n    // PROFILE.get(null).set('buffer', this.vtxBag.freeSpace(64));\r\n  }\r\n}","import { IndexBuffer, VertexBuffer } from \"./drawstruct\";\r\n\r\nexport class VertexBufferImpl implements VertexBuffer {\r\n  constructor(\r\n    private buffer: WebGLBuffer,\r\n    private type: number,\r\n    private spacing: number = 3,\r\n    private normalized: boolean = false,\r\n    private stride: number = 0,\r\n    private offset: number = 0\r\n  ) { }\r\n\r\n  getBuffer(): WebGLBuffer { return this.buffer }\r\n  getType(): number { return this.type }\r\n  getSpacing(): number { return this.spacing }\r\n  getNormalized(): boolean { return this.normalized }\r\n  getStride(): number { return this.stride }\r\n  getOffset(): number { return this.offset }\r\n}\r\n\r\n\r\nclass IndexBufferImpl implements IndexBuffer {\r\n  constructor(\r\n    private buffer: WebGLBuffer,\r\n    private type: number\r\n  ) { }\r\n\r\n  getBuffer(): WebGLBuffer { return this.buffer }\r\n  getType(): number { return this.type }\r\n}\r\n\r\nexport function genIndexBuffer(gl: WebGLRenderingContext, count: number, pattern: number[]): IndexBuffer {\r\n  const bufIdx = gl.createBuffer();\r\n  const len = pattern.length;\r\n  const size = Math.max.apply(null, pattern) + 1;\r\n  const data = new Uint16Array(count * len);\r\n  for (let i = 0; i < count; i++) {\r\n    const off = i * len;\r\n    const off1 = i * size;\r\n    for (let j = 0; j < len; j++) {\r\n      data[off + j] = off1 + pattern[j];\r\n    }\r\n  }\r\n  gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, bufIdx);\r\n  gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, <ArrayBuffer>data.buffer, gl.STATIC_DRAW);\r\n  return new IndexBufferImpl(bufIdx, gl.UNSIGNED_SHORT);\r\n}\r\n\r\nexport function GlType2ArrayType(glType: number): any {\r\n  switch (glType) {\r\n    case WebGLRenderingContext.BYTE: return Int8Array;\r\n    case WebGLRenderingContext.UNSIGNED_BYTE: return Uint8Array;\r\n    case WebGLRenderingContext.SHORT: return Int16Array;\r\n    case WebGLRenderingContext.UNSIGNED_SHORT: return Uint16Array;\r\n    case WebGLRenderingContext.INT: return Int32Array;\r\n    case WebGLRenderingContext.UNSIGNED_INT: return Uint32Array;\r\n    case WebGLRenderingContext.FLOAT: return Float32Array;\r\n    default: throw new Error('Unknown GL Type: ' + glType);\r\n  }\r\n}\r\n\r\nexport function ArrayType2GlType(arrayType: any): number {\r\n  switch (arrayType) {\r\n    case Int8Array: return WebGLRenderingContext.BYTE;\r\n    case Uint8Array: return WebGLRenderingContext.UNSIGNED_BYTE;\r\n    case Int16Array: return WebGLRenderingContext.SHORT;\r\n    case Uint16Array: return WebGLRenderingContext.UNSIGNED_SHORT;\r\n    case Int32Array: return WebGLRenderingContext.INT;\r\n    case Uint32Array: return WebGLRenderingContext.UNSIGNED_INT;\r\n    case Float32Array: return WebGLRenderingContext.FLOAT;\r\n    default: throw new Error('Unknown Array Type: ' + arrayType);\r\n  }\r\n}\r\n\r\nexport interface Updatable {\r\n  updateRegion(gl: WebGLRenderingContext, offset: number, length: number): void;\r\n}\r\n\r\nexport class VertexBufferDynamic extends VertexBufferImpl implements Updatable {\r\n  private data: ArrayBufferView;\r\n\r\n  constructor(\r\n    gl: WebGLRenderingContext,\r\n    type: number,\r\n    data: ArrayBufferView,\r\n    spacing: number,\r\n    usage: number = WebGLRenderingContext.STREAM_DRAW,\r\n    normalized: boolean = false\r\n  ) {\r\n    super(gl.createBuffer(), type, spacing, normalized, 0, 0);\r\n    this.data = data;\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.getBuffer());\r\n    gl.bufferData(gl.ARRAY_BUFFER, this.data, usage);\r\n  }\r\n\r\n  public getData(): ArrayBufferView {\r\n    return this.data;\r\n  }\r\n\r\n  public update(gl: WebGLRenderingContext): void {\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.getBuffer());\r\n    gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.data);\r\n  }\r\n\r\n  public updateRegion(gl: WebGLRenderingContext, offset: number, length: number): void {\r\n    var sizeof = (<any>this.data).BYTES_PER_ELEMENT * this.getSpacing();\r\n    var region = new Uint8Array(this.data.buffer, offset * sizeof, length * sizeof);\r\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.getBuffer());\r\n    gl.bufferSubData(gl.ARRAY_BUFFER, offset * sizeof, region);\r\n  }\r\n}\r\n\r\nexport class DynamicIndexBuffer extends IndexBufferImpl implements Updatable {\r\n  private data: ArrayBufferView;\r\n\r\n  constructor(\r\n    gl: WebGLRenderingContext,\r\n    data: ArrayBufferView,\r\n    type: number = WebGLRenderingContext.UNSIGNED_SHORT,\r\n    usage: number = WebGLRenderingContext.STREAM_DRAW\r\n  ) {\r\n    super(gl.createBuffer(), type);\r\n    this.data = data;\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.getBuffer());\r\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.data, usage);\r\n  }\r\n\r\n  public update(gl: WebGLRenderingContext, length: number = 0) {\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.getBuffer());\r\n    gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, 0, this.data);\r\n  }\r\n\r\n  public updateRegion(gl: WebGLRenderingContext, offset: number, length: number): void {\r\n    var sizeof = 2;\r\n    var region = new Uint8Array(this.data.buffer, offset * sizeof, length * sizeof);\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.getBuffer());\r\n    gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER, offset * sizeof, region);\r\n  }\r\n\r\n  public getData(): ArrayBufferView { return this.data }\r\n}\r\nexport function createVertexBuffer(gl: WebGLRenderingContext, type: number, data: any, spacing: number, usage: number = WebGLRenderingContext.DYNAMIC_DRAW, norm: boolean = false): VertexBufferDynamic {\r\n  var arrtype = GlType2ArrayType(type);\r\n  if (typeof data == 'number') data = new arrtype(data * spacing)\r\n  else if (arrtype != data.constructor) throw new Error('GL Type and ArrayBuffer is incompatible')\r\n  return new VertexBufferDynamic(gl, type, data, spacing, usage, norm);\r\n}\r\n\r\nexport function wrap(gl: WebGLRenderingContext, data: ArrayBufferView, spacing: number, usage: number = WebGLRenderingContext.STREAM_DRAW, norm: boolean = false): VertexBufferDynamic {\r\n  return new VertexBufferDynamic(gl, ArrayType2GlType(data.constructor), data, spacing, usage, norm);\r\n}\r\n\r\n\r\nexport function createIndexBuffer(gl: WebGLRenderingContext, type: number, data: any, usage: number = WebGLRenderingContext.STREAM_DRAW): DynamicIndexBuffer {\r\n  const arrtype = GlType2ArrayType(type);\r\n  if (typeof data == 'number') data = new arrtype(data);\r\n  else if (arrtype != data.constructor) throw new Error('GL Type and ArrayBuffer is incompatible')\r\n  return new DynamicIndexBuffer(gl, data, type, usage);\r\n}\r\n\r\nexport function wrapIndexBuffer(gl: WebGLRenderingContext, data: ArrayBufferView, usage: number = WebGLRenderingContext.STREAM_DRAW): DynamicIndexBuffer {\r\n  return new DynamicIndexBuffer(gl, data, ArrayType2GlType(data.constructor), usage);\r\n}  ","\r\nexport function createContextFromCanvas(id: string, opts = {}): WebGLRenderingContext {\r\n  let canvas = <HTMLCanvasElement>document.getElementById(id);\r\n  let gl = <WebGLRenderingContext>canvas.getContext('webgl2', opts);\r\n  return gl;\r\n}\r\n\r\nexport function createContext(w: number, h: number, opts = {}): WebGLRenderingContext {\r\n  let canvas: HTMLCanvasElement = document.createElement('canvas');\r\n  canvas.width = w;\r\n  canvas.height = h;\r\n  canvas.id = 'gl';\r\n  let gl = <WebGLRenderingContext>canvas.getContext('webgl2', opts);\r\n\r\n  document.body.appendChild(canvas);\r\n  document.body.style.overflow = 'hidden';\r\n  canvas.style.position = 'absolute';\r\n  return gl;\r\n}\r\n\r\nfunction resize(gl: WebGLRenderingContext) {\r\n  let canvas = <HTMLCanvasElement>gl.canvas;\r\n\r\n  let displayWidth = canvas.clientWidth;\r\n  let displayHeight = canvas.clientHeight;\r\n\r\n  if (canvas.width != displayWidth || canvas.height != displayHeight) {\r\n\r\n    canvas.width = displayWidth;\r\n    canvas.height = displayHeight;\r\n\r\n    gl.viewport(0, 0, canvas.width, canvas.height);\r\n  }\r\n}\r\n\r\nexport function animate(gl: WebGLRenderingContext, callback: (gl: WebGLRenderingContext, time: number) => void) {\r\n  let time = new Date().getTime();\r\n\r\n  function update() {\r\n    resize(gl);\r\n    let now = new Date().getTime();\r\n    callback(gl, (now - time) / 1000);\r\n    requestAnimationFrame(update);\r\n    time = now;\r\n  }\r\n\r\n  update();\r\n}\r\n\r\nlet pixel = new Uint8Array(4);\r\nexport function readId(gl: WebGLRenderingContext, x: number, y: number): number {\r\n  gl.readPixels(x, gl.drawingBufferHeight - y, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixel);\r\n  return pixel[0] | pixel[1] << 8 | pixel[2] << 16 /*| pixel[3]<<24*/;\r\n}\r\n\r\n","import { Definition, Shader } from \"./drawstruct\";\r\nimport { loadString } from \"../getter\";\r\n\r\nexport class ShaderImpl implements Shader {\r\n  private program: WebGLProgram;\r\n  private definitions: Definitions;\r\n\r\n  readonly uniforms: WebGLUniformLocation[] = [];\r\n  readonly attribs: number[] = [];\r\n  readonly uniformIndex: { [index: string]: number } = {};\r\n  readonly attributeIndex: { [index: string]: number } = {};\r\n\r\n  public constructor(gl: WebGLRenderingContext, prog: WebGLProgram, defs: Definitions) {\r\n    this.program = prog;\r\n    this.definitions = defs;\r\n    this.initUniformLocations(gl);\r\n    this.initAttributeLocations(gl);\r\n  }\r\n\r\n  private initUniformLocations(gl: WebGLRenderingContext): void {\r\n    for (let i = 0; i < this.definitions.uniforms.length; i++) {\r\n      let uniform = this.definitions.uniforms[i];\r\n      this.uniformIndex[uniform.name] = i;\r\n      this.uniforms[i] = gl.getUniformLocation(this.program, uniform.name);\r\n    }\r\n  }\r\n\r\n  private initAttributeLocations(gl: WebGLRenderingContext): void {\r\n    for (let i = 0; i < this.definitions.attributes.length; i++) {\r\n      let attrib = this.definitions.attributes[i];\r\n      this.attributeIndex[attrib.name] = i;\r\n      this.attribs[i] = gl.getAttribLocation(this.program, attrib.name);\r\n    }\r\n  }\r\n\r\n  public getUniformLocation(name: string, gl: WebGLRenderingContext): WebGLUniformLocation {\r\n    return this.uniforms[this.uniformIndex[name]];\r\n  }\r\n\r\n  public getAttributeLocation(name: string, gl: WebGLRenderingContext): number {\r\n    return this.attribs[this.attributeIndex[name]];\r\n  }\r\n\r\n  public getProgram(): WebGLProgram {\r\n    return this.program;\r\n  }\r\n\r\n  public getUniforms(): Definition[] {\r\n    return this.definitions.uniforms;\r\n  }\r\n\r\n  public getAttributes(): Definition[] {\r\n    return this.definitions.attributes;\r\n  }\r\n\r\n  public getSamplers(): Definition[] {\r\n    return this.definitions.samplers;\r\n  }\r\n}\r\n\r\nexport async function createShader(gl: WebGLRenderingContext, name: string, defines: string[] = []): Promise<Shader> {\r\n  const deftext = '#version 300 es\\n' + defines.map(d => \"#define \" + d).join(\"\\n\") + \"\\n\";\r\n  return Promise.all([loadString(name + '.vsh'), loadString(name + '.fsh')]).then(([vsh, fsh]) => {\r\n    return Promise.all([preprocess(vsh), preprocess(fsh)]).then(([pvhs, pfsh]) => {\r\n      const program = compileProgram(gl, deftext + pvhs, deftext + pfsh);\r\n      const defs = processShaders(gl, program);\r\n      return new ShaderImpl(gl, program, defs);\r\n    })\r\n  })\r\n}\r\n\r\nfunction compileProgram(gl: WebGLRenderingContext, vsh: string, fsh: string): WebGLProgram {\r\n  const program = gl.createProgram();\r\n  gl.attachShader(program, compileSource(gl, gl.VERTEX_SHADER, vsh));\r\n  gl.attachShader(program, compileSource(gl, gl.FRAGMENT_SHADER, fsh));\r\n  gl.linkProgram(program);\r\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) throw new Error('link error: ' + gl.getProgramInfoLog(program));\r\n  return program;\r\n}\r\n\r\nfunction compileSource(gl: WebGLRenderingContext, type: number, source: string): WebGLShader {\r\n  const shader = gl.createShader(type);\r\n  gl.shaderSource(shader, source);\r\n  gl.compileShader(shader);\r\n  if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) throw new Error('compile error: ' + gl.getShaderInfoLog(shader) + '\\nin source:\\n' + source);\r\n  return shader;\r\n}\r\n\r\nexport class DefinitionImpl implements Definition {\r\n  constructor(\r\n    readonly type: string,\r\n    readonly name: string\r\n  ) { }\r\n}\r\n\r\nexport class Definitions {\r\n  public uniforms: Definition[] = [];\r\n  public attributes: Definition[] = [];\r\n  public samplers: Definition[] = [];\r\n}\r\n\r\n\r\nfunction processShaders(gl: WebGLRenderingContext, program: WebGLProgram): any {\r\n  const defs = new Definitions();\r\n  const attribs = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\r\n  for (let a = 0; a < attribs; a++) {\r\n    const info = gl.getActiveAttrib(program, a);\r\n    defs.attributes.push(convertToDefinition(info));\r\n  }\r\n  const uniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\r\n  for (let u = 0; u < uniforms; u++) {\r\n    const info = gl.getActiveUniform(program, u);\r\n    const def = convertToDefinition(info);\r\n    defs.uniforms.push(def);\r\n    if (def.type == 'sampler2D')\r\n      defs.samplers.push(def);\r\n  }\r\n  return defs;\r\n}\r\n\r\nfunction convertToDefinition(info: WebGLActiveInfo): DefinitionImpl {\r\n  return new DefinitionImpl(type2String(info.type), info.name);\r\n}\r\n\r\nfunction type2String(type: number): string {\r\n  switch (type) {\r\n    case WebGLRenderingContext.SAMPLER_2D: return \"sampler2D\";\r\n    case WebGLRenderingContext.INT: return \"int\";\r\n    case WebGLRenderingContext.FLOAT: return \"float\";\r\n    case WebGLRenderingContext.FLOAT_MAT4: return \"mat4\";\r\n    case WebGLRenderingContext.FLOAT_MAT3: return \"mat3\";\r\n    case WebGLRenderingContext.FLOAT_VEC2: return \"vec2\";\r\n    case WebGLRenderingContext.FLOAT_VEC3: return \"vec3\";\r\n    case WebGLRenderingContext.FLOAT_VEC4: return \"vec4\";\r\n    case WebGLRenderingContext.INT_VEC2: return \"ivec2\";\r\n    case WebGLRenderingContext.INT_VEC3: return \"ivec3\";\r\n    case WebGLRenderingContext.INT_VEC4: return \"ivec4\";\r\n    default: throw new Error('Invalid type: ' + type);\r\n  }\r\n}\r\n\r\nasync function preprocess(shader: string): Promise<string> {\r\n  const lines = shader.split(\"\\n\");\r\n  const includes: Promise<string>[] = [];\r\n  for (let i = 0; i < lines.length; i++) {\r\n    const l = lines[i];\r\n    const m = l.match(/^#include +\"([^\"]+)\"/);\r\n    includes.push(m != null ? loadString(m[1]) : Promise.resolve(l));\r\n  }\r\n  return Promise.all(includes).then(lines => lines.join('\\n'));\r\n}\r\n\r\nconst setters = {\r\n  mat4: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: Float32List) => gl.uniformMatrix4fv(loc, false, val),\r\n  ivec2: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: Int32List) => gl.uniform2iv(loc, val),\r\n  vec2: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: Float32List) => gl.uniform2fv(loc, val),\r\n  vec3: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: Float32List) => gl.uniform3fv(loc, val),\r\n  vec4: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: Float32List) => gl.uniform4fv(loc, val),\r\n  int: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: number) => gl.uniform1i(loc, val),\r\n  float: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: number) => gl.uniform1f(loc, val),\r\n  sampler2D: (gl: WebGLRenderingContext, loc: WebGLUniformLocation, val: number) => gl.uniform1i(loc, val),\r\n}\r\n\r\nexport function setUniform(gl: WebGLRenderingContext, shader: Shader, uniform: Definition, value: any) {\r\n  if (uniform == undefined) return;\r\n  const loc = shader.getUniformLocation(uniform.name, gl);\r\n  const setter = setters[uniform.type];\r\n  if (setter == undefined) throw new Error('Invalid type: ' + uniform.type);\r\n  setter(gl, loc, value);\r\n}\r\n","import * as GLM from '../../libs_js/glmatrix';\r\nimport { Deck, isEmpty } from '../collections';\r\nimport { Buffer } from './buffergl';\r\nimport { Definition, IndexBuffer, Shader, Texture, VertexBuffer } from './drawstruct';\r\nimport * as SHADER from './shaders';\r\nimport { StateValueMatrix, StateValueGeneric, StateValue } from './statevalue';\r\n\r\nfunction createStateValue(type: string, changecb: () => void): StateValue<any> {\r\n  switch (type) {\r\n    case \"mat4\":\r\n    case \"vec3\":\r\n    case \"vec4\":\r\n      return new StateValueMatrix<GLM.Mat4Array>(changecb, GLM[type].create(), GLM[type].exactEquals, GLM[type].copy)\r\n    default:\r\n      return new StateValueGeneric<number>(changecb, 0);\r\n  }\r\n}\r\n\r\nexport class Profile {\r\n  public drawsRequested = 0;\r\n  public drawsMerged = 0;\r\n  public shaderChanges = 0;\r\n  public uniformChanges = 0;\r\n  public textureChanges = 0;\r\n  public bufferChanges = 0;\r\n  public shaderSwaps: { [index: string]: number } = {}\r\n  public uniqTextures = new Set<Texture>();\r\n\r\n  public changeShader(from: string, to: string) {\r\n    const key = `${from}->${to}`;\r\n    const swap = this.shaderSwaps[key];\r\n    this.shaderSwaps[key] = !swap ? 1 : swap + 1;\r\n  }\r\n\r\n  public changeTexture(tex: Texture) {\r\n    this.uniqTextures.add(tex);\r\n  }\r\n\r\n  public reset() {\r\n    this.drawsRequested = 0;\r\n    this.drawsMerged = 0;\r\n    this.shaderChanges = 0;\r\n    this.uniformChanges = 0;\r\n    this.textureChanges = 0;\r\n    this.bufferChanges = 0;\r\n    this.shaderSwaps = {};\r\n    this.uniqTextures.clear()\r\n  }\r\n}\r\n\r\nfunction nextBatch(batch: number) {\r\n  const nb = batch + 0.05;\r\n  return nb > 1.0 ? 0 : nb;\r\n}\r\n\r\nclass ShaderConfig {\r\n  constructor(\r\n    readonly shader: Shader,\r\n    readonly uniforms: number[],\r\n    readonly attribs: number[],\r\n    readonly samplers: [number, number][]\r\n  ) { }\r\n}\r\n\r\nexport class State {\r\n  readonly profile = new Profile();\r\n\r\n  private batchUniform = -1;\r\n  private lastBuffer: Buffer;\r\n\r\n  private shader: StateValue<string> = new StateValueGeneric<string>(() => this.changeShader = true, null);\r\n  private lastShader: string;\r\n  private selectedShader: Shader;\r\n  private indexBuffer: StateValue<IndexBuffer> = new StateValueGeneric<IndexBuffer>(() => this.changeIndexBuffer = true, null);\r\n  private shaders: { [index: string]: ShaderConfig } = {};\r\n\r\n  private states: StateValue<any>[] = [];\r\n  private stateIndex: { [index: string]: number } = {};\r\n\r\n  private attribs: StateValue<VertexBuffer>[] = [];\r\n  private attribNames: string[] = [];\r\n  private attribIndex: { [index: string]: number } = {};\r\n\r\n  private uniforms: StateValue<any>[] = [];\r\n  private uniformDefinitions: Definition[] = [];\r\n  private uniformIndex: { [index: string]: number } = {};\r\n\r\n  private textures: StateValue<Texture>[] = [];\r\n  private textureIndex: { [index: string]: number } = {};\r\n\r\n  private changeShader = true;\r\n  private changeIndexBuffer = true;\r\n  private changedVertexBuffersIds = new Deck<number>();\r\n  private changedTextures = new Deck<[number, number]>();\r\n  private changedUniformIdxs = new Deck<number>();\r\n\r\n  private chainOffset = -1;\r\n  private chainSize = -1;\r\n  private chainMode = -1;\r\n\r\n  constructor() {\r\n    this.registerState('shader', this.shader);\r\n    this.registerState('aIndex', this.indexBuffer);\r\n  }\r\n\r\n  private nextBatch() {\r\n    if (this.batchUniform == -1) {\r\n      this.batchUniform = this.getState('sys');\r\n    }\r\n    const value = [...<GLM.Vec4Array>this.states[this.batchUniform].get()];\r\n    value[3] = nextBatch(value[3])\r\n    this.states[this.batchUniform].set(value);\r\n  }\r\n\r\n  public flush(gl: WebGLRenderingContext, buffer: Buffer = this.lastBuffer) {\r\n    if (this.chainMode == -1) return;\r\n    if (buffer) buffer.update(gl);\r\n    gl.drawElements(this.chainMode, this.chainSize, gl.UNSIGNED_SHORT, this.chainOffset * 2);\r\n    // this.nextBatch();\r\n    this.chainMode = -1;\r\n    this.lastBuffer = null;\r\n  }\r\n\r\n  private tryChain(gl: WebGLRenderingContext, buffer: Buffer, offset: number, size: number, mode: number): boolean {\r\n    if (this.chainMode == -1) {\r\n      this.chainMode = mode;\r\n      this.chainOffset = offset;\r\n      this.chainSize = size;\r\n      this.lastBuffer = buffer;\r\n      return false;\r\n    } else if (this.sameState(mode)) {\r\n      if (this.chainOffset == offset + size) {\r\n        this.chainOffset = offset;\r\n        this.chainSize += size;\r\n        return true;\r\n      } else if (this.chainOffset + this.chainSize == offset) {\r\n        this.chainSize += size;\r\n        return true;\r\n      }\r\n    }\r\n    this.flush(gl);\r\n    return this.tryChain(gl, buffer, offset, size, mode);\r\n  }\r\n\r\n  private sameState(mode: number) {\r\n    return this.chainMode == mode\r\n      && !this.changeShader\r\n      && !this.changeIndexBuffer\r\n      && isEmpty(this.changedUniformIdxs)\r\n      && isEmpty(this.changedTextures)\r\n      && isEmpty(this.changedVertexBuffersIds);\r\n  }\r\n\r\n  private registerUniforms(shader: Shader) {\r\n    const uniforms: number[] = [];\r\n    for (const uniform of shader.getUniforms()) {\r\n      const existedId = this.uniformIndex[uniform.name];\r\n      if (existedId != undefined) {\r\n        uniforms.push(existedId);\r\n        continue;\r\n      }\r\n      const idx = this.uniforms.length;\r\n      const state = createStateValue(uniform.type, () => this.changedUniformIdxs.push(idx));\r\n      if (uniform.type != 'sampler2D') this.registerState(uniform.name, state);\r\n      this.uniforms.push(state);\r\n      this.uniformDefinitions.push(uniform);\r\n      this.uniformIndex[uniform.name] = idx;\r\n      uniforms.push(idx);\r\n    }\r\n    return uniforms;\r\n  }\r\n\r\n  private registerSamplers(shader: Shader) {\r\n    const samplers = shader.getSamplers();\r\n    const shaderSamplers: [number, number][] = [];\r\n    for (let s = 0; s < samplers.length; s++) {\r\n      const sampler = samplers[s];\r\n      const existedId = this.textureIndex[sampler.name];\r\n      if (existedId != undefined) {\r\n        shaderSamplers.push([existedId, s]);\r\n        continue;\r\n      };\r\n      const idx = this.textures.length;\r\n      const key: [number, number] = [idx, s];\r\n      const state = new StateValueGeneric<Texture>(() => this.changedTextures.push(key), null);\r\n      this.registerState(sampler.name, state);\r\n      this.textures.push(state);\r\n      this.textureIndex[sampler.name] = idx;\r\n      shaderSamplers.push(key);\r\n    }\r\n    return shaderSamplers;\r\n  }\r\n\r\n  private registerAttributes(shader: Shader) {\r\n    const attribs: number[] = [];\r\n    for (const attrib of shader.getAttributes()) {\r\n      const existedId = this.attribIndex[attrib.name];\r\n      if (existedId != undefined) {\r\n        attribs.push(existedId);\r\n        continue;\r\n      }\r\n      const idx = this.attribs.length;\r\n      const state = new StateValueGeneric<VertexBuffer>(() => this.changedVertexBuffersIds.push(idx), null);\r\n      this.registerState(attrib.name, state);\r\n      this.attribNames[idx] = attrib.name;\r\n      this.attribs.push(state);\r\n      this.attribIndex[attrib.name] = idx;\r\n      attribs.push(idx);\r\n    }\r\n    return attribs;\r\n  }\r\n\r\n  public registerShader(name: string, shader: Shader) {\r\n    const uniforms = this.registerUniforms(shader);\r\n    const attribs = this.registerAttributes(shader);\r\n    const samplers = this.registerSamplers(shader);\r\n    this.shaders[name] = new ShaderConfig(shader, uniforms, attribs, samplers);\r\n  }\r\n\r\n  private registerState(name: string, state: StateValue<any>) {\r\n    if (this.stateIndex[name] != undefined)\r\n      throw new Error(`Duplicate state name ${name}`);\r\n    const idx = this.states.length;\r\n    this.states.push(state);\r\n    this.stateIndex[name] = idx;\r\n  }\r\n\r\n  public getState(name: string) {\r\n    const idx = this.stateIndex[name];\r\n    if (idx == undefined) throw new Error(`Invalid state name ${name}`);\r\n    return idx;\r\n  }\r\n\r\n  public setUniform(name: string, value: any) {\r\n    this.getUniformValue(name).set(value);\r\n  }\r\n\r\n  public getUniformValue(name: string): StateValue<any> {\r\n    const u = this.uniformIndex[name];\r\n    if (u == undefined) throw new Error('Invalid uniform name: ' + name);\r\n    return this.uniforms[u];\r\n  }\r\n\r\n  public isUniformEnabled(name: string): boolean {\r\n    return this.uniformIndex[name] != undefined;\r\n  }\r\n\r\n  public setShader(name: string) {\r\n    const s = this.shaders[name];\r\n    if (s == undefined) throw new Error('Unknown shader: ' + name);\r\n    this.shader.set(name);\r\n  }\r\n\r\n  public setTexture(name: string, tex: Texture) {\r\n    this.getTextureValue(name).set(tex);\r\n  }\r\n\r\n  public getTextureValue(name: string): StateValue<Texture> {\r\n    const t = this.textureIndex[name];\r\n    if (t == undefined) throw new Error('Invalid sampler name: ' + name);\r\n    return this.textures[t];\r\n  }\r\n\r\n  public setIndexBuffer(b: IndexBuffer) {\r\n    this.indexBuffer.set(b);\r\n  }\r\n\r\n  public setVertexBuffer(name: string, b: VertexBuffer) {\r\n    this.getVertexBufferValue(name).set(b);\r\n  }\r\n\r\n  public getVertexBufferValue(name: string): StateValue<VertexBuffer> {\r\n    const a = this.attribIndex[name];\r\n    if (a == undefined) throw new Error(`Invalid attribute name ${name}`);\r\n    return this.attribs[a];\r\n  }\r\n\r\n  private rebindShader(gl: WebGLRenderingContext) {\r\n    if (!this.changeShader) return;\r\n    ++this.profile.shaderChanges;\r\n    const newShader = this.shader.get();\r\n    this.profile.changeShader(this.lastShader, newShader);\r\n    this.lastShader = newShader;\r\n    const shaderConfig = this.shaders[newShader];\r\n    const shader = shaderConfig.shader;\r\n    this.selectedShader = shader;\r\n    gl.useProgram(shader.getProgram());\r\n\r\n    const samplers = shader.getSamplers();\r\n    for (let s = 0; s < samplers.length; s++) {\r\n      const sampler = samplers[s];\r\n      this.setUniform(sampler.name, s);\r\n    }\r\n\r\n    this.changedUniformIdxs.clear().pushAll(shaderConfig.uniforms);\r\n    this.changedVertexBuffersIds.clear().pushAll(shaderConfig.attribs);\r\n    this.changedTextures.clear().pushAll(shaderConfig.samplers);\r\n    this.changeShader = false;\r\n    this.changeIndexBuffer = true;\r\n  }\r\n\r\n  private rebindVertexBuffers(gl: WebGLRenderingContext) {\r\n    if (isEmpty(this.changedVertexBuffersIds)) return;\r\n    const vertexBufferIdxs = this.changedVertexBuffersIds;\r\n    const len = vertexBufferIdxs.length();\r\n    const shader = this.selectedShader;\r\n    for (let a = 0; a < len; a++) {\r\n      const idx = vertexBufferIdxs.get(a);\r\n      const buf = this.attribs[idx];\r\n      const vbuf = buf.get();\r\n      const location = shader.getAttributeLocation(this.attribNames[idx], gl);\r\n      if (location == -1)\r\n        continue;\r\n      gl.bindBuffer(gl.ARRAY_BUFFER, vbuf.getBuffer());\r\n      gl.enableVertexAttribArray(location);\r\n      gl.vertexAttribPointer(location, vbuf.getSpacing(), vbuf.getType(), vbuf.getNormalized(), vbuf.getStride(), vbuf.getOffset());\r\n    }\r\n    vertexBufferIdxs.clear();\r\n  }\r\n\r\n  private rebindIndexBuffer(gl: WebGLRenderingContext) {\r\n    if (!this.changeIndexBuffer) return;\r\n    ++this.profile.bufferChanges;\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer.get().getBuffer());\r\n    this.changeIndexBuffer = false;\r\n  }\r\n\r\n  private rebindTextures(gl: WebGLRenderingContext) {\r\n    if (isEmpty(this.changedTextures)) return;\r\n    const textures = this.changedTextures;\r\n    const len = textures.length();\r\n    this.profile.textureChanges += len;\r\n    for (let t = 0; t < len; t++) {\r\n      const [idx, sampler] = textures.get(t);\r\n      const texture = this.textures[idx];\r\n      if (texture != undefined && texture.get() != null) {\r\n        this.profile.changeTexture(texture.get());\r\n        gl.activeTexture(gl.TEXTURE0 + sampler);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture.get().get());\r\n      }\r\n    }\r\n    textures.clear();\r\n  }\r\n\r\n  private updateUniforms(gl: WebGLRenderingContext) {\r\n    if (isEmpty(this.changedUniformIdxs)) return;\r\n    const uniformsIdxs = this.changedUniformIdxs;\r\n    const len = uniformsIdxs.length();\r\n    this.profile.uniformChanges += len;\r\n    for (let u = 0; u < len; u++) {\r\n      const idx = uniformsIdxs.get(u);\r\n      const state = this.uniforms[idx];\r\n      SHADER.setUniform(gl, this.selectedShader, this.uniformDefinitions[idx], state.get());\r\n    }\r\n    uniformsIdxs.clear();\r\n  }\r\n\r\n  public draw(gl: WebGLRenderingContext, buffer: Buffer, offset: number, size: number, mode: number = gl.TRIANGLES) {\r\n    ++this.profile.drawsRequested;\r\n    if (this.tryChain(gl, buffer, offset, size, mode)) {\r\n      ++this.profile.drawsMerged;\r\n      return;\r\n    }\r\n    this.rebindShader(gl);\r\n    this.rebindVertexBuffers(gl);\r\n    this.rebindIndexBuffer(gl);\r\n    this.updateUniforms(gl);\r\n    this.rebindTextures(gl);\r\n  }\r\n\r\n  public run(gl: WebGLRenderingContext, call: DrawCall) {\r\n    const values = call.values;\r\n    const size = call.values.length;\r\n    for (let i = 0; i < size; i += 2) {\r\n      const idx = values[i];\r\n      const value = values[i + 1];\r\n      this.states[idx].set(value);\r\n    }\r\n    this.draw(gl, call.buffer, call.offset, call.size, call.mode)\r\n  }\r\n}\r\n\r\nexport class DrawCall {\r\n  constructor(\r\n    readonly values: any[],\r\n    readonly buffer: Buffer,\r\n    readonly offset: number,\r\n    readonly size: number,\r\n    readonly mode: number,\r\n    readonly hint: number,\r\n    readonly kind: number,\r\n  ) { }\r\n}\r\n","\r\nexport interface StateValue<T> {\r\n  get(): T;\r\n  set(v: T): void;\r\n}\r\n\r\nexport class StateValueGeneric<T> implements StateValue<T>{\r\n  constructor(\r\n    private changecb: () => void,\r\n    public value: T,\r\n  ) { }\r\n  get(): T { return this.value; }\r\n  set(v: T) {\r\n    if (v !== this.value) {\r\n      this.value = v;\r\n      this.changecb()\r\n    }\r\n  }\r\n}\r\n\r\nexport class StateValueMatrix<T> {\r\n  constructor(\r\n    private changecb: () => void,\r\n    public value: T,\r\n    public cmp: (lh: T, rh: T) => boolean,\r\n    public setter: (dst: T, src: T) => T\r\n  ) { }\r\n  get(): T { return this.value; }\r\n  set(v: T) {\r\n    if (!this.cmp(v, this.value)) {\r\n      this.setter(this.value, v);\r\n      this.changecb();\r\n    }\r\n  }\r\n}","import * as DS from './drawstruct';\r\n\r\nexport class TextureStub implements DS.Texture {\r\n  constructor(public w: number, public h: number) { }\r\n  public get(): WebGLTexture { return null }\r\n  public getWidth(): number { return this.w }\r\n  public getHeight(): number { return this.h }\r\n  public getFormat(): number { return null }\r\n  public getType(): number { return null }\r\n}\r\n\r\nfunction getMagFilter(filter: number): number {\r\n  switch (filter) {\r\n    case WebGLRenderingContext.NEAREST:\r\n    case WebGLRenderingContext.NEAREST_MIPMAP_LINEAR:\r\n    case WebGLRenderingContext.NEAREST_MIPMAP_NEAREST:\r\n      return WebGLRenderingContext.NEAREST;\r\n    case WebGLRenderingContext.LINEAR:\r\n    case WebGLRenderingContext.LINEAR_MIPMAP_LINEAR:\r\n    case WebGLRenderingContext.LINEAR_MIPMAP_NEAREST:\r\n      return WebGLRenderingContext.LINEAR;\r\n  }\r\n}\r\n\r\nexport class TextureImpl implements DS.Texture {\r\n\r\n  public id: WebGLTexture;\r\n  public width: number;\r\n  public height: number;\r\n  private format: number;\r\n  private type: number;\r\n  public data: Uint8Array;\r\n\r\n  constructor(width: number, height: number, gl: WebGLRenderingContext, options: any = {}, img: Uint8Array = null, format: number = gl.RGBA, bpp: number = 4) {\r\n    this.id = gl.createTexture();\r\n    this.width = width;\r\n    this.height = height;\r\n    this.format = format;\r\n    this.type = gl.UNSIGNED_BYTE;\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, getMagFilter(options.filter || gl.NEAREST));\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, options.filter || gl.NEAREST);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, options.repeat || gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, options.repeat || gl.CLAMP_TO_EDGE);\r\n\r\n    if (options.aniso) {\r\n      let ext = gl.getExtension('EXT_texture_filter_anisotropic');\r\n      let max = gl.getParameter(ext.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\r\n      gl.texParameterf(gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, max);\r\n    }\r\n\r\n\r\n    if (img == null)\r\n      img = new Uint8Array(width * height * bpp);\r\n    this.data = img;\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, this.type, this.data);\r\n\r\n    gl.bindTexture(gl.TEXTURE_2D, null);\r\n  }\r\n\r\n  public get(): WebGLTexture {\r\n    return this.id;\r\n  }\r\n\r\n  public getWidth(): number {\r\n    return this.width;\r\n  }\r\n\r\n  public getHeight(): number {\r\n    return this.height;\r\n  }\r\n\r\n  public getFormat(): number {\r\n    return this.format;\r\n  }\r\n\r\n  public getType(): number {\r\n    return this.type;\r\n  }\r\n\r\n  public reload(gl: WebGLRenderingContext): void {\r\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, 0, 0, this.width, this.height, this.getFormat(), this.getType(), this.data);\r\n  }\r\n\r\n  public mip(gl: WebGLRenderingContext, level: number, width: number, height: number, data: Uint8Array) {\r\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    gl.texImage2D(gl.TEXTURE_2D, level, this.format, width, height, 0, this.format, this.type, data);\r\n    gl.bindTexture(gl.TEXTURE_2D, null);\r\n  }\r\n}\r\n\r\nexport function createTexture(width: number, height: number, gl: WebGLRenderingContext, options: any = {}, img: Uint8Array = null, format: number = gl.RGBA, bpp: number = 4) {\r\n  return new TextureImpl(width, height, gl, options, img, format, bpp);\r\n}\r\n\r\nexport class DrawTexture extends TextureImpl {\r\n\r\n  constructor(width: number, height: number, gl: WebGLRenderingContext, options: any = {}, img: Uint8Array = null, format: number = gl.RGBA, bpp: number = 4) {\r\n    super(width, height, gl, options, img, format, bpp);\r\n  }\r\n\r\n  public putPixel(x: number, y: number, pixel: Uint8Array, gl: WebGLRenderingContext): void {\r\n    if (x < 0 || x >= this.width || y < 0 || y >= this.height)\r\n      return;\r\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, x, y, 1, 1, this.getFormat(), this.getType(), pixel);\r\n  }\r\n\r\n  public putSubImage(x: number, y: number, w: number, h: number, img: ArrayBufferView, gl: WebGLRenderingContext): void {\r\n    gl.bindTexture(gl.TEXTURE_2D, this.id);\r\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, x, y, w, h, this.getFormat(), this.getType(), img);\r\n  }\r\n}\r\n\r\nexport function createDrawTexture(width: number, height: number, gl: WebGLRenderingContext, options: any = {}, img: Uint8Array = null, format: number = gl.RGBA, bpp: number = 4) {\r\n  return new DrawTexture(width, height, gl, options, img, format, bpp);\r\n}\r\n\r\nexport class RenderTexture extends TextureImpl {\r\n\r\n  private framebuffer: WebGLFramebuffer;\r\n  private renderbuffer: WebGLRenderbuffer;\r\n\r\n  constructor(width: number, height: number, gl: WebGLRenderingContext, options: any = {}, img: Uint8Array = null) {\r\n    super(width, height, gl, options, img);\r\n    this.framebuffer = gl.createFramebuffer();\r\n    this.renderbuffer = gl.createRenderbuffer();\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderbuffer);\r\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, this.getWidth(), this.getHeight());\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n  }\r\n\r\n  public drawTo(gl: WebGLRenderingContext, callback: (WebGLRenderingContext) => void): Uint8Array {\r\n    let v = gl.getParameter(gl.VIEWPORT);\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, this.framebuffer);\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, this.renderbuffer);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.id, 0);\r\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, this.renderbuffer);\r\n    gl.viewport(0, 0, this.getWidth(), this.getHeight());\r\n\r\n    callback(gl);\r\n\r\n    gl.readPixels(0, 0, this.getWidth(), this.getHeight(), gl.RGBA, gl.UNSIGNED_BYTE, this.data);\r\n\r\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n    gl.viewport(v[0], v[1], v[2], v[3]);\r\n\r\n    return this.data;\r\n  }\r\n}\r\n\r\nexport function createRenderTexture(width: number, height: number, gl: WebGLRenderingContext, options: any = {}, img: Uint8Array = null) {\r\n  return new RenderTexture(width, height, gl, options, img);\r\n}","import { Dependency, Injector } from \"./injector\";\r\nimport { RAW_PAL } from \"../app/modules/artselector\";\r\n// import init, { ImgLib } from \"../libs_js/wasm_lib\";\r\nimport { convertPal, rgb2xyz, xyz2lab, resizeIndexed, findLab } from \"./color\";\r\nimport { rect } from \"./collections\";\r\n\r\nexport interface IndexedImgLib {\r\n  palettize(w: number, h: number, img: Uint8Array): Uint8Array;\r\n  resize(dstw: number, dsth: number, srcw: number, srch: number, src: Uint8Array): Uint8Array;\r\n}\r\n\r\nexport const INDEXED_IMG_LIB = new Dependency<IndexedImgLib>('IndexedImgLib');\r\n\r\n// export async function IndexedImgLibWasmConstructor(injector: Injector): Promise<IndexedImgLib> {\r\n//   const pal = await injector.getInstance(RAW_PAL);\r\n//   await init();\r\n//   let lib = ImgLib.init(pal, 256, 255);\r\n//   return {\r\n//     palettize: (w: number, h: number, img: Uint8Array) => {\r\n//       const dst = new Uint8Array(w * h);\r\n//       lib.palettize(w, h, img, dst);\r\n//       return dst;\r\n//     },\r\n//     resize: (dstw: number, dsth: number, srcw: number, srch: number, src: Uint8Array) => {\r\n//       const dst = new Uint8Array(dstw * dsth);\r\n//       lib.resize(dstw, dsth, dst, srcw, srch, src);\r\n//       return dst;\r\n//     }\r\n//   }\r\n// }\r\n\r\nexport async function IndexedImgLibJsConstructor(injector: Injector): Promise<IndexedImgLib> {\r\n  const pal = [...await injector.getInstance(RAW_PAL)];\r\n  const xyzpal = convertPal(pal, rgb2xyz);\r\n  const labpal = convertPal(xyzpal, xyz2lab);\r\n  return {\r\n    palettize: (w: number, h: number, img: Uint8Array) => {\r\n      const dst = new Uint8Array(w * h);\r\n      for (const [x, y] of rect(w, h)) {\r\n        const idx = y * w + x;\r\n        const r = img[idx * 4];\r\n        const g = img[idx * 4 + 1];\r\n        const b = img[idx * 4 + 2];\r\n        const xyz = rgb2xyz(r, g, b);\r\n        const lab = xyz2lab(xyz[0], xyz[1], xyz[2]);\r\n        dst[idx] = findLab(labpal, lab[0], lab[1], lab[2])[0];\r\n      }\r\n      return dst;\r\n    },\r\n    resize: (dstw: number, dsth: number, srcw: number, srch: number, src: Uint8Array) => {\r\n      return resizeIndexed(dstw, dsth, srcw, srch, src, pal, labpal);\r\n    }\r\n  }\r\n}","import { PixelProvider, BlendFunc, BlendNormal } from \"./pixelprovider\";\r\n\r\nexport function createEmptyCanvas(width: number, height: number): HTMLCanvasElement {\r\n  const canvas: HTMLCanvasElement = document.createElement('canvas');\r\n  canvas.width = width;\r\n  canvas.height = height;\r\n  return canvas;\r\n}\r\n\r\nexport function createCanvas(provider: PixelProvider, blend: BlendFunc = BlendNormal): HTMLCanvasElement {\r\n  const canvas: HTMLCanvasElement = document.createElement('canvas');\r\n  canvas.width = provider.getWidth();\r\n  canvas.height = provider.getHeight();\r\n  drawToCanvas(provider, canvas.getContext('2d'), 0, 0, blend);\r\n  return canvas;\r\n}\r\n\r\nexport function drawToCanvas(provider: PixelProvider, ctx: CanvasRenderingContext2D, x: number = 0, y: number = 0, blend: BlendFunc = BlendNormal) {\r\n  let data: Uint8ClampedArray;\r\n  let id: ImageData;\r\n  if (blend === BlendNormal) {\r\n    data = new Uint8ClampedArray(provider.getWidth() * provider.getHeight() * 4);\r\n    id = new ImageData(data, provider.getWidth(), provider.getHeight());\r\n  } else {\r\n    id = ctx.getImageData(x, y, provider.getWidth(), provider.getHeight());\r\n    data = id.data;\r\n  }\r\n  provider.render(data, blend);\r\n  ctx.putImageData(id, x, y);\r\n}\r\n\r\nexport function clearCanvas(canvas: HTMLCanvasElement, style: string) {\r\n  const ctx = canvas.getContext('2d');\r\n  ctx.fillStyle = style;\r\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\nexport function loadImageFromBuffer(buff: ArrayBuffer): Promise<[number, number, Uint8Array]> {\r\n  return new Promise(resolve => {\r\n    const blob = new Blob([buff]);\r\n    const urlCreator = window.URL;\r\n    const imageUrl = urlCreator.createObjectURL(blob);\r\n    const img = new Image();\r\n    img.src = imageUrl;\r\n    img.onload = (evt) => {\r\n      const img = <HTMLImageElement>evt.target;\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n      const ctx = canvas.getContext('2d');\r\n      ctx.drawImage(img, 0, 0);\r\n      const data = new Uint8Array(ctx.getImageData(0, 0, img.width, img.height).data);\r\n      resolve([img.width, img.height, data]);\r\n    }\r\n  });\r\n}\r\n\r\nexport function loadImage(name: string): Promise<[number, number, Uint8Array]> {\r\n  return new Promise(resolve => {\r\n    const image = new Image();\r\n    image.src = name;\r\n    image.onload = (evt) => {\r\n      const img = <HTMLImageElement>evt.target;\r\n      const canvas = document.createElement('canvas');\r\n      canvas.width = img.width;\r\n      canvas.height = img.height;\r\n      const ctx = canvas.getContext('2d');\r\n      ctx.drawImage(img, 0, 0);\r\n      resolve([img.width, img.height, new Uint8Array(ctx.getImageData(0, 0, img.width, img.height).data)]);\r\n    }\r\n  });\r\n}\r\n","\r\nexport class Dependency<T> { constructor(readonly name: string, readonly multi = false) { } }\r\nexport type InstanceProvider<T> = (injector: Injector) => Promise<T>;\r\nexport type SubModule = (module: Module) => void;\r\n\r\nexport class CircularDependencyError extends Error {\r\n  constructor(readonly dependencies: string[]) { super() }\r\n  get message() { return 'Circular dependency detected while trying to resolve ' + this.dependencies.join(' -> ') }\r\n  name = 'CircularDependencyError'\r\n  stack = super.stack\r\n}\r\n\r\nexport interface Module {\r\n  bind<T>(dependency: Dependency<T | T[]>, provider: InstanceProvider<T>): void;\r\n  bindInstance<T>(dependency: Dependency<T>, instance: T): void;\r\n  install(submodule: SubModule): void;\r\n  execute(executable: (injector: Injector) => void): void;\r\n}\r\n\r\nexport interface Injector {\r\n  getInstance<T>(dependency: Dependency<T>): Promise<T>;\r\n}\r\n\r\ninterface ParentInjector extends Injector {\r\n  getInstanceParent<T>(dependency: Dependency<T>, injector: Injector): Promise<T>;\r\n}\r\n\r\nclass ChildInjector<T> implements ParentInjector {\r\n  constructor(readonly dependency: Dependency<T>, readonly parent: ParentInjector) { }\r\n  getInstanceParent<T>(dependency: Dependency<T>, injector: Injector): Promise<T> { return this.parent.getInstanceParent(dependency, injector) }\r\n  getInstance<T>(dependency: Dependency<T>): Promise<T> { return this.parent.getInstanceParent(dependency, this) }\r\n}\r\n\r\nclass DependencyNode {\r\n  readonly dependencies = new Set<DependencyNode>();\r\n  constructor(readonly label: string) { };\r\n}\r\n\r\nclass Graph {\r\n  private nodes = new Map<string, DependencyNode>();\r\n\r\n  private ensureNode(label: string) {\r\n    let node = this.nodes.get(label);\r\n    if (node == undefined) {\r\n      node = new DependencyNode(label);\r\n      this.nodes.set(label, node);\r\n    }\r\n    return node;\r\n  }\r\n\r\n  public add(o: string, i: string) {\r\n    this.ensureNode(o).dependencies.add(this.ensureNode(i));\r\n  }\r\n\r\n  public checkCycles() {\r\n    const colors = new Map<string, string>();\r\n    const paint = function (node: DependencyNode) {\r\n      colors.set(node.label, 'gray');\r\n      for (const child of node.dependencies) {\r\n        const c = colors.get(child.label);\r\n        if (c == undefined) {\r\n          try { paint(child) } catch (e) {\r\n            if (e instanceof CircularDependencyError) e.dependencies.unshift(child.label);\r\n            throw e;\r\n          }\r\n        }\r\n        else if (c == 'gray') throw new CircularDependencyError([child.label]);\r\n      }\r\n      colors.set(node.label, 'black');\r\n    }\r\n    for (const [label, node] of this.nodes) {\r\n      if (colors.has(label)) continue;\r\n      paint(node);\r\n    }\r\n  }\r\n}\r\n\r\nexport class RootModule implements Module {\r\n  private providers = new Map<Dependency<any>, InstanceProvider<any>[]>();\r\n  private promises = new Map<Dependency<any>, Promise<any>>();\r\n  private executables: ((injector: Injector) => void)[] = [];\r\n\r\n  public bind<T>(dependency: Dependency<T | T[]>, provider: InstanceProvider<T>): void {\r\n    let p = this.providers.get(dependency);\r\n    if (dependency.multi) {\r\n      if (p == undefined) {\r\n        p = [];\r\n        this.providers.set(dependency, p);\r\n      }\r\n      p.push(provider);\r\n    } else {\r\n      if (p != undefined) throw new Error(`Multiple bindings to dependency ${dependency.name}`);\r\n      this.providers.set(dependency, [provider]);\r\n    }\r\n  }\r\n\r\n  public bindInstance<T>(dependency: Dependency<T>, instance: T) {\r\n    this.promises.set(dependency, Promise.resolve(instance));\r\n  }\r\n\r\n  public install(submodule: SubModule) {\r\n    submodule(this);\r\n  }\r\n\r\n  execute(executable: (injector: Injector) => void): void {\r\n    this.executables.push(executable);\r\n  }\r\n\r\n  public start() {\r\n    const injector = new RootInjector(this.providers, this.promises);\r\n    for (const e of this.executables) e(injector);\r\n  }\r\n}\r\n\r\n\r\nclass RootInjector implements ParentInjector {\r\n  private graph: Graph = new Graph();\r\n\r\n  constructor(\r\n    private providers: Map<Dependency<any>, InstanceProvider<any>[]>,\r\n    private promises: Map<Dependency<any>, Promise<any>>\r\n  ) { }\r\n\r\n  private add<T>(dependency: Dependency<T>, injector: Injector) {\r\n    const chain = [dependency.name];\r\n    let current = injector;\r\n    while (current instanceof ChildInjector) {\r\n      chain.unshift(current.dependency.name);\r\n      current = current.parent;\r\n    }\r\n    for (let i = 0; i < chain.length - 1; i++) this.graph.add(chain[i], chain[i + 1]);\r\n    this.graph.checkCycles();\r\n  }\r\n\r\n  public getInstanceParent<T>(dependency: Dependency<T>, injector: ParentInjector): Promise<T> {\r\n    this.add(dependency, injector);\r\n    let instance = this.promises.get(dependency);\r\n    if (instance == undefined) {\r\n      instance = this.create(dependency, injector);\r\n      this.promises.set(dependency, instance);\r\n    }\r\n    return instance;\r\n  }\r\n\r\n  public getInstance<T>(dependency: Dependency<T>): Promise<T> {\r\n    return this.getInstanceParent(dependency, this);\r\n  }\r\n\r\n  private create<T>(dependency: Dependency<T>, parent: ParentInjector) {\r\n    const provider = this.providers.get(dependency);\r\n    if (provider == null) throw new Error(`No provider bound to ${dependency.name}`);\r\n    const injector = new ChildInjector(dependency, parent);\r\n    return dependency.multi\r\n      ? Promise.all(provider.map(p => p(injector)))\r\n      : provider[0](injector);\r\n  }\r\n}\r\n\r\nexport async function create<T, D1, D2, D3, D4, D5, D6, D7, D8>(i: Injector, ctr: { new(d1: D1, d2?: D2, d3?: D3, d4?: D4, d5?: D5, d6?: D6, d7?: D7, d8?: D8): T },\r\n  d1: Dependency<D1>, d2?: Dependency<D2>, d3?: Dependency<D3>, d4?: Dependency<D4>, d5?: Dependency<D5>, d6?: Dependency<D6>, d7?: Dependency<D7>, d8?: Dependency<D8>): Promise<T> {\r\n  if (d8 != undefined) return create8(i, ctr, d1, d2, d3, d4, d5, d6, d7, d8);\r\n  if (d7 != undefined) return create7(i, ctr, d1, d2, d3, d4, d5, d6, d7);\r\n  if (d6 != undefined) return create6(i, ctr, d1, d2, d3, d4, d5, d6);\r\n  if (d5 != undefined) return create5(i, ctr, d1, d2, d3, d4, d5);\r\n  if (d4 != undefined) return create4(i, ctr, d1, d2, d3, d4);\r\n  if (d3 != undefined) return create3(i, ctr, d1, d2, d3);\r\n  if (d2 != undefined) return create2(i, ctr, d1, d2);\r\n  if (d1 != undefined) return create1(i, ctr, d1);\r\n  throw new Error('Invalid create usage');\r\n}\r\n\r\nasync function create8<T, D1, D2, D3, D4, D5, D6, D7, D8>(i: Injector, ctr: { new(d1: D1, d2: D2, d3: D3, d4: D4, d5: D5, d6: D6, d7: D7, d8: D8): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>, d3: Dependency<D3>, d4: Dependency<D4>, d5: Dependency<D5>, d6: Dependency<D6>, d7: Dependency<D7>, d8: Dependency<D8>): Promise<T> {\r\n  const [i1, i2, i3, i4, i5, i6, i7, i8] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n    i.getInstance(d3),\r\n    i.getInstance(d4),\r\n    i.getInstance(d5),\r\n    i.getInstance(d6),\r\n    i.getInstance(d7),\r\n    i.getInstance(d8),\r\n  ]);\r\n  return new ctr(i1, i2, i3, i4, i5, i6, i7, i8);\r\n}\r\n\r\nasync function create7<T, D1, D2, D3, D4, D5, D6, D7>(i: Injector, ctr: { new(d1: D1, d2: D2, d3: D3, d4: D4, d5: D5, d6: D6, d7: D7): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>, d3: Dependency<D3>, d4: Dependency<D4>, d5: Dependency<D5>, d6: Dependency<D6>, d7: Dependency<D7>): Promise<T> {\r\n  const [i1, i2, i3, i4, i5, i6, i7] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n    i.getInstance(d3),\r\n    i.getInstance(d4),\r\n    i.getInstance(d5),\r\n    i.getInstance(d6),\r\n    i.getInstance(d7),\r\n  ]);\r\n  return new ctr(i1, i2, i3, i4, i5, i6, i7);\r\n}\r\n\r\nasync function create6<T, D1, D2, D3, D4, D5, D6>(i: Injector, ctr: { new(d1: D1, d2: D2, d3: D3, d4: D4, d5: D5, d6: D6): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>, d3: Dependency<D3>, d4: Dependency<D4>, d5: Dependency<D5>, d6: Dependency<D6>): Promise<T> {\r\n  const [i1, i2, i3, i4, i5, i6] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n    i.getInstance(d3),\r\n    i.getInstance(d4),\r\n    i.getInstance(d5),\r\n    i.getInstance(d6),\r\n  ]);\r\n  return new ctr(i1, i2, i3, i4, i5, i6);\r\n}\r\n\r\nasync function create5<T, D1, D2, D3, D4, D5>(i: Injector, ctr: { new(d1: D1, d2: D2, d3: D3, d4: D4, d5: D5): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>, d3: Dependency<D3>, d4: Dependency<D4>, d5: Dependency<D5>): Promise<T> {\r\n  const [i1, i2, i3, i4, i5] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n    i.getInstance(d3),\r\n    i.getInstance(d4),\r\n    i.getInstance(d5),\r\n  ]);\r\n  return new ctr(i1, i2, i3, i4, i5);\r\n}\r\n\r\nasync function create4<T, D1, D2, D3, D4>(i: Injector, ctr: { new(d1: D1, d2: D2, d3: D3, d4: D4): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>, d3: Dependency<D3>, d4: Dependency<D4>): Promise<T> {\r\n  const [i1, i2, i3, i4] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n    i.getInstance(d3),\r\n    i.getInstance(d4),\r\n  ]);\r\n  return new ctr(i1, i2, i3, i4);\r\n}\r\n\r\nasync function create3<T, D1, D2, D3>(i: Injector, ctr: { new(d1: D1, d2: D2, d3: D3): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>, d3: Dependency<D3>): Promise<T> {\r\n  const [i1, i2, i3] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n    i.getInstance(d3),\r\n  ]);\r\n  return new ctr(i1, i2, i3);\r\n}\r\n\r\nasync function create2<T, D1, D2>(i: Injector, ctr: { new(d1: D1, d2: D2): T },\r\n  d1: Dependency<D1>, d2: Dependency<D2>): Promise<T> {\r\n  const [i1, i2] = await Promise.all([\r\n    i.getInstance(d1),\r\n    i.getInstance(d2),\r\n  ]);\r\n  return new ctr(i1, i2);\r\n}\r\n\r\nasync function create1<T, D1>(i: Injector, ctr: { new(d1: D1): T },\r\n  d1: Dependency<D1>): Promise<T> {\r\n  const i1 = await i.getInstance(d1);\r\n  return new ctr(i1);\r\n}","\r\nexport interface InputState {\r\n  readonly keys: { [index: string]: boolean };\r\n  readonly keysPress: { [index: string]: boolean };\r\n  readonly mouseButtons: [boolean, boolean, boolean];\r\n  readonly mouseClicks: [boolean, boolean, boolean];\r\n  readonly mouseX: number;\r\n  readonly mouseY: number;\r\n  readonly wheel: number;\r\n}\r\n\r\nlet named = {\r\n  8: 'BACKSPACE',\r\n  9: 'TAB',\r\n  13: 'ENTER',\r\n  16: 'SHIFT',\r\n  27: 'ESCAPE',\r\n  32: 'SPACE',\r\n  37: 'LEFT',\r\n  38: 'UP',\r\n  39: 'RIGHT',\r\n  40: 'DOWN',\r\n  45: 'INSERT',\r\n  46: 'DELETE'\r\n};\r\n\r\nfunction mapKeyCode(code: number): string {\r\n  return named[code] || (code >= 65 && code <= 90 ? String.fromCharCode(code) : null);\r\n}\r\n\r\nconst state = {\r\n  keys: {},\r\n  keysPress: {},\r\n  mouseButtons: <[boolean, boolean, boolean]>[false, false, false],\r\n  mouseClicks: <[boolean, boolean, boolean]>[false, false, false],\r\n  mouseX: 0,\r\n  mouseY: 0,\r\n  wheel: 0\r\n}\r\n\r\nexport function postFrame() {\r\n  state.wheel = 0;\r\n  state.mouseClicks[0] = false;\r\n  state.mouseClicks[1] = false;\r\n  state.mouseClicks[2] = false;\r\n  state.keysPress = {};\r\n}\r\n\r\nexport function bind(canvas: HTMLCanvasElement) {\r\n  canvas.addEventListener('mousemove', (e: MouseEvent) => mousemove(e));\r\n  canvas.addEventListener('mouseup', (e: MouseEvent) => mouseup(e));\r\n  canvas.addEventListener('mousedown', (e: MouseEvent) => mousedown(e));\r\n  canvas.addEventListener('wheel', (e: WheelEvent) => wheelevent(e));\r\n  document.addEventListener('keyup', (e: KeyboardEvent) => keyup(e));\r\n  document.addEventListener('keydown', (e: KeyboardEvent) => keydown(e));\r\n}\r\n\r\nfunction updateState(keys: { [index: string]: boolean }, e: KeyboardEvent, state: boolean) {\r\n  keys['ALT'] = e.altKey;\r\n  keys['SHIFT'] = e.shiftKey;\r\n  keys['CTRL'] = e.ctrlKey;\r\n  let key = mapKeyCode(e.keyCode);\r\n  if (key) keys[key] = state;\r\n  keys[e.keyCode] = state;\r\n  keys[e.key] = state;\r\n}\r\n\r\nfunction keydown(e: KeyboardEvent) {\r\n  if (e.target != document.body) return true;\r\n  updateState(state.keys, e, true);\r\n  updateState(state.keysPress, e, true);\r\n  e.preventDefault();\r\n  return false;\r\n}\r\n\r\nfunction keyup(e: KeyboardEvent) {\r\n  if (e.target != document.body) return true;\r\n  updateState(state.keys, e, false);\r\n  e.preventDefault();\r\n  return false;\r\n}\r\n\r\nfunction mousemove(e: MouseEvent): boolean {\r\n  state.mouseX = e.offsetX;\r\n  state.mouseY = e.offsetY;\r\n  return false;\r\n}\r\n\r\nfunction mouseup(e: MouseEvent): boolean {\r\n  state.mouseButtons[e.button] = false;\r\n  state.mouseClicks[e.button] = true;\r\n  return false;\r\n}\r\n\r\nfunction mousedown(e: MouseEvent): boolean {\r\n  state.mouseButtons[e.button] = true;\r\n  return false;\r\n}\r\n\r\nfunction wheelevent(e: WheelEvent): boolean {\r\n  state.wheel = e.deltaY > 0 ? 1 : -1;\r\n  return false;\r\n}\r\n\r\nexport function get(): InputState {\r\n  return state;\r\n}\r\n","import { FastList } from \"./list\";\r\nimport { Collection } from \"./collections\";\r\n\r\nexport type Interpolator<T> = (lh: T, rh: T, t: number) => T;\r\n\r\nexport const NumberInterpolator = (lh: number, rh: number, t: number) => { return lh + (rh - lh) * t; }\r\n\r\nexport const Vec3Interpolator = (lh: number[], rh: number[], t: number) => {\r\n  return [\r\n    lh[0] + (rh[0] - lh[0]) * t,\r\n    lh[1] + (rh[1] - lh[1]) * t,\r\n    lh[2] + (rh[2] - lh[2]) * t\r\n  ]\r\n}\r\n\r\nexport const Vec4Interpolator = (lh: number[], rh: number[], t: number) => {\r\n  return [\r\n    lh[0] + (rh[0] - lh[0]) * t,\r\n    lh[1] + (rh[1] - lh[1]) * t,\r\n    lh[2] + (rh[2] - lh[2]) * t,\r\n    lh[3] + (rh[3] - lh[3]) * t\r\n  ]\r\n}\r\n\r\nexport class Point<T> {\r\n  constructor(public val: T, public pos: number, public interpolator: Interpolator<T>) { }\r\n}\r\n\r\nexport type Comparator<T> = (lh: T, rh: T) => number;\r\nexport function PointComparator<T>(lh: Point<T>, rh: Point<T>) { return lh.pos - rh.pos }\r\n\r\nexport class Range<T> {\r\n  private points = new FastList<Point<T>>();\r\n\r\n  constructor(start: T, end: T, interpolator: Interpolator<T>) {\r\n    this.points.push(new Point<T>(start, 0, interpolator));\r\n    this.points.push(new Point<T>(end, 1, null));\r\n  }\r\n\r\n  public insert(val: T, t: number, interpolator: Interpolator<T>): void {\r\n    let idx = binaryIndexOf1(this.points, new Point<T>(null, t, null), PointComparator);\r\n    this.points.insertAfter(new Point<T>(val, t, interpolator), idx);\r\n  }\r\n\r\n  public get(t: number): T {\r\n    if (t < 0) return this.points.get(this.points.next(0)).val;\r\n    if (t > 1) return this.points.get(this.points.last(0)).val;\r\n    let idx = binaryIndexOf1(this.points, new Point<T>(null, t, null), PointComparator);\r\n    let lh = this.points.get(idx);\r\n    let rh = this.points.get(this.points.next(idx));\r\n    let localT = (t - lh.pos) / (rh.pos - lh.pos);\r\n    return lh.interpolator(lh.val, rh.val, localT);\r\n  }\r\n}\r\n\r\nfunction advance(iter: number, list: FastList<any>, steps: number) {\r\n  for (let i = 0; i < steps; i++) iter = list.next(iter)\r\n  return iter;\r\n}\r\n\r\nfunction length(list: FastList<any>) {\r\n  let length = 0;\r\n  for (let i = 0; i != list.last(0); i = list.next(i)) length++;\r\n  return length;\r\n}\r\n\r\nexport function binaryIndexOf1<T>(list: FastList<T>, searchElement: T, cmp: Comparator<T>) {\r\n  let refMin = list.next(0);\r\n  let min = list.next(0);\r\n  let max = list.last(0);\r\n  if (cmp(searchElement, list.get(min)) < 0 || cmp(searchElement, list.get(max)) > 0)\r\n    return -1;\r\n  let current = min;\r\n  let currentElement: T = null;\r\n  while (min != max) {\r\n    current = advance(min, list, length(list) / 2 | 0);\r\n    currentElement = list.get(current);\r\n    let cmpVal = cmp(currentElement, searchElement);\r\n    if (cmpVal < 0) min = list.next(current);\r\n    else if (cmpVal > 0) max = list.last(current);\r\n    else break;\r\n  }\r\n  return current == refMin ? refMin : current - 1;\r\n}\r\n\r\nexport function binaryIndexOf<T>(arr: Collection<T>, searchElement: T, cmp: Comparator<T>, minIndex: number = 0, maxIndex: number = arr.length() - 1) {\r\n  let refMinIndex = minIndex;\r\n  if (cmp(searchElement, arr.get(minIndex)) < 0 || cmp(searchElement, arr.get(maxIndex)) > 0)\r\n    return -1;\r\n  let currentIndex = 0;\r\n  let currentElement: T = null;\r\n  while (minIndex <= maxIndex) {\r\n    currentIndex = (minIndex + maxIndex) / 2 | 0;\r\n    currentElement = arr.get(currentIndex);\r\n    let cmpVal = cmp(currentElement, searchElement);\r\n    if (cmpVal < 0) minIndex = currentIndex + 1;\r\n    else if (cmpVal > 0) maxIndex = currentIndex - 1;\r\n    else break;\r\n  }\r\n  return currentIndex == refMinIndex ? refMinIndex : currentIndex - 1;\r\n}","import { filter, map, reduce, forEach, all, enumerate, take, findFirst, chain, butLast, skip, any, iterIsEmpty, skipWhile } from \"./collections\";\r\n\r\n\r\nexport class Iter<T> implements Iterable<T>{\r\n  public static of<T>(iter: Iterable<T>) { return new Iter(iter) }\r\n\r\n  constructor(public iter: Iterable<T>) { };\r\n  [Symbol.iterator]() { return this.iter[Symbol.iterator]() }\r\n\r\n  filter(f: (t: T) => boolean): Iter<T> { return new Iter(filter(this.iter, f)) }\r\n  map<U>(f: (t: T) => U): Iter<U> { return new Iter(map(this.iter, f)) }\r\n  forEach(f: (t: T) => void): Iter<T> { forEach(this.iter, f); return this }\r\n  enumerate(): Iter<[T, number]> { return new Iter(enumerate(this.iter)) }\r\n  take(count: number): Iter<T> { return new Iter(take(this.iter, count)) }\r\n  skip(count: number): Iter<T> { return new Iter(skip(this.iter, count)) }\r\n  skipWhile(f: (t: T) => boolean): Iter<T> { return new Iter(skipWhile(this.iter, f)) }\r\n  reduce(f: (lh: T, rh: T) => T, start: T): T { return reduce(this.iter, f, start) }\r\n  all(f: (t: T) => boolean): boolean { return all(this.iter, f) }\r\n  any(f: (t: T) => boolean): boolean { return any(this.iter, f) }\r\n  isEmpty(): boolean { return iterIsEmpty(this.iter) }\r\n  first(f: (t: T) => boolean, def: T): T { return findFirst(this.iter, f, def) }\r\n  chain(i: Iterable<T>): Iter<T> { return new Iter(chain(this.iter, i)) }\r\n  butLast(): Iter<T> { return new Iter(butLast(this.iter)) }\r\n  collect(): T[] { return [...this.iter] }\r\n  set(): Set<T> { return new Set(this.iter) }\r\n}\r\n\r\nexport function iter<T>(iter: Iterable<T>) {\r\n  return Iter.of(iter);\r\n}\r\n\r\n","\r\nexport class LexerRule {\r\n  public id: number = null;\r\n  constructor(\r\n    public pattern: RegExp,\r\n    public name: string,\r\n    public mid = 0,\r\n    public conv: (s: string) => any = (s: string) => s\r\n  ) { }\r\n}\r\n\r\nexport class Lexer {\r\n  private rulesIndex: { [index: string]: LexerRule } = {};\r\n  private rules: LexerRule[] = [];\r\n  private src: string;\r\n  private offset = 0;\r\n  private lastOffset = 0;\r\n  private eoi = false;\r\n\r\n  private matchedRule: LexerRule = null;\r\n  private matchedValue = null;\r\n\r\n  public addRule(rule: LexerRule): Lexer {\r\n    let r = this.rulesIndex[rule.name];\r\n    if (r == undefined) {\r\n      rule.id = this.rules.length;\r\n      this.rules.push(rule);\r\n    } else {\r\n      throw new Error('Rule ' + rule.name + ' already exist');\r\n    }\r\n\r\n    this.rulesIndex[rule.name] = rule;\r\n    return this;\r\n  }\r\n\r\n  public mark(): number {\r\n    return this.lastOffset;\r\n  }\r\n\r\n  public reset(offset: number = 0): string {\r\n    this.offset = offset;\r\n    this.lastOffset = offset;\r\n    this.eoi = false;\r\n    return this.next();\r\n  }\r\n\r\n  public setSource(src: string): void {\r\n    this.src = src;\r\n    this.offset = 0;\r\n    this.eoi = false;\r\n  }\r\n\r\n  private exec(): string {\r\n    if (this.offset >= this.src.length) this.eoi = true;\r\n    if (this.eoi) return null;\r\n\r\n    let len = 0;\r\n    let matchedValue = null;\r\n    let matchedRule: LexerRule = null;\r\n    let subsrc = this.src.substr(this.offset);\r\n    for (let i = 0; i < this.rules.length; i++) {\r\n      let rule = this.rules[i];\r\n      let match = rule.pattern.exec(subsrc);\r\n      if (match != null && match[0].length >= len) {\r\n        matchedValue = match;\r\n        matchedRule = rule;\r\n        len = match[0].length;\r\n      }\r\n    }\r\n\r\n    this.matchedRule = matchedRule;\r\n    this.matchedValue = matchedValue;\r\n    this.lastOffset = this.offset;\r\n    this.offset += len;\r\n\r\n    if (matchedRule == null)\r\n      throw new Error('Unexpected input \"' + subsrc.substr(0, 10) + '...\"');\r\n\r\n    return matchedRule.name;\r\n  }\r\n\r\n  public next(): string {\r\n    return this.exec()\r\n  }\r\n\r\n  public rule(): LexerRule {\r\n    return this.matchedRule;\r\n  }\r\n\r\n  public value(): any {\r\n    return this.rule().conv(this.matchedValue[this.rule().mid]);\r\n  }\r\n\r\n  public isEoi(): boolean {\r\n    return this.eoi;\r\n  }\r\n}\r\n","import { TERMINAL_ITERATOR_RESULT, EMPTY_ITERATOR, Deck } from \"./collections\";\r\n\r\nexport class Node<T> {\r\n  constructor(\r\n    public obj: T = null,\r\n    public next: Node<T> = null,\r\n    public prev: Node<T> = null) {\r\n  }\r\n}\r\n\r\nexport class List<T> implements Iterable<T>{\r\n  private nil = new Node<T>();\r\n\r\n  constructor() {\r\n    this.clear();\r\n  }\r\n\r\n  public first(): Node<T> {\r\n    return this.nil.next;\r\n  }\r\n\r\n  public last(): Node<T> {\r\n    return this.nil.prev;\r\n  }\r\n\r\n  public terminator(): Node<T> {\r\n    return this.nil;\r\n  }\r\n\r\n  public pop(): T {\r\n    let ret = this.last().obj;\r\n    this.remove(this.last());\r\n    return ret;\r\n  }\r\n\r\n  public push(value: T): Node<T> {\r\n    return this.insertAfter(value);\r\n  }\r\n\r\n  public pushAll(values: T[]): Node<T>[] {\r\n    let nodes = [];\r\n    for (let i = 0; i < values.length; i++)\r\n      nodes.push(this.insertAfter(values[i]));\r\n    return nodes;\r\n  }\r\n\r\n  public isEmpty(): boolean {\r\n    return this.nil.next == this.nil;\r\n  }\r\n\r\n  public insertNodeBefore(node: Node<T>, ref: Node<T> = this.nil.next): Node<T> {\r\n    node.next = ref;\r\n    node.prev = ref.prev;\r\n    node.prev.next = node;\r\n    ref.prev = node;\r\n    return node;\r\n  }\r\n\r\n  public insertBefore(val: T, ref: Node<T> = this.nil.next): Node<T> {\r\n    return this.insertNodeBefore(new Node<T>(val), ref);\r\n  }\r\n\r\n  public insertNodeAfter(node: Node<T>, ref: Node<T> = this.nil.prev): Node<T> {\r\n    node.next = ref.next;\r\n    node.next.prev = node;\r\n    ref.next = node;\r\n    node.prev = ref;\r\n    return node;\r\n  }\r\n\r\n  public insertAfter(val: T, ref: Node<T> = this.nil.prev): Node<T> {\r\n    return this.insertNodeAfter(new Node<T>(val), ref);\r\n  }\r\n\r\n  public remove(ref: Node<T>): Node<T> {\r\n    if (ref == this.nil)\r\n      return;\r\n\r\n    ref.next.prev = ref.prev;\r\n    ref.prev.next = ref.next;\r\n    return ref;\r\n  }\r\n\r\n  public clear() {\r\n    this.nil.next = this.nil;\r\n    this.nil.prev = this.nil;\r\n  }\r\n\r\n  public [Symbol.iterator]() {\r\n    let pointer = this.first();\r\n    return pointer == this.terminator()\r\n      ? EMPTY_ITERATOR\r\n      : {\r\n        next: () => {\r\n          if (pointer == this.terminator())\r\n            return <IteratorResult<T>>TERMINAL_ITERATOR_RESULT;\r\n          else {\r\n            let obj = pointer.obj;\r\n            pointer = pointer.next;\r\n            return <IteratorResult<T>>{ done: false, value: obj }\r\n          }\r\n        }\r\n      }\r\n  }\r\n}\r\n\r\nexport class FastList<T> implements Iterable<T> {\r\n  private elements = new Deck<T>();\r\n  private nextIdx = new Deck<number>();\r\n  private lastIdx = new Deck<number>();\r\n\r\n  constructor() { this.clear() }\r\n\r\n  public insertAfter(value: T, after: number = this.lastIdx.get(0)): number {\r\n    const idx = this.elements.length();\r\n    const next = this.nextIdx.get(after);\r\n    this.elements.push(value);\r\n    this.nextIdx.push(next)\r\n    this.lastIdx.push(after);\r\n    this.nextIdx.set(after, idx);\r\n    this.lastIdx.set(next, idx);\r\n    return idx;\r\n  }\r\n\r\n  public insertBefore(value: T, before: number = this.nextIdx.get(0)): number {\r\n    const idx = this.elements.length();\r\n    const last = this.lastIdx.get(before);\r\n    this.elements.push(value);\r\n    this.nextIdx.push(before)\r\n    this.lastIdx.push(last);\r\n    this.nextIdx.set(last, idx);\r\n    this.lastIdx.set(before, idx);\r\n    return idx;\r\n  }\r\n\r\n  public remove(idx: number): T {\r\n    if (idx <= 0 || idx >= this.elements.length() - 1 || this.nextIdx.get(idx) == -1) return null;\r\n    this.nextIdx.set(this.lastIdx.get(idx), this.nextIdx.get(idx));\r\n    this.lastIdx.set(this.nextIdx.get(idx), this.lastIdx.get(idx));\r\n    this.nextIdx.set(idx, -1);\r\n    return this.elements.get(idx);\r\n  }\r\n\r\n  public pop() {\r\n    const lastId = this.last(0);\r\n    const last = this.get(lastId);\r\n    this.remove(lastId);\r\n    return last;\r\n  }\r\n\r\n  public get(idx: number): T { return this.elements.get(idx) }\r\n  public next(idx: number): number { return this.nextIdx.get(idx) }\r\n  public last(idx: number): number { return this.lastIdx.get(idx) }\r\n  public push(value: T) { this.insertAfter(value) }\r\n  public first() { return this.next(0) }\r\n\r\n  public clear() {\r\n    this.elements.clear().push(null);\r\n    this.nextIdx.clear().push(0);\r\n    this.lastIdx.clear().push(0);\r\n  }\r\n\r\n  public [Symbol.iterator]() {\r\n    let pointer = this.first();\r\n    return pointer == 0\r\n      ? EMPTY_ITERATOR\r\n      : {\r\n        next: () => {\r\n          if (pointer == 0) return TERMINAL_ITERATOR_RESULT;\r\n          else {\r\n            const obj = this.get(pointer);\r\n            pointer = this.next(pointer);\r\n            return { done: false, value: obj }\r\n          }\r\n        }\r\n      }\r\n  }\r\n}\r\n\r\nfunction advance(iter: number, list: FastList<any>, steps: number) {\r\n  for (let i = 0; i < steps; i++) iter = list.next(iter)\r\n  return iter;\r\n}\r\n\r\nfunction length(list: FastList<any>, from: number, to: number) {\r\n  let length = 0;\r\n  for (let i = from; i != to; i = list.next(i)) length++;\r\n  return length;\r\n}\r\n\r\nfunction binaryIndexOf(list: FastList<number>, searchElement: number) {\r\n  let refMin = list.first();\r\n  let min = list.first();\r\n  let max = list.last(0);\r\n  if (searchElement < list.get(min)) return 0;\r\n  if (searchElement >= list.get(max)) return max;\r\n  let current = min;\r\n  let currentElement: number = null;\r\n  let size = length(list, min, max);\r\n  while (size > 0) {\r\n    size -= size / 2 | 0;\r\n    current = advance(min, list, size);\r\n    currentElement = list.get(current);\r\n    if (currentElement < searchElement) min = list.next(current);\r\n    else if (currentElement > searchElement) max = list.last(current);\r\n    else break;\r\n    size--;\r\n  }\r\n  return current == refMin ? refMin : current;\r\n}\r\n\r\nexport class SortedHeap<T> {\r\n  private values = new FastList<T>();\r\n  private sortValues = new FastList<number>();\r\n\r\n  public add(value: T, sortValue: number) {\r\n    const ptr = binaryIndexOf(this.sortValues, sortValue);\r\n    this.values.insertAfter(value, ptr);\r\n    this.sortValues.insertAfter(sortValue, ptr);\r\n  }\r\n\r\n  public clear() {\r\n    this.values.clear();\r\n    this.sortValues.clear();\r\n  }\r\n\r\n  public get(): Iterable<T> { return this.values }\r\n}","export const ERROR = 0;\r\nexport const WARN = 1;\r\nexport const INFO = 2;\r\nexport const TRACE = 3;\r\nexport const DEBUG = 4;\r\n\r\nexport type Appender = (level: number, ...msg: any) => void;\r\n\r\nlet appenders: Array<Appender> = [];\r\n\r\nfunction write(level: number, ...msg: any) {\r\n  for (let i = 0; i < appenders.length; i++) {\r\n    appenders[i](level, ...msg);\r\n  }\r\n}\r\n\r\nexport const error = (...msg: any) => write(ERROR, ...msg);\r\nexport const warning = (...msg: any) => write(WARN, ...msg);\r\nexport const info = (...msg: any) => write(INFO, ...msg);\r\nexport const trace = (...msg: any) => write(TRACE, ...msg);\r\nexport const debug = (...msg: any) => write(DEBUG, ...msg);\r\n\r\nexport function addLogAppender(appender: Appender) {\r\n  appenders.push(appender);\r\n}\r\n\r\nexport const CONSOLE: Appender = (level: number, ...msg: any) => {\r\n  switch (level) {\r\n    case ERROR: console.error(...msg); return;\r\n    case WARN: console.warn(...msg); return;\r\n    case INFO: console.info(...msg); return;\r\n    case TRACE: console.trace(...msg); return;\r\n    case DEBUG: console.debug(...msg); return;\r\n  }\r\n}","export var radsInDeg = 180 / Math.PI;\r\nexport var degInRad = Math.PI / 180;\r\nexport var PI2 = Math.PI * 2;\r\nexport var EPS = 1e-9;\r\n\r\nexport function eq(lh: number, rh: number) {\r\n  return Math.abs(lh - rh) < EPS;\r\n}\r\n\r\nexport function lse(lh: number, rh: number) {\r\n  return eq(lh, rh) || lh < rh;\r\n}\r\nexport function gte(lh: number, rh: number) {\r\n  return eq(lh, rh) || lh > rh;\r\n}\r\n\r\nexport function deg2rad(deg: number): number {\r\n  return deg * degInRad;\r\n}\r\n\r\nexport function rad2deg(rad: number): number {\r\n  return rad * radsInDeg;\r\n}\r\n\r\nexport function sign(x: number) {\r\n  return x > 0 ? 1 : x < 0 ? -1 : 0;\r\n}\r\n\r\nexport function int(x: number) {\r\n  return x | 0;\r\n}\r\n\r\nexport function ispow2(x: number): boolean {\r\n  return (x & (x - 1)) == 0;\r\n}\r\n\r\nexport function fract(x: number): number {\r\n  return x - int(x);\r\n}\r\n\r\nexport function nextpow2(x: number) {\r\n  --x;\r\n  for (var i = 1; i < 32; i <<= 1) {\r\n    x = x | x >> i;\r\n  }\r\n  return x + 1;\r\n}\r\n\r\nexport function sqrLen2d(x: number, y: number) {\r\n  return x * x + y * y;\r\n}\r\n\r\nexport function len2d(x: number, y: number) {\r\n  return Math.sqrt(x * x + y * y);\r\n}\r\n\r\nexport function lenPointToLine(px: number, py: number, l1x: number, l1y: number, l2x: number, l2y: number) {\r\n  let ldx = l2x - l1x;\r\n  let ldy = l2y - l1y;\r\n  let pdx = px - l1x;\r\n  let pdy = py - l1y;\r\n  let dot = dot2d(ldx, ldy, pdx, pdy);\r\n  if (dot <= 0) return len2d(pdx, pdy);\r\n  let llensqr = sqrLen2d(ldx, ldy);\r\n  if (dot >= llensqr) return len2d(px - l2x, py - l2y);\r\n  let t = dot / llensqr;\r\n  return len2d(px - (l1x + ldx * t), py - (l1y + ldy * t));\r\n}\r\n\r\nexport function len3d(x: number, y: number, z: number) {\r\n  return Math.sqrt(x * x + y * y + z * z);\r\n}\r\n\r\nexport function dot2d(x1: number, y1: number, x2: number, y2: number) {\r\n  return x1 * x2 + y1 * y2;\r\n}\r\n\r\nexport function cross2d(x1: number, y1: number, x2: number, y2: number) {\r\n  return x1 * y2 - y1 * x2;\r\n}\r\n\r\nexport function monoatan2(y: number, x: number): number {\r\n  let atan = Math.atan2(y, x);\r\n  return atan < 0 ? (2 * Math.PI) + atan : atan;\r\n}\r\n\r\nexport function angInArc(arcStart: number, arcEnd: number, ang: number): boolean {\r\n  return arcStart > arcEnd ? ang >= arcStart || ang <= arcEnd : ang >= arcStart && ang <= arcEnd;\r\n}\r\n\r\nexport function arcsIntersects(a1s: number, a1e: number, a2s: number, a2e: number): boolean {\r\n  return angInArc(a1s, a1e, a2s) || angInArc(a1s, a1e, a2e) || angInArc(a2s, a2e, a1s) || angInArc(a2s, a2e, a1e);\r\n}\r\n\r\nexport function cyclic(x: number, max: number): number {\r\n  const mod = x % max;\r\n  return x >= 0 ? mod : mod == 0 ? max - 1 : max + mod;\r\n}\r\n\r\nexport function reverse(x: number, max: number) {\r\n  return max - x;\r\n}\r\n\r\nexport function ubyte2byte(n: number) {\r\n  var minus = (n & 0x80) != 0;\r\n  return minus ? -(~n & 0xFF) - 1 : n;\r\n}\r\n\r\nexport function int2vec4(int: number) {\r\n  return [(int & 0xff), ((int >>> 8) & 0xff), ((int >>> 16) & 0xff), ((int >>> 24) & 0xff)];\r\n}\r\n\r\nexport function int2vec4norm(int: number) {\r\n  return [(int & 0xff) / 256, ((int >>> 8) & 0xff) / 256, ((int >>> 16) & 0xff) / 256, ((int >>> 24) & 0xff) / 256];\r\n}\r\n\r\nexport function tuple(v0: number, v1: number) {\r\n  return (v0 & 0xffff) | (v1 << 16);\r\n}\r\n\r\nexport function detuple0(v: number) {\r\n  return v & 0xffff;\r\n}\r\n\r\nexport function detuple1(v: number) {\r\n  return (v >>> 16) & 0xffff;\r\n}\r\n\r\nexport function tuple2<T1, T2>(value: [T1, T2], v0: T1, v1: T2): [T1, T2] {\r\n  value[0] = v0;\r\n  value[1] = v1;\r\n  return value;\r\n}\r\n\r\nexport function tuple3<T1, T2, T3>(value: [T1, T2, T3], v0: T1, v1: T2, v2: T3): [T1, T2, T3] {\r\n  value[0] = v0;\r\n  value[1] = v1;\r\n  value[2] = v2;\r\n  return value;\r\n}\r\n\r\nexport function tuple4<T1, T2, T3, T4>(value: [T1, T2, T3, T4], v0: T1, v1: T2, v2: T3, v3: T4): [T1, T2, T3, T4] {\r\n  value[0] = v0;\r\n  value[1] = v1;\r\n  value[2] = v2;\r\n  value[3] = v3;\r\n  return value;\r\n}\r\n\r\nexport function productValue<T>(start: T, f: (lh: T, rh: T) => T) {\r\n  return {\r\n    get: () => start,\r\n    set: (v: T) => start = f(start, v)\r\n  }\r\n}\r\n\r\nexport function minValue(start: number) {\r\n  return productValue(start, (lh, rh) => Math.min(rh, lh));\r\n}\r\n","import * as  MU from './mathutils';\r\n\r\nexport type BlendFunc = (dst: Uint8Array, dstoff: number, src: Uint8Array, srcoff: number) => void;\r\n\r\nexport var BlendNormal = (dst: Uint8Array, dstoff: number, src: Uint8Array, srcoff: number) => {\r\n  // dst.set(src.slice(srcoff, srcoff+4), dstoff);\r\n  dst[dstoff] = src[srcoff];\r\n  dst[dstoff + 1] = src[srcoff + 1];\r\n  dst[dstoff + 2] = src[srcoff + 2];\r\n  dst[dstoff + 3] = src[srcoff + 3];\r\n}\r\n\r\nexport var BlendAlpha = (dst: Uint8Array, dstoff: number, src: Uint8Array, srcoff: number) => {\r\n  var a = src[srcoff + 3] / 255;\r\n  var _a = 1 - a;\r\n  dst[dstoff] = src[srcoff] * a + dst[dstoff] * _a;\r\n  dst[dstoff + 1] = src[srcoff + 1] * a + dst[dstoff + 1] * _a;\r\n  dst[dstoff + 2] = src[srcoff + 2] * a + dst[dstoff + 2] * _a;\r\n  dst[dstoff + 3] = 255;\r\n}\r\n\r\nexport interface PixelProvider {\r\n  getPixel(x: number, y: number): Uint8Array;\r\n  putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void;\r\n  getWidth(): number;\r\n  getHeight(): number;\r\n  render(dst: Uint8Array | Uint8ClampedArray | number[], blend: BlendFunc): void;\r\n}\r\n\r\nexport class AbstractPixelProvider implements PixelProvider {\r\n\r\n  constructor(private w: number, private h: number) {\r\n    if (w < 0 || h < 0)\r\n      throw new Error('Invalid size');\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void { }\r\n\r\n  public getPixel(x: number, y: number): Uint8Array {\r\n    var dst = new Uint8Array(4);\r\n    this.putToDst(x, y, dst, 0, BlendNormal);\r\n    return dst;\r\n  }\r\n\r\n  public getWidth(): number {\r\n    return this.w;\r\n  }\r\n\r\n  public getHeight(): number {\r\n    return this.h;\r\n  }\r\n\r\n  public render(dst: Uint8Array, blend: BlendFunc = BlendNormal): void {\r\n    var off = 0;\r\n    for (var y = 0; y < this.h; y++) {\r\n      for (var x = 0; x < this.w; x++) {\r\n        this.putToDst(x, y, dst, off, blend);\r\n        off += 4;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport class ConstPixelProvider extends AbstractPixelProvider {\r\n\r\n  constructor(private color: Uint8Array, w: number, h: number) {\r\n    super(w, h);\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    blend(dst, dstoff, this.color, 0);\r\n  }\r\n}\r\n\r\nexport class RGBAArrayPixelProvider extends AbstractPixelProvider {\r\n\r\n  constructor(private arr: Uint8Array, w: number, h: number) {\r\n    super(w, h);\r\n    if (arr.length != w * h * 4)\r\n      throw new Error('Invalid array size. Need ' + (w * h * 4) + ' but provided ' + arr.length);\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    var w = this.getWidth();\r\n    blend(dst, dstoff, this.arr, (x + y * w) * 4)\r\n  }\r\n}\r\n\r\nexport class RGBPalPixelProvider extends AbstractPixelProvider {\r\n  private palTmp = new Uint8Array(4);\r\n\r\n  constructor(\r\n    private arr: Uint8Array,\r\n    private pal: Uint8Array,\r\n    w: number, h: number,\r\n    private alpha: number = 255,\r\n    private transIdx: number = -1,\r\n    private shadow: number = -1,\r\n    private shadowColor: Uint8Array = new Uint8Array([0, 0, 0, 0])\r\n  ) {\r\n    super(w, h);\r\n    if (arr.length != w * h)\r\n      throw new Error('Invalid array size. Need ' + (w * h * 4) + ' but provided ' + arr.length);\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    var w = this.getWidth();\r\n    var idx = this.arr[x + y * w];\r\n    if (idx == this.shadow) {\r\n      blend(dst, dstoff, this.shadowColor, 0);\r\n      return;\r\n    }\r\n    var paloff = idx * 3;\r\n    // this.palTmp.set(this.pal.slice(paloff, paloff + 3));\r\n    this.palTmp[0] = this.pal[paloff];\r\n    this.palTmp[1] = this.pal[paloff + 1];\r\n    this.palTmp[2] = this.pal[paloff + 2];\r\n    this.palTmp[3] = idx == this.transIdx ? 0 : this.alpha;\r\n    blend(dst, dstoff, this.palTmp, 0);\r\n  }\r\n}\r\n\r\nexport class RectPixelProvider extends AbstractPixelProvider {\r\n\r\n  private origw: number;\r\n  private origh: number;\r\n\r\n  constructor(\r\n    private provider: PixelProvider,\r\n    private sx: number,\r\n    private sy: number,\r\n    private ex: number,\r\n    private ey: number,\r\n    private paddColor: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n    super(ex - sx, ey - sy);\r\n    this.origw = provider.getWidth();\r\n    this.origh = provider.getHeight();\r\n    if (sx >= ex || sy >= ey)\r\n      throw new Error('Invalid subrect');\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    var nx = this.sx + x;\r\n    var ny = this.sy + y;\r\n    if (nx < 0 || ny < 0 || nx >= this.origw || ny >= this.origh)\r\n      blend(dst, dstoff, this.paddColor, 0);\r\n    else\r\n      this.provider.putToDst(nx, ny, dst, dstoff, blend);\r\n  }\r\n}\r\n\r\nexport class ResizePixelProvider extends AbstractPixelProvider {\r\n\r\n  private dx: number;\r\n  private dy: number;\r\n\r\n  constructor(private provider: PixelProvider, w: number, h: number) {\r\n    super(w, h);\r\n    this.dx = provider.getWidth() / w;\r\n    this.dy = provider.getHeight() / h;\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    this.provider.putToDst(MU.int(x * this.dx), MU.int(y * this.dy), dst, dstoff, blend);\r\n  }\r\n}\r\n\r\nexport class AxisSwapPixelProvider extends AbstractPixelProvider {\r\n\r\n  constructor(private provider: PixelProvider) {\r\n    super(provider.getHeight(), provider.getWidth());\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    this.provider.putToDst(y, x, dst, dstoff, blend);\r\n  }\r\n}\r\n\r\nexport class FlipPixelProvider extends AbstractPixelProvider {\r\n  private xs: number;\r\n  private ys: number;\r\n\r\n  constructor(private provider: PixelProvider, xswap: boolean, yswap: boolean) {\r\n    super(provider.getWidth(), provider.getHeight());\r\n    this.xs = xswap ? provider.getWidth() - 1 : 0;\r\n    this.ys = yswap ? provider.getHeight() - 1 : 0;\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    this.provider.putToDst(Math.abs(x - this.xs), Math.abs(y - this.ys), dst, dstoff, blend);\r\n  }\r\n}\r\n\r\nexport class OffsetPixelProvider extends AbstractPixelProvider {\r\n  constructor(private provider: PixelProvider, w: number, h: number, private xo: number, private yo: number, private paddColor: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n    super(w, h);\r\n  }\r\n\r\n  public putToDst(x: number, y: number, dst: Uint8Array, dstoff: number, blend: BlendFunc): void {\r\n    var rx = x - this.xo;\r\n    var ry = y - this.yo;\r\n    if (rx < 0 || ry < 0 || rx >= this.provider.getWidth() || ry >= this.provider.getHeight())\r\n      blend(dst, dstoff, this.paddColor, 0);\r\n    else\r\n      this.provider.putToDst(rx, ry, dst, dstoff, blend);\r\n  }\r\n}\r\n\r\nexport function fromPal(arr: Uint8Array, pal: Uint8Array, w: number, h: number, alpha: number = 255, transIdx: number = -1, shadow: number = -1, shadowColor: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n  return new RGBPalPixelProvider(arr, pal, w, h, alpha, transIdx, shadow, shadowColor);\r\n}\r\n\r\nexport function axisSwap(provider: PixelProvider) {\r\n  return new AxisSwapPixelProvider(provider);\r\n}\r\n\r\nexport function xflip(provider: PixelProvider) {\r\n  return new FlipPixelProvider(provider, true, false);\r\n}\r\n\r\nexport function yflip(provider: PixelProvider) {\r\n  return new FlipPixelProvider(provider, false, true);\r\n}\r\n\r\nexport function xyflip(provider: PixelProvider) {\r\n  return new FlipPixelProvider(provider, true, true);\r\n}\r\n\r\nexport function rect(provider: PixelProvider, sx: number, sy: number, ex: number, ey: number, paddColod: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n  if (sx == 0 && sy == 0 && provider.getHeight() == ey && provider.getWidth() == ex)\r\n    return provider;\r\n  return new RectPixelProvider(provider, sx, sy, ex, ey, paddColod);\r\n}\r\n\r\nexport function center(provider: PixelProvider, w: number, h: number, paddColod: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n  var dw = MU.int((provider.getWidth() - w) / 2);\r\n  var dh = MU.int((provider.getHeight() - h) / 2);\r\n  return rect(provider, dw, dh, w + dw, h + dh);\r\n\r\n}\r\n\r\nexport function resize(provider: PixelProvider, w: number, h: number) {\r\n  if (provider.getHeight() == h && provider.getWidth() == w)\r\n    return provider;\r\n  return new ResizePixelProvider(provider, w, h);\r\n}\r\n\r\nexport function fit(w: number, h: number, provider: PixelProvider, paddColor: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n  if (provider.getHeight() == h && provider.getWidth() == w)\r\n    return provider;\r\n  if (provider.getWidth() <= w && provider.getHeight() <= h) {\r\n    var sx = MU.int((provider.getWidth() - w) / 2);\r\n    var sy = MU.int((provider.getHeight() - h) / 2);\r\n    return rect(provider, sx, sy, w + sx, h + sy, paddColor);\r\n  } else {\r\n    var aspect = provider.getWidth() / provider.getHeight();\r\n    var nw = provider.getWidth();\r\n    var nh = provider.getHeight();\r\n    var r = false;\r\n    if (nw > w) {\r\n      nw = w;\r\n      nh = MU.int(nw / aspect);\r\n      r = true;\r\n    }\r\n    if (nh > h) {\r\n      nh = h;\r\n      nw = MU.int(nh * aspect);\r\n      r = true;\r\n    }\r\n    if (r) {\r\n      var sx = MU.int((nw - w) / 2);\r\n      var sy = MU.int((nh - h) / 2);\r\n      return rect(resize(provider, nw, nh), sx, sy, w + sx, h + sy, paddColor);\r\n    } else {\r\n      return resize(provider, w, h);\r\n    }\r\n  }\r\n}\r\n\r\nexport function offset(provider: PixelProvider, w: number, h: number, xo: number, yo: number, paddColor: Uint8Array = new Uint8Array([0, 0, 0, 0])) {\r\n  return new OffsetPixelProvider(provider, w, h, xo, yo, paddColor);\r\n}\r\n","\r\nfunction now() {\r\n  return window.performance.now();\r\n}\r\n\r\nexport class Section {\r\n  constructor(\r\n    public parent: Section,\r\n    public name: string,\r\n    public startTime: number = now(),\r\n    public time: number = 0,\r\n    public subSections = {},\r\n    public counts = {}) {\r\n    if (parent != null)\r\n      parent.subSections[name] = this;\r\n  }\r\n\r\n  public start() {\r\n    if (this.startTime == -1)\r\n      this.startTime = now();\r\n  }\r\n\r\n  public stop() {\r\n    if (this.startTime != -1) {\r\n      this.time = now() - this.startTime;\r\n      this.startTime = -1;\r\n    }\r\n    return this.time;\r\n  }\r\n\r\n  public pause() {\r\n    if (this.startTime != -1) {\r\n      this.time += now() - this.startTime;\r\n      this.startTime = -1;\r\n    }\r\n    return this.time;\r\n  }\r\n\r\n  public currentTime() {\r\n    return this.startTime == -1 ? this.time : now() - this.startTime;\r\n  }\r\n\r\n  public createSubsection(name: string): Section {\r\n    return new Section(this, name);\r\n  }\r\n\r\n  public inc(name: string, amount = 1) {\r\n    let count = this.counts[name];\r\n    this.counts[name] = (count == undefined ? 0 : count) + amount;\r\n  }\r\n\r\n  public set(name: string, value: any) {\r\n    this.counts[name] = value;\r\n  }\r\n}\r\n\r\nlet mainSection = new Section(null, 'Main');\r\nlet currentSection: Section = mainSection;\r\n\r\nexport function startProfile(name: string) {\r\n  let subsec = currentSection.subSections[name];\r\n  if (subsec == undefined) {\r\n    subsec = new Section(currentSection, name);\r\n  }\r\n  currentSection = subsec;\r\n  currentSection.start();\r\n}\r\n\r\nexport function startGlobalProfile(name: string) {\r\n  let subsec = mainSection.subSections[name];\r\n  if (subsec == undefined) {\r\n    subsec = new Section(mainSection, name);\r\n    subsec.parent = currentSection;\r\n  }\r\n  currentSection = subsec;\r\n  currentSection.start();\r\n}\r\n\r\nexport function incCount(name: string, amount = 1) {\r\n  currentSection.inc(name, amount);\r\n}\r\n\r\nexport function set(name: string, value: any) {\r\n  currentSection.set(name, value);\r\n}\r\n\r\nexport function endProfile() {\r\n  let time = currentSection.pause();\r\n  if (currentSection != mainSection)\r\n    currentSection = currentSection.parent;\r\n  return time;\r\n}\r\n\r\nexport function start() {\r\n  mainSection = new Section(null, 'Main');\r\n  currentSection = mainSection;\r\n}\r\n\r\nexport function get(path: string = null): Section {\r\n  if (path == null)\r\n    return mainSection;\r\n  let parts = path.split('.');\r\n  let section = mainSection;\r\n  for (let i = 0; i < parts.length; i++) {\r\n    section = section.subSections[parts[i]];\r\n  }\r\n  return section;\r\n}","export class Stream {\r\n  private view: DataView;\r\n  private offset: number;\r\n  private littleEndian: boolean;\r\n  private aligned = true;\r\n  private currentBit = 0;\r\n  private currentByte = 0;\r\n\r\n  constructor(buf: ArrayBuffer, isLE: boolean) {\r\n    this.view = new DataView(buf);\r\n    this.offset = 0;\r\n    this.littleEndian = isLE;\r\n  }\r\n\r\n  private checkBitAlignment() {\r\n    if (!this.aligned)\r\n      throw new Error(`Unaligned offset: ${this.offset}:${this.currentBit}`);\r\n  }\r\n\r\n  public buffer(): ArrayBuffer {\r\n    return this.view.buffer;\r\n  }\r\n\r\n  public eoi(): boolean {\r\n    return this.offset >= this.view.byteLength;\r\n  }\r\n\r\n  public skip(n: number) {\r\n    this.checkBitAlignment();\r\n    this.offset += n;\r\n  }\r\n\r\n  public setOffset(off: number): void {\r\n    this.checkBitAlignment();\r\n    this.offset = off;\r\n  }\r\n\r\n  public mark(): number {\r\n    this.checkBitAlignment();\r\n    return this.offset;\r\n  }\r\n\r\n  public readByte(): number {\r\n    this.checkBitAlignment();\r\n    return this.view.getInt8(this.offset++);\r\n  }\r\n\r\n  public writeByte(byte: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setInt8(this.offset++, byte);\r\n  }\r\n\r\n  public readUByte(): number {\r\n    this.checkBitAlignment();\r\n    return this.view.getUint8(this.offset++);\r\n  }\r\n\r\n  public writeUByte(byte: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setUint8(this.offset++, byte);\r\n  }\r\n\r\n  public readShort(): number {\r\n    this.checkBitAlignment();\r\n    const ret = this.view.getInt16(this.offset, this.littleEndian);\r\n    this.offset += 2;\r\n    return ret;\r\n  }\r\n\r\n  public writeShort(short: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setInt16(this.offset, short, this.littleEndian);\r\n    this.offset += 2;\r\n  }\r\n\r\n  public readUShort(): number {\r\n    this.checkBitAlignment();\r\n    const ret = this.view.getUint16(this.offset, this.littleEndian);\r\n    this.offset += 2;\r\n    return ret;\r\n  }\r\n\r\n  public writeUShort(short: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setUint16(this.offset, short, this.littleEndian);\r\n    this.offset += 2;\r\n  }\r\n\r\n  public readInt(): number {\r\n    this.checkBitAlignment();\r\n    const ret = this.view.getInt32(this.offset, this.littleEndian);\r\n    this.offset += 4;\r\n    return ret;\r\n  }\r\n\r\n  public writeInt(int: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setInt32(this.offset, int, this.littleEndian);\r\n    this.offset += 4;\r\n  }\r\n\r\n  public readUInt(): number {\r\n    this.checkBitAlignment();\r\n    const ret = this.view.getUint32(this.offset, this.littleEndian);\r\n    this.offset += 4;\r\n    return ret;\r\n  }\r\n\r\n  public writeUInt(int: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setUint32(this.offset, int, this.littleEndian);\r\n    this.offset += 4;\r\n  }\r\n\r\n  public readFloat(): number {\r\n    this.checkBitAlignment();\r\n    const ret = this.view.getFloat32(this.offset, this.littleEndian);\r\n    this.offset += 4;\r\n    return ret;\r\n  }\r\n\r\n  public writeFloat(float: number): void {\r\n    this.checkBitAlignment();\r\n    this.view.setFloat32(this.offset, float, this.littleEndian);\r\n    this.offset += 4;\r\n  }\r\n\r\n  public readByteString(len: number): string {\r\n    this.checkBitAlignment();\r\n    let str = new Array<string>(len);\r\n    for (let i = 0; i < len; i++) {\r\n      let c = this.readByte();\r\n      if (c == 0) {\r\n        this.skip(len - i - 1);\r\n        break;\r\n      }\r\n      str.push(String.fromCharCode(c));\r\n    }\r\n    return str.join('');\r\n  }\r\n\r\n  public writeByteString(len: number, str: string): void {\r\n    this.checkBitAlignment();\r\n    str = str.length > len ? str.substr(0, len) : str;\r\n    for (const c of str) this.writeByte(c.charCodeAt(0));\r\n    for (let i = 0; i < len - str.length; i++) this.writeByte(0);\r\n  }\r\n\r\n  public subView(): Stream {\r\n    this.checkBitAlignment();\r\n    const ret = new Stream(this.view.buffer, this.littleEndian);\r\n    ret.setOffset(this.offset);\r\n    return ret;\r\n  }\r\n\r\n  public readArrayBuffer(bytes: number): ArrayBuffer {\r\n    this.checkBitAlignment();\r\n    const slice = this.view.buffer.slice(this.offset, this.offset + bytes);\r\n    this.offset += bytes;\r\n    return slice;\r\n  }\r\n\r\n  public writeArrayBuffer(buffer: ArrayBuffer, len: number): void {\r\n    const dst = new Uint8Array(this.view.buffer, this.offset);\r\n    dst.set(new Uint8Array(buffer, 0, len));\r\n    this.offset += len;\r\n  }\r\n\r\n  public readBit(): number {\r\n    if (this.aligned) this.currentByte = this.readUByte();\r\n    const bit = ((this.currentByte >> (this.currentBit)) & 1);\r\n    this.currentBit = (this.currentBit + 1) % 8;\r\n    this.aligned = this.currentBit == 0;\r\n    return bit;\r\n  }\r\n\r\n  public writeBit(bit: boolean): void {\r\n    if (this.aligned) this.currentByte = 0;\r\n    if (bit) this.currentByte |= (1 << this.currentBit)\r\n    else this.currentByte &= (~(1 << this.currentBit) & 0xff);\r\n    this.currentBit = (this.currentBit + 1) % 8;\r\n    this.aligned = this.currentBit == 0;\r\n    if (this.aligned) this.writeUByte(this.currentByte);\r\n  }\r\n\r\n  public readBits(bits: number): number {\r\n    let value = 0;\r\n    const signed = bits < 0;\r\n    bits = signed ? -bits : bits;\r\n    for (let i = 0; i < bits; i++) {\r\n      let b = this.readBit();\r\n      value = value | (b << i);\r\n    }\r\n    return signed ? toSigned(value, bits) : value;\r\n  }\r\n\r\n  public writeBits(bits: number, value: number): void {\r\n    const signed = bits < 0;\r\n    bits = signed ? -bits : bits;\r\n    value = signed ? fromSigned(value, bits) : value;\r\n    for (let i = 0; i < bits; i++)  this.writeBit(((value >> i) & 1) == 1);\r\n  }\r\n}\r\n\r\nfunction toSigned(value: number, bits: number) {\r\n  return value & (1 << (bits - 1))\r\n    ? -(~value & ((1 << bits) - 1)) - 1\r\n    : value\r\n}\r\n\r\nfunction fromSigned(value: number, bits: number) {\r\n  const mask = ((1 << bits) - 1);\r\n  return value > 0\r\n    ? value & mask\r\n    : (~(-value) & mask) + 1;\r\n}\r\n\r\ntype ScalarReader<T> = (s: Stream) => T;\r\ntype ScalarWriter<T> = (s: Stream, value: T) => void;\r\n\r\nexport interface Accessor<T> {\r\n  readonly read: ScalarReader<T>;\r\n  readonly write: ScalarWriter<T>;\r\n  readonly size: number;\r\n}\r\n\r\ntype AtomicArrayConstructor<T> = { new(buffer: ArrayBuffer, byteOffset: number, length: number): T };\r\n\r\nexport interface AtomicReader<T, AT> extends Accessor<T> {\r\n  readonly atomicArrayConstructor: AtomicArrayConstructor<AT>;\r\n}\r\n\r\nfunction accessor<T>(read: ScalarReader<T>, write: ScalarWriter<T>, size: number): Accessor<T> {\r\n  return { read, write, size };\r\n}\r\n\r\nfunction atomicReader<T, AT>(read: ScalarReader<T>, write: ScalarWriter<T>, size: number, atomicArrayConstructor: AtomicArrayConstructor<AT>): AtomicReader<T, AT> {\r\n  return { read, write, size, atomicArrayConstructor };\r\n}\r\n\r\nexport const byte = atomicReader(s => s.readByte(), (s, v) => s.writeByte(v), 1, Int8Array);\r\nexport const ubyte = atomicReader(s => s.readUByte(), (s, v) => s.writeUByte(v), 1, Uint8Array);\r\nexport const short = atomicReader(s => s.readShort(), (s, v) => s.writeShort(v), 2, Int16Array);\r\nexport const ushort = atomicReader(s => s.readUShort(), (s, v) => s.writeUShort(v), 2, Uint16Array);\r\nexport const int = atomicReader(s => s.readInt(), (s, v) => s.writeInt(v), 4, Int32Array);\r\nexport const uint = atomicReader(s => s.readUInt(), (s, v) => s.writeUInt(v), 4, Uint32Array);\r\nexport const float = atomicReader(s => s.readFloat(), (s, v) => s.writeFloat(v), 4, Float32Array);\r\nexport const string = (len: number) => accessor(s => s.readByteString(len), (s, v) => s.writeByteString(len, v), len);\r\nexport const bits = (len: number) => accessor(s => s.readBits(len), (s, v) => s.writeBits(len, v), Math.abs(len) / 8);\r\nexport const array = <T>(type: Accessor<T>, len: number) => accessor(s => readArray(s, type, len), (s, v) => writeArray(s, type, len, v), type.size * len);\r\nexport const atomic_array = <T>(type: AtomicReader<any, T>, len: number) => accessor(s => readAtomicArray(s, type, len), (s, v) => writeAtomicArray(s, type, len, v), type.size * len);\r\nexport const struct = <T>(type: Constructor<T>) => new StructBuilder(type);\r\n\r\nconst readArray = <T>(s: Stream, type: Accessor<T>, len: number): Array<T> => {\r\n  const arr = new Array<T>();\r\n  for (let i = 0; i < len; i++)\r\n    arr[i] = type.read(s);\r\n  return arr;\r\n}\r\n\r\nconst writeArray = <T>(s: Stream, type: Accessor<T>, len: number, value: Array<T>): void => {\r\n  for (let i = 0; i < len; i++) type.write(s, value[i]);\r\n}\r\n\r\nconst readAtomicArray = <T>(s: Stream, type: AtomicReader<any, T>, len: number) => {\r\n  const ctr = type.atomicArrayConstructor;\r\n  const buffer = s.readArrayBuffer(len * type.size);\r\n  return new ctr(buffer, 0, len * type.size);\r\n}\r\n\r\nconst writeAtomicArray = <T>(s: Stream, type: AtomicReader<any, T>, len: number, value: T) => {\r\n  s.writeArrayBuffer((<any>value).buffer, len);\r\n}\r\n\r\ntype Constructor<T> = { new(): T };\r\ntype Field<T> = [T, Accessor<any>];\r\n\r\nclass StructBuilder<T, K extends keyof T> implements Accessor<T> {\r\n  private fields: Field<K>[] = [];\r\n  public size = 0;\r\n  constructor(private ctr: Constructor<T>) { }\r\n\r\n  field(f: K, r: Accessor<any>) {\r\n    this.fields.push([f, r]);\r\n    this.size += r.size;\r\n    return this;\r\n  }\r\n\r\n  read(s: Stream) {\r\n    const struct = new this.ctr();\r\n    for (let i = 0; i < this.fields.length; i++) {\r\n      const [name, reader] = this.fields[i];\r\n      struct[name] = reader.read(s);\r\n    }\r\n    return struct;\r\n  }\r\n\r\n  write(s: Stream, value: T) {\r\n    for (let i = 0; i < this.fields.length; i++) {\r\n      const [name, accessor] = this.fields[i];\r\n      accessor.write(s, value[name]);\r\n    }\r\n  }\r\n}\r\n\r\n","\r\nexport class Tiler {\r\n  private tiles: Map<string, number> = new Map();\r\n\r\n  public put(x: number, y: number, tileId: number): Tiler {\r\n    this.tiles.set(`${x},${y}`, tileId);\r\n    return this;\r\n  }\r\n\r\n  public get(x: number, y: number) {\r\n    return this.tiles.get(`${x},${y}`);\r\n  }\r\n\r\n  public size() {\r\n    return this.tiles.size;\r\n  }\r\n\r\n  public tile(cb: (x: number, y: number, tileId: number) => void) {\r\n    for (const [key, tileId] of this.tiles.entries()) {\r\n      const [x, y] = key.split(',').map(Number.parseFloat);\r\n      cb(x, y, tileId);\r\n    }\r\n  }\r\n}","import { Interpolator } from \"./interpolator\";\r\n\r\nexport type TimedValue<T> = (time: number) => T;\r\n\r\nexport function constTimed<T>(value: T): TimedValue<T> { return () => value }\r\n\r\nexport function timed<T>(startTime: number, startValue: T, endTime: number, endValue: T, interpolator: Interpolator<T>): TimedValue<T> {\r\n  const dt = endTime - startTime;\r\n  return (time: number) => {\r\n    if (time < startTime) return startValue;\r\n    if (time > endTime) return endValue;\r\n    const t = (time - startTime) / dt;\r\n    return interpolator(startValue, endValue, t);\r\n  }\r\n}\r\n\r\nexport function delayed<T>(dt: number, last: T, next: T, inter: Interpolator<T>): TimedValue<T> {\r\n  const now = performance.now();\r\n  return timed(now, last, now + dt, next, inter);\r\n}\r\n\r\nexport class DelayedValue<T> {\r\n  private startValue: T;\r\n  private endValue: T;\r\n  private time: number;\r\n\r\n  constructor(private delay: number, value: T, private inter: Interpolator<T>) {\r\n    this.endValue = value;\r\n    this.startValue = value;\r\n    this.time = 0;\r\n  }\r\n\r\n  public set(val: T) {\r\n    if (this.endValue == val) return;\r\n    this.startValue = this.get();\r\n    this.time = performance.now();\r\n    this.endValue = val;\r\n  }\r\n\r\n  public get() {\r\n    const t = performance.now() - this.time;\r\n    if (t < 0) return this.startValue;\r\n    if (t > this.delay) return this.endValue;\r\n    return this.inter(this.startValue, this.endValue, t / this.delay);\r\n  }\r\n}","import { int } from \"../mathutils\";\r\nimport { take, enumerate } from \"../collections\";\r\n\r\nexport type Widget = (ctx: CanvasRenderingContext2D, x: number, y: number) => void;\r\n\r\nexport function drawGrid(canvas: HTMLCanvasElement, widgets: Iterable<Widget>, cw: number, ch: number, bg = 'black') {\r\n  const w = canvas.clientWidth;\r\n  const h = canvas.clientHeight;\r\n  const ctx = canvas.getContext('2d');\r\n  const wcells = int(w / cw);\r\n  const hcells = int(h / ch);\r\n  const cells = wcells * hcells;\r\n\r\n  ctx.fillStyle = bg;\r\n  ctx.fillRect(0, 0, w, h);\r\n\r\n  for (const [widget, i] of enumerate(take(widgets, cells))) {\r\n    const x = (i % wcells) * cw;\r\n    const y = int(i / wcells) * ch;\r\n\r\n    ctx.save();\r\n    ctx.beginPath();\r\n    ctx.rect(x, y, w, h);\r\n    ctx.clip();\r\n\r\n    widget(ctx, x, y);\r\n    ctx.restore();\r\n  }\r\n}","import { Deck, isEmpty, map } from \"../collections\";\r\nimport { drawToCanvas } from \"../imgutils\";\r\nimport { iter } from \"../iter\";\r\nimport { int } from \"../mathutils\";\r\nimport { BlendAlpha, fit, PixelProvider } from \"../pixelprovider\";\r\nimport { drawGrid } from \"./canvasgrid\";\r\n\r\nexport class PixelDataProvider {\r\n\r\n  constructor(\r\n    private s: number,\r\n    private f: (i: number) => PixelProvider\r\n  ) { }\r\n\r\n  public size(): number {\r\n    return this.s;\r\n  }\r\n\r\n  public get(i: number): PixelProvider {\r\n    return this.f(i);\r\n  }\r\n}\r\n\r\nexport enum ScrollType {\r\n  ITEM,\r\n  ROW,\r\n  PAGE\r\n}\r\n\r\nexport class DrawPanel {\r\n  private offset = 0;\r\n  private pageIds: Deck<number> = new Deck();\r\n  private selected = new Set<number>();\r\n\r\n  constructor(\r\n    private canvas: HTMLCanvasElement,\r\n    private idsProvider: () => Iterable<number>,\r\n    private provider: PixelDataProvider,\r\n    private selectCallback: (id: number) => void,\r\n    private cellW = 64,\r\n    private cellH = 64,\r\n  ) {\r\n    canvas.onclick = (e: MouseEvent) => {\r\n      const idx = this.calcIdx(e.offsetX, e.offsetY);\r\n      if (idx != -1) this.selectCallback(idx);\r\n    }\r\n    canvas.onwheel = (e: WheelEvent) => {\r\n      if (e.altKey) {\r\n        const d = e.deltaY > 0 ? -4 : 4;\r\n        this.cellH += d;\r\n        this.cellW += d;\r\n        this.draw();\r\n      } else if (e.deltaY > 0) this.scroll(1, e.shiftKey ? ScrollType.PAGE : ScrollType.ROW);\r\n      else if (e.deltaY < 0) this.scroll(-1, e.shiftKey ? ScrollType.PAGE : ScrollType.ROW);\r\n    }\r\n  }\r\n\r\n  private prepareIds() {\r\n    this.pageIds.clear().pushAll(\r\n      iter(this.idsProvider())\r\n        .skip(this.offset)\r\n        .take(this.cellsOnPage()));\r\n    if (this.offset != 0 && isEmpty(this.pageIds)) {\r\n      this.offset = 0;\r\n      this.prepareIds();\r\n    }\r\n  }\r\n\r\n  private calcIdx(x: number, y: number) {\r\n    const cx = int(x / this.cellW);\r\n    const cy = int(y / this.cellH);\r\n    const idx = cy * this.horizontalCells() + cx;\r\n    return idx < this.pageIds.length() ? this.pageIds.get(idx) : -1;\r\n  }\r\n\r\n  private horizontalCells() { return int(this.canvas.clientWidth / this.cellW) }\r\n  private verticalCells() { return int(this.canvas.clientHeight / this.cellH) }\r\n  private cellsOnPage() { return this.horizontalCells() * this.verticalCells() }\r\n\r\n  private getDelta(type: ScrollType): number {\r\n    switch (type) {\r\n      case ScrollType.ITEM: return 1;\r\n      case ScrollType.ROW: return this.verticalCells() == 1 ? 1 : this.horizontalCells();\r\n      case ScrollType.PAGE: return this.cellsOnPage();\r\n    }\r\n  }\r\n\r\n  public seOffset(offset: number): void { this.offset = offset }\r\n\r\n  public scrollToId(id: number): void {\r\n    this.offset = 0;\r\n    const found = !iter(this.idsProvider())\r\n      .skipWhile(i => { this.offset++; return i != id })\r\n      .isEmpty();\r\n    this.offset = found ? this.offset - 1 : 0;\r\n  }\r\n\r\n  public setCellSize(w: number, h: number) {\r\n    this.cellW = w;\r\n    this.cellH = h;\r\n    this.draw();\r\n  }\r\n\r\n  public select(id: number) { this.selected.add(id) }\r\n  public deselect(id: number) { this.selected.delete(id) }\r\n  public deselectAll() { this.selected.clear() }\r\n\r\n  public scroll(off: number, type: ScrollType) {\r\n    const d = off * this.getDelta(type);\r\n    let newOffset = this.offset;\r\n    if (d > 0) {\r\n      iter(this.idsProvider())\r\n        .skip(this.offset + this.cellsOnPage())\r\n        .take(d)\r\n        .forEach(_ => newOffset++);\r\n    } else {\r\n      newOffset = Math.max(0, newOffset + d);\r\n    }\r\n    if (this.offset != newOffset) {\r\n      this.offset = newOffset;\r\n      this.draw();\r\n    }\r\n  }\r\n\r\n  private render(id: number) {\r\n    const cw = this.cellW;\r\n    const ch = this.cellH;\r\n    return (ctx: CanvasRenderingContext2D, x: number, y: number) => {\r\n      ctx.font = \"8px Arial\";\r\n      ctx.fillStyle = 'white';\r\n      ctx.strokeStyle = 'white';\r\n      ctx.textAlign = \"center\";\r\n      const img = this.provider.get(id);\r\n      if (img != null) {\r\n        const pixels = fit(cw, ch - 10, img, new Uint8Array([0, 0, 0, 255]));\r\n        drawToCanvas(pixels, ctx, x, y, BlendAlpha);\r\n      }\r\n      ctx.fillText(id + \"\", x + cw / 2, y + ch - 2);\r\n      if (this.selected.has(id)) ctx.strokeRect(x + 0.5, y + 0.5, cw - 1, ch - 1);\r\n    }\r\n  }\r\n\r\n  public draw(): void {\r\n    this.prepareIds();\r\n    drawGrid(this.canvas, map(this.pageIds, i => this.render(i)), this.cellW, this.cellH);\r\n  }\r\n}","import tippy from \"tippy.js\";\r\nimport { MenuBuilder } from \"../../app/apis/ui\";\r\nimport { iter } from \"../iter\";\r\nimport { div, Element, replaceContent, span, Table, tag } from \"./ui\";\r\n\r\nexport type ColumnRenderer<T> = (value: T) => Element;\r\n\r\nexport interface GridModel {\r\n  rows(): Promise<Iterable<any[]>>;\r\n  columns(): Iterable<ColumnRenderer<any>>;\r\n  onClick(row: any[], rowElement: Element): void;\r\n}\r\n\r\nexport type IconText = { text: string, icon: string, style: string };\r\n\r\nexport function IconTextRenderer(value: IconText): Element {\r\n  const text = span().className('icon-text').text(value.text);\r\n  if (value.style != null) text.className(value.style);\r\n  if (value.icon != null) text.append(span().className('icon pull-left ' + value.icon));\r\n  return text;\r\n}\r\n\r\nexport async function renderGrid(grid: GridModel): Promise<Element> {\r\n  const table = new Table();\r\n  table.className(\"table-striped\");\r\n  iter(await grid.rows()).forEach(dataRow => {\r\n    const columns = [...iter(grid.columns()).enumerate().map(([r, i]) => r(dataRow[i]))];\r\n    const row = table.row(columns);\r\n    row.click(() => grid.onClick(dataRow, row));\r\n  });\r\n  return table;\r\n}\r\n\r\nexport function sugggestionsMenu(items: Iterable<[string, () => void]>): SuggestionModel {\r\n  const menu = div('menu menu-default');\r\n  let selected = -1;\r\n  const options: [Element, () => void][] = [];\r\n  for (const [label, click] of items) {\r\n    const item = div('menu-item').text(label).click(() => click());\r\n    options.push([item, click]);\r\n    menu.append(item);\r\n  }\r\n  if (options.length != 0) {\r\n    selected = 0;\r\n    options[selected][0].elem().classList.add('selected');\r\n  }\r\n  return {\r\n    widget: menu.elem(),\r\n    shift(d: number) {\r\n      if (options.length == 0) return;\r\n      const newSelected = Math.min(Math.max(0, selected + d), options.length - 1);\r\n      if (newSelected != selected) {\r\n        options[selected][0].elem().classList.remove('selected');\r\n        options[newSelected][0].elem().classList.add('selected');\r\n        selected = newSelected;\r\n      }\r\n    },\r\n\r\n    select() {\r\n      if (options.length == 0) return;\r\n      else options[selected][1]();\r\n    }\r\n  }\r\n}\r\n\r\nexport function renderMenu(items: Iterable<[string, () => void]>) {\r\n  const menu = div('menu menu-default');\r\n  for (const [label, click] of items)\r\n    menu.append(div('menu-item').text(label).click(() => click()));\r\n  return menu;\r\n}\r\n\r\nexport function menuButton(icon: string, menu: MenuBuilder): HTMLElement {\r\n  const btn = tag('button').className('btn btn-default btn-dropdown').append(span().className('icon ' + icon));\r\n  menu.build(btn.elem());\r\n  return btn.elem();\r\n}\r\n\r\nexport interface SerachBar {\r\n  readonly widget: HTMLElement;\r\n  setValue(s: String): void;\r\n  updateSuggestions(model: SuggestionModel): void;\r\n}\r\n\r\nexport interface SuggestionModel {\r\n  readonly widget: HTMLElement,\r\n  shift(d: number): void;\r\n  select(): void;\r\n}\r\n\r\nexport function search(hint: string, change: (s: string) => void): SerachBar {\r\n  const suggestContainer = div('suggest');\r\n  let suggestModel: SuggestionModel = null;\r\n  const textBox = tag('input')\r\n    .className('toolbar-control')\r\n    .attr('type', 'text')\r\n    .attr('placeholder', hint)\r\n    .change(s => change(s));\r\n  const input = <HTMLInputElement>textBox.elem();\r\n  input.addEventListener('keydown', e => {\r\n    if (e.key == 'ArrowDown') suggestModel.shift(1)\r\n    else if (e.key == 'ArrowUp') suggestModel.shift(-1)\r\n    else if (e.key == 'Enter') suggestModel.select()\r\n  });\r\n  const searchBar =\r\n    tag('button').className('btn btn-default btn-mini pull-right')\r\n      .append(span().className('icon icon-search'))\r\n      .append(textBox)\r\n      .click(() => { (<HTMLInputElement>textBox.elem()).value = ''; change('') });\r\n\r\n  const inst = tippy(textBox.elem(), {\r\n    allowHTML: true,\r\n    placement: 'bottom-start',\r\n    interactive: true,\r\n    content: suggestContainer.elem(),\r\n    trigger: 'focus',\r\n    arrow: false,\r\n    offset: [0, 0],\r\n    appendTo: document.body\r\n  });\r\n\r\n  return {\r\n    widget: searchBar.elem(),\r\n    setValue(s: string) { input.value = s; inst.hide() },\r\n    updateSuggestions(model: SuggestionModel) {\r\n      suggestModel = model\r\n      const sugg = suggestContainer.elem();\r\n      replaceContent(sugg, model.widget);\r\n      inst.show();\r\n    },\r\n  }\r\n}","\r\n\r\nexport class Element {\r\n  constructor(private element: HTMLElement) { }\r\n\r\n  public className(name: string): Element {\r\n    this.element.className = name;\r\n    return this;\r\n  }\r\n\r\n  public id(id: string): Element {\r\n    this.element.id = id;\r\n    return this;\r\n  }\r\n\r\n  public text(text: string): Element {\r\n    this.element.textContent = text;\r\n    return this;\r\n  }\r\n\r\n  public appendHtml(html: HTMLElement): Element {\r\n    this.element.appendChild(html);\r\n    return this;\r\n  }\r\n\r\n  public append(element: Element): Element {\r\n    this.element.appendChild(element.element);\r\n    return this;\r\n  }\r\n\r\n  public pos(x: string, y: string): Element {\r\n    this.element.style.left = x;\r\n    this.element.style.top = y;\r\n    return this;\r\n  }\r\n\r\n  public size(w: string, h: string): Element {\r\n    this.element.style.width = w;\r\n    this.element.style.height = h;\r\n    return this;\r\n  }\r\n\r\n  public width(w: string): Element {\r\n    this.element.style.width = w;\r\n    return this;\r\n  }\r\n\r\n  public height(h: string): Element {\r\n    this.element.style.height = h;\r\n    return this;\r\n  }\r\n\r\n  public elem(): HTMLElement {\r\n    return this.element;\r\n  }\r\n\r\n  public attr(name: string, val: any): Element {\r\n    this.element.setAttribute(name, val);\r\n    return this;\r\n  }\r\n\r\n  public css(name: string, val: any): Element {\r\n    this.element.style[name] = val;\r\n    return this;\r\n  }\r\n\r\n  public click(e: () => void): Element {\r\n    this.element.onclick = e;\r\n    return this;\r\n  }\r\n\r\n  public change(cb: (s: string) => void): Element {\r\n    this.element.oninput = (e) => {\r\n      cb((<HTMLInputElement>e.target).value);\r\n    };\r\n    return this;\r\n  }\r\n}\r\n\r\nfunction create(tag: string) {\r\n  return document.createElement(tag);\r\n}\r\n\r\nexport class Table extends Element {\r\n  private tbody: Element;\r\n  private thead: Element;\r\n\r\n  constructor() {\r\n    super(create('table'));\r\n    this.thead = new Element(create('thead'));\r\n    this.tbody = new Element(create('tbody'));\r\n    this.append(this.thead);\r\n    this.append(this.tbody);\r\n  }\r\n\r\n  public head(cols: Element[]): Table {\r\n    let tr = new Element(create('tr'));\r\n    for (let i = 0; i < cols.length; i++) {\r\n      let c = cols[i];\r\n      let td = new Element(create('th')).append(c);\r\n      tr.append(td);\r\n    }\r\n    this.thead.append(tr);\r\n    return this;\r\n  }\r\n\r\n  public row(cols: Element[]): Element {\r\n    let tr = new Element(create('tr'));\r\n    for (let i = 0; i < cols.length; i++) {\r\n      let c = cols[i];\r\n      let td = new Element(create('td')).append(c);\r\n      tr.append(td);\r\n    }\r\n    this.tbody.append(tr);\r\n    return tr;\r\n  }\r\n\r\n  public removeRow(row: number): Table {\r\n    (<HTMLTableElement>this.tbody.elem()).deleteRow(row);\r\n    return this;\r\n  }\r\n}\r\n\r\nexport declare module Object {\r\n  export function keys(obj: any): any;\r\n}\r\n\r\nexport class Properties extends Table {\r\n  private labels: any = {};\r\n\r\n  constructor() {\r\n    super();\r\n    this.className('props');\r\n  }\r\n\r\n  public prop(name: string, el: Element): Properties {\r\n    this.row([div('property_name').text(name), el]);\r\n    return this;\r\n  }\r\n\r\n  public refresh(props: any): Properties {\r\n    let fields = Object.keys(props);\r\n    for (let i = 0; i < fields.length; i++) {\r\n      let field = fields[i];\r\n      let l = this.labels[field];\r\n      if (l == undefined) {\r\n        l = label('');\r\n        this.labels[field] = l;\r\n        this.prop(field, l);\r\n      }\r\n      l.text(props[field] + '');\r\n    }\r\n    return this;\r\n  }\r\n}\r\n\r\nexport function tag(tag: string): Element {\r\n  return new Element(create(tag));\r\n}\r\n\r\nexport function div(className: string): Element {\r\n  return new Element(create('div')).className(className);\r\n}\r\n\r\nexport function span(): Element {\r\n  return new Element(create('span'))\r\n}\r\n\r\nexport function table(): Table {\r\n  return new Table();\r\n}\r\n\r\nexport function props(): Properties {\r\n  return new Properties();\r\n}\r\n\r\nexport function label(text: string): Element {\r\n  return div('label').text(text);\r\n}\r\n\r\nexport function button(caption: string): Element {\r\n  return div('contour').append(div('button').text(caption));\r\n}\r\n\r\nexport function panel(title: string): Element {\r\n  return div('frame')\r\n    .append(div('header').text(title))\r\n    .append(div('hline'))\r\n    .append(div('content'));\r\n}\r\n\r\nexport class Progress extends Element {\r\n  private title: Element;\r\n  private progress: Element;\r\n\r\n  constructor(title: string, max: number = 100) {\r\n    super(create('div'));\r\n    this.title = div('title').text(title);\r\n    this.progress = new Element(create('progress')).attr('max', max);\r\n    this.append(this.title).append(this.progress);\r\n  }\r\n\r\n  public max(max: number): Progress {\r\n    this.progress.attr('max', max);\r\n    return this;\r\n  }\r\n\r\n  public setValue(val: number): Progress {\r\n    this.progress.attr('value', val);\r\n    return this;\r\n  }\r\n}\r\n\r\nexport function progress(title: string, max: number = 100) {\r\n  return new Progress(title, max);\r\n}\r\n\r\nexport class VerticalPanel extends Element {\r\n  private rows = 0;\r\n  constructor(className: string) {\r\n    super(create('div'));\r\n    this.className(className);\r\n  }\r\n\r\n  public add(elem: Element): number {\r\n    this.append(elem);\r\n    return this.rows++;\r\n  }\r\n}\r\n\r\nexport function verticalPanel(className: string): VerticalPanel {\r\n  return new VerticalPanel(className);\r\n}\r\n\r\nexport function dragElement(header: HTMLElement, elment: HTMLElement) {\r\n  let startx = 0;\r\n  let starty = 0;\r\n  let onmouseup = null;\r\n  let onmousemove = null;\r\n  header.onmousedown = dragMouseDown;\r\n\r\n  function dragMouseDown(e: MouseEvent) {\r\n    e.preventDefault();\r\n    startx = e.clientX;\r\n    starty = e.clientY;\r\n    onmouseup = document.onmouseup;\r\n    onmousemove = document.onmousemove;\r\n    document.onmouseup = closeDragElement;\r\n    document.onmousemove = elementDrag;\r\n  }\r\n\r\n  function elementDrag(e: MouseEvent) {\r\n    e.preventDefault();\r\n    let x = startx - e.clientX;\r\n    let y = starty - e.clientY;\r\n    startx = e.clientX;\r\n    starty = e.clientY;\r\n    elment.style.top = (elment.offsetTop - y) + \"px\";\r\n    elment.style.left = (elment.offsetLeft - x) + \"px\";\r\n  }\r\n\r\n  function closeDragElement() {\r\n    document.onmouseup = onmouseup;\r\n    document.onmousemove = onmousemove;\r\n  }\r\n}\r\n\r\nexport function closeModal<T>(window: HTMLElement, cb: (v: T) => void, value: T) {\r\n  window.classList.add('hidden');\r\n  cb(value);\r\n}\r\n\r\nexport function stopPropagation(e: Event) {\r\n  e.stopPropagation();\r\n  e.preventDefault();\r\n}\r\n\r\nexport function addDragAndDrop(elem: HTMLElement, dropHandler: (e: DragEvent) => void) {\r\n  elem.addEventListener(\"dragenter\", stopPropagation, false);\r\n  elem.addEventListener(\"dragover\", stopPropagation, false);\r\n  elem.addEventListener(\"drop\", (e) => {\r\n    stopPropagation(e);\r\n    dropHandler(e);\r\n  }, false);\r\n}\r\n\r\nexport function replaceContent(root: HTMLElement, newchild: HTMLElement) {\r\n  const child = root.firstChild;\r\n  if (child) root.replaceChild(newchild, child);\r\n  else root.appendChild(newchild);\r\n}","import * as GLM from '../libs_js/glmatrix';\r\nimport * as MU from './mathutils';\r\n\r\nexport function intersect2d(p1s:GLM.Vec2Array, p1e:GLM.Vec2Array, p2s:GLM.Vec2Array, p2e:GLM.Vec2Array):GLM.Vec2Array {\r\n  let t = intersect2dT(p1s, p1e, p2s, p2e);\r\n  if (t == null)\r\n    return null;\r\n  return GLM.vec2.lerp(GLM.vec2.create(), p1s, p1e, t);\r\n}\r\n\r\n\r\nexport function intersect2dT(p1s:GLM.Vec2Array, p1e:GLM.Vec2Array, p2s:GLM.Vec2Array, p2e:GLM.Vec2Array):number {\r\n  let d = (p1s[0]-p1e[0])*(p2s[1]-p2e[1]) - (p1s[1]-p1e[1])*(p2s[0]-p2e[0]);\r\n  if (Math.abs(d) < MU.EPS)\r\n    return null;\r\n  let res0 = ((p1s[0]*p1e[1]-p1s[1]*p1e[0])*(p2s[0]-p2e[0]) - (p1s[0]-p1e[0])*(p2s[0]*p2e[1]-p2s[1]*p2e[0])) / d;\r\n  let res1 = ((p1s[0]*p1e[1]-p1s[1]*p1e[0])*(p2s[1]-p2e[1]) - (p1s[1]-p1e[1])*(p2s[0]*p2e[1]-p2s[1]*p2e[0])) / d;\r\n\r\n  let dx1 = p1e[0]-p1s[0];\r\n  let dy1 = p1e[1]-p1s[1];\r\n  let dot1 = ((res0-p1s[0])*dx1 + (res1-p1s[1])*dy1) / MU.sqrLen2d(dx1, dy1);\r\n  if (dot1 < 0.0 || dot1 > 1.0)\r\n    return null;\r\n  let dx2 = p2e[0]-p2s[0];\r\n  let dy2 = p2e[1]-p2s[1];\r\n  let dot2 = ((res0-p2s[0])*dx2 + (res1-p2s[1])*dy2) / MU.sqrLen2d(dx2, dy2);\r\n  if (dot2 < 0.0 || dot2 > 1.0)\r\n    return null;\r\n\r\n  return dot1;\r\n}\r\n\r\nexport function direction3d(ps:GLM.Vec3Array, pe:GLM.Vec3Array):GLM.Vec3Array {\r\n  let dir = GLM.vec3.sub(GLM.vec3.create(), pe, ps);\r\n  return GLM.vec3.normalize(dir, dir);\r\n}\r\n\r\nexport function direction2d(ps:GLM.Vec2Array, pe:GLM.Vec2Array):GLM.Vec2Array {\r\n  let dir = GLM.vec2.sub(GLM.vec2.create(), pe, ps);\r\n  return GLM.vec2.normalize(dir, dir);\r\n}\r\n\r\nexport function projectXY(p:GLM.Vec3Array):GLM.Vec2Array {return GLM.vec2.fromValues(p[0], p[1])}\r\nexport function projectXZ(p:GLM.Vec3Array):GLM.Vec2Array {return GLM.vec2.fromValues(p[0], p[2])}\r\nexport function projectYZ(p:GLM.Vec3Array):GLM.Vec2Array {return GLM.vec2.fromValues(p[1], p[2])}\r\n\r\nexport function intersect3d(p1s:GLM.Vec3Array, p1e:GLM.Vec3Array, p2s:GLM.Vec3Array, p2e:GLM.Vec3Array):GLM.Vec3Array {\r\n  let dir1 = direction3d(p1s, p1e);\r\n  let dir2 = direction3d(p2s, p2e);\r\n\r\n  let p = \r\n    (dir1[1]*dir2[0] - dir2[1]*dir1[0]) != 0 ? projectXY :\r\n    (dir1[0]*dir2[1] - dir2[0]*dir1[1]) != 0 ? projectXZ :\r\n    (dir1[1]*dir2[2] - dir2[1]*dir1[2]) != 0 ? projectYZ :\r\n    null;\r\n  \r\n  if (p == null)\r\n    return null;\r\n  let p1s_ = p(p1s);\r\n  let p2s_ = p(p2s);\r\n  let p1e_ = p(p1e);\r\n  let p2e_ = p(p2e);\r\n  let t = intersect2dT(p1s_, p1e_, p2s_, p2e_);\r\n\r\n  if (t == null)\r\n    return null;\r\n  return GLM.vec3.lerp(GLM.vec3.create(), p1s, p1e, t);\r\n}\r\n\r\nexport function reflectVec3d(out:GLM.Vec3Array, id:GLM.Vec3Array, n:GLM.Vec3Array):GLM.Vec3Array {\r\n  let dot = GLM.vec3.dot(n, id);\r\n  GLM.vec3.scale(out, n, dot * 2);\r\n  GLM.vec3.sub(out, id, out);\r\n  return out;\r\n}\r\n\r\nlet tmp = GLM.vec3.create();\r\nexport function reflectPoint3d(out:GLM.Vec3Array, mirrorNormal:GLM.Vec3Array, mirrorD:number, point:GLM.Vec3Array) {\r\n  let t = GLM.vec3.dot(point, mirrorNormal) + mirrorD;\r\n  GLM.vec3.scale(tmp, mirrorNormal, t * 2)\r\n  return GLM.vec3.sub(out, point, tmp);\r\n}\r\n\r\nexport function normal2d(out:GLM.Vec2Array, vec:GLM.Vec2Array) {\r\n  GLM.vec2.set(out, vec[1], -vec[0]);\r\n  return GLM.vec2.normalize(out, out);\r\n}\r\n\r\nlet side = GLM.vec3.create();\r\nlet up = GLM.vec3.create();\r\nlet forward = GLM.vec3.create();\r\nlet oside = GLM.vec3.create();\r\nlet oup = GLM.vec3.create();\r\nlet oforward = GLM.vec3.create();\r\nlet mirroredPos = GLM.vec3.create();\r\nexport function mirrorBasis(out:GLM.Mat4Array, mat:GLM.Mat4Array, point:GLM.Vec3Array, mirrorNormal:GLM.Vec3Array, mirrorD:number) {\r\n  GLM.vec3.set(oside, mat[0], mat[4], mat[8]);\r\n  GLM.vec3.set(oup, mat[1], mat[5], mat[9]);\r\n  GLM.vec3.set(oforward, mat[2], mat[6], mat[10]);\r\n  reflectVec3d(side, oside, mirrorNormal);\r\n  reflectVec3d(up, oup, mirrorNormal);\r\n  reflectVec3d(forward, oforward, mirrorNormal);\r\n  reflectPoint3d(mirroredPos, mirrorNormal, mirrorD, point);\r\n\r\n  GLM.mat4.identity(out);\r\n  out[0] = side[0]; out[1] = up[0]; out[2] = forward[0]; out[3] = 0;\r\n  out[4] = side[1]; out[5] = up[1]; out[6] = forward[1]; out[7] = 0;\r\n  out[8] = side[2]; out[9] = up[2]; out[10] = forward[2]; out[11] = 0;\r\n  GLM.vec3.negate(mirroredPos, mirroredPos);\r\n  GLM.mat4.translate(out, out, mirroredPos);\r\n  return out;\r\n}\r\n\r\n/*\r\nexport function normal2d(v1:GLM.Vec2Array, v2:GLM.Vec2Array):GLM.Vec2Array {\r\n  let tmp = normalize2d(subCopy2d(v2, v1));\r\n  let norm = fromValues2d(-tmp[1], tmp[0]);\r\n  release2d(tmp);\r\n  return norm;\r\n}\r\n\r\n//\r\n//   p1     p3\r\n//    \\ ang /\r\n//     \\ ^ /\r\n//      \\ /\r\n//      p2\r\nexport function ang2d(p1:GLM.Vec2Array, p2:GLM.Vec2Array, p3:GLM.Vec2Array):number {\r\n  let toNext = subCopy2d(p3, p2); normalize2d(toNext);\r\n  let toPrev = subCopy2d(p1, p2); normalize2d(toPrev);\r\n  let angToNext = Math.acos(toNext[0]);\r\n  angToNext = toNext[1] < 0 ? MU.PI2 - angToNext : angToNext;\r\n  let angToPrev = Math.acos(toPrev[0]);\r\n  angToPrev = toPrev[1] < 0 ? MU.PI2 - angToPrev : angToPrev;\r\n  release2d(toNext); release2d(toPrev);\r\n  let ang = angToNext - angToPrev;\r\n  ang = (ang < 0 ? MU.PI2 + ang : ang);\r\n  return ang;\r\n}\r\n\r\nexport function isCW(polygon:GLM.VecArray[]):boolean {\r\n  let angsum = 0;\r\n  let N = polygon.length;\r\n  for (let i = 0; i < N; i++) {\r\n    let curr = polygon[i];\r\n    let prev = polygon[i == 0 ? N - 1 : i - 1];\r\n    let next = polygon[i == N - 1 ? 0 : i + 1];\r\n    angsum += ang2d(prev, curr, next);\r\n  }\r\n  return MU.rad2deg(angsum) == 180*(N-2);\r\n}\r\n\r\n\r\nexport function projectionSpace(vtxs:GLM.Vec3Array[], n:GLM.Vec3Array) {\r\n  let a = normalize3d(subCopy3d(vtxs[0], vtxs[1]));\r\n  let c = normalize3d(crossCopy3d(n, a));\r\n  let ret = [\r\n    a[0], c[0], n[0],\r\n    a[1], c[1], n[1],\r\n    a[2], c[2], n[2]\r\n  ];\r\n  release3d(a); release3d(c); \r\n  return ret;\r\n}\r\n\r\nexport function project3d(vtxs:GLM.Vec3Array[], normal:GLM.Vec3Array):GLM.Vec2Array[] {\r\n  let mat = projectionSpace(vtxs, normal);\r\n  let ret = [];\r\n  for (let i = 0; i < vtxs.length; i++) {\r\n    let vtx = GLM.vec3.transformMat3(GLM.vec3.create(), vtxs[i], mat);\r\n    ret.push([vtx[0], vtx[1]]);\r\n  }\r\n  return ret;\r\n}\r\n*/\r\n\r\n\r\n"],"sourceRoot":""}